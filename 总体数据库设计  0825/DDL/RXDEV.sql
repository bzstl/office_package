/*
Navicat Oracle Data Transfer
Oracle Client Version : 11.2.0.2.0

Source Server         : RXDEV
Source Server Version : 110200
Source Host           : 192.168.201.192:1521
Source Schema         : RXDEV

Target Server Type    : ORACLE
Target Server Version : 110200
File Encoding         : 65001

Date: 2017-05-19 14:08:09
*/


-- ----------------------------
-- Table structure for AR_CALL_SIGN_T
-- ----------------------------
DROP TABLE "RXDEV"."AR_CALL_SIGN_T";
CREATE TABLE "RXDEV"."AR_CALL_SIGN_T" (
"CALL_SIGN_ID" VARCHAR2(10 BYTE) NOT NULL ,
"USER_NAME" VARCHAR2(20 BYTE) NULL ,
"USER_ID" VARCHAR2(50 BYTE) NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;



-- ----------------------------
-- Table structure for FRBT_ASSIGN_TEMP_BUSINESS
-- ----------------------------
DROP TABLE "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS";
CREATE TABLE "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"ORG_NAME" VARCHAR2(80 BYTE) NULL ,
"PURPOSE" VARCHAR2(80 BYTE) NULL ,
"ADDR" VARCHAR2(80 BYTE) NULL ,
"START_DATE" DATE NULL ,
"END_DATE" DATE NULL ,
"MEMO" VARCHAR2(512 BYTE) NULL ,
"FREQ_COUNT" NUMBER(4) NULL ,
"FREQ_RANGE" VARCHAR2(512 BYTE) NULL ,
"APPROVE_INFO" VARCHAR2(512 BYTE) NULL ,
"APPROVE_DATE" DATE NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS"."ORG_NAME" IS '申请单位名称';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS"."PURPOSE" IS '使用目的';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS"."ADDR" IS '使用地点';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS"."START_DATE" IS '开始时间';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS"."END_DATE" IS '结束时间';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS"."MEMO" IS '备注';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS"."FREQ_COUNT" IS '频率数量';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS"."FREQ_RANGE" IS '频率范围';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS"."APPROVE_INFO" IS '审批信息';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS"."APPROVE_DATE" IS '审批时间';

-- ----------------------------
-- Table structure for FRBT_ASSIGN_TEMP_FILE
-- ----------------------------
DROP TABLE "RXDEV"."FRBT_ASSIGN_TEMP_FILE";
CREATE TABLE "RXDEV"."FRBT_ASSIGN_TEMP_FILE" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"ASSIGN_GUID" VARCHAR2(36 BYTE) NULL ,
"FILE_NAME" VARCHAR2(80 BYTE) NULL ,
"ISFREQFILE" VARCHAR2(8 BYTE) NULL ,
"FILE_DATA" BLOB NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_FILE"."ASSIGN_GUID" IS '指配主键';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_FILE"."FILE_NAME" IS '文件名称';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_FILE"."ISFREQFILE" IS '是否频率附件，0否1是';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_FILE"."FILE_DATA" IS '文件数据';

-- ----------------------------
-- Table structure for FRBT_ASSIGN_TEMP_MATCH
-- ----------------------------
DROP TABLE "RXDEV"."FRBT_ASSIGN_TEMP_MATCH";
CREATE TABLE "RXDEV"."FRBT_ASSIGN_TEMP_MATCH" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"ORG_NAME" VARCHAR2(80 BYTE) NULL ,
"EVENT_NAME" VARCHAR2(80 BYTE) NULL ,
"ADDR" VARCHAR2(128 BYTE) NULL ,
"START_DATE" DATE NULL ,
"FREQ_RANGE" VARCHAR2(128 BYTE) NULL ,
"MEMO" VARCHAR2(512 BYTE) NULL ,
"END_DATE" DATE NULL ,
"FREQ_COUNT" NUMBER(4) NULL ,
"APPROVE_INFO" VARCHAR2(512 BYTE) NULL ,
"APPROVE_DATE" DATE NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_MATCH"."ORG_NAME" IS '申请单位名称';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_MATCH"."EVENT_NAME" IS '事件名称';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_MATCH"."ADDR" IS '使用地点';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_MATCH"."START_DATE" IS '开始时间';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_MATCH"."FREQ_RANGE" IS '频率范围';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_MATCH"."MEMO" IS '备注';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_MATCH"."END_DATE" IS '结束时间';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_MATCH"."FREQ_COUNT" IS '频率数量';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_MATCH"."APPROVE_INFO" IS '审批信息';
COMMENT ON COLUMN "RXDEV"."FRBT_ASSIGN_TEMP_MATCH"."APPROVE_DATE" IS '审批时间';

-- ----------------------------
-- Table structure for FRBT_RESOURCE
-- ----------------------------
DROP TABLE "RXDEV"."FRBT_RESOURCE";
CREATE TABLE "RXDEV"."FRBT_RESOURCE" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"RESOURCE_NAME" VARCHAR2(80 BYTE) NULL ,
"NET_SVN" VARCHAR2(10 BYTE) NULL ,
"NET_TS" VARCHAR2(8 BYTE) NULL ,
"RESOURCE_COLOR" VARCHAR2(12 BYTE) NULL ,
"ORDERNUM" NUMBER(4) NULL ,
"MEMO" VARCHAR2(512 BYTE) NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE"."RESOURCE_NAME" IS '资源名称';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE"."NET_SVN" IS '通信业务/系统类型

台站代码数据 00452006';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE"."NET_TS" IS '技术体制

台站代码数据00012006';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE"."RESOURCE_COLOR" IS '颜色';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE"."ORDERNUM" IS '排序';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE"."MEMO" IS '备注';

-- ----------------------------
-- Table structure for FRBT_RESOURCE_BAND
-- ----------------------------
DROP TABLE "RXDEV"."FRBT_RESOURCE_BAND";
CREATE TABLE "RXDEV"."FRBT_RESOURCE_BAND" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"RESOURCE_GUID" VARCHAR2(36 BYTE) NULL ,
"BAND_NAME" VARCHAR2(80 BYTE) NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_BAND"."RESOURCE_GUID" IS '频率资源GUID';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_BAND"."BAND_NAME" IS '频段名称';

-- ----------------------------
-- Table structure for FRBT_RESOURCE_BAND_FREQ
-- ----------------------------
DROP TABLE "RXDEV"."FRBT_RESOURCE_BAND_FREQ";
CREATE TABLE "RXDEV"."FRBT_RESOURCE_BAND_FREQ" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"BAND_GUID" VARCHAR2(36 BYTE) NULL ,
"BAND_FB" NUMBER(14,7) NULL ,
"BAND_FE" NUMBER(14,7) NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_BAND_FREQ"."BAND_GUID" IS '频段GUID';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_BAND_FREQ"."BAND_FB" IS '频率下限';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_BAND_FREQ"."BAND_FE" IS '频率上限';

-- ----------------------------
-- Table structure for FRBT_RESOURCE_FREQ
-- ----------------------------
DROP TABLE "RXDEV"."FRBT_RESOURCE_FREQ";
CREATE TABLE "RXDEV"."FRBT_RESOURCE_FREQ" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"GROUP_GUID" VARCHAR2(36 BYTE) NULL ,
"FREQ_CHAN" NUMBER(5) NULL ,
"FREQ_UC" NUMBER(14,7) NULL ,
"FREQ_LC" NUMBER(14,7) NULL ,
"FREQ_BAND" NUMBER(14,7) NULL ,
"FREQ_STATUS" VARCHAR2(8 BYTE) NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_FREQ"."GROUP_GUID" IS '分组GUID';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_FREQ"."FREQ_CHAN" IS '频率代号';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_FREQ"."FREQ_UC" IS '发射频率	单位：MHz';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_FREQ"."FREQ_LC" IS '接收频率	单位：MHz';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_FREQ"."FREQ_BAND" IS '信道间隔	单位：MHz';

-- ----------------------------
-- Table structure for FRBT_RESOURCE_GROUP
-- ----------------------------
DROP TABLE "RXDEV"."FRBT_RESOURCE_GROUP";
CREATE TABLE "RXDEV"."FRBT_RESOURCE_GROUP" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"BAND_GUID" VARCHAR2(36 BYTE) NULL ,
"GROUP_NAME" VARCHAR2(80 BYTE) NULL ,
"DDLGL" VARCHAR2(8 BYTE) NULL ,
"FREQ_LB" NUMBER(14,7) NULL ,
"FREQ_LE" NUMBER(14,7) NULL ,
"FREQ_UB" NUMBER(14,7) NULL ,
"FREQ_UE" NUMBER(14,7) NULL ,
"FREQ_BAND" NUMBER(14,7) NULL ,
"CHANNEL_NUM" NUMBER(3) NULL ,
"MEMO" VARCHAR2(512 BYTE) NULL ,
"MANAGER" VARCHAR2(8 BYTE) NULL ,
"DDL_TYPE" VARCHAR2(8 BYTE) NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."BAND_GUID" IS '频段GUID';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."GROUP_NAME" IS '分组名称';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."DDLGL" IS '功率范围(W)';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."FREQ_LB" IS '下行频率下限';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."FREQ_LE" IS '下行频率上限';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."FREQ_UB" IS '上行频率下限';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."FREQ_UE" IS '上行频率上限';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."FREQ_BAND" IS '信道间隔';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."CHANNEL_NUM" IS '频点个数/频点对数';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."MEMO" IS '备注';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."MANAGER" IS '管理权限';
COMMENT ON COLUMN "RXDEV"."FRBT_RESOURCE_GROUP"."DDL_TYPE" IS '组网方式';

-- ----------------------------
-- Table structure for IP_SYS_SEQUENCE
-- ----------------------------
DROP TABLE "RXDEV"."IP_SYS_SEQUENCE";
CREATE TABLE "RXDEV"."IP_SYS_SEQUENCE" (
"ID" VARCHAR2(64 BYTE) NOT NULL ,
"CURRENT_YEAR" NUMBER(10) NOT NULL ,
"CURRENT_NUM" NUMBER(10) NOT NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON TABLE "RXDEV"."IP_SYS_SEQUENCE" IS '申请表序号表';
COMMENT ON COLUMN "RXDEV"."IP_SYS_SEQUENCE"."ID" IS '主键';
COMMENT ON COLUMN "RXDEV"."IP_SYS_SEQUENCE"."CURRENT_YEAR" IS '当前年份';
COMMENT ON COLUMN "RXDEV"."IP_SYS_SEQUENCE"."CURRENT_NUM" IS '当前序号';

-- ----------------------------
-- Table structure for RSBT_TEMPORARY
-- ----------------------------
DROP TABLE "RXDEV"."RSBT_TEMPORARY";
CREATE TABLE "RXDEV"."RSBT_TEMPORARY" (
"GUID" VARCHAR2(128 BYTE) NOT NULL ,
"APP_CODE" VARCHAR2(14 BYTE) NULL ,
"STAT_TDI" VARCHAR2(14 BYTE) NULL ,
"DATA_JSON" VARCHAR2(4000 BYTE) NULL ,
"APP_TYPE" VARCHAR2(8 BYTE) NULL ,
"PROCESS_STATE" VARCHAR2(8 BYTE) DEFAULT 0  NULL ,
"PA_TYPE" VARCHAR2(8 BYTE) NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."RSBT_TEMPORARY"."APP_TYPE" IS '申请表类型';
COMMENT ON COLUMN "RXDEV"."RSBT_TEMPORARY"."PROCESS_STATE" IS '流程状态(0：未开始，1：审批中，2：审批结束)';
COMMENT ON COLUMN "RXDEV"."RSBT_TEMPORARY"."PA_TYPE" IS '0:国表17  1:国表19';

-- ----------------------------
-- Table structure for SPLSTATION_CONDITION
-- ----------------------------
DROP TABLE "RXDEV"."SPLSTATION_CONDITION";
CREATE TABLE "RXDEV"."SPLSTATION_CONDITION" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"CONDITION_TRADE" VARCHAR2(4000 BYTE) NULL ,
"CONDITION_COMPANY" VARCHAR2(4000 BYTE) NULL ,
"CONDITION_DATATAB" VARCHAR2(128 BYTE) NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONDITION"."GUID" IS '主键';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONDITION"."CONDITION_TRADE" IS '所属行业';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONDITION"."CONDITION_DATATAB" IS '涉及特殊台站的技术资料表类型';

-- ----------------------------
-- Table structure for SPLSTATION_CONSULT
-- ----------------------------
DROP TABLE "RXDEV"."SPLSTATION_CONSULT";
CREATE TABLE "RXDEV"."SPLSTATION_CONSULT" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"SPLSTATION_GUID" VARCHAR2(36 BYTE) NOT NULL ,
"CONSULT_OBJECT" VARCHAR2(128 BYTE) NULL ,
"CONSULT_ADDRESS" VARCHAR2(256 BYTE) NULL ,
"CONSULT_CONTENT" VARCHAR2(512 BYTE) NULL ,
"CONSULT_FILENAME" VARCHAR2(128 BYTE) NULL ,
"CONSULT_FILE" BLOB NULL ,
"CONSULT_TIME" DATE NULL ,
"REPLY_TIME" DATE NULL ,
"CONSULT_RESULT" VARCHAR2(512 BYTE) NULL ,
"REPLAY_FILENAME" VARCHAR2(128 BYTE) NULL ,
"REPLAY_FILE" BLOB NULL ,
"CONSULT_STATUS" VARCHAR2(8 BYTE) NULL ,
"CREATETIME" DATE NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."GUID" IS '主键ID';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."SPLSTATION_GUID" IS '特殊台站管理ID';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."CONSULT_OBJECT" IS '征询对象';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."CONSULT_ADDRESS" IS '征询地址';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."CONSULT_CONTENT" IS '征询内容';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."CONSULT_FILENAME" IS '征询附件名称';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."CONSULT_FILE" IS '征询附件';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."CONSULT_TIME" IS '征询时间';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."REPLY_TIME" IS '回询时间';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."CONSULT_RESULT" IS '征询结果';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."REPLAY_FILENAME" IS '回询附件名称';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."REPLAY_FILE" IS '回询附件';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."CONSULT_STATUS" IS '征询状态<0:待回复 1:同意建站 2:驳回建站>';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_CONSULT"."CREATETIME" IS '创建时间';

-- ----------------------------
-- Table structure for SPLSTATION_ELECTENV
-- ----------------------------
DROP TABLE "RXDEV"."SPLSTATION_ELECTENV";
CREATE TABLE "RXDEV"."SPLSTATION_ELECTENV" (
"GUID" VARCHAR2(36 BYTE) NULL ,
"SPECIAL_STATION_GUID" VARCHAR2(36 BYTE) NULL ,
"FILE_NAME" VARCHAR2(128 BYTE) NULL ,
"FILE_ENCLOSEURE" BLOB NULL ,
"CREATETIME" DATE NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."SPLSTATION_ELECTENV"."GUID" IS '主键ID';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_ELECTENV"."SPECIAL_STATION_GUID" IS '特殊台站关联ID';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_ELECTENV"."FILE_NAME" IS '附件名称';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_ELECTENV"."FILE_ENCLOSEURE" IS '附件';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_ELECTENV"."CREATETIME" IS '创建时间';

-- ----------------------------
-- Table structure for SPLSTATION_MANGER
-- ----------------------------
DROP TABLE "RXDEV"."SPLSTATION_MANGER";
CREATE TABLE "RXDEV"."SPLSTATION_MANGER" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"STATION_GUID" VARCHAR2(128 BYTE) NOT NULL ,
"STATION_PIC" BLOB NULL ,
"BUILD_GLOBAL_PIC" BLOB NULL ,
"DOORPLATE_PIC" BLOB NULL ,
"POSITION_GLOBAL_PIC" BLOB NULL ,
"ANTFEED_PIC" BLOB NULL ,
"ANTFEED_POINT_PIC" BLOB NULL ,
"AREA_PLANE_PIC" BLOB NULL ,
"STOP_SKETCH_PIC" BLOB NULL ,
"AREA_SATELLITE_PIC" BLOB NULL ,
"STATION_PURPOSE" VARCHAR2(512 BYTE) NULL ,
"SERVICE_TYPE" VARCHAR2(512 BYTE) NULL ,
"STATION_ATTR" VARCHAR2(8 BYTE) NULL ,
"WORK_PERIODTIME_TYPE" VARCHAR2(8 BYTE) NULL ,
"WORK_PERIODTIME_DATA" VARCHAR2(512 BYTE) NULL ,
"REPLACE_WIRED" VARCHAR2(8 BYTE) NULL ,
"REPLACE_WIRED_REASON" VARCHAR2(512 BYTE) NULL ,
"REPLACE_PUBLIC" VARCHAR2(8 BYTE) NULL ,
"REPLACE_PUBLIC_REASON" VARCHAR2(512 BYTE) NULL ,
"REPLACE_OTHER" VARCHAR2(512 BYTE) NULL ,
"EQU_REFORM" VARCHAR2(8 BYTE) NULL ,
"EQU_REFORM_CON" VARCHAR2(512 BYTE) NULL ,
"EQU_INSTRUCTIONS_FILE" BLOB NULL ,
"EQU_INSTRUCTIONS_FILENAME" VARCHAR2(128 BYTE) NULL ,
"INTERFERE_INFLUENCE" VARCHAR2(8 BYTE) NULL ,
"INTERFERE_ENV_TYPE" VARCHAR2(8 BYTE) NULL ,
"INTERFERE_FEATURES" VARCHAR2(8 BYTE) NULL ,
"INTERFERE_CYCLE" VARCHAR2(8 BYTE) NULL ,
"INTERFERE_PERAZI" VARCHAR2(128 BYTE) NULL ,
"TRAFFIC_INTERFERE" VARCHAR2(8 BYTE) NULL ,
"TRAFFIC_INTERFERE_DATA" VARCHAR2(256 BYTE) NULL ,
"ISM_INTERFERE" VARCHAR2(8 BYTE) NULL ,
"ISM_INTERVALDES" VARCHAR2(512 BYTE) NULL ,
"POWER_INTERFERE" VARCHAR2(8 BYTE) NULL ,
"POWER_INTERFERE_DATA" VARCHAR2(256 BYTE) NULL ,
"RESIDENT_CONAREA" VARCHAR2(8 BYTE) NULL ,
"RESIDENT_CONAREA_DATA" VARCHAR2(4000 BYTE) NULL ,
"RELEVANT_STATUTE" VARCHAR2(512 BYTE) NULL ,
"RELEVANT_POLICY" VARCHAR2(512 BYTE) NULL ,
"RELEVANT_TECHNOLOGY" VARCHAR2(512 BYTE) NULL ,
"DESIGN_DATA" VARCHAR2(512 BYTE) NULL ,
"PROTECT_REQUIREMENT" VARCHAR2(512 BYTE) NULL ,
"PROTECT_PROPOSAL" VARCHAR2(512 BYTE) NULL ,
"PROTECT_INTERVAL" VARCHAR2(512 BYTE) NULL ,
"PROTECT_MEASURE" VARCHAR2(512 BYTE) NULL ,
"LEGAL_PROVE" VARCHAR2(512 BYTE) NULL ,
"LEGAL_PROVE_FILENAME" VARCHAR2(128 BYTE) NULL ,
"LEGAL_PROVE_FILE" BLOB NULL ,
"PROTECT_DROPMAP" VARCHAR2(512 BYTE) NULL ,
"PROTECT_DROPMAP_FILENAME" VARCHAR2(128 BYTE) NULL ,
"PROTECT_DROPMAP_FILE" BLOB NULL ,
"BUILD_GUIDE" VARCHAR2(512 BYTE) NULL ,
"BUILD_GUIDE_FILENAME" VARCHAR2(128 BYTE) NULL ,
"BUILD_GUIDE_FILE" BLOB NULL ,
"CREATETIME" DATE NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON TABLE "RXDEV"."SPLSTATION_MANGER" IS '特殊台站资料表';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."GUID" IS '主键';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."STATION_GUID" IS '特殊台站GUID';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."STATION_PIC" IS '台站照片';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."BUILD_GLOBAL_PIC" IS '所在建筑全景图';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."DOORPLATE_PIC" IS '门牌照片';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."POSITION_GLOBAL_PIC" IS '所在位置全景图';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."ANTFEED_PIC" IS '天线照片';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."AREA_PLANE_PIC" IS '区域平面图';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."STOP_SKETCH_PIC" IS '有阻挡的示意照片';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."AREA_SATELLITE_PIC" IS '区域卫星图';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."STATION_PURPOSE" IS '用途';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."SERVICE_TYPE" IS '业务类型';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."STATION_ATTR" IS '台站属性 0:主站 1:分站 2:对等台(站)';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."WORK_PERIODTIME_TYPE" IS '工作时段类型 0:连续 1:根据需要   ';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."WORK_PERIODTIME_DATA" IS '工作时段<固定时段> JSON';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."REPLACE_WIRED" IS '替代性<有线方式可替代>0:否 1:可';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."REPLACE_WIRED_REASON" IS '替代性<有线方式可替代>否原因';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."REPLACE_PUBLIC" IS '替代性<公众通信方式可替代>0:否 1:可';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."REPLACE_PUBLIC_REASON" IS '替代性<公众通信方式可替代>否原因';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."REPLACE_OTHER" IS '其它替代方式';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."EQU_REFORM" IS '设备更新/改造 0:暂无 1:设备更新 2:设备改造';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."EQU_REFORM_CON" IS '设备更新/改造内容';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."EQU_INSTRUCTIONS_FILE" IS '设备技术和使用说明书附件';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."EQU_INSTRUCTIONS_FILENAME" IS '设备技术和使用说明书附件名称';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."INTERFERE_INFLUENCE" IS '干扰影响 0:无 1:有';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."INTERFERE_ENV_TYPE" IS '干扰影响类型 <有干扰影响>0:稍有影响，可正常工作 1:有影响，尚可工作 2:不能正常工作';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."INTERFERE_FEATURES" IS '干扰特性 0:单频 1:双频';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."INTERFERE_CYCLE" IS '干扰周期 0:周期性 1:突发性';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."INTERFERE_PERAZI" IS '干扰周期时段、方位角';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."TRAFFIC_INTERFERE" IS '交通设施干扰 0:无 1:有';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."TRAFFIC_INTERFERE_DATA" IS '交通设施干扰数据';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."ISM_INTERFERE" IS ' ISM设备、设施干扰 0:无 1:有';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."ISM_INTERVALDES" IS 'ISM设备、设施干扰描述,干扰距离';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."POWER_INTERFERE" IS '电力设施干扰 0:无 1:有 ';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."POWER_INTERFERE_DATA" IS '电力设施干扰数据  ';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."RESIDENT_CONAREA" IS '居民集中区  0:无  1:有';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."RESIDENT_CONAREA_DATA" IS '居民集中区数据  ';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."RELEVANT_STATUTE" IS '相关法规';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."RELEVANT_POLICY" IS '相关政策';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."RELEVANT_TECHNOLOGY" IS '相关技术标准';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."DESIGN_DATA" IS '设计资料';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."PROTECT_REQUIREMENT" IS '保护要求';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."PROTECT_PROPOSAL" IS '设台单位对台（站）保护建议';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."PROTECT_INTERVAL" IS '台站保护距离、净空要求（计算结果）';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."PROTECT_MEASURE" IS '保护措施';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."LEGAL_PROVE" IS '规划建设的合法手续证明';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."LEGAL_PROVE_FILENAME" IS '规划建设的合法手续证明附件名称';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."LEGAL_PROVE_FILE" IS '规划建设的合法手续证明附件';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."PROTECT_DROPMAP" IS '保护落图';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."PROTECT_DROPMAP_FILENAME" IS '保护落图附件名称';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."PROTECT_DROPMAP_FILE" IS '保护落图附件';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."BUILD_GUIDE" IS '专项规划建设导则';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."BUILD_GUIDE_FILENAME" IS '专项规划建设导则附件名称';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."BUILD_GUIDE_FILE" IS '专项规划建设导则附件';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_MANGER"."CREATETIME" IS '创建时间';

-- ----------------------------
-- Table structure for SPLSTATION_PROTECTINTERVAL
-- ----------------------------
DROP TABLE "RXDEV"."SPLSTATION_PROTECTINTERVAL";
CREATE TABLE "RXDEV"."SPLSTATION_PROTECTINTERVAL" (
"GUID" VARCHAR2(128 BYTE) NOT NULL ,
"PROTECT_TYPE" VARCHAR2(8 BYTE) NULL ,
"PROTECT_NAME" VARCHAR2(128 BYTE) NULL ,
"PTOTECT_INTERVAL" NUMBER(8,2) NULL ,
"CREATETIME" DATE NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."SPLSTATION_PROTECTINTERVAL"."GUID" IS '主键';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_PROTECTINTERVAL"."PROTECT_TYPE" IS '保护分类 共22类 0:干扰源  1:无线干扰源  2:一级保护区 3:二级保护区';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_PROTECTINTERVAL"."PROTECT_NAME" IS '名称';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_PROTECTINTERVAL"."PTOTECT_INTERVAL" IS '距离';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_PROTECTINTERVAL"."CREATETIME" IS '创建时间';

-- ----------------------------
-- Table structure for SPLSTATION_RELEVANTFILE
-- ----------------------------
DROP TABLE "RXDEV"."SPLSTATION_RELEVANTFILE";
CREATE TABLE "RXDEV"."SPLSTATION_RELEVANTFILE" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"FILE_TYPE" VARCHAR2(8 BYTE) NULL ,
"TEC_TYPE" VARCHAR2(8 BYTE) NULL ,
"FILE_NO" VARCHAR2(128 BYTE) NULL ,
"FILE_NAME" VARCHAR2(128 BYTE) NULL ,
"ENCLOSEURE_NAME" VARCHAR2(256 BYTE) NULL ,
"ENCLOSEURE_FILE" BLOB NULL ,
"CREATETIME" DATE NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."SPLSTATION_RELEVANTFILE"."GUID" IS '主键';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_RELEVANTFILE"."FILE_TYPE" IS '文件类型 - 0:相关法规 1:相关政策 2:相关技术标准 3:设计资料';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_RELEVANTFILE"."TEC_TYPE" IS '技术标准类型 - 0:国标 1:行标';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_RELEVANTFILE"."FILE_NO" IS '文件编号';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_RELEVANTFILE"."FILE_NAME" IS '文件名称';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_RELEVANTFILE"."ENCLOSEURE_NAME" IS '附件名称';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_RELEVANTFILE"."ENCLOSEURE_FILE" IS '附件';
COMMENT ON COLUMN "RXDEV"."SPLSTATION_RELEVANTFILE"."CREATETIME" IS '创建时间';

-- ----------------------------
-- Table structure for T_RIM_PA_AR_LICENSE
-- ----------------------------
DROP TABLE "RXDEV"."T_RIM_PA_AR_LICENSE";
CREATE TABLE "RXDEV"."T_RIM_PA_AR_LICENSE" (
"GUID" VARCHAR2(36 BYTE) NOT NULL ,
"APPLY_ID" VARCHAR2(36 BYTE) NULL ,
"LICENSE_CODE" VARCHAR2(20 BYTE) NULL ,
"LICENSE_STATUS" VARCHAR2(10 BYTE) NULL ,
"LICENSE_DATE_B" DATE NULL ,
"LICENSE_DATE_E" DATE NULL ,
"LICENSE_DATE" DATE NULL ,
"MEMO" VARCHAR2(512 BYTE) NULL ,
"LICENSE_TYPE" VARCHAR2(10 BYTE) NULL 
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN "RXDEV"."T_RIM_PA_AR_LICENSE"."LICENSE_TYPE" IS '''0'' 个人 ‘1’单位';

-- ----------------------------
-- View structure for FRBT_ALLOCATION_DETAIL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."FRBT_ALLOCATION_DETAIL" AS 
SELECT a.GUID,b.SERV_CODE,a.AREA_CODE,a.VER_CODE,a.BAND_B,a.BAND_E,
       a.FN_CODE as FN_CODE_COM,b.Fn_Code as FN_CODE_SPEC,b.addi_info,b.isallocate,b.notalloc_info,b.serv_type
       ,c.serv_name,c.rgb_color, c.iscutline, c.serv_parent
FROM FRBT_ALLOCATION a  JOIN FRBT_ALLOCATION_SERVICE b ON a.GUID=b.ALLOC_GUID
                        join FRBT_SERVICE c on b.serv_code = c.serv_code
      order by BAND_B, SERV_TYPE ASC;

-- ----------------------------
-- View structure for FRBT_PLANS_DETAIL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."FRBT_PLANS_DETAIL" AS 
SELECT a."GUID",a."PLANS_NAME",a."SYS_CODE",a."BAND_TYPE",a."CH_TYPE",a."FREQ_LNAME",a."FREQ_UNAME",a."EDIT_ORG_CODE",a."FILE_NO",to_char(a."START_DATE",'yyyy-mm-dd') as START_DATE,to_char(a."CONFIRM_DATE",'yyyy-mm-dd') as CONFIRM_DATE,a."DATA_STATUS",a."MEMO",
       nvl(b.band_lb, 0) as BAND_LB,nvl(b.band_lE, 0) as BAND_LE,nvl(b.band_Ub, 0) as BAND_UB,nvl(b.band_UE, 0) as BAND_UE,c.sys_name
FROM FRBT_PLANS a left  JOIN FRBT_PLANS_BAND b ON a.GUID=b.plans_guid left join FRBT_SYSTEM c on a.sys_code = c.sys_code;

-- ----------------------------
-- View structure for ORG_DIC
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."ORG_DIC" AS 
select 
t1."GUID",t1."ORG_CODE",t1."ORG_NAME",t1."ORG_AREA_CODE",t1."ORG_SYS_CODE",t1."ORG_TYPE",t1."ORG_LINK_PERSON",t1."ORG_PERSON_ID",t1."ORG_SUP_CODE",t1."ORG_ADDR",t1."ORG_POST",t1."ORG_PHONE",t1."ORG_MOB_PHONE",t1."ORG_FAX",t1."ORG_BANK",t1."ORG_ACCOUNT_NAME",t1."ORG_ACCOUNT",t1."ORG_HOSTILITY",t1."ORG_WEB_SITE",t1."ORG_MAIL", 
t2.code_chi_name org_type_name, 
t3.code_chi_name org_area_name,
t4.code_chi_name org_sys_name,
t5.code_chi_name ORG_Hostility_name
from 
rsbt_org t1,
rsbt_code_dic t2,
rsbt_code_dic t3,
rsbt_code_dic t4,
rsbt_code_dic t5
where 
t1.org_type = t2.cn(+) and t2.code_data_type(+)='00262006' 
and t1.org_area_code = t3.cn(+) and t3.code_data_type(+)='00032006' 
and t1.org_sys_code = t4.cn(+) and t4.code_data_type(+)='00092006'
and t1.ORG_Hostility = t5.cn(+) and t5.code_data_type(+)='00552006'
and org_type not in ('000','008')
and org_area_code = '310000';

-- ----------------------------
-- View structure for RIM_LICENSE_ALL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."RIM_LICENSE_ALL" AS 
select t."LICENSE_GUID",t."STATION_GUID",t."APP_CODE",t."STAT_TDI",t."STAT_APP_TYPE",t."LICENSE_TYPE",t."LICENSE_CODE",t."LICENSE_ORG_NAME",t."LICENSE_MANAGER",t."LICENSE_DATE_B",t."LICENSE_DATE_E",t."LICENSE_DATE",t."MEMO",t."NET_GUID",t."ORG_CODE",t."STAT_NAME",t."STAT_ADDR",t."STAT_AREA_CODE",t."STAT_TYPE",t."STAT_WORK",t."STAT_STATUS",t."STAT_EQU_SUM",t."STAT_LG",t."STAT_LA",t."STAT_AT",t."STAT_DATE_START" ,l.print_status,l.license_status
from (select * from RIM_LICENSE_STATION) t ,rim_license_lit l
where t.license_guid = l.LICENSE_GUID;

-- ----------------------------
-- View structure for RIM_LICENSE_LIT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."RIM_LICENSE_LIT" AS 
select l.guid LICENSE_GUID,l.station_guid,l.app_code,l.stat_tdi,l.stat_app_type,l.license_type,l.license_code,
l.license_org_name,l.license_manager,l.license_date_b,l.license_date_e,l.license_date,l.memo,
t.guid,t.license_status,t.print_status,t.print_time,t.record_status,t.using_status,t.state_description,
t.annual_status,t.audit_year from RSBT_LICENSE l,RSBT_LICENSE_T t
where l.guid = t.guid;

-- ----------------------------
-- View structure for RIM_LICENSE_ORG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."RIM_LICENSE_ORG" AS 
select v."LICENSE_GUID",v."STATION_GUID",v."APP_CODE",v."STAT_TDI",v."STAT_APP_TYPE",v."LICENSE_TYPE",v."LICENSE_CODE",v."LICENSE_ORG_NAME",v."LICENSE_MANAGER",v."LICENSE_DATE_B",v."LICENSE_DATE_E",v."LICENSE_DATE",v."MEMO",v."GUID",v."LICENSE_STATUS",v."PRINT_STATUS",v."PRINT_TIME",v."RECORD_STATUS",v."USING_STATUS",v."STATE_DESCRIPTION",v."ANNUAL_STATUS",v."AUDIT_YEAR",v."NET_GUID",v."FEE_GUID",o.org_name from
(select f.*,n.FEE_GUID from
(select t.*,s.NET_GUID from RIM_LICENSE_LIT t,RSBT_STATION s
where t.station_guid = s.guid) f,RSBT_NET n
where f.net_guid = n.guid) v,RSBT_ORG o
where v.FEE_GUID = o.guid

--缴费单位视图;

-- ----------------------------
-- View structure for RIM_LICENSE_STATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."RIM_LICENSE_STATION" AS 
select l.guid license_guid,l.station_guid,l.app_code,l.stat_tdi,l.stat_app_type,l.license_type,l.license_code,l.license_org_name,l.license_manager,
l.license_date_b,l.license_date_e,l.license_date,l.memo,s.net_guid,s.org_code,
s.stat_name,s.stat_addr,s.stat_area_code,s.stat_type,s.stat_work,s.stat_status,s.stat_equ_sum,s.stat_lg,s.stat_la,s.stat_at,s.stat_date_start
from RSBT_LICENSE l,RSBT_STATION s
where l.station_guid = s.guid;

-- ----------------------------
-- View structure for USERANDDEPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."USERANDDEPT" AS 
select a.userid,a.username,a.empno,b.deptid,c.deptname from t_rim_comm_user a,t_rim_comm_dept_emp b,t_rim_comm_department c
 where a.empno=b.empno and c.deptid=b.deptid;

-- ----------------------------
-- View structure for V_AR_CALL_SIGN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_AR_CALL_SIGN" AS 
select c.call_sign_id, decode(c.area_code,'310000','上海市无线电管理局',440000,'广东省无线电管理局') area_code,decode(c.call_sign_status,0,'未指配',1,'已占用',2,'预留',3,'锁定',4,'注销',5,'他省占用',6,'临时指配','','未指配') call_sign_status,
 c.set_time,c.end_time,c.activate_time from ar_call_sign c;

-- ----------------------------
-- View structure for V_AR_CERTIFICATEINFOR
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_AR_CERTIFICATEINFOR" AS 
select guid, idnumber, name, decode(gender,0,'男','女') gender, birthday, call_sign, currentlevel, passdate, examname, issuancedate, issuanceaddr, operatno,
 b.code_chi_name areacode,b.cn concode, c.code_chi_name citiesname,c.cn citiesCode, address, postcode, hphone, email, qqcode, remark, filename
 from AR_CERTIFICATEINFOR a,
 (select CN,CODE_CHI_NAME from ar_dic where code_data_type='00032006') b
 ,(select CN,CODE_CHI_NAME from ar_dic where code_data_type='00032006') c
  where
     a.areacode=b.cn(+) and a.citiesname=c.cn(+);

-- ----------------------------
-- View structure for V_BAND_FREAQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_BAND_FREAQ" AS 
select
T2.BAND_GUID,
T1."RESOURCE_GUID",
T1."BAND_NAME" ,
T2.BAND_FE||'-'||T2.BAND_FB freq_rang,
T2.BAND_FE,
T2.BAND_FB,
T2.GUID FREQ_GUID
from
FRBT_RESOURCE_BAND T1,
FRBT_RESOURCE_BAND_FREQ T2
WHERE T1.GUID = T2.BAND_GUID(+);

-- ----------------------------
-- View structure for V_EXP_DATA_STATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_EXP_DATA_STATION" AS 
select ---??
  A.STAT_NAME,A.STAT_ADDR,A.STAT_LG,A.STAT_LA,A.STAT_AREA_CODE,
B.FREQ_TYPE,B.FREQ_UC,B.FREQ_LC,B.FREQ_EFB,B.FREQ_EFE,b.freq_e_band,B.FREQ_RFB,B.FREQ_RFE,B.FREQ_R_BAND,
G.ORG_NAME
from RSBT_STATION A,Rsbt_Freq B,
(
select E.GUID AS NET_GUID, F.ORG_NAME
from RSBT_NET E,RSBT_ORG F
where E.ORG_GUID=F.GUID(+)
) G
where A.GUID=B.STATION_GUID and A.NET_GUID=G. NET_GUID;

-- ----------------------------
-- View structure for V_FORM_VALIDATE_STATUS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FORM_VALIDATE_STATUS" AS 
select  status.form_guid,status.status,app.app_code,'' stat_tdi,app.guid  rsbt_guid from T_FORM_VALIDATE_STATUS status,rsbt_apply app where  status.form_guid(+)=app.guid
union all
select  status.form_guid,status.status,stat.app_code,stat.stat_tdi,stat.guid from T_FORM_VALIDATE_STATUS status,rsbt_station stat where  status.form_guid(+)=stat.guid;

-- ----------------------------
-- View structure for V_FRBT_ASSIGN_IMAGE_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FRBT_ASSIGN_IMAGE_FREQ" AS 
select c.FREQ_LC FREQ_VAL,c.FREQ_TYPE,count(*) ASSIGN_COUNT,c.rgb_color from
(SELECT a.FREQ_LC,1 FREQ_TYPE,'#0000FF' RGB_COLOR  FROM FRBT_ASSIGN_CHANNEL a  where a.FREQ_LC is not null and a.FREQ_LC <> 0
UNION ALL
SELECT b.FREQ_UC,1 FREQ_TYPE,'#0000FF' RGB_COLOR  FROM FRBT_ASSIGN_CHANNEL b where b.FREQ_UC is not null and b.FREQ_UC <> 0 and b.FREQ_UC <> b.FREQ_LC) c group by c.FREQ_LC,c.FREQ_TYPE,c.rgb_color order by c.FREQ_LC;

-- ----------------------------
-- View structure for V_FRBT_ASSIGN_LIST
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FRBT_ASSIGN_LIST" AS 
SELECT a.APP_CODE,a.STAT_ADDR,a.STAT_LG,a.STAT_LA,b.freq_lc,b.freq_uc,c.org_name FROM FRBT_ASSIGN a left join FRBT_ASSIGN_CHANNEL b on a.guid = b.assign_guid
left join FRBT_ORG c on a.org_guid = c.guid;

-- ----------------------------
-- View structure for V_FRBT_FOOTNOTE_DETAIL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FRBT_FOOTNOTE_DETAIL" AS 
select
       t.FN_CODE,t.FN_PROPERTY,t.FN_CLASS,
       decode(t.FN_PROPERTY, 'ITU','国际电联','CN','附加划分') as FN_PROPERTY_SHOW,
       decode(t.FN_CLASS,'01','普通划分','02','附加划分','03','替代划分') as FN_CLASS_SHOW,
       t.FN_CONTENT,t.MEMO
  from
       FRBT_FOOTNOTE t;

-- ----------------------------
-- View structure for V_FRBT_ORG_MANAGE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FRBT_ORG_MANAGE" AS 
select
t1."GUID",t1."ORG_CODE",t1."ORG_NAME",t1."ORG_AREA_CODE",t1."ORG_SYS_CODE",t1."ORG_TYPE",t1."ORG_LINK_PERSON",t1."ORG_SUP_CODE",t1."ORG_ADDR",t1."ORG_POST",t1."ORG_PHONE",t1."ORG_MOB_PHONE",t1."ORG_FAX",t1."ORG_BANK",t1."ORG_ACCOUNT_NAME",t1."ORG_ACCOUNT",t1."ORG_WEB_SITE",t1."ORG_MAIL",
t2.code_chi_name org_type_name,
t3.code_chi_name org_area_name,
t4.code_chi_name org_sys_name
from
FRBT_ORG t1,
RSBT_code_dic t2,
RSBT_code_dic t3,
RSBT_code_dic t4
where
t1.org_type = t2.cn(+) and t2.code_data_type(+)='00262006'
and t1.org_area_code = t3.cn(+) and t3.code_data_type(+)='00032006'
and t1.org_sys_code = t4.cn(+) and t4.code_data_type(+)='00092006'
and org_type in ('000','008');

-- ----------------------------
-- View structure for V_FRBT_PLANS_POPEDOM_DETAIL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FRBT_PLANS_POPEDOM_DETAIL" AS 
select a."GUID",a."ORG_CODE",a."EDIT_ORG_CODE",a."PLANS_CH_GUID",a."MEMO",b.org_name,c.ch_lno,c.freq_lc,c.ch_uno,decode(c.freq_uc,0,'',c.freq_uc) as freq_uc,e.plans_name,d.plans_guid,d.group_name,c.plans_group_guid,e.sys_code
       from FRBT_PLANS_POPEDOM a
            left join FRBT_ORG b on a.org_code = b.org_code
            left join FRBT_PLANS_CHANNEL c on a.plans_ch_guid = c.guid
            left join FRBT_PLANS_GROUP d on c.plans_group_guid = d.guid
            left join FRBT_PLANS e on d.plans_guid = e.guid
WITH READ ONLY 
CONSTRAINTS "SYS_C0013189";

-- ----------------------------
-- View structure for V_FRBT_PLANS_POPEDOM_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FRBT_PLANS_POPEDOM_FREQ" AS 
select a.GUID,c.sys_code,c.plans_name,b.plans_guid,b.group_name,a.plans_group_guid,a.ch_lno,a.freq_lc,a.ch_uno,decode(a.freq_uc,0,'',a.freq_uc) as freq_uc
       from FRBT_PLANS_CHANNEL a
            left join FRBT_PLANS_GROUP b  on a.plans_group_guid = b.guid
            left join FRBT_PLANS c on b.plans_guid = c.guid order by a.freq_lc
WITH READ ONLY 
CONSTRAINTS "SYS_C0013188";

-- ----------------------------
-- View structure for V_FRBT_RESOURCE_GROUP
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FRBT_RESOURCE_GROUP" AS 
SELECT 
T1."GUID",T1."BAND_GUID",T1."GROUP_NAME",T1."DDLGL",T1."FREQ_LB",T1."FREQ_LE",T1."FREQ_UB",T1."FREQ_UE",T1."FREQ_BAND",T1."CHANNEL_NUM",T1."MEMO",T1."MANAGER",T1."DDL_TYPE" ,
T2.CODE_CHI_NAME MANAGER_NAME, 
T3.CODE_CHI_NAME DDL_TYPE_NAME,
T4.CODE_CHI_NAME DDLGL_NAME
FROM 
FRBT_RESOURCE_GROUP T1,
FRBT_CODE_DIC	T2,
FRBT_CODE_DIC T3，
FRBT_CODE_DIC T4
WHERE
T1.MANAGER = T2.CN(+) AND T2.CODE_DATA_TYPE (+) = '00192006'
AND
T1.DDL_TYPE = T3.CN(+) AND T3.CODE_DATA_TYPE (+)= '00182006'
AND
T1.DDLGL = T4.CN(+) AND T4.CODE_DATA_TYPE (+)= '00202006';

-- ----------------------------
-- View structure for V_FREQ_APPLY_DETAIL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FREQ_APPLY_DETAIL" AS 
select a.guid,a.org_guid,a.net_guid,a.app_code,to_char(a.app_date,'yyyy-mm-dd') as APP_DATE,to_char(a.APP_FTLB,'yyyy-mm-dd') as APP_FTLB,to_char(a.APP_FTLE,'yyyy-mm-dd') as APP_FTLE,a.MEMO
,b.ORG_NAME,c.Net_Name
from RSBT_APPLY a,RSBT_ORG b,RSBT_NET c where a.app_TYPE = 'F' and a.ORG_GUID = b.GUID and a.NET_GUID = c.GUID;

-- ----------------------------
-- View structure for V_FREQ_CHOOSE_LIST
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FREQ_CHOOSE_LIST" AS 
(select c.sys_code,c.sys_name,d.BAND_B,d.Band_e,decode(d.area_code,'CN','中国') as AREA from FRBT_ALLOCATION d,(select a.ALLOC_GUID,a.Serv_Code,b.sys_code,b.sys_NAME from FRBT_ALLOCATION_SERVICE a,FRBT_SYSTEM b where a.serv_code = b.serv_code ) c where d.guid = c.alloc_guid and d.area_code='CN'
);

-- ----------------------------
-- View structure for V_FREQ_EXPIRATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FREQ_EXPIRATION" AS 
select t."OBJECT_GUID",t."OBJECT_TYPE",t."PRINT_COUNT",t."ISALERT",t."END_DATE",t."GUID",t."ORG_GUID",t."ORG_NAME",t."ORG_LINK_PERSON",t."APP_CODE",t."APP_DATE",t."APP_FTLB",t."APP_FTLE" from (select c.*,a.guid,a.org_guid,b.org_name,b.org_link_person,a.app_code,APP_DATE,APP_FTLB,APP_FTLE
FROM RSBT_APPLY a,RSBT_ORG b,t_rim_rsm_alert_info c
where a.org_guid = b.guid(+) and a.guid = c.object_guid(+) and  c.object_type(+) = '0' ) t  where sysdate >nvl(t.end_date, t.APP_FTLE) and nvl(t.isalert,1) = 1;

-- ----------------------------
-- View structure for V_FREQ_PLANS_IMAGE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FREQ_PLANS_IMAGE" AS 
SELECT a."GUID",a."PLANS_NAME",a."SYS_CODE",a."BAND_TYPE",a."CH_TYPE",a."FREQ_LNAME",a."FREQ_UNAME",a."EDIT_ORG_CODE",a."FILE_NO",to_char(a."START_DATE",'yyyy-mm-dd') as START_DATE,to_char(a."CONFIRM_DATE",'yyyy-mm-dd') as CONFIRM_DATE,a."DATA_STATUS",a."MEMO",
       nvl(b.band_lb, 0) as BAND_LB,nvl(b.band_lE, 0) as BAND_LE,nvl(b.band_Ub, 0) as BAND_UB,nvl(b.band_UE, 0) as BAND_UE,c.sys_name,e.rgb_color
FROM FRBT_PLANS a left  JOIN FRBT_PLANS_BAND b ON a.GUID=b.plans_guid left join FRBT_SYSTEM c on a.sys_code = c.sys_code
 left join (select aa.SYS_CODE,bb.rgb_color from FRBT_SYSTEM aa left join FRBT_SERVICE bb on aa.serv_code = bb.serv_code) e on a.sys_code = e.sys_code
WITH READ ONLY 
CONSTRAINTS "SYS_C0012900";

-- ----------------------------
-- View structure for V_FREQ_PLASN_IMAGE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FREQ_PLASN_IMAGE" AS 
SELECT a."GUID",a."PLANS_NAME",a."SYS_CODE",a."BAND_TYPE",a."CH_TYPE",a."FREQ_LNAME",a."FREQ_UNAME",a."EDIT_ORG_CODE",a."FILE_NO",to_char(a."START_DATE",'yyyy-mm-dd') as START_DATE,to_char(a."CONFIRM_DATE",'yyyy-mm-dd') as CONFIRM_DATE,a."DATA_STATUS",a."MEMO",
       nvl(b.band_lb, 0) as BAND_LB,nvl(b.band_lE, 0) as BAND_LE,nvl(b.band_Ub, 0) as BAND_UB,nvl(b.band_UE, 0) as BAND_UE,c.sys_name,e.rgb_color
FROM FRBT_PLANS a left  JOIN FRBT_PLANS_BAND b ON a.GUID=b.plans_guid left join FRBT_SYSTEM c on a.sys_code = c.sys_code
 left join (select aa.SYS_CODE,bb.rgb_color from FRBT_SYSTEM aa left join FRBT_SERVICE bb on aa.serv_code = bb.serv_code) e on a.sys_code = e.sys_code
WITH READ ONLY 
CONSTRAINTS "SYS_C0012678";

-- ----------------------------
-- View structure for V_FREQ_RESOURCE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_FREQ_RESOURCE" AS 
SELECT 
T1."GUID",T1."RESOURCE_NAME",T1."NET_SVN",T1."NET_TS",T1."RESOURCE_COLOR",T1."ORDERNUM",T1."MEMO",
T2.CODE_CHI_NAME NET_SVN_TYPE,
T3.CODE_CHI_NAME NET_TS_TYPE
FROM 
FRBT_RESOURCE T1,
RSBT_CODE_DIC T2,
RSBT_CODE_DIC T3
where 
T1.NET_SVN = T2.CN (+)AND T2.code_data_type(+) = '00452006'
AND
T1.NET_TS = T3.CN(+) AND T3.code_data_type(+) = '00012006';

-- ----------------------------
-- View structure for V_GETORG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_GETORG" AS 
select org.guid,org_name,org_area_code from rsbt_org org
where org_name is not null and org.guid not like '%null' and (org.org_type='001' or org.org_type='004' or org.org_type='005' or org.org_type='007')
and (org.org_code <> '999999999' or org.org_sys_code is not null)
union all
select  app_pa.app_guid, app_pa.app_pa_name,decode(org.org_area_code,'999999', substr(app_code,length(app_code)-11,4)||'00',org.org_area_code)
from  rsbt_apply_pa app_pa,rsbt_apply app,rsbt_org org
where app.guid=app_pa.app_guid and org.guid(+)=app.org_guid;

-- ----------------------------
-- View structure for V_GETORG_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_GETORG_R" AS 
select distinct org.guid,org_name,org_area_code from rsbt_org org,rsbt_apply_r app
where org_name is not null and org.guid not like '%null' and (org.org_type='001' or org.org_type='004' or org.org_type='005' or org.org_type='007')
and (org.org_code <> '999999999' or org.org_sys_code is not null) and org.guid =app.org_guid and app.guid is not null
union all
select  app_pa.app_guid, app_pa.app_pa_name,decode(org.org_area_code,'999999', substr(app_code,length(app_code)-11,4)||'00',org.org_area_code)
from  rsbt_apply_pa_r app_pa,rsbt_apply_r app,rsbt_org org
where app.guid=app_pa.app_guid and org.guid(+)=app.org_guid;

-- ----------------------------
-- View structure for V_PLANS_GROUP_DETAIL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_PLANS_GROUP_DETAIL" AS 
select c.band_TYPE,b.band_lb,b.band_le,b.band_ub,b.band_ue,a."GUID",a."PLANS_GUID",a."GROUP_NAME",a."CH_SPACING",a."CH_E_BW",a."CH_ER_INTERVAL",a."CH_COUNT",a."TC_INFO",a."CH_FORM",a."MEMO" from FRBT_PLANS_GROUP a left join FRBT_PLANS_BAND b on a.Plans_Guid = b.plans_guid left join FRBT_PLANS c on a.Plans_Guid = c.GUID
WITH READ ONLY 
CONSTRAINTS "SYS_C0012929";

-- ----------------------------
-- View structure for V_PROTECT_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_PROTECT_FREQ" AS 
SELECT T1."GUID",T1."ORG_GUID",T1."SYS_CODE",T1."PF_TYPE",T1."ADMIN_ORG_CODE",T1."EDIT_ORG_CODE",T1."FILE_NO",T1."START_DATE",T1."STOP_DATE",T1."DATA_STATUS",T1."MEMO",T1."FREQ_PROTECT_TYPE",
  t2.org_name,
  t3.sys_name,
  t4.code_chi_name pf_name,
  t5.org_name admin_org_name,
  t6.org_name edit_org_name,
  t7.code_chi_name data_status_name,

  t8.code_chi_name FREQ_PROTECT_TYPE_NAME
FROM
 frbt_protect t1,
 rsbt_org t2,
 frbt_system t3,
 frbt_code_dic t4, 
rsbt_org t5, 
rsbt_org t6, 
frbt_code_dic t7,
frbt_code_dic t8
WHERE t1.org_guid = t2.guid(+)
AND   t1.sys_code = t3.sys_code(+)
AND   t1.pf_type = t4.cn(+) and t4.code_data_type(+)='00092006'
AND   t1.admin_org_code = t5.org_code(+)
AND   t1.edit_org_code = t6.org_code(+)
AND   t1.data_status = t7.cn(+) and t7.code_data_type(+)='00012006'
AND 	(t1.FREQ_PROTECT_TYPE = t8.cn(+) AND t8.code_data_type(+)='00172006')
AND t1.FREQ_PROTECT_TYPE = '1';

-- ----------------------------
-- View structure for V_RIM_COMM_DEPART_USERLIST
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_DEPART_USERLIST" AS 
select
-----部门Deptid下的所有用户（视图）
C.USERID,C.USERNAME,C.AREACODE,B.Deptid,B.DIRECT,B.EMPNO
from T_RIM_COMM_DEPARTMENT A,T_Rim_Comm_Dept_Emp B,T_Rim_Comm_User C
where A.Deptid=B.DEPTID and B.EMPNO=C.EMPNO;

-- ----------------------------
-- View structure for V_RIM_COMM_EMPLOYEE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_EMPLOYEE" AS 
select
  -----
  distinct a."EMPNO",a."NAME",a."SEX",a."NATIONALITY",a."BIRTH",a."EDUCATION",a."PRINCIPALSHIP",a."TECHNICALPOST",a."MOBILE",a."HOMEADDRESS",a."POSTALCODE",a."HOMETEL",a."EMAIL",a."NOTE",a."DELFLAG",a."AREACODE",a."STATE",a."NATIVEPLACE",a."GRADUATESCHOOL",a."MAJOR",a."FIRSTJOBTIME",a."POLITYFACE",a."WORKTIME",a."POLITYRANK",a."SAMERANKTIME",a."ADDUNITTIME",a."REMOVEINFORMATION",b.deptid,d.userid,c.deptname as dept_name
from t_rim_comm_employee a, t_rim_comm_dept_emp b,
t_rim_comm_department c,t_rim_comm_user  d
where a.empno=b.empno(+) and b.direct='Y'
and b.deptid=c.deptid(+) and a.empno = d.empno(+);

-- ----------------------------
-- View structure for V_RIM_COMM_EMPNOID
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_EMPNOID" AS 
select distinct a."EMPNO",a."NAME",a."SEX",a."NATIONALITY",a."BIRTH",a."EDUCATION",a."PRINCIPALSHIP",a."TECHNICALPOST",a."MOBILE",a."HOMEADDRESS",a."POSTALCODE",a."HOMETEL",a."EMAIL",a."NOTE",a."DELFLAG",a."AREACODE",a."STATE",a."NATIVEPLACE",a."GRADUATESCHOOL",a."MAJOR",a."FIRSTJOBTIME",a."POLITYFACE",a."WORKTIME",a."POLITYRANK",a."SAMERANKTIME",a."ADDUNITTIME",a."REMOVEINFORMATION",b.deptid,c.deptname as dept_name
        from t_rim_comm_employee  a, t_rim_comm_dept_emp b,
        t_rim_comm_department c
             where a.empno=b.empno(+) and b.deptid=c.DEPTID(+);

-- ----------------------------
-- View structure for V_RIM_COMM_IDDEPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_IDDEPT" AS 
select a.userid,a.Username,b.deptid
from  v_rim_comm_userinfo a, v_rim_comm_empnoid  b
where a.empno = b.empno(+);

-- ----------------------------
-- View structure for V_RIM_COMM_LOG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_LOG" AS 
select
  ----日志视图
  X.LOGID,X.USERID,X.USERHOSTIP,X.DESCRIPTION,X.LOGDATE,X.SOURCE,X.LOGTYPE,
DECODE(Y.DEPTNAME,null,Y.Name,Y.DEPTNAME||'----'||Y.Name) as USERNAME
from T_RIM_COMM_LOG X,
(
  select AA.USERID,AA.USERNAME,BB.DEPTNAME,AA.AREACODE,BB.DEPTID,
  DECODE(BB.NAME, NULL, DECODE(AA.USERNAME, NULL, AA.USERID, AA.USERNAME), BB.NAME) "NAME"
  from T_RIM_COMM_USER AA ,
  (
    select A.DEPTID,A.DEPTNAME,B.EMPNO,C.NAME
    from t_rim_comm_department A,t_rim_comm_dept_emp B,t_rim_comm_employee C
    where A.DEPTID=b.deptid and b.empno=C.EMPNO and B.DIRECT='Y'
  ) BB
  where AA.EMPNO=BB.EMPNO(+)
) Y where X.USERID=Y.USERID(+);

-- ----------------------------
-- View structure for V_RIM_COMM_LOGIN_LOG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_LOGIN_LOG" AS 
select userid,BeginTime,max(coun) coun from (
    select l.userid, to_char(BeginTime,'yyyy/mm/dd') BeginTime,l.coun from t_rim_comm_login_log  l) a
    where 1=1
    group by userid,BeginTime;

-- ----------------------------
-- View structure for V_RIM_COMM_PERMISSION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_PERMISSION" AS 
select a.resID resID, b.userid,
	max(bitand(a.permissionValue , 1) + 0) +
  max(bitand(a.permissionValue , 2) + 0) +
  max(bitand(a.permissionValue , 4) + 0) +
  max(bitand(a.permissionValue , 8) + 0) +
  max(bitand(a.permissionValue , 16) + 0) +
  max(bitand(a.permissionValue , 32) + 0) +
  max(bitand(a.permissionValue , 64) + 0) +
  max(bitand(a.permissionValue , 128) + 0) as permissionValue
from T_RIM_comm_data_ACL a, v_RIM_comm_principal b where
	a.principalid=b.principalid and a.principaltype=b.principaltype
group by a.resID, b.userID;

-- ----------------------------
-- View structure for V_RIM_COMM_PRINCIPAL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_PRINCIPAL" AS 
select u.userid as principalID, 0 as principalType, u.userid as userid
    from T_RIM_comm_user u
union
  select r.rolename as principalID, 1 as principalType, r.userid as userid
    from T_RIM_comm_role_member r
union
  select d.deptid as principalID, 2 as principalType, u1.userid as userid
    from T_RIM_comm_dept_emp d, T_RIM_comm_user u1
    where d.empno = u1.empno
union
  select 'everyone' as principalID, 99 as principalType, u.userid as userid
    from T_RIM_comm_user u;

-- ----------------------------
-- View structure for V_RIM_COMM_ROLEUSERLIST
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_ROLEUSERLIST" AS 
select
-----角色的所有用户ID，Name视图
A.USERID,A.USERNAME,A.EMPNO,A.AREACODE,B.ROLENAME
from T_Rim_Comm_User A,T_RIM_COMM_ROLE_MEMBER B where A.USERID(+)=B.USERID;

-- ----------------------------
-- View structure for V_RIM_COMM_USER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_USER" AS 
select a."USERID",a."USERNAME",a."EMPNO",a."USERDESC",a."PASSWORD",a."AREACODE",a."APPLEPCID",a."DELFLAG",
       a."LASTLOGINDATE",a."USERCODE",c."CN",c."CODE_CHI_NAME",c."CODE_DISCN",a.unit
from
       T_RIM_COMM_USER a,
       (SELECT CN,CODE_CHI_NAME,CODE_DISCN FROM RSBT_CODE_DIC WHERE instr(CODE_DATA_TYPE,'0003')>0
       and  CN like '50%' order by  CODE_DISCN ) c
where a.Areacode=c.CN
order by CODE_DISCN,USERCODE;

-- ----------------------------
-- View structure for V_RIM_COMM_USER_LINEVIEW
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_USER_LINEVIEW" AS 
select distinct v."USERID",v."USERNAME",v."AREACODE",v.unit,v."CN",v."CODE_CHI_NAME",v.CODE_DISCN, m.stateflage,m.uplinetime,m.monthcount,m.daycount,v.usercode
 from V_rim_comm_user_Online v,t_rim_comm_login_messge m
 where v.userid=m.userid
  and m.uplinetime in( select a.UPLINETIME from (
 select USERID,max(UPLINETIME) UPLINETIME from t_rim_comm_login_messge  group by USERID order by USERID)  a)
 order by v.CN,v.username;

-- ----------------------------
-- View structure for V_RIM_COMM_USER_NOTINTABLEDATA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_USER_NOTINTABLEDATA" AS 
select a.userid,a.username,a.areacode,b.CN,b.CODE_CHI_NAME,a.unit,a.usercode
            from t_rim_comm_user a,(SELECT CN,CODE_CHI_NAME FROM RSBT_CODE_DIC WHERE instr(CODE_DATA_TYPE,'0003')>0 ) b
            where a.areacode=b.CN and USERID not in (select m.userid from t_rim_comm_login_messge m)
             order by a.areacode,a.username;

-- ----------------------------
-- View structure for V_RIM_COMM_USER_ONLINE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_USER_ONLINE" AS 
select a.userid,a.username,a.areacode,b.CN,b.CODE_CHI_NAME,b.CODE_DISCN,a.unit,a.usercode
 from t_rim_comm_user a,(SELECT CN,CODE_CHI_NAME,CODE_DISCN FROM RSBT_CODE_DIC WHERE instr(CODE_DATA_TYPE,'0003')>0  order by CODE_DISCN) b
 where a.areacode=b.CN
 order by a.areacode,a.username;

-- ----------------------------
-- View structure for V_RIM_COMM_USER_ORG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_USER_ORG" AS 
select a."USERID",a."USERNAME",a."EMPNO",a."USERDESC",a."PASSWORD",a."AREACODE",
       a."APPLEPCID", a."DELFLAG",a."LASTLOGINDATE",a."USERCODE",b.deptid,c."CN",
       c."CODE_CHI_NAME",c."CODE_DISCN",
       decode(d.secondrole,'', F_GetRoleName(d.role),F_GetRoleName(d.role)||','|| F_GetRoleName(d.secondrole)) roleName
from
       T_RIM_COMM_USER a, t_rim_comm_dept_emp b,t_rim_comm_employee d,
       (SELECT CN,CODE_CHI_NAME,CODE_DISCN FROM RSBT_CODE_DIC WHERE instr
       (CODE_DATA_TYPE,'0003')>0  and  CN like '44%' order by  CODE_DISCN ) c
where  a.Areacode=c.CN(+)
and    a.empno = b.empno
and    a.empno = d.empno
and    b.direct = 'Y'
order by CODE_DISCN,USERCODE;

-- ----------------------------
-- View structure for V_RIM_COMM_USERIDGETDEPTNAME
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_USERIDGETDEPTNAME" AS 
select
  ---根据用户UserID,获取用户所在的机构名称(markmao modify)
 XX.USERID,XX.USERNAME, DECODE(XX.DEPTNAME,null,XX.CODE_CHI_NAME,XX.DEPTNAME) as DEPTNAME,
 XX.AREACODE,XX.DEPTID,XX.NAME,XX.CODE_CHI_NAME AREANAME,
 XX.role,XX.secondrole,usercode,
 DECODE(XX.DEPTNAME,null,XX.CODE_CHI_NAME||'--'||XX.Name,XX.DEPTNAME||'--'||XX.Name) as DEPTNAME2
 from
 (
    select AA.USERID,AA.USERNAME,BB.DEPTNAME,AA.AREACODE,BB.DEPTID,bb.role,bb.secondrole,
    CC.CODE_CHI_NAME,aa.usercode,
    DECODE(BB.NAME, NULL, DECODE(AA.USERNAME, NULL, AA.USERID, AA.USERNAME), BB.NAME) "NAME"
    from T_RIM_COMM_USER AA ,
    (
      select A.DEPTID,A.DEPTNAME,B.EMPNO,C.NAME,c.role,c.secondrole
      from t_rim_comm_department A,t_rim_comm_dept_emp B,t_rim_comm_employee C
      where A.DEPTID=b.deptid and b.empno=C.EMPNO and B.DIRECT='Y'
    ) BB,
    (
       select CN,CODE_CHI_NAME from RSBT_CODE_DIC Where Code_Data_Type='00032006'
    ) CC
    where AA.EMPNO=BB.EMPNO(+) and AA.AREACODE=CC.CN(+)
  ) XX;

-- ----------------------------
-- View structure for V_RIM_COMM_USERINFO
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_USERINFO" AS 
select u.userid,
       u.Username,
       u.areacode,
       e."EMPNO",
       DECODE(E.NAME, NULL, DECODE(u.USERNAME, NULL, u.USERID, u.USERNAME), e.NAME) "NAME",
       e."SEX",
       e."NATIONALITY",
       e."BIRTH",
       e."EDUCATION",
       e."PRINCIPALSHIP",
       e."TECHNICALPOST",
       e."MOBILE",
       e."HOMEADDRESS",
       e."POSTALCODE",
       e."HOMETEL",
       e."EMAIL",
       e."NOTE",
       e."DELFLAG"
  from T_RIM_comm_user u, T_RIM_comm_employee e
 where u.empno = e.empno(+);

-- ----------------------------
-- View structure for V_RIM_COMM_USERSELECTOR
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_COMM_USERSELECTOR" AS 
select a.userid,a.username,a.userdesc,a.areacode,a.empno,b.code_chi_name
from t_rim_comm_user a,RSBT_CODE_DIC b
where a.AREACODE = B.CN order by a.areacode;

-- ----------------------------
-- View structure for V_RIM_FREQ_ALLOC
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FREQ_ALLOC" AS 
select a."GUID",a."VER_CODE",a."AREA_CODE",a."BAND_B",a."BAND_E",a."FN_CODE",v.ver_name,decode(v.data_status,'0','废止','在用') data_status,decode(s.isallocate,'0','否','是') isallocate,s.notalloc_info,s.serv_code,s.addi_info,decode(s.serv_type,'0','次要业务','主要业务') serv_type,sv.serv_name,
d.code_chi_name AREA_NAME from
FRBT_ALLOCATION a,FRBT_VERSION v,FRBT_ALLOCATION_SERVICE s,FRBT_SERVICE sv ,FRBT_CODE_DIC d
where a.ver_code = v.ver_code(+)
      and a.guid = s.alloc_guid(+)
      and s.serv_code = sv.serv_code(+)
      and a.area_code = d.cn(+);

-- ----------------------------
-- View structure for V_RIM_FREQ_PLANS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FREQ_PLANS" AS 
select p."GUID",p."PLANS_NAME",p."SYS_CODE",p."BAND_TYPE",p."CH_TYPE",p."FREQ_LNAME",p."FREQ_UNAME",p."EDIT_ORG_CODE",p."FILE_NO",p."START_DATE",p."CONFIRM_DATE",p."DATA_STATUS",p."MEMO",b.band_lb,b.band_le,b.band_ub,b.band_ue,g.group_name,g.ch_spacing,g.ch_e_bw,g.ch_er_interval,g.ch_count,
g.tc_info,g.ch_form,c.ch_lno,c.freq_lc,c.freq_lb,c.freq_le,c.ch_uno,c.freq_uc,c.freq_ub,c.freq_ue,d.org_code,d.edit_org_code pop_edit_org_code
FROM
FRBT_PLANS p,FRBT_PLANS_BAND b,FRBT_PLANS_GROUP g,FRBT_PLANS_CHANNEL c,FRBT_PLANS_POPEDOM d
where p.guid = b.plans_guid(+)
and p.guid = g.plans_guid(+)
and g.guid = c.plans_group_guid(+)
and c.guid = d.plans_ch_guid(+);

-- ----------------------------
-- View structure for V_RIM_FRM_ALLOCATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_ALLOCATION" AS 
SELECT allocation_id, freq_start, 'MHz' unit, freq_end, a.service_code,
       service_type,
       DECODE (service_type,
               '1', '主要业务',
               '0', '次要业务'
              ) service_type_name,
       alloc_alias, special_footnote_allocation, general_footnote_allocation,
      DECODE(area_code,'CH','中国','NATION','国际第三区','HK','香港','MARCO','澳门') area_codename,area_code, b.service_name, b.service_color
  FROM t_rim_frm_allocation a, t_rim_frm_service b
 WHERE a.service_code = b.service_code;

-- ----------------------------
-- View structure for V_RIM_FRM_ALLOTMENT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_ALLOTMENT" AS 
SELECT allotment_id, freq_start, freq_end, freq_start1, freq_end1,
       freq_channel_type, freq_type,
       DECODE (freq_type,
               'Y', DECODE (freq_channel_type, 'Y', '双频段', 'N', '单频段'),
               'N', DECODE (freq_channel_type, 'Y', '双频点', 'N', '单频点')
              ) freq_type_name,
       freq_working, freq_working1, allotment_area, document_code,
       administration_code, deptrrc_code, date_start, date_end,
       allotment_type, allotment_note, a.system_code, a.company_code,
       a.company_name, a.system_name
       ,d.code_chi_name
  FROM t_rim_frm_allotment a,
       t_rim_frm_allotment_company b,
       t_rim_frm_system c
       ,rsbt_code_dic d
 WHERE a.company_code = b.company_code(+) AND a.system_code = c.system_code(+)
       and a.allotment_area = d.cn(+);

-- ----------------------------
-- View structure for V_RIM_FRM_ALLOTMENT2
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_ALLOTMENT2" AS 
select a.system_code,a.COMPANY_CODE, a."ALLOTMENT_ID",a."FREQ_START",a."FREQ_END",a."FREQ_START1",a."FREQ_END1",a."FREQ_CHANNEL_TYPE",a."FREQ_TYPE",a."FREQ_WORKING",a."FREQ_WORKING1",a."ALLOTMENT_AREA",a."DOCUMENT_CODE",a."ADMINISTRATION_CODE",a."DEPTRRC_CODE",a."DATE_START",a."DATE_END",a."ALLOTMENT_TYPE",a."ALLOTMENT_NOTE",a.freq_start as freq_start0,a.freq_end as freq_end0,b.ORG_Name as deptrrc_name from t_rim_frm_allotment a,V_RIM_FRM_RSBT_ORG b where a.deptrrc_code=b.ORG_Code(+) and a.freq_type='Y'
union select g.system_code,g.COMPANY_CODE, g."ALLOTMENT_ID",g."FREQ_START",g."FREQ_END",g."FREQ_START1",g."FREQ_END1",g."FREQ_CHANNEL_TYPE",g."FREQ_TYPE",g."FREQ_WORKING",g."FREQ_WORKING1",g."ALLOTMENT_AREA",g."DOCUMENT_CODE",g."ADMINISTRATION_CODE",g."DEPTRRC_CODE",g."DATE_START",g."DATE_END",g."ALLOTMENT_TYPE",g."ALLOTMENT_NOTE",g.freq_start1 as freq_start0,g.freq_end1 as freq_end0,h.ORG_Name as deptrrc_name from t_rim_frm_allotment g,V_RIM_FRM_RSBT_ORG h where g.deptrrc_code=h.ORG_Code(+) and g.freq_type='Y';

-- ----------------------------
-- View structure for V_RIM_FRM_ASSIGNPICTURE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_ASSIGNPICTURE" AS 
(SELECT b.stat_area_code area_code, '000000' AS dept_no,
        b.app_code || ';' || b.stat_app_type || b.stat_tdi || ';'
        || a.guid code,
        stat_addr, '000' AS label, '1' AS TYPE,
        DECODE (a.freq_type,
                1, (a.freq_efe + a.freq_efb) / 2,
                a.freq_uc
               ) freq_start,
        0 freq_end,
        DECODE (a.freq_type,
                1, (a.freq_efe + a.freq_efb) / 2,
                a.freq_uc
               ) freq_emit,
        b.stat_lg longi, b.stat_la lati
   FROM rsbt_freq a, rsbt_station b, rsbt_net c
  WHERE a.station_guid = b.guid(+) AND b.net_guid = c.guid(+)
        AND b.stat_status = 1)
UNION ALL
((SELECT dept_no AS area_code, dept_no, code, 'xxx' AS stat_addr,
         TO_CHAR (freq_start) || ';' || TO_CHAR (freq_end) AS label, TYPE,
         freq_start, freq_end, freq_start AS freq_emit, longi, lati
    FROM (SELECT dept_no, guid AS code, '3' AS TYPE,
                 DECODE (freq_type,
                         '1', freq - bandwidth / 2,
                         '2', fre_low
                        ) AS freq_start,
                 DECODE (freq_type,
                         '1', freq + bandwidth / 2,
                         '2', fre_up
                        ) AS freq_end,
                 0 AS longi, 0 AS lati
            FROM (SELECT guid, dept_no, freq_type, freq, fre_low, fre_up,
                         bandwidth
                    FROM t_rim_frm_protected_freq)))
 UNION ALL
 (SELECT dept_no AS area_code, dept_no, code, 'xxx' AS stat_addr,
         TO_CHAR (freq_start) || ';' || TO_CHAR (freq_end) AS label, TYPE,
         freq_start, freq_end, freq_start AS freq_emit, longi, lati
    FROM (SELECT dept_no, guid AS code, '5' AS TYPE,
                 DECODE (freq_type,
                         '1', freq - bandwidth / 2,
                         '2', fre_low
                        ) AS freq_start,
                 DECODE (freq_type,
                         '1', freq + bandwidth / 2,
                         '2', fre_up
                        ) AS freq_end,
                 0 AS longi, 0 AS lati
            FROM (SELECT guid, dept_no, freq_type, freq, fre_low, fre_up,
                         bandwidth
                    FROM t_rim_frm_emergency_freq))))
UNION ALL
(SELECT '' AS area_code, '000000' AS dept_no, code, 'xxx' AS stat_addr,
        TO_CHAR (freq_start) || ';' || TO_CHAR (freq_end) AS label, TYPE,
        freq_start, freq_end, 0 AS freq_emit, longi, lati
   FROM (SELECT layout_code AS code, '4' AS TYPE, freq_start, freq_end,
                0 AS freq_emit, 0 AS longi, 0 AS lati
           FROM t_rim_frm_region_layout));

-- ----------------------------
-- View structure for V_RIM_FRM_CALLLETTER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_CALLLETTER" AS 
select "ID","CALL_TYPE","COMPANY_NAME","CALL_RANGE","NUM","DEPT_CODE","NOTE","CALL_RANGE1","NUM1","DOUBLERANGE","GUID","ORG_CODE","ORG_NAME","ORG_AREA_CODE","ORG_SYS_CODE","ORG_TYPE","ORG_LINK_PERSON","ORG_PERSON_ID","ORG_SUP_CODE","ORG_ADDR","ORG_POST","ORG_PHONE","ORG_MOB_PHONE","ORG_FAX","ORG_BANK","ORG_ACCOUNT_NAME","ORG_ACCOUNT","ORG_HOSTILITY","ORG_WEB_SITE","ORG_MAIL"
from t_rim_frm_callletter a, RSBT_ORG b where
  a.DEPT_CODE=b.ORG_CODE;

-- ----------------------------
-- View structure for V_RIM_FRM_DOCUMENT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_DOCUMENT" AS 
SELECT document_code, document_name, a.document_type_id, b.document_type_name,
       administration, document_date, document_content, file_name, file_dir,
       document_index, distribute,
       DECODE (distribute, '1', '下发', '0', '不下发') distributename
  FROM t_rim_frm_document a, t_rim_frm_document_type b
 WHERE a.document_type_id = b.document_type_id;

-- ----------------------------
-- View structure for V_RIM_FRM_EMERGENCY_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_EMERGENCY_FREQ" AS 
SELECT a.guid, dept_no, b.org_name, freq_type,
       DECODE (freq_type, '1', '频点', '2', '频段') freq_type_name, freq,
       bandwidth, fre_low, fre_up, oper_kind, d.system_name oper_kind_name,
       area_code, c.code_chi_name, used_org, document_code, note
  FROM t_rim_frm_emergency_freq a,
       rsbt_org b,
       rsbt_code_dic c,
       t_rim_frm_system d
 WHERE a.dept_no = b.org_code
   AND a.area_code = c.cn
   AND c.code_data_type = '00032006'
   AND a.oper_kind = d.system_code;

-- ----------------------------
-- View structure for V_RIM_FRM_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_FREQ" AS 
select
       b.allocation_id,a.system_name,a.system_code,a.service_name,b.freq_start,b.freq_end,b.area_codename
from
       v_rim_frm_system a,v_rim_frm_allocation b
where
       a.service_name=b.service_name and b.area_codename='中国'
order by b.freq_start;

-- ----------------------------
-- View structure for V_RIM_FRM_FREQ_ASSIGN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_FREQ_ASSIGN" AS 
select a."ASSIGN_GUID",a."DEPT_ASSIGN",a."FREQWORKING",a."FREQ_START",a."FREQ_END",a."TYPES",a."BAND",a."NOTE",b.org_name from t_rim_frm_freq_assign a,rsbt_org b where  a.dept_assign=b.org_code(+);

-- ----------------------------
-- View structure for V_RIM_FRM_FREQ_PAY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_FREQ_PAY" AS 
SELECT "PAY_GUID", "ORG_GUID", "APP_GUID", "FREQ_APPROVE_DATE",
       "STAT_APPROVE_DATE",
       "FEE_DERATE_PROPORTION" * 100 fee_derate_proportion,
       "FEE_DERATE_ACCORDING", "FEE_BILL", "FEE_PAYMENT", "GUID", "ORG_CODE",
       "ORG_NAME", "ORG_AREA_CODE", "ORG_SYS_CODE", "ORG_TYPE",
       "ORG_LINK_PERSON", "ORG_PERSON_ID", "ORG_SUP_CODE", "ORG_ADDR",
       "ORG_POST", "ORG_PHONE", "ORG_MOB_PHONE", "ORG_FAX", "ORG_BANK",
       "ORG_ACCOUNT_NAME", "ORG_ACCOUNT", "ORG_HOSTILITY", "ORG_WEB_SITE",
       "ORG_MAIL"
  FROM t_rim_frm_freq_pay a, rsbt_org b
 WHERE a.org_guid = b.guid;

-- ----------------------------
-- View structure for V_RIM_FRM_FREQLAYOUT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_FREQLAYOUT" AS 
SELECT   l.layout_name, l.freq_start, l.freq_end, lg.group_name,
         lg.freq_distince, lg.freq_emitwidth
    FROM t_rim_frm_layout l, t_rim_frm_layout_group lg
   WHERE l.layout_code = lg.layout_code(+)
ORDER BY l.freq_start, lg.group_name;

-- ----------------------------
-- View structure for V_RIM_FRM_LAYOUT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_LAYOUT" AS 
select a.layout_name,a.freq_start,a.freq_end,a.freq_start0,a.freq_end0,a.document_code,
a.system_code as code,a.layout_band,a.channel_type,a.layout_note,a.layout_code,
b.system_name,b.system_code from t_rim_frm_layout a ,t_rim_frm_system b  where  a.system_code=b.system_code(+);

-- ----------------------------
-- View structure for V_RIM_FRM_LAYOUT_DATA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_LAYOUT_DATA" AS 
select a."LAYOUT_NAME",a."FREQ_START",a."FREQ_END",a."FREQ_START0",a."FREQ_END0",a."DOCUMENT_CODE",a."LAYOUT_BAND",a."CHANNEL_TYPE",a."LAYOUT_NOTE",a."LAYOUT_CODE",a."SYSTEM_CODE",D.SYSTEM_NAME,a.freq_start as freq_start2,a.freq_end as freq_end2 from T_RIM_FRM_LAYOUT a,T_RIM_FRM_SYSTEM D
where A.System_Code=D.SYSTEM_CODE AND  channel_type='2' union
select b."LAYOUT_NAME",b."FREQ_START",b."FREQ_END",b."FREQ_START0",b."FREQ_END0",b."DOCUMENT_CODE",b."LAYOUT_BAND",b."CHANNEL_TYPE",b."LAYOUT_NOTE",b."LAYOUT_CODE",b."SYSTEM_CODE",E.SYSTEM_NAME,b.freq_start0 as freq_start2,b.freq_end0 as freq_end2 from T_RIM_FRM_LAYOUT b,T_RIM_FRM_SYSTEM E
 where B.System_Code=E.SYSTEM_CODE AND  channel_type='2'
 union select c."LAYOUT_NAME",c."FREQ_START",c."FREQ_END",c."FREQ_START0",c."FREQ_END0",c."DOCUMENT_CODE",c."LAYOUT_BAND",c."CHANNEL_TYPE",c."LAYOUT_NOTE",c."LAYOUT_CODE",c."SYSTEM_CODE",F.SYSTEM_NAME,c.freq_start as freq_start2,c.freq_end as freq_end2 from T_RIM_FRM_LAYOUT c,T_RIM_FRM_SYSTEM F
 where C.System_Code=F.SYSTEM_CODE AND channel_type='1';

-- ----------------------------
-- View structure for V_RIM_FRM_PRE_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_PRE_FREQ" AS 
select '' GUID,
     '' accept_id,
    '' apply_code,'' decl_code,
    '' freq_no,'' area_code,
    '' dept_name,
    '' Stat_addr,--台站地址
    '' stat_name,--台站名称
    0 altitude, --海拔高度
    '' begin_date,'' appr_date,--批准日期
    '' stat_type,--台站类型
  0 longi,
    0 lati,
    null longi_view,
    null lati_view,--经纬度
  0 freq_emit,--发射频率
  0 freq_emit_low,--发射频率下限
  0 freq_emit_up,--发射频率上限
  0 freq_rece,0 freq_rece_low,0 freq_rece_up,--接收频率
  '' freq_emit_view,--查看发射频率
  null freq_rece_view--查看接收频率
  from dual where 0=1;

-- ----------------------------
-- View structure for V_RIM_FRM_PROTECTED_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_PROTECTED_FREQ" AS 
SELECT a.guid, dept_no, b.org_name, freq_type,
       DECODE (freq_type, '1', '频点', '2', '频段') freq_type_name, freq,
       bandwidth, fre_low, fre_up, oper_kind, d.system_name oper_kind_name,
       area_code, c.code_chi_name, used_org, document_code, note
  FROM t_rim_frm_protected_freq a,
       rsbt_org b,
       rsbt_code_dic c,
       t_rim_frm_system d
 WHERE a.dept_no = b.org_code
   AND a.area_code = c.cn
   AND c.code_data_type = '00032006'
   AND a.oper_kind = d.system_code;

-- ----------------------------
-- View structure for V_RIM_FRM_REGION_LAYOUT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_REGION_LAYOUT" AS 
select a.layout_name,a.freq_start,a.freq_end,a.freq_start0,a.freq_end0,a.document_code,
a.system_code as code,a.layout_band,a.channel_type,a.layout_note,a.layout_code,
b.system_name,b.system_code from t_rim_frm_region_layout a ,t_rim_frm_system b  where  a.system_code=b.system_code(+);

-- ----------------------------
-- View structure for V_RIM_FRM_REGION_LAYOUT_DATA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_REGION_LAYOUT_DATA" AS 
SELECT D.Service_Code,D.SYSTEM_NAME,a.layout_code, a."LAYOUT_NAME", a."FREQ_START", a."FREQ_END",
          a."FREQ_START0", a."FREQ_END0", a."DOCUMENT_CODE", a."SYSTEM_CODE",
          a."LAYOUT_BAND", a."CHANNEL_TYPE", a."LAYOUT_NOTE",
          a.freq_start AS freq_start2, a.freq_end AS freq_end2
     FROM t_rim_frm_region_layout a,T_RIM_FRM_SYSTEM D
    WHERE  a.System_Code=D.SYSTEM_CODE AND channel_type = '2'
   UNION
   SELECT D.Service_Code, D.SYSTEM_NAME,b.layout_code, b."LAYOUT_NAME", b."FREQ_START", b."FREQ_END",
          b."FREQ_START0", b."FREQ_END0", b."DOCUMENT_CODE", b."SYSTEM_CODE",
          b."LAYOUT_BAND", b."CHANNEL_TYPE", b."LAYOUT_NOTE",
          b.freq_start0 AS freq_start2, b.freq_end0 AS freq_end2
     FROM t_rim_frm_region_layout b,T_RIM_FRM_SYSTEM D
    WHERE  b.System_Code=D.SYSTEM_CODE AND channel_type = '2'
   UNION
   SELECT D.Service_Code, D.SYSTEM_NAME,c.layout_code, c."LAYOUT_NAME", c."FREQ_START", c."FREQ_END",
          c."FREQ_START0", c."FREQ_END0", c."DOCUMENT_CODE", c."SYSTEM_CODE",
          c."LAYOUT_BAND", c."CHANNEL_TYPE", c."LAYOUT_NOTE",
          c.freq_start AS freq_start2, c.freq_end AS freq_end2
     FROM t_rim_frm_region_layout c,T_RIM_FRM_SYSTEM D
    WHERE  c.System_Code=D.SYSTEM_CODE AND channel_type = '1';

-- ----------------------------
-- View structure for V_RIM_FRM_RSBT_FEEUNITRECORD
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_RSBT_FEEUNITRECORD" AS 
SELECT a."GUID",a."ORG_GUID",a."FEE_TIME",a."FEE_YEAR",a."FEE_BILL",a."FEE_PAYMENT",a."FEE_FREQ",a."FEE_ELSE",a."FEE_LATE",a."FEE_BILL_CODE",a."FEE_OPERATION",a."MEMO",b.org_code,b.org_name from  RSBT_FEEUNITRECORD a,rsbt_org b where a.org_guid=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_FRM_RSBT_ORG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_RSBT_ORG" AS 
SELECT a."GUID", a."ORG_CODE", a."ORG_NAME", a."ORG_AREA_CODE",
       a."ORG_SYS_CODE", a."ORG_TYPE", a."ORG_LINK_PERSON", a."ORG_PERSON_ID",
       a."ORG_SUP_CODE", a."ORG_ADDR", a."ORG_POST", a."ORG_PHONE",
       a."ORG_MOB_PHONE", a."ORG_FAX", a."ORG_BANK", a."ORG_ACCOUNT_NAME",
       a."ORG_ACCOUNT", a."ORG_HOSTILITY", a."ORG_WEB_SITE", a."ORG_MAIL"
  FROM rsbt_org a
 WHERE a.org_area_code = '000000' AND ROWNUM = 1
UNION ALL
SELECT a."GUID", a."ORG_CODE", a."ORG_NAME", a."ORG_AREA_CODE",
       a."ORG_SYS_CODE", a."ORG_TYPE", a."ORG_LINK_PERSON", a."ORG_PERSON_ID",
       a."ORG_SUP_CODE", a."ORG_ADDR", a."ORG_POST", a."ORG_PHONE",
       a."ORG_MOB_PHONE", a."ORG_FAX", a."ORG_BANK", a."ORG_ACCOUNT_NAME",
       a."ORG_ACCOUNT", a."ORG_HOSTILITY", a."ORG_WEB_SITE", a."ORG_MAIL"
  FROM rsbt_org a
 WHERE a.org_area_code <> '000000';

-- ----------------------------
-- View structure for V_RIM_FRM_SERVICE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_SERVICE" AS 
SELECT a."SERVICE_NAME",a."SERVICE_COLOR",a."ISCUTLINE",a."PARENTSERVICE",a."SERVICE_CODE", b.service_name parentservice_name
  FROM t_rim_frm_service a, t_rim_frm_service b
 WHERE a.parentservice = b.service_code(+);

-- ----------------------------
-- View structure for V_RIM_FRM_STAT_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_STAT_FREQ" AS 
SELECT h."GUID",h."APPLY_CODE",h."STAT_APP_TYPE",h."STAT_TYPEID",h."DECL_CODE",
h."AREA_CODE",h."DEPT_NAME",h."STAT_ADDR",h."STAT_NAME",h."ALTITUDE",h."ALTITUDE_VIEW",
h."BEGIN_DATE",h."APPR_DATE",h."STAT_TYPE",h."STAT_SIGN_NAME",h."STAT_SIGN",h."LONGI",
h."LATI",h."LONGI_VIEW",h."LATI_VIEW",h."FREQ_EMIT",h."FREQ_EMIT_LOW",h."FREQ_EMIT_UP",
h."FREQ_EMIT_UNIT",h."EMIT_UNIT_NAME",h."FREQ_RECE",h."FREQ_RECE_LOW",h."FREQ_RECE_UP",
h."FREQ_RECE_UNIT",h."RECE_UNIT_NAME",h."FREQ_EMIT_VIEW",h."FREQ_RECE_VIEW",
h."FREQ_EMIT_VALUE",h."FREQ_RECE_VALUE",h."FREQ_NO", g.code_chi_name area_name
  FROM (SELECT b.guid guid, b.app_code apply_code,
               b.stat_app_type stat_app_type, b.stat_app_type stat_typeid,
               b.stat_app_type || b.stat_tdi decl_code,
               DECODE (b.stat_area_code,
                       NULL, DECODE (SUBSTR (b.app_code, 2, 1),
                                     '9', '000000',
                                     SUBSTR (b.app_code, 2, 4) || '00'
                                    ),
                       b.stat_area_code
                      ) area_code,
               DECODE(SUBSTR(b.app_code,0,2),'PA',f_rim_rsm_getpaname(b.app_code,''),d.org_name) dept_name,----台站名称
               b.stat_addr stat_addr,         --台站地址
               b.stat_name stat_name,  --台站名称
                                     b.stat_at altitude,
               TO_CHAR (b.stat_at) || '米' altitude_view,   --海拔高度
               b.stat_date_start begin_date, b.stat_date_start appr_date,  --批准日期
               e.code_chi_name stat_type,                           --台站类型
               DECODE (stat_status,
                       0, '封存台站',
                       1, '工作台站',
                       '报废台站'
                      ) stat_sign_name,
               b.stat_status stat_sign,                             --台站状态
                                       b.stat_lg longi, b.stat_la lati,
               f_rim_rsm_changedegree (b.stat_lg) longi_view,
               f_rim_rsm_changedegree (b.stat_la) lati_view,
               DECODE (a.freq_type,
                       1, (a.freq_efe + a.freq_efb) / 2,
                       a.freq_uc
                      ) freq_emit,                                  --发射频率
               DECODE (a.freq_type, 1, a.freq_efb, a.freq_uc) freq_emit_low,  --发射频率下限
               DECODE (a.freq_type, 1, a.freq_efe, a.freq_uc) freq_emit_up,  --发射频率上限
               '1' freq_emit_unit, 'MHz' emit_unit_name,   --发射频率单位，单位名称
               DECODE (a.freq_type,
                       1, (a.freq_rfe + a.freq_rfb) / 2,
                       a.freq_lc
                      ) freq_rece,                                  --接收频率
               DECODE (a.freq_type, 1, a.freq_rfb, a.freq_lc) freq_rece_low,    --接收频率下限
               DECODE (a.freq_type, 1, a.freq_rfe, a.freq_lc) freq_rece_up,   --接收频率上限
               '1' freq_rece_unit, 'MHz' rece_unit_name,   --发射频率单位，单位名称
               DECODE (a.freq_type,
                       1, TO_CHAR (a.freq_efb) || '--' || TO_CHAR (a.freq_efe),
                       TO_CHAR (a.freq_uc)
                      ) freq_emit_view,                           --发射频率值
               DECODE (a.freq_type,
                       1, TO_CHAR (a.freq_rfb) || '--' || TO_CHAR (a.freq_rfe),
                       TO_CHAR (a.freq_lc)
                      ) freq_rece_view,                           --接收频率值
                  DECODE (a.freq_type,
                          1, TO_CHAR (a.freq_efb) || '--'
                           || TO_CHAR (a.freq_efe),
                          TO_CHAR (a.freq_uc)
                         )
               || 'MHz' freq_emit_value,                    --发射频率显示结果
                  DECODE (a.freq_type,
                          1, TO_CHAR (a.freq_rfb) || '--'
                           || TO_CHAR (a.freq_rfe),
                          TO_CHAR (a.freq_lc)
                         )
               || 'MHz' freq_rece_value,                    --接收频率显示结果
               f.ft_freq_no freq_no                        --设备编号/频率编号
          FROM rsbt_freq a,
               rsbt_station b,
               rsbt_net c,
               rsbt_org d,
               rsbt_code_dic e,
               rsbt_freq_t f
         WHERE a.station_guid = b.guid(+)
           AND b.net_guid = c.guid(+)
           AND c.org_guid = d.guid(+)
           AND b.stat_type = e.cn(+)
           AND e.code_data_type(+) = '00052006'
           AND a.guid = f.guid(+)
           AND b.stat_status = 1 ) h,
           rsbt_code_dic g
 WHERE h.area_code = g.cn AND g.code_data_type = '00032006';

-- ----------------------------
-- View structure for V_RIM_FRM_SYSTEM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_SYSTEM" AS 
select 
a.system_name,
a.system_note,
a.system_code,
a.service_code,
b.service_name,
b.service_color,
b.iscutline,
b.parentservice 
from 
t_rim_frm_system a , 
t_rim_frm_service b 
where a.service_code=b.service_code;

-- ----------------------------
-- View structure for V_RIM_FRM_SYSTEM_SER_ALL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_FRM_SYSTEM_SER_ALL" AS 
select a."SYSTEM_NAME",a."SYSTEM_NOTE",a."SYSTEM_CODE",a."SERVICE_CODE",b.parentservice,b.service_name,b.service_color,c.freq_start,c.freq_end from t_rim_frm_system a,t_rim_frm_service b,t_rim_frm_allocation c
where a.service_code=b.service_code(+) and b.service_code=c.service_code(+);

-- ----------------------------
-- View structure for V_RIM_OA_ADDRESSLIST
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_OA_ADDRESSLIST" AS 
select a.guid, a.deptname, a.rolename, a.uname,
       DECODE (a.sex, '1','未知','2','男','3','女') sex,
        a.mobitetele, a.telephone, a.exigrer, a.exigetele,a.ctype,b.itemname
      from t_rim_oa_addresslist a,( select ITEMID,ITEMNAME from t_rim_oa_type where TYpeID='18') b
      where a.ctype=b.itemid(+);

-- ----------------------------
-- View structure for V_RIM_OA_DOC
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_OA_DOC" AS 
SELECT
	   d.DOCID, d.DOCNAME, d.DOCDESC, d.SECURITYTYPE, d.KEEPYEAR, d.PAGENUM, d.CREATOR,
	   TO_CHAR(d.CREATETIME, 'yyyy-MM-dd') AS CREATETIME, d.DOCLIB, d.DOCFOLDER,
	   d.REFDATA, d.REFDATAVIEWER, l.LIBNAME, s.SECURITYTYPENAME,userid
FROM
	 T_RIM_OA_DOC d, T_RIM_OA_DOC_LIB l, T_RIM_OA_DOC_SECURITYTYPE s,
    t_rim_comm_data_res_key e,v_rim_comm_permission f
WHERE
	 d.DOCLIB = l.LIBID AND d.SECURITYTYPE = s.SECURITYTYPEID
   and d.securitytype=s.securitytypeid
   and d.securitytype=e.datakey(+)
   AND (    e.reftable(+) = 'T_RIM_OA_DOC_SECURITYTYPE'
        AND e.resid = f.resid(+)
        AND BITAND (f.permissionvalue, 1) + 0 = 1
       );

-- ----------------------------
-- View structure for V_RIM_OA_DOC_WFNOTE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_OA_DOC_WFNOTE" AS 
select ID,ACTIVITY,ACTOR,PROCESSDATE,NOTE,REFDATA
    from T_RIM_OA_DOC_WFNOTE
union
  select to_char(rownum) as ID,
         e.activityname as ACTIVITY,
         f.username as ACTOR,
         b.finishdate as PROCESSDATE,
         a.note as note,
         d.datakey as refdata
    from wf_rt_note a, wf_rt_work b, wf_rt_activity c, wf_rt_case d, WF_DEF_CACHEACTNAME e, T_RIM_comm_user f
    where
          a.workid(+)=b.workid and
          b.activityinstid=c.id and
          c.caseid=d.id and
          d.packageid=e.packageid and
          d.processid=e.processid and
          c.activityid=e.activityid and
          b.performer = f.userid;

-- ----------------------------
-- View structure for V_RIM_OA_DOCEXPLORE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_OA_DOCEXPLORE" AS 
SELECT
	   a.FOLDERID AS DOCID, a.PARENT, a.FOLDERNAME AS DOCNAME, '' AS DOCDESC, 0 AS DOCTYPE, '目录' AS DOCTYPENAME
FROM
	 T_RIM_OA_DOC_FOLDER a
UNION
SELECT
	   b.DOCID, b.DOCFOLDER AS PARENT, b.DOCNAME, b.DOCDESC, 1 AS DOCTYPE, '档案' AS DOCTYPENAME
FROM
	 T_RIM_OA_DOC b;

-- ----------------------------
-- View structure for V_RIM_OA_MEMORABILIA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_OA_MEMORABILIA" AS 
SELECT m."UNIQUEID",m."MENTYPE",m."CONTENT",m."RECORDER",m."RECORDDATE",m."TITLE" ,t.itemname FROM
   T_RIM_OA_MEMORABILIA  m,t_rim_oa_type t
WHERE t.typeid='06' and m.mentype=t.itemid order by m.recorddate desc;

-- ----------------------------
-- View structure for V_RIM_OA_NEWS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_OA_NEWS" AS 
SELECT n."UNIQUEID",n."TITLE",n."CONTENT",n."PUBLISHERID",n."CLASSID",n."PUBLISHDATE",n."EFFECTIVEDATE",n."DOWNATTACHMENT",n."STATUS",n."READFLAQ" ,userid,t.itemname FROM
   t_rim_oa_news  n,t_rim_comm_data_res_key e,v_rim_comm_permission f,t_rim_oa_type t
WHERE n.uniqueid=e.datakey(+)
   AND (    e.reftable(+) = 't_rim_oa_news'
        AND e.resid = f.resid(+)
        AND BITAND (f.permissionvalue, 1) + 0 = 1
       )  and n.classid=t.itemid and t.typeid='01'  order by n.publishdate desc;

-- ----------------------------
-- View structure for V_RIM_OA_NEWS_SREVIEW
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_OA_NEWS_SREVIEW" AS 
select a."UNIQUEID",a."TITLE",a."CONTENT",a."PUBLISHERID",a."CLASSID",a."PUBLISHDATE",a."EFFECTIVEDATE",a."DOWNATTACHMENT",a."STATUS",a."READFLAQ",b.uniqueid as Revuniqueid,b.content as revcontent,b.reviewerid,b.newsid,b.applydata from t_rim_oa_news a,
t_rim_oa_newsreview b  where a.uniqueid(+)=b.newsid;

-- ----------------------------
-- View structure for V_RIM_OA_NOTICE_VIEW
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_OA_NOTICE_VIEW" AS 
select a.UNIQUEID,a.TITLE,a.CONTENT,a.PUBLISHERID,a.CLASSID,to_char(a.PUBLISHDATE,'yyyy-MM-dd') PUBLISHDATE,to_char(a.EFFECTIVEDATE,'yyyy-MM-dd') EFFECTIVEDATE,a.DOWNATTACHMENT,
 DECODE ( a.STATUS,
               '0', '新建',
               '1', '待审批',
               '2','不批准',
               '3','生效',
               '4','终止'
              ) STATUSNAME , a.STATUS,a.READFLAQ,a.APPROVER,b.classcontext,c.username
  from T_RIM_OA_NOTICE a,(select ITEMID ClassID,ITEMNAME ClassContext from t_rim_oa_type where TYPEID='05') b,t_rim_comm_user c
  where a.classid=b.classid(+) and c.userid(+)=a.approver order by PUBLISHDATE desc;

-- ----------------------------
-- View structure for V_RIM_OA_WF_ARCHIVE_MAIN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_OA_WF_ARCHIVE_MAIN" AS 
select ----公文表审批（工作流视图）
a."ARCHIVEID",a."ARCHIVENO",a."RECEIVERNO",a."ARCHIVETYPE",a."SUBJECT",a."KEYWORDS",a."ARCHIVECLASS",a."URGENCY",a."RECEIVER_MAIN",a."RECEIVER_CC",a."SECRECY",a."SECRECYDATE",a."NUM",a."CREATORDEPARTMENT",a."CREATOR",a."CREATORTEL",a."COMPANY",a."ARCHIVEDATE",a."SIGNER",a."STATUS",a."AREACODE",a."USERID",F_IFNULL(B.DATAKEY) AS DATAKEY,F_RIM_OA_ARCHIVEName(a.archiveclass,'02') as ARCHIVECLASSName,
F_RIM_OA_ARCHIVEName(a.URGENCY,'03') as URGENCYName,
F_RIM_OA_ARCHIVEName(a.SECRECY,'04') as SECRECYName
from T_RIM_OA_ARCHIVE A ,WF_RT_CASE B
where  A.ARCHIVEID=B.Datakey(+)
 order by A.ARCHIVEID;

-- ----------------------------
-- View structure for V_RIM_OA_WF_MISSIVE_MAIN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_OA_WF_MISSIVE_MAIN" AS 
select ----公文表审批（工作流视图）
a."MISSIVEID",a."MISSIVETITLE",a."MISSIVETYPE",a."EXIGENCE",a."KEEPSECRET",a."OPERID",a."PROPOSALTELE",a."ADDRESSERDEPT",a."MAINDEPT",a."CCDEPT",a."THEMATIC",a."FALG",a."COMEONDEPT",a."COMEONNUMER",a."COMEONCODE",a."COMEONDATE",a."DODATE",a."CONTEXTTYPE",a."CREATEDATE",a."CRETAER",a."PARTCODE",F_IFNULL(B.DATAKEY) AS DATAKEY,F_RIM_OA_ARCHIVEName(a.missivetype,'02') as ARCHIVECLASSName,
F_RIM_OA_ARCHIVEName(a.exigence,'03') as URGENCYName
from T_RIM_WF_MISSIVE A ,WF_RT_CASE B
where  A.MISSIVEID=B.Datakey(+)
 order by A.Missiveid;

-- ----------------------------
-- View structure for V_RIM_PA_AR_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_PA_AR_APPLY" AS 
select a.apply_id,a.app_code,a.area_code,b.user_name unit_name,b.idcard unit_code,a.app_date,'个人申请' app_type,
       decode(a.stat_class,'0','一般台站','特殊台站') stat_class,decode(a.stat_type,'0','A','1','B','2','C') stat_type
from ar_apply a,ar_user b
where a.apply_id=b.apply_id and b.user_type='0' and  a.app_subject='0' --个人台站申请
union all
select a.apply_id,a.app_code,a.area_code,b.unit_name,substr(b.unit_code,0,8)||'-'||substr(b.unit_code,9) unit_code,a.app_date,'单位申请' app_type,
decode(a.stat_class,'0','一般台站','特殊台站') stat_class,decode(a.stat_type,'0','A','1','B','2','C') stat_type
from ar_apply a,ar_unit b
where a.apply_id=b.apply_id and a.app_subject='1';

-- ----------------------------
-- View structure for V_RIM_PA_AR_APPLY_SEARCH
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_PA_AR_APPLY_SEARCH" AS 
select a.apply_id, a.app_code, a.area_code,a.app_item, decode(a.app_item,'0','新设','1','变更个人信息','2','变更台站级别','3','变更电台其他参数') app_item_v,a.app_subject, decode( a.app_subject,'0','个人申请','单位申请') app_subject_v, a.stat_class, a.special_explain,
a.stat_name, a.stat_scope, a.stat_special, a.stat_type, a.callsign_old, a.level_old, a.otherinfo, a.memo, a.app_date, a.lastmodify ,
b.user_id unit_id, user_name unit_name,b.idcard unit_code,
contact_addr1||contact_addr2||contact_addr3||contact_addr4 contact_addr  ,connect_phone  unit_phone ,b.fax unit_fax
from ar_apply a,ar_user b
where a.apply_id=b.apply_id and b.user_type='0' --个人台站申请
union all
select a.apply_id, a.app_code, a.area_code,a.app_item, decode(a.app_item,'0','新设','1','变更个人信息','2','变更台站级别','3','变更电台其他参数') app_item_v, a.app_subject,decode( a.app_subject,'0','个人申请','单位申请') app_subject_v, a.stat_class, a.special_explain,
a.stat_name, a.stat_scope, a.stat_special, a.stat_type, a.callsign_old, a.level_old, a.otherinfo, a.memo, a.app_date, a.lastmodify ,
b.unit_id, unit_name, unit_code, address1||address2||address3||address4 contact_addr, unit_phone, unit_fax
from ar_apply a,ar_unit b
where a.apply_id=b.apply_id;

-- ----------------------------
-- View structure for V_RIM_PA_AR_LICENSE_UNIT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_PA_AR_LICENSE_UNIT" AS 
select  a.guid license_guid,c.apply_id,a.license_code,decode(c.special_explain,'3','4','2') license_type,decode(c.stat_class,'0','单位一般电台','单位特殊电台') license_type_v,f_rim_rsm_licevalidcheck(a.license_date_e,a.license_status) license_status,a.license_date_b,a.license_date_e,a.license_date,a.memo,
 b.call_sign_id, b.area_code, b.stat_class, b.stat_status, b.rep_freq_up, b.rep_freq_down, b.rep_pow, b.rep_mod, b.rep_data_mod_class, b.rep_remoter_class, b.ar_memo,
 c.app_code, c.app_item, c.app_subject, c.special_explain, c.stat_name, c.stat_scope, c.stat_special,decode(c.special_explain,'3','业余中继台',decode(c.stat_type,0,'A类',1,'B类',2,'C类'))stat_type, c.callsign_old, c.level_old, c.otherinfo,  c.app_date, c.lastmodify,
 d.unit_name, decode(length(d.unit_code),9,substr(d.unit_code,1,8)||'-'||substr(d.unit_code,9,1),d.unit_code) unit_code,u1.user_name user_name1,u1.idcard idcard1,u2.user_name user_name2,u2.idcard idcard2,decode(s.call_sign_status,'0','未指配','1','已占用','2','预留','3','锁定','4','注销','5','他省占用','6','临时指配','','未指配') call_sign_status,
  e.stat_addr1||e.stat_addr2||e.stat_addr3||e.stat_addr4  stat_address, e.plate_number
 from t_rim_pa_AR_LICENSE a,ar_station b ,ar_apply c ,ar_unit d,ar_station_ext e,ar_user u1, ar_user u2,ar_call_sign s
 where a.apply_id(+)=b.apply_id and b.apply_id(+)=c.apply_id and c.apply_id=e.apply_id(+) and b.call_sign_id=s.call_sign_id(+)
 and c.apply_id=u1.apply_id and u1.user_type='1' and c.apply_id=u2.apply_id and u2.user_type='2'
 and c.apply_id=d.apply_id;

-- ----------------------------
-- View structure for V_RIM_PA_AR_LICENSE_USER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_PA_AR_LICENSE_USER" AS 
select a.guid license_guid,c.apply_id,a.license_code,decode(c.special_explain,'3','3','1') license_type,decode(c.stat_class,'0','个人一般电台','个人特殊台') license_type_v, f_rim_rsm_licevalidcheck(a.license_date_e,a.license_status) license_status,a.license_date_b,a.license_date_e,a.license_date,a.memo,
 b.call_sign_id, b.area_code, b.stat_class, b.stat_status, b.rep_freq_up, b.rep_freq_down, b.rep_pow, b.rep_mod, b.rep_data_mod_class, b.rep_remoter_class, b.ar_memo,
 c.app_code, c.app_item, c.app_subject, c.special_explain, c.stat_name, c.stat_scope, c.stat_special, c.callsign_old, c.level_old, c.otherinfo,  c.app_date, c.lastmodify,
 d.user_name, d.idcard,decode(c.special_explain,'3','业余中继台',decode(c.stat_type,0,'A类',1,'B类',2,'C类'))stat_type,decode(s.call_sign_status,'0','未指配','1','已占用','2','预留','3','锁定','4','注销','5','他省占用','6','临时指配','','未指配') call_sign_status,
 e.stat_addr1||e.stat_addr2||e.stat_addr3||e.stat_addr4  stat_address, e.plate_number
 from t_rim_pa_AR_LICENSE a,ar_station b ,ar_apply c ,ar_user d,ar_station_ext e,ar_call_sign s
 where a.apply_id(+)=c.apply_id and b.apply_id(+)=c.apply_id and c.apply_id=e.apply_id(+) and b.call_sign_id=s.call_sign_id(+)
 and c.apply_id=d.apply_id and d.user_type='0';

-- ----------------------------
-- View structure for V_RIM_PA_AR_STAITON
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_PA_AR_STAITON" AS 
select  a.apply_id, s.call_sign_id, a.area_code,decode(a.stat_class,'0','一般台站','特殊台站') stat_class, s.stat_status, s.rep_freq_up, s.rep_freq_down, s.rep_pow,c.call_sign_status call_status,
 decode(s.rep_mod,'0','数字调制','模拟调制') rep_mod, s.rep_data_mod_class, s.rep_remoter_class, s.ar_memo,
a.app_code,b.user_name unit_name,b.idcard unit_code,a.app_date,b.mobile contact_phone,decode(c.call_sign_status,'0','未指配','1','已占用','2','预留','3','锁定','4','注销','5','他省占用','6','临时指配','','未指配') call_sign_status,
contact_addr1||contact_addr2||contact_addr3||contact_addr4 contact_addr  ,connect_phone  unit_phone,decode(s.stat_class,'','申请表','技术资料表') app_type
from ar_station s, ar_apply a,ar_user b,ar_call_sign c
where s.apply_id(+)=a.apply_id  and a.apply_id=b.apply_id and s.call_sign_id=c.call_sign_id(+) and b.user_type='0' and a.app_subject='0' --个人台站申请
union all
select  a.apply_id, s.call_sign_id, a.area_code,  decode(a.stat_class,'0','一般台站','特殊台站') stat_class, s.stat_status, s.rep_freq_up, s.rep_freq_down, s.rep_pow,c.call_sign_status call_status,
 decode(s.rep_mod,'0','数字调制','模拟调制') rep_mod, s.rep_data_mod_class, s.rep_remoter_class, s.ar_memo,
a.app_code,b.unit_name,substr(b.unit_code,0,8)||'-'||substr(b.unit_code,9) unit_code ,a.app_date,b.unit_phone contact_phone,decode(c.call_sign_status,'0','未指配','1','已占用','2','预留','3','锁定','4','注销','5','他省占用','6','临时指配','','未指配') call_sign_status,
address1||address2||address3||address4 contact_addr, unit_phone,decode(s.stat_class,'','申请表','技术资料表') app_type
from ar_station s, ar_apply a,ar_unit b,ar_call_sign c
where s.apply_id(+)=a.apply_id and a.apply_id=b.apply_id  and s.call_sign_id=c.call_sign_id(+) and  a.app_subject='1';

-- ----------------------------
-- View structure for V_RIM_PA_AR_STAITON_CSIGN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_PA_AR_STAITON_CSIGN" AS 
select distinct a."SIGNTYPES",a."SPECIAL_EXPLAIN",a."APPLY_ID",a."CALL_SIGN_ID",a."AREA_CODE",a."STAT_CLASS",a."STAT_STATUS",a."REP_FREQ_UP",a."REP_FREQ_DOWN",a."REP_POW",a."REP_MOD",a."REP_DATA_MOD_CLASS",a."REP_REMOTER_CLASS",a."AR_MEMO",a."APP_CODE",a."UNIT_NAME",a."UNIT_CODE",a."APP_DATE",a."CONTACT_ADDR",a."UNIT_PHONE",a."APP_TYPE",a."APP_SUBJECT",
b.call_sign_status,decode(call_sign_status,0,'未指配',1,'已占用',2,'预留',3,'锁定',4,'注销',5,'他省占用',6,'临时指配','','未指配') callSignStatus,b.set_time,c.code_chi_name
from v_rim_pa_ar_staiton_search a,ar_call_sign b,(select * from ar_dic where CODE_DATA_TYPE='00032006') c
where a.call_sign_id=b.call_sign_id(+) and a.area_code=c.cn;

-- ----------------------------
-- View structure for V_RIM_PA_AR_STAITON_SEARCH
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_PA_AR_STAITON_SEARCH" AS 
select decode(s.call_sign_id,'','未指配','已指配') SignTypes ,a.special_explain,a.apply_id, s.call_sign_id, a.area_code, decode(s.stat_class,'0','一般台站','特殊台站') stat_class, s.stat_status, s.rep_freq_up, s.rep_freq_down, s.rep_pow,
 decode(s.rep_mod,'0','数字调制','模拟调制') rep_mod, s.rep_data_mod_class, s.rep_remoter_class, s.ar_memo,
a.app_code,b.user_name unit_name,b.idcard unit_code,a.app_date,
contact_addr1||contact_addr2||contact_addr3||contact_addr4 contact_addr  ,connect_phone  unit_phone,decode(s.stat_class,'','申请表','技术资料表') app_type,a.app_subject
from ar_station s, ar_apply a,ar_user b
where s.apply_id=a.apply_id(+)  and a.apply_id=b.apply_id and b.user_type='0' and a.app_subject='0' --个人台站申请
union all
select decode(s.call_sign_id,'','未指配','已指配') SignTypes ,a.special_explain,a.apply_id, s.call_sign_id, a.area_code,  decode(s.stat_class,'0','一般台站','特殊台站') stat_class, s.stat_status, s.rep_freq_up, s.rep_freq_down, s.rep_pow,
 decode(s.rep_mod,'0','数字调制','模拟调制') rep_mod, s.rep_data_mod_class, s.rep_remoter_class, s.ar_memo,
a.app_code,b.unit_name,substr(b.unit_code,0,8)||'-'||substr(b.unit_code,9) unit_code ,a.app_date,
address1||address2||address3||address4 contact_addr, unit_phone,decode(s.stat_class,'','申请表','技术资料表') app_type,a.app_subject
from ar_station s, ar_apply a,ar_unit b
where s.apply_id=a.apply_id(+) and a.apply_id=b.apply_id and  a.app_subject='1';

-- ----------------------------
-- View structure for V_RIM_RMS_FORMLIST
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RMS_FORMLIST" AS 
select 0 sortindex, guid ,app_code formcode,app_type  formtype,app_code from rsbt_apply
  union
  select 1 sortindex,guid, stat_app_type || stat_tdi as formcode,stat_app_type formtype,app_code from rsbt_station;

-- ----------------------------
-- View structure for V_RIM_RMS_FORMLIST_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RMS_FORMLIST_R" AS 
select 0 sortindex, guid ,app_code formcode,app_type  formtype,app_code from rsbt_apply_r
  union
  select 1 sortindex,guid, stat_app_type || stat_tdi as formcode,stat_app_type formtype,app_code from rsbt_station_r;

-- ----------------------------
-- View structure for V_RIM_RSM_ANTE_DATA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_ANTE_DATA" AS 
select 
a."GUID",
a."MODEL_NO",
a."TYPE",
a."APPR_CODE",
a."MANUFACTURER",
a."FB_CONT",
a."DIRE_COEF",
a."DIST_DEGREE",
a."ISOL_DEGREE",
a."POLA",
a."ANTE_COEF",
a."WORKFREQ",
a."ANGLE",
a."GAIN",
b.code_chi_name type_Name,
c.code_chi_name pola_name 

from
t_rim_rsm_ante_data a,rsbt_code_dic b,rsbt_code_dic c
where 
a.type=b.cn(+) and (b.code_data_type='00172006' 
or b.code_data_type is null) 
and a.pola=c.cn(+) and 
(c.code_data_type='00202006' or c.code_data_type is null);

-- ----------------------------
-- View structure for V_RIM_RSM_ANTFEED_DATA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_ANTFEED_DATA" AS 
select antdata."GUID",antdata."MODEL_NO",antdata."TYPE",antdata."APPR_CODE",antdata."MANUFACTURER",antdata."FB_CONT",antdata."DIRE_COEF",antdata."DIST_DEGREE",antdata."ISOL_DEGREE",antdata."POLA",antdata."ANTE_COEF",antdata."WORKFREQ",antdata."ANGLE",antdata."GAIN",AntTypeCode.Code_Chi_Name as antType,PoleCode.Code_Chi_Name as Pole
from t_rim_rsm_ante_data antdata,rsbt_code_dic AntTypeCode,rsbt_code_dic PoleCode
where AntTypeCode.code_data_type='00172006' and antdata.type=AntTypeCode.code1
and PoleCode.code_data_type='00202006' and antdata.pola=PoleCode.code1;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY" AS 
select a.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,
a.APP_OBJECT_TYPE,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
c.org_name as set_org_name,
c.org_addr AS set_org_addr,
c.org_link_person AS set_org_link_person,
c.org_phone AS set_org_phone,
c.org_mob_phone AS set_org_mob_phone,
c.org_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY a , RSBT_net b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006');

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_EXP
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_EXP" AS 
select a.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
c.org_name as set_org_name,
c.org_addr AS set_org_addr,
c.org_link_person AS set_org_link_person,
c.org_phone AS set_org_phone,
c.org_mob_phone AS set_org_mob_phone,
c.org_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
 to_char(a.APP_FTLB,'yyyy-MM-dd') app_ftlb_v,
 to_char(a.APP_FTLE,'yyyy-MM-dd') app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY a , RSBT_net b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type<>'PA'
union all
select a.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
app_pa.app_pa_name as set_org_name,
app_pa.app_pa_live_addr AS set_org_addr,
app_pa.app_pa_name AS set_org_link_person,
app_pa.app_pa_org_phone AS set_org_phone,
app_pa.app_pa_mobile AS set_org_mob_phone,
app_pa.app_pa_serv_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
 to_char(a.APP_FTLB,'yyyy-MM-dd') app_ftlb_v,
 to_char(a.APP_FTLE,'yyyy-MM-dd') app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY a , RSBT_net b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H,rsbt_apply_pa app_pa
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type='PA'
and a.guid = app_pa.app_guid;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_EXP_H
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_EXP_H" AS 
select a.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
c.org_name as set_org_name,
c.org_addr AS set_org_addr,
c.org_link_person AS set_org_link_person,
c.org_phone AS set_org_phone,
c.org_mob_phone AS set_org_mob_phone,
c.org_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY_h a , RSBT_net_h b , rsbt_org_h c,rsbt_org_h d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG_h H
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type<>'PA'
union all
select a.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
app_pa.app_pa_name as set_org_name,
app_pa.app_pa_live_addr AS set_org_addr,
app_pa.app_pa_name AS set_org_link_person,
app_pa.app_pa_org_phone AS set_org_phone,
app_pa.app_pa_mobile AS set_org_mob_phone,
app_pa.app_pa_serv_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY_h a , RSBT_net_h b , rsbt_org_h c,rsbt_org_h d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG_h H,rsbt_apply_pa_h app_pa
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type='PA'
and a.guid = app_pa.app_guid;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_EXP_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_EXP_R" AS 
select a.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
c.org_name as set_org_name,
c.org_addr AS set_org_addr,
c.org_link_person AS set_org_link_person,
c.org_phone AS set_org_phone,
c.org_mob_phone AS set_org_mob_phone,
c.org_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY_r a , RSBT_net_r b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type<>'PA'
union all
select a.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
app_pa.app_pa_name as set_org_name,
app_pa.app_pa_live_addr AS set_org_addr,
app_pa.app_pa_name AS set_org_link_person,
app_pa.app_pa_org_phone AS set_org_phone,
app_pa.app_pa_mobile AS set_org_mob_phone,
app_pa.app_pa_serv_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY_r a , RSBT_net_r b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H,rsbt_apply_pa_r app_pa
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type='PA'
and a.guid = app_pa.app_guid;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_FILELIST_WF
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_FILELIST_WF" AS 
select t_rim_rsm_apply_wf."ACCEPT_ID",t_rim_rsm_apply_wf."GUID",t_rim_rsm_apply_wf."ORG_GUID",t_rim_rsm_apply_wf."NET_GUID",t_rim_rsm_apply_wf."ORG_MANAGER_GUID",t_rim_rsm_apply_wf."APP_CODE",t_rim_rsm_apply_wf."APP_TYPE",t_rim_rsm_apply_wf."APP_SUB_TYPE",t_rim_rsm_apply_wf."APP_OBJECT_TYPE",t_rim_rsm_apply_wf."APP_DATE",t_rim_rsm_apply_wf."APP_FTLB",t_rim_rsm_apply_wf."APP_FTLE",t_rim_rsm_apply_wf."MEMO",t_rim_rsm_apply_wf."NET_NAME",t_rim_rsm_apply_wf."ORG_NAME",t_rim_rsm_apply_wf."APP_STATE",t_rim_rsm_apply_wf."CREATOR",t_rim_rsm_apply_wf."CREATETIME",t_rim_rsm_applyfilelist_wf.filename,t_rim_rsm_applyfilelist_wf.stat_tdi,t_rim_rsm_apply_wf.app_code||t_rim_rsm_applyfilelist_wf.stat_tdi formcode,
substr(t_rim_rsm_applyfilelist_wf.filename,0,(length(t_rim_rsm_applyfilelist_wf.filename)-4)) as fileguid
from t_rim_rsm_apply_wf ,t_rim_rsm_applyfilelist_wf
where t_rim_rsm_apply_wf.guid=t_rim_rsm_applyfilelist_wf.accept_id(+);

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_NET_ORG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_NET_ORG" AS 
select substr(app_code,length(app_code)-11,4) as area_code,net.net_name,org.org_name,app."GUID",app."ORG_GUID",app."NET_GUID",app."ORG_MANAGER_GUID",app."APP_CODE",app."APP_TYPE",app."APP_SUB_TYPE",app."APP_OBJECT_TYPE",app."APP_DATE",app."APP_FTLB",app."APP_FTLE",app."MEMO" from rsbt_apply app,rsbt_org org,rsbt_net net
where app.org_guid=org.guid and app.net_guid=net.guid
and app_type='T';

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_NET_ORG_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_NET_ORG_R" AS 
select substr(app_code,length(app_code)-11,4) as area_code,net.net_name,org.org_name,app."GUID",app."ORG_GUID",app."NET_GUID",app."ORG_MANAGER_GUID",app."APP_CODE",app."APP_TYPE",app."APP_SUB_TYPE",app."APP_OBJECT_TYPE",app."APP_DATE",app."APP_FTLB",app."APP_FTLE",app."MEMO" from rsbt_apply_r app,rsbt_org org,rsbt_net_r net
where app.org_guid=org.guid and app.net_guid=net.guid
and app_type='T';

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_PA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_PA" AS 
select
  ----业余无线电台设置申请表
  A.GUID,A.APP_CODE,Substr(A.app_code,3,4)||'00' as Area_Code,
  Substr(A.app_code,7,4) as Year_Code, Substr(A.app_code,11,4) as Sequence_Number,
  B.APP_PA_NAME,Decode(B.APP_PA_GENDER,'0','男','女') as APP_PA_GENDER,B.APP_PA_BIRTHDAY,
  B.APP_PA_NATION,B.APP_PA_DEGREE,B.APP_PA_ID_CARD,B.APP_PA_SERV_ORG,B.APP_PA_SERV_POST,
  B.APP_PA_LIVE_ADDR,B.APP_PA_LIVE_POST,B.APP_PA_CONTACT_ADDR,B.APP_PA_CONTACT_POST,
  B.APP_PA_EMAIL,
  B.APP_PA_ORG_PHONE,B.APP_PA_HOME_PHONE,B.APP_PA_MOBILE,B.APP_PA_OTHER_INFO,B.App_Pa_Stat_Addr,B.App_Pa_Call_Sign,
  B.APP_PA_NAME as APP_PA_NAME_A,
  to_char(A.APP_Date,'yyyy-MM-dd') as APP_Date,
  B.MEMO,C.ORG_AREA_CODE,C.ORG_PERSON_ID,D.code_chi_name as app_type_name
 from RSBT_APPLY A,RSBT_APPLY_PA B,RSBT_ORG C,RSBT_CODE_DIC D,RSBT_ORG org
where A.GUID=B.APP_GUID and A.APP_TYPE='PA'AND A.ORG_MANAGER_GUID=C.GUID(+) AND C.ORG_TYPE='000'
AND (a.app_type = D.cn (+) and D.code_data_type(+) = '00522006') and org.guid(+)=a.org_guid;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_PA_PRINT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_PA_PRINT" AS 
select
  ----业余无线电台设置申请表----报表
  A.GUID,A.APP_CODE,
  Substr(A.app_code,3,4) as Area_Code,
  Substr(A.app_code,7,4) as Year_Code, Substr(A.app_code,11,4) as Sequence_Number,
  B.APP_PA_NAME,Decode(B.APP_PA_GENDER,'0','男','女') as APP_PA_GENDER,B.APP_PA_BIRTHDAY,
  B.APP_PA_NATION,B.APP_PA_DEGREE,B.APP_PA_ID_CARD,B.APP_PA_SERV_ORG,B.APP_PA_SERV_POST,
  B.APP_PA_LIVE_ADDR,B.APP_PA_LIVE_POST,B.APP_PA_CONTACT_ADDR,B.APP_PA_CONTACT_POST,
  B.APP_PA_EMAIL,
  B.APP_PA_ORG_PHONE,B.APP_PA_HOME_PHONE,B.APP_PA_MOBILE,B.APP_PA_OTHER_INFO,
  B.APP_PA_NAME as APP_PA_NAME_A,A.APP_Date,B.MEMO
 from RSBT_APPLY A,RSBT_APPLY_PA B
where A.GUID=B.APP_GUID and A.APP_TYPE='PA';

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_PA_PRINT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_PA_PRINT_R" AS 
select
  ----业余无线电台设置申请表----报表
  A.GUID,A.APP_CODE,
  Substr(A.app_code,3,4) as Area_Code,
  Substr(A.app_code,7,4) as Year_Code, Substr(A.app_code,11,4) as Sequence_Number,
  B.APP_PA_NAME,Decode(B.APP_PA_GENDER,'0','男','女') as APP_PA_GENDER,B.APP_PA_BIRTHDAY,
  B.APP_PA_NATION,B.APP_PA_DEGREE,B.APP_PA_ID_CARD,B.APP_PA_SERV_ORG,B.APP_PA_SERV_POST,
  B.APP_PA_LIVE_ADDR,B.APP_PA_LIVE_POST,B.APP_PA_CONTACT_ADDR,B.APP_PA_CONTACT_POST,
  B.APP_PA_EMAIL,
  B.APP_PA_ORG_PHONE,B.APP_PA_HOME_PHONE,B.APP_PA_MOBILE,B.APP_PA_OTHER_INFO,
  B.APP_PA_NAME as APP_PA_NAME_A,A.APP_Date,B.MEMO
 from RSBT_APPLY_r A,RSBT_APPLY_PA_r B
where A.GUID=B.APP_GUID and A.APP_TYPE='PA';

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_PA_PRINT1
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_PA_PRINT1" AS 
select
  ----业余无线电台设置申请表----报表
  ----业余无线电台设置申请表社团/人员表
  A.GUID,C.APP_CLUBS_NAME,C.APP_CLUBS_SUP_ORG,C.APP_CLUBS_MEMBER_CODE
    from RSBT_APPLY A,RSBT_APPLY_PA B,RSBT_APPCLUBS C
   where A.GUID=B.APP_GUID and B.GUID=C.APP_GUID;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_PA_PRINT1_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_PA_PRINT1_R" AS 
select
  ----业余无线电台设置申请表----报表
  ----业余无线电台设置申请表社团/人员表
  A.GUID,C.APP_CLUBS_NAME,C.APP_CLUBS_SUP_ORG,C.APP_CLUBS_MEMBER_CODE
    from RSBT_APPLY_r A,RSBT_APPLY_PA_r B,RSBT_APPCLUBS_r C
   where A.GUID=B.APP_GUID and B.GUID=C.APP_GUID;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_PA_PRINT2
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_PA_PRINT2" AS 
select
  ----业余无线电台设置申请表----报表
  ----设台情况
  A.GUID,
  Decode(a.app_sub_type,'0','新设','1','变更','2','撤消','3','封存','4','启封') as App_SubType,
  Decode(B.APP_PA_STAT_TYPE,'FB','基地台','LC','车载台','LS','手持台','JT','其它') as PA_STAT_TYPE,
  Decode(B.APP_PA_ENTITY_TYPE,'0','集体','个人') as PA_ENTITY_TYPE,
  B.APP_PA_STAT_ADDR,B.APP_PA_OPE_Degree,B.APP_PA_OPE_Code,B.APP_PA_Call_Sign
  from RSBT_APPLY A,RSBT_APPLY_PA B
where A.GUID=B.APP_GUID;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_PA_PRINT2_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_PA_PRINT2_R" AS 
select
  ----业余无线电台设置申请表----报表
  ----设台情况
  A.GUID,
  Decode(a.app_sub_type,'0','新设','1','变更','2','撤消','3','封存','4','启封') as App_SubType,
  Decode(B.APP_PA_STAT_TYPE,'FB','基地台','LC','车载台','LS','手持台','JT','其它') as PA_STAT_TYPE,
  Decode(B.APP_PA_ENTITY_TYPE,'0','集体','个人') as PA_ENTITY_TYPE,
  B.APP_PA_STAT_ADDR,B.APP_PA_OPE_Degree,B.APP_PA_OPE_Code,B.APP_PA_Call_Sign
  from RSBT_APPLY_r A,RSBT_APPLY_PA_r B
where A.GUID=B.APP_GUID;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_PA_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_PA_R" AS 
select
  ----业余无线电台设置申请表
  A.GUID,A.APP_CODE,
  decode(org.org_area_code,'999999', Substr(A.app_code,3,4)||'00',org.org_area_code) as Area_Code,
  Substr(A.app_code,7,4) as Year_Code, Substr(A.app_code,11,4) as Sequence_Number,
  B.APP_PA_NAME,Decode(B.APP_PA_GENDER,'0','男','女') as APP_PA_GENDER,B.APP_PA_BIRTHDAY,
  B.APP_PA_NATION,B.APP_PA_DEGREE,B.APP_PA_ID_CARD,B.APP_PA_SERV_ORG,B.APP_PA_SERV_POST,
  B.APP_PA_LIVE_ADDR,B.APP_PA_LIVE_POST,B.APP_PA_CONTACT_ADDR,B.APP_PA_CONTACT_POST,
  B.APP_PA_EMAIL,
  B.APP_PA_ORG_PHONE,B.APP_PA_HOME_PHONE,B.APP_PA_MOBILE,B.APP_PA_OTHER_INFO,B.App_Pa_Stat_Addr,B.App_Pa_Call_Sign,
  B.APP_PA_NAME as APP_PA_NAME_A,
  to_char(A.APP_Date,'yyyy-MM-dd') as APP_Date,
  B.MEMO,C.ORG_AREA_CODE,C.ORG_PERSON_ID,D.code_chi_name as app_type_name,
decode(impback.imp_back_type,2,'二类',DECODE(impback.imp_back_type,3,'三类','')) AS imp_back_type
 from RSBT_APPLY_r A,RSBT_APPLY_PA_r B,RSBT_ORG C,RSBT_CODE_DIC D,T_RIM_RSM_RSBT_IMBACKTYPE_LOG impback,RSBT_ORG org
where A.GUID=B.APP_GUID and A.APP_TYPE='PA'AND A.ORG_MANAGER_GUID=C.GUID(+) AND C.ORG_TYPE='000'
AND (a.app_type = D.cn (+) and D.code_data_type(+) = '00522006')
AND a.guid=impback.form_guid(+) and org.guid(+)=a.org_guid;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_PRINT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_PRINT" AS 
select a."GUID",a."ORG_GUID",a."NET_GUID",a."ORG_MANAGER_GUID",a."APP_CODE",a."APP_TYPE",a."APP_SUB_TYPE",a."APP_OBJECT_TYPE",a."APP_DATE",a."APP_FTLB",a."APP_FTLE",a."MEMO" ,substr(a.app_code,-12,12) app_codeDes,b.net_name,decode(app_type,'PA',app_pa_name, c.org_name) org_name,d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
app_pa_name,APP_PA_ID_Card,APP_PA_SERV_ORG,APP_PA_SERV_POST,APP_PA_Live_ADDR,APP_PA_Live_POST,
APP_PA_Contact_ADDR,APP_PA_Contact_Post,APP_PA_Email,APP_PA_ORG_Phone,APP_PA_Home_Phone,
APP_PA_Mobile,APP_PA_Other_INFO,APP_PA_OPE_Code,APP_PA_Call_Sign,APP_PA_STAT_ADDR,
decode(app_type,'PA',to_date(null),a.app_ftlb) app_ftlb_v,
decode(app_type,'PA',to_date(null),a.app_ftle) app_ftle_v
from RSBT_APPLY a , RSBT_net b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g
,RSBT_APPLY_PA pa
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+)
and a.guid = pa.app_guid(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006');

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_PRINT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_PRINT_R" AS 
select a."GUID",a."ORG_GUID",a."NET_GUID",a."ORG_MANAGER_GUID",a."APP_CODE",a."APP_TYPE",a."APP_SUB_TYPE",a."APP_OBJECT_TYPE",a."APP_DATE",a."APP_FTLB",a."APP_FTLE",a."MEMO" ,substr(a.app_code,-12,12) app_codeDes,b.net_name,decode(app_type,'PA',app_pa_name, c.org_name) org_name,d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
app_pa_name,APP_PA_ID_Card,APP_PA_SERV_ORG,APP_PA_SERV_POST,APP_PA_Live_ADDR,APP_PA_Live_POST,
APP_PA_Contact_ADDR,APP_PA_Contact_Post,APP_PA_Email,APP_PA_ORG_Phone,APP_PA_Home_Phone,
APP_PA_Mobile,APP_PA_Other_INFO,APP_PA_OPE_Code,APP_PA_Call_Sign,APP_PA_STAT_ADDR,
decode(app_type,'PA',to_date(null),a.app_ftlb) app_ftlb_v,
decode(app_type,'PA',to_date(null),a.app_ftle) app_ftle_v
from RSBT_APPLY_r a , RSBT_net_r b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g
,RSBT_APPLY_PA_r pa
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+)
and a.guid = pa.app_guid(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006');

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_R" AS 
select a.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,
a.APP_OBJECT_TYPE,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
c.org_name as set_org_name,
c.org_addr AS set_org_addr,
c.org_link_person AS set_org_link_person,
c.org_phone AS set_org_phone,
c.org_mob_phone AS set_org_mob_phone,
c.org_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT,
decode(impback.imp_back_type,2,'二类',DECODE(impback.imp_back_type,3,'三类','')) AS imp_back_type
from RSBT_APPLY_r a , RSBT_net_r b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H,T_RIM_RSM_RSBT_IMBACKTYPE_LOG impback
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006')
AND a.guid=impback.form_guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_STATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_STATION" AS 
select a.guid,a.org_guid, a.app_code,a.app_date,a.app_type, a.app_sub_type,
a.app_object_type ,
t.STAT_APP_Type, T.STAT_APP_Type || stat_tdi as tech_ID, t.guid stat_guid,t.stat_name,t.stat_addr,
decode(app_type,'PA',f_rim_rsm_getpanamebyappcode(a.app_code), c.org_name) org_name,t.net_guid,d.net_name,
t.STAT_Area_Code org_area_code,
t.stat_status,substr(a.app_code,-12,12) app_codeDes ,c.code_chi_name stat_status_v
,f.code_chi_name  app_sub_type_name
,g.code_chi_name  app_object_type_name
,e.code_chi_name app_type_name
from rsbt_station t,rsbt_apply a
, RSBT_CODE_DIC c,rsbt_net d,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g, rsbt_org c
where t.app_code = a.app_code
      and a.app_type<>'F'
      and t.net_guid=d.guid
      and a.org_guid=c.guid(+)
      and (t.stat_status = c.cn (+) and c.code_data_type(+) = '00072006')
      and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
      and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
      and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006')
union all
select a.guid,a.org_guid, a.app_code,a.app_date,a.app_type, a.app_sub_type,
a.app_object_type ,
t.STAT_APP_Type, T.STAT_APP_Type || stat_tdi as tech_ID, t.guid stat_guid,t.stat_name,t.stat_addr,
decode(app_type,'PA',F_rim_rsm_GetPaNameByAppCode_H(a.app_code), c.org_name) org_name,
t.net_guid,d.net_name,
d.org_code org_area_code,
t.stat_status,substr(a.app_code,-12,12) app_codeDes ,c.code_chi_name stat_status_v
,f.code_chi_name  app_sub_type_name
,g.code_chi_name  app_object_type_name
,e.code_chi_name app_type_name
from rsbt_station_h t,rsbt_apply_h a
, RSBT_CODE_DIC c,rsbt_net_h d,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g, Rsbt_Org_h c
where t.app_code = a.app_code
      and a.app_type<>'F'
      and t.net_guid=d.guid
      and a.org_guid=c.guid(+)
      and (t.stat_status = c.cn (+) and c.code_data_type(+) = '00072006')
      and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
      and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
      and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006');

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_STATION_EXP
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_STATION_EXP" AS 
select stat.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,stat.stat_name stat_name,stat.stat_addr stat_addr,stat.stat_app_type stat_app_type,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,stat.stat_app_type || stat.stat_tdi as techCode,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
c.org_name as set_org_name,
c.org_addr AS set_org_addr,
c.org_link_person AS set_org_link_person,
c.org_phone AS set_org_phone,
c.org_mob_phone AS set_org_mob_phone,
c.org_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY a , RSBT_net b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H,rsbt_station stat
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type<>'PA'
and a.app_code=stat.app_code(+)
union all
select stat.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,stat.stat_name stat_name,stat.stat_addr stat_addr,stat.stat_app_type stat_app_type,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,stat.stat_app_type || stat.stat_tdi as techCode,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
app_pa.app_pa_name as set_org_name,
app_pa.app_pa_live_addr AS set_org_addr,
app_pa.app_pa_name AS set_org_link_person,
app_pa.app_pa_org_phone AS set_org_phone,
app_pa.app_pa_mobile AS set_org_mob_phone,
app_pa.app_pa_serv_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY a , RSBT_net b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H,rsbt_apply_pa app_pa,rsbt_station stat
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type='PA'
and a.app_code=stat.app_code(+) and app_pa.app_guid=a.guid;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_STATION_EXP_H
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_STATION_EXP_H" AS 
select stat.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,stat.stat_name stat_name,stat.stat_addr stat_addr,stat.stat_app_type stat_app_type,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,stat.stat_app_type || stat.stat_tdi as techCode,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
c.org_name as set_org_name,
c.org_addr AS set_org_addr,
c.org_link_person AS set_org_link_person,
c.org_phone AS set_org_phone,
c.org_mob_phone AS set_org_mob_phone,
c.org_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY a , RSBT_net b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H,rsbt_station_h stat
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type<>'PA'
and stat.app_code=a.app_code(+)
union all
select stat.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,stat.stat_name stat_name,stat.stat_addr stat_addr,stat.stat_app_type stat_app_type,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,stat.stat_app_type || stat.stat_tdi as techCode,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
app_pa.app_pa_name as set_org_name,
app_pa.app_pa_live_addr AS set_org_addr,
app_pa.app_pa_name AS set_org_link_person,
app_pa.app_pa_org_phone AS set_org_phone,
app_pa.app_pa_mobile AS set_org_mob_phone,
app_pa.app_pa_serv_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY a , RSBT_net b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H,rsbt_apply_pa app_pa,rsbt_station_h stat
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type='PA'
and stat.app_code=a.app_code(+) and app_pa.app_guid=a.guid;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_STATION_EXP_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_STATION_EXP_R" AS 
select stat.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,stat.stat_name stat_name,stat.stat_addr stat_addr,stat.stat_app_type stat_app_type,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,stat.stat_app_type || stat.stat_tdi as techCode,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
c.org_name as set_org_name,
c.org_addr AS set_org_addr,
c.org_link_person AS set_org_link_person,
c.org_phone AS set_org_phone,
c.org_mob_phone AS set_org_mob_phone,
c.org_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY_r a , RSBT_net_r b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H,rsbt_station_r stat
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type<>'PA'
and a.app_code=stat.app_code(+)
union all
select stat.GUID,a.ORG_GUID ,a.NET_GUID,a.ORG_MANAGER_GUID,a.APP_CODE,a.APP_TYPE,a.APP_SUB_TYPE,stat.stat_name stat_name,stat.stat_addr stat_addr,stat.stat_app_type stat_app_type,
b.net_svn,b.net_ts,
a.APP_OBJECT_TYPE,stat.stat_app_type || stat.stat_tdi as techCode,
  to_char(a.APP_DATE,'yyyy-MM-dd')  APP_DATE,
   to_char(a.APP_FTLB,'yyyy-MM-dd') APP_FTLB,
  to_char(a.APP_FTLE,'yyyy-MM-dd') APP_FTLE,
   a.MEMO,
   substr(a.app_code,-12,12) app_codeDes,b.net_name,
app_pa.app_pa_name as set_org_name,
app_pa.app_pa_live_addr AS set_org_addr,
app_pa.app_pa_name AS set_org_link_person,
app_pa.app_pa_org_phone AS set_org_phone,
app_pa.app_pa_mobile AS set_org_mob_phone,
app_pa.app_pa_serv_post AS set_org_post,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(substr(a.app_code,-12,12),1,1),'9','000000',substr(substr(a.app_code,-12,12),1,4)||'00'),d.org_area_code) org_area_code,
e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
a.app_ftlb app_ftlb_v,a.app_ftle app_ftle_v,
H.org_name as FEE_org_name,
H.org_addr AS FEE_org_addr,
H.org_link_person AS FEE_org_link_person,
H.org_phone AS FEE_org_phone,
H.org_mob_phone AS FEE_org_mob_phone,
H.org_post AS FEE_org_post,
H.ORG_BANK,
H.ORG_ACCOUNT_NAME,
H.ORG_ACCOUNT
from RSBT_APPLY_r a , RSBT_net_r b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,RSBT_ORG H,rsbt_apply_pa_r app_pa,rsbt_station_r stat
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+) AND B.FEE_GUID=H.GUID(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006') and a.app_type='PA'
and a.app_code=stat.app_code(+) and app_pa.app_guid=a.guid;

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_STATION_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_STATION_R" AS 
select a.guid,a.org_guid, a.app_code,a.app_date,a.app_type, a.app_sub_type,
a.app_object_type ,
t.STAT_APP_Type, T.STAT_APP_Type || stat_tdi as tech_ID, t.guid stat_guid,t.stat_name,t.stat_addr,
decode(app_type,'PA',f_rim_rsm_getpanamebyappcode(a.app_code), c.org_name) org_name,t.net_guid,d.net_name,
t.STAT_Area_Code org_area_code,
t.stat_status,substr(a.app_code,-12,12) app_codeDes ,c.code_chi_name stat_status_v
,f.code_chi_name  app_sub_type_name
,g.code_chi_name  app_object_type_name
,e.code_chi_name app_type_name
from rsbt_station_r t,rsbt_apply_r a
, RSBT_CODE_DIC c,rsbt_net_r d,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g, rsbt_org c
where t.app_code = a.app_code
      and a.app_type<>'F'
      and t.net_guid=d.guid
      and a.org_guid=c.guid(+)
      and (t.stat_status = c.cn (+) and c.code_data_type(+) = '00072006')
      and (a.app_type = e.cn (+) and e.code_data_type(+) = '00522006')
      and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
      and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '00532006');

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_WF
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_WF" AS 
select fileList.Filename,fileList.Stat_Tdi, a."ACCEPT_ID",a."GUID",a."ORG_GUID",a."NET_GUID",a."ORG_MANAGER_GUID",a."APP_CODE",a."APP_TYPE",a."APP_SUB_TYPE",a."APP_OBJECT_TYPE",a."APP_DATE",a."APP_FTLB",a."APP_FTLE",a."MEMO",a."NET_NAME",a."ORG_NAME",a."APP_STATE",a."CREATOR",a."CREATETIME" ,a.app_code app_codeDes,
d.org_name org_manager_name,
decode(d.org_area_code,null,decode(substr(a.app_code,1,1),'9','000000',substr(a.app_code,1,4)||'00'),d.org_area_code) org_area_code,e.code_chi_name as app_type_name,
f.code_chi_name app_sub_type_name ,g.code_chi_name app_object_type_name,
app_pa_name,APP_PA_ID_Card,APP_PA_SERV_ORG,APP_PA_SERV_POST,APP_PA_Live_ADDR,APP_PA_Live_POST,
APP_PA_Contact_ADDR,APP_PA_Contact_Post,APP_PA_Email,APP_PA_ORG_Phone,APP_PA_Home_Phone,
APP_PA_Mobile,APP_PA_Other_INFO,APP_PA_OPE_Code,APP_PA_Call_Sign,APP_PA_STAT_ADDR,
F_Ifnull(H.DATAKEY) AS DATAKEY,
Decode(A.GUID,H.Datakey,'已提交','未提交') as AcceptName
   from T_RIM_RSM_APPLY_wf a , rsbt_net b , rsbt_org c,rsbt_org d ,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g
,T_RIM_RSM_APPLY_PA_wf pa,WF_RT_CASE H,t_rim_rsm_applyfilelist_wf fileList --增加文件列表
where a.net_guid = b.guid(+) and a.org_guid=c.guid(+) and a.org_manager_guid = d.guid(+)
and a.guid = pa.app_guid(+)
and (a.app_type = e.cn (+) and e.code_data_type(+) = '01242006')
and (a.app_sub_type = f.cn (+) and f.code_data_type(+) = '00102006')
and (a.app_object_type = g.cn (+) and g.code_data_type(+) = '01252006')
AND A.guid=H.DATAKEY(+)
and a.guid = fileList.Accept_Id(+);

-- ----------------------------
-- View structure for V_RIM_RSM_APPLY_WF_AA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_APPLY_WF_AA" AS 
select a."FILENAME",a."STAT_TDI",a."ACCEPT_ID",a."GUID",a."ORG_GUID",a."NET_GUID",a."ORG_MANAGER_GUID",a."APP_CODE",a."APP_TYPE",a."APP_SUB_TYPE",a."APP_OBJECT_TYPE",a."APP_DATE",a."APP_FTLB",a."APP_FTLE",a."MEMO",a."NET_NAME",a."ORG_NAME",a."APP_STATE",a."CREATOR",a."CREATETIME",a."APP_CODEDES",a."ORG_MANAGER_NAME",a."ORG_AREA_CODE",a."APP_TYPE_NAME",a."APP_SUB_TYPE_NAME",a."APP_OBJECT_TYPE_NAME",a."APP_PA_NAME",a."APP_PA_ID_CARD",a."APP_PA_SERV_ORG",a."APP_PA_SERV_POST",a."APP_PA_LIVE_ADDR",a."APP_PA_LIVE_POST",a."APP_PA_CONTACT_ADDR",a."APP_PA_CONTACT_POST",a."APP_PA_EMAIL",a."APP_PA_ORG_PHONE",a."APP_PA_HOME_PHONE",a."APP_PA_MOBILE",a."APP_PA_OTHER_INFO",a."APP_PA_OPE_CODE",a."APP_PA_CALL_SIGN",a."APP_PA_STAT_ADDR",a."DATAKEY",a."ACCEPTNAME"
   from v_rim_rsm_apply_wf a
where A.GUID<>A.DATAKEY and a.stat_tdi is null;

-- ----------------------------
-- View structure for V_RIM_RSM_AREA_USER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_AREA_USER" AS 
SELECT guid,org_name,org_area_code,org_code,F_RIM_RSM_GetUserListByArea(guid) user_list,F_RIM_RSM_GetUserListByArea(guid,1) user_list_name,'' user_list_v
FROM rsbt_org
WHERE org_type='000';

-- ----------------------------
-- View structure for V_RIM_RSM_AUDITLICE_INQUI
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_AUDITLICE_INQUI" AS 
select apply.guid app_guid ,c.guid station_guid,a.guid, a.app_code,A.STAT_APP_TYPE||A.STAT_TDI STAT_TDI,A.LICENSE_CODE,A.LICENSE_TYPE,A.LICENSE_ORG_NAME,decode(A.LICENSE_TYPE,'1','A类执照','0','B类执照') LICENSE_TYPE_NAME,
A.LICENSE_DATE_B,A.LICENSE_DATE_E,A.LICENSE_DATE, b.audit_year ,decode(b.audit_pass,'0','不合格','1','合格','未年审') audit_pass,
b.audit_result,decode(substr(a.app_code,1,1),'P',substr(a.app_code,3,4),substr(a.app_code,2,4))||'00' area_code,s.org_name,s.guid org_guid,f.org_name fee_name,f.guid fee_guid
from rsbt_license a,t_Rim_Rsm_Lice_Audit b,rsbt_station c,rsbt_net n,rsbt_org f,rsbt_org s,rsbt_apply apply
where a.guid=b.License_Guid(+) and a.station_guid=c.guid(+) and c.net_guid=n.guid(+) and n.fee_guid=f.guid(+) and n.org_guid=s.guid(+)
and a.app_code=apply.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_AS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_AS" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
  from rsbt_station a,rsbt_code_dic c
    where  STAT_APP_Type='A'and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T'
      and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_AS_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_AS_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_deptitem_detail a,rsbt_org c
    where a.dept_pay=c.guid(+) and (item_code='710000' or item_code='720000' or item_code='730000' or item_code='740000')
  union all
    select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_applyitem_detail a,rsbt_org c
    where a.dept_pay=c.guid(+) and (item_code='710000' or item_code='720000' or item_code='730000' or item_code='740000');

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_AS_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_AS_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
  from rsbt_station_r a,rsbt_code_dic c
    where  STAT_APP_Type='A' and substr(app_code,1,length(app_code)-12)='T'
      and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_BC
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_BC" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
  from rsbt_station a,rsbt_station_t b,rsbt_code_dic c
  where STAT_APP_Type='B' AND substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
    AND nvl(ST_B_TYPE1,'0')='0' and nvl(ST_B_IC,'0')='0' and a.guid=b.guid
    and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_BC_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_BC_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
    from (
    select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay
        from v_rim_rsm_pay_deptitem_detail
  where item_code='560000' or item_code='570000' or item_code='580000' or item_code='590000'
    union all
    select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay
        from v_rim_rsm_pay_applyitem_detail
  where item_code='560000' or item_code='570000' or item_code='580000' or item_code='590000'
      ) a,rsbt_org b
    where a.dept_pay=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_BC_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_BC_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
  from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c
  where STAT_APP_Type='B' AND substr(app_code,1,length(app_code)-12)='T'
    AND nvl(ST_B_TYPE1,'0')='0' and nvl(ST_B_IC,'0')='0' and a.guid=b.guid
    and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_BD
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_BD" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
  from rsbt_station a,rsbt_station_t b,rsbt_code_dic c
  where STAT_APP_Type='B' AND substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
    AND nvl(ST_B_TYPE1,'2')='0' and nvl(ST_B_IC,'0')='0' and a.guid=b.guid
    and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_BD_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_BD_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
  from rsbt_station a,rsbt_station_t b,rsbt_code_dic c
  where STAT_APP_Type='B' AND substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
    AND nvl(ST_B_TYPE1,'2')='0' and nvl(ST_B_IC,'0')='0' and a.guid=b.guid
    and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_BT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_BT" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
  from rsbt_station a,rsbt_station_t b,rsbt_code_dic c
    where STAT_APP_Type='B' AND substr(app_code,1,length(app_code)-12)='T'and STAT_Status='1'
      AND ST_B_TYPE1='1'  and nvl(ST_B_IC,'0')='0' and a.guid=b.guid
      and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_BT_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_BT_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
    from (
    select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay
        from v_rim_rsm_pay_deptitem_detail
  where item_code='510000' or item_code='520000' or item_code='530000' or item_code='540000'
    union all
    select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay
        from v_rim_rsm_pay_applyitem_detail
  where item_code='510000' or item_code='520000' or item_code='530000' or item_code='540000'
    ) a,rsbt_org b
    where a.dept_pay=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_BT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_BT_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
  from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c
    where STAT_APP_Type='B' AND substr(app_code,1,length(app_code)-12)='T'
      AND ST_B_TYPE1='1'  and nvl(ST_B_IC,'0')='0' and a.guid=b.guid
      and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_BW
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_BW" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
  from rsbt_station a,rsbt_station_t b,rsbt_code_dic c
    where STAT_APP_Type='B' AND ST_B_IC='1' and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
      and a.guid=b.guid and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_BW_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_BW_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
  from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c
    where STAT_APP_Type='B' AND ST_B_IC='1' and substr(app_code,1,length(app_code)-12)='T'
      and a.guid=b.guid and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_CDMA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_CDMA" AS 
select  a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station a,rsbt_net c,rsbt_code_dic b
    where a.net_guid=c.guid
      and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
      AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
      --and c.net_ts='LY0102' --CDMA??
      and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
      and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
      and ((FREQ_TYPE='0' and (FREQ_UC>=870 and FREQ_UC<=880) or (FREQ_UC>=2110 and FREQ_UC<=2125))
                or (FREQ_TYPE='1' and (FREQ_EFE>=870 and FREQ_EFB<=880) or (FREQ_EFE>=2110 and FREQ_EFB<=2125))) );

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_CDMA_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_CDMA_P" AS 
select item_no,apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_deptitem_detail a,rsbt_org f,
        (select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station c,rsbt_net d,rsbt_freq e
        where substr(app_code,1,length(app_code)-12)='T' and e.station_guid=c.guid and c.net_guid=d.guid
     AND ((STAT_APP_Type='C' AND ((FREQ_TYPE='0' AND ((FREQ_UC>=870 AND FREQ_UC<=880 ) OR (FREQ_UC>=2110 AND FREQ_UC<=2125 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFB>=870 AND FREQ_EFE<=880 ) OR (FREQ_EFB>=2110 AND FREQ_EFE<=2125 ))))) or (STAT_APP_Type='D' AND NET_ts='LY0102'))) b
    where  a.dept_pay=f.guid(+) and  a.apply_code=b.app_code and a.decl_code =b.decl_code
union all
    select item_no,apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
        from v_rim_rsm_pay_applyitem_detail a,rsbt_org f,
        (select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station c,rsbt_net d,rsbt_freq e
        where substr(app_code,1,length(app_code)-12)='T' and e.station_guid=c.guid and c.net_guid=d.guid
     AND ((STAT_APP_Type='C' AND ((FREQ_TYPE='0' AND ((FREQ_UC>=870 AND FREQ_UC<=880 ) OR (FREQ_UC>=2110 AND FREQ_UC<=2125 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFB>=870 AND FREQ_EFE<=880 ) OR (FREQ_EFB>=2110 AND FREQ_EFE<=2125 ))))) or (STAT_APP_Type='D' AND NET_ts='LY0102'))) b
    where  a.dept_pay=f.guid(+) and  a.apply_code=b.app_code and a.decl_code=b.decl_code;

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_CDMA_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_CDMA_R" AS 
select  a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station_r a,rsbt_net_r c,rsbt_code_dic b
    where a.net_guid=c.guid
      and substr(app_code,1,length(app_code)-12)='T'
      AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
      --and c.net_ts='LY0102' --CDMA??
      and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
      and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
      and ((FREQ_TYPE='0' and (FREQ_UC>=870 and FREQ_UC<=880) or (FREQ_UC>=2110 and FREQ_UC<=2125))
                or (FREQ_TYPE='1' and (FREQ_EFE>=870 and FREQ_EFB<=880) or (FREQ_EFE>=2110 and FREQ_EFB<=2125))) );

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_GD
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_GD" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station a,rsbt_code_dic b,rsbt_net c
    where a.net_guid=c.guid AND  ((STAT_APP_Type='TF' and nvl(stat_type,'null')='TS'))
        -- and  (NET_SVN='GD02' OR NET_SVN='GD03' OR NET_ts='GD0420' or NET_ts='GD0421' or NET_ts='GD0422')
         and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
         and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_GD_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_GD_P" AS 
select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org f,
			(select app_code,stat_app_type||stat_tdi decl_code from RSBT_STATION a,RSBT_NET c
       where a.net_guid=c.guid  AND (STAT_APP_Type='TF' and nvl(stat_type,' ')='TS') and substr(app_code,1,length(app_code)-12)='T') b
		where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=f.guid(+)
			and (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120200' or item_code='120300' or item_code='130100' or item_code='130200')
  union all
    select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_applyitem_detail a,rsbt_org f,
      (select app_code,stat_app_type||stat_tdi decl_code from RSBT_STATION a,RSBT_NET c
       where a.net_guid=c.guid  AND (STAT_APP_Type='TF' and nvl(stat_type,' ')='TS') and substr(app_code,1,length(app_code)-12)='T') b
    where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=f.guid(+)
      and (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120200' or item_code='120300' or item_code='130100' or item_code='130200');

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_GD_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_GD_R" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station_r a,rsbt_code_dic b,rsbt_net_r c
    where a.net_guid=c.guid AND  ((STAT_APP_Type='TF' and nvl(stat_type,'null')='TS'))
        -- and  (NET_SVN='GD02' OR NET_SVN='GD03' OR NET_ts='GD0420' or NET_ts='GD0421' or NET_ts='GD0422')
         and substr(app_code,1,length(app_code)-12)='T'
         and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_GSM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_GSM" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station a,rsbt_net c,rsbt_code_dic b
    where substr(app_code,1,length(app_code)-12)='T'
      and a.net_guid=c.guid and STAT_Status='1'
      AND a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
      AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
      --and c.net_ts='LY0101' --GSM/GPRS ??
      and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
      and ((FREQ_TYPE='0' and (FREQ_UC>=935 and FREQ_UC<=960) or (FREQ_UC>=1805 and FREQ_UC<=1850))
                or (FREQ_TYPE='1' and (FREQ_EFE>=935 and FREQ_EFB<=960) or (FREQ_EFE>=1805 and FREQ_EFB<=1850))) );

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_GSM_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_GSM_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org f
		where a.dept_pay=f.guid(+) and (item_code='110000' or item_code='120000')
  union all
    select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_applyitem_detail a,rsbt_org f
    where a.dept_pay=f.guid(+) and (item_code='110000' or item_code='120000');

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_GSM_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_GSM_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station_r a,rsbt_net_r c,rsbt_code_dic b
    where substr(app_code,1,length(app_code)-12)='T'
      and a.net_guid=c.guid
      AND a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
      AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
      --and c.net_ts='LY0101' --GSM/GPRS ??
      and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
      and ((FREQ_TYPE='0' and (FREQ_UC>=935 and FREQ_UC<=960) or (FREQ_UC>=1805 and FREQ_UC<=1850))
                or (FREQ_TYPE='1' and (FREQ_EFE>=935 and FREQ_EFB<=960) or (FREQ_EFE>=1805 and FREQ_EFB<=1850))) );

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_GX
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_GX" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station a,rsbt_code_dic b,rsbt_net c
    where   a.net_guid=c.guid  AND STAT_APP_Type='TF' and  nvl(stat_type,'null')='CS'
       and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
       and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_GX_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_GX_P" AS 
select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org f,
			(select app_code,stat_app_type||stat_tdi decl_code from RSBT_STATION a,RSBT_NET c
				where a.net_guid=c.guid  AND (STAT_APP_Type='TF'  and nvl(stat_type,'null')='CS') and substr(app_code,1,length(app_code)-12)='T') b
		where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=f.guid(+)
			and (item_code='910000' or item_code='920000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200')
	union all
		select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_applyitem_detail a,rsbt_org f,
      (select app_code,stat_app_type||stat_tdi decl_code from RSBT_STATION a,RSBT_NET c
				where a.net_guid=c.guid  AND (STAT_APP_Type='TF'  and nvl(stat_type,'null')='CS') and substr(app_code,1,length(app_code)-12)='T') b
    where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=f.guid(+)
      and (item_code='910000' or item_code='920000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200');

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_GX_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_GX_R" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station_r a,rsbt_code_dic b,rsbt_net_r c
    where   a.net_guid=c.guid  AND STAT_APP_Type='TF' and  nvl(stat_type,'null')='CS'
       and substr(app_code,1,length(app_code)-12)='T'
       and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_HA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_HA" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
			b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
		from rsbt_station a,rsbt_antfeed c,rsbt_code_dic b
		where a.guid=c.station_guid  AND STAT_APP_Type='E'
			 and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
			 and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5
       and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_HA_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_HA_P" AS 
select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org f,
			(select app_code,stat_app_type||stat_tdi decl_code from RSBT_STATION a,rsbt_antfeed c
        where a.guid=c.station_guid AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5) b
		where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=f.guid(+) and item_code='100100'
	union all
		select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_applyitem_detail a,rsbt_org f,
			(select app_code,stat_app_type||stat_tdi decl_code from RSBT_STATION a,rsbt_antfeed c
        where a.guid=c.station_guid AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5) b
		where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=f.guid(+) and item_code='100100';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_HA_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_HA_R" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
			b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
		from rsbt_station_r a,rsbt_antfeed_r c,rsbt_code_dic b
		where a.guid=c.station_guid  AND STAT_APP_Type='E'
			 and substr(app_code,1,length(app_code)-12)='T'
			 and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5
       and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_HF
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_HF" AS 
select c.NET_SVN, a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
  b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
from rsbt_station a,rsbt_code_dic b,rsbt_net c
where  a.net_guid=c.guid and STAT_APP_Type='V' and STAT_Status='1' and a.stat_type<>'RA' AND a.stat_type<>'AT'  and substr(app_code,1,length(app_code)-12)='T'
   -- and  nvl(NET_SVN,' ')<>'GD04' and nvl(NET_SVN,' ')<>'LY05' and nvl(NET_SVN,' ')<>'LY06' and nvl(NET_SVN,' ')<>'WA'
        and exists (select station_guid from rsbt_freq f where a.guid=f.station_guid and decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC)>30 )
         and a.stat_type=b.cn(+) and nvl(c.NET_SVN,'null')<>'LY06' and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_HF_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_HF_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org f
		where a.dept_pay=f.guid(+) and item_code='810000'
          and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,'MHz',to_number(translate(freq_note,'KMGHz',' '))) >30
   	union all
		select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_applyitem_detail a,rsbt_org f
		where a.dept_pay=f.guid(+) and item_code='810000'
			 and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,'MHz',to_number(translate(freq_note,'KMGHz',' '))) >30;

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_HF_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_HF_R" AS 
select c.NET_SVN, a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
  b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
from rsbt_station_r a,rsbt_code_dic b,rsbt_net_r c
where  a.net_guid=c.guid and STAT_APP_Type='V'  and a.stat_type<>'RA' AND a.stat_type<>'AT'  and substr(app_code,1,length(app_code)-12)='T'
   -- and  nvl(NET_SVN,' ')<>'GD04' and nvl(NET_SVN,' ')<>'LY05' and nvl(NET_SVN,' ')<>'LY06' and nvl(NET_SVN,' ')<>'WA'
        and exists (select station_guid from rsbt_freq_r f where a.guid=f.station_guid and decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC)>30 )
         and a.stat_type=b.cn(+) and nvl(c.NET_SVN,'null')<>'LY06' and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_HM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_HM" AS 
select b.guid Stat_guid,b.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,b.stat_name,b.stat_addr,Stat_app_type,
      d.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,b.org_code,et_equ_no
      from rsbt_equ a,rsbt_station b,RSBT_NET c,RSBT_CODE_DIC d,rsbt_equ_t e
      where  a.station_guid=b.guid and b.STAT_APP_Type='LM' and b.NET_GUID=c.GUID
       -- and nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' AND nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422'
        and a.guid=e.guid(+) and STAT_Status='1'
        and substr(app_code,1,length(app_code)-12)='T'
        and  exists (select  station_guid from rsbt_freq f where b.guid = f.station_guid and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30)
        and b.stat_type=d.cn(+) and d.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_HM_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_HM_P" AS 
select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org c,
			(select distinct app_code,stat_app_type||stat_tdi decl_code from  rsbt_equ a,rsbt_station b,RSBT_NET c
    where a.station_guid=b.guid  and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' and b.NET_GUID=c.GUID
        --and  nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' and nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422' and b.STAT_Date_Start<=seldate AND b.org_code=areacode
				and b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30)) b
		where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=c.guid(+) and item_code='820000'
	union all
	select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_applyitem_detail a,rsbt_org c,
    (select distinct app_code,stat_app_type||stat_tdi decl_code from  rsbt_equ a,rsbt_station b,RSBT_NET c
    where a.station_guid=b.guid  and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' and b.NET_GUID=c.GUID
        --and  nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' and nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422' and b.STAT_Date_Start<=seldate AND b.org_code=areacode
				and b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30)) b
    where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=c.guid(+) and item_code='820000';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_HM_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_HM_R" AS 
select b.guid Stat_guid,b.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,b.stat_name,b.stat_addr,Stat_app_type,
      d.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,b.org_code,et_equ_no
      from rsbt_equ_r a,rsbt_station_r b,RSBT_NET_r c,RSBT_CODE_DIC d,rsbt_equ_t_r e
      where  a.station_guid=b.guid and b.STAT_APP_Type='LM' and b.NET_GUID=c.GUID
       -- and nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' AND nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422'
        and a.guid=e.guid(+)
        and substr(app_code,1,length(app_code)-12)='T'
        and  exists (select  station_guid from rsbt_freq_r f where b.guid = f.station_guid and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30)
        and b.stat_type=d.cn(+) and d.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_JQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_JQ" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      d.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station a,rsbt_code_dic d
where substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
  AND (STAT_APP_Type='C' OR STAT_APP_Type='D')
  and a.stat_type=d.cn(+) and d.code_data_type(+)='00052006'
       and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
           AND ((FREQ_TYPE='0' AND (FREQ_UC>=361 AND FREQ_UC<=368 ) or (FREQ_UC>=382 AND FREQ_UC<=389 ) or (FREQ_UC>=851 AND FREQ_UC<=866 ))
                OR (FREQ_TYPE='1' AND (FREQ_EFE>=361 AND FREQ_EFB<=368 ) or (FREQ_EFE>=382 AND FREQ_EFB<=389 ) or (FREQ_EFE>=851 AND FREQ_EFB<=866 ))));

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_JQ_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_JQ_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org c
		where a.dept_pay=c.guid(+) and (item_code='210000' or item_code='220000' or item_code='230000')
	union all
		select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_applyitem_detail a,rsbt_org c
		where a.dept_pay=c.guid(+) and (item_code='210000' or item_code='220000' or item_code='230000');

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_JQ_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_JQ_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      d.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station_r a,rsbt_code_dic d
where substr(app_code,1,length(app_code)-12)='T'
  AND (STAT_APP_Type='C' OR STAT_APP_Type='D')
  and a.stat_type=d.cn(+) and d.code_data_type(+)='00052006'
       and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
           AND ((FREQ_TYPE='0' AND (FREQ_UC>=361 AND FREQ_UC<=368 ) or (FREQ_UC>=382 AND FREQ_UC<=389 ) or (FREQ_UC>=851 AND FREQ_UC<=866 ))
                OR (FREQ_TYPE='1' AND (FREQ_EFE>=361 AND FREQ_EFB<=368 ) or (FREQ_EFE>=382 AND FREQ_EFB<=389 ) or (FREQ_EFE>=851 AND FREQ_EFB<=866 ))));

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_LA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_LA" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
    from rsbt_station a,rsbt_antfeed c,rsbt_code_dic b
    where a.guid=c.station_guid(+) AND STAT_APP_Type='E'
       and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
       and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5
        and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_LA_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_LA_P" AS 
select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_deptitem_detail a,rsbt_org f,
      (select distinct app_code,stat_app_type||stat_tdi decl_code from RSBT_STATION a,rsbt_antfeed c
        where  a.guid=c.station_guid(+) AND STAT_APP_Type='E'
          and substr(app_code,1,length(app_code)-12)='T'
          and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5) b
    where item_code='100100' and a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=f.guid(+)
  union all
    select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_applyitem_detail a,rsbt_org f,
     (select distinct app_code,stat_app_type||stat_tdi decl_code from RSBT_STATION a,rsbt_antfeed c
        where  a.guid=c.station_guid(+) AND STAT_APP_Type='E'
          and substr(app_code,1,length(app_code)-12)='T'
          and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5) b
    where item_code='100100' and a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=f.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_LA_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_LA_R" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
    from rsbt_station_r a,rsbt_antfeed_r c,rsbt_code_dic b
    where a.guid=c.station_guid(+) AND STAT_APP_Type='E'
       and substr(app_code,1,length(app_code)-12)='T'
       and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5
        and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_LF
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_LF" AS 
select b.guid Stat_guid,b.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,b.stat_name,b.stat_addr,Stat_app_type,
      d.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,b.org_code,et_equ_no
      from rsbt_equ a,rsbt_station b,rsbt_net c,rsbt_code_dic d,rsbt_equ_t e
      where a.station_guid=b.guid and a.guid=e.guid(+) and b.net_guid=c.guid AND c.NET_SVN='LY01'
        and STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
        and b.stat_type=d.cn(+) and d.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_LJ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_LJ" AS 
select b.guid Stat_guid,b.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,b.stat_name,b.stat_addr,Stat_app_type,
			d.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,b.org_code,et_equ_no
			from rsbt_equ a,rsbt_station b,rsbt_net c,rsbt_code_dic d,rsbt_equ_t e
			where a.station_guid=b.guid and STAT_APP_Type='LM' and a.guid=e.guid(+) and STAT_Status='1'
				and substr(app_code,1,length(app_code)-12)='T' and b.net_guid=c.guid AND c.NET_SVN='LY02'
				and b.stat_type=d.cn(+) and d.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_LJ_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_LJ_P" AS 
select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org c,
			(select distinct app_code,stat_app_type||stat_tdi decl_code from RSBT_STATION a,RSBT_NET b where b.GUID=a.NET_GUID and nvl(NET_SVN,' ')='LY02' and substr(app_code,1,length(app_code)-12)='T' and STAT_APP_Type='LM') b
    where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=c.guid(+) and item_code='820000'
  union all
  select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_applyitem_detail a,rsbt_org c,
		(select distinct app_code,stat_app_type||stat_tdi decl_code from RSBT_STATION a,RSBT_NET b where b.GUID=a.NET_GUID and nvl(NET_SVN,' ')='LY02' and substr(app_code,1,length(app_code)-12)='T' and STAT_APP_Type='LM') b
    where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=c.guid(+) and item_code='820000';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_LJ_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_LJ_R" AS 
select b.guid Stat_guid,b.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,b.stat_name,b.stat_addr,Stat_app_type,
			d.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,b.org_code,et_equ_no
			from rsbt_equ_r a,rsbt_station_r b,rsbt_net_r c,rsbt_code_dic d,rsbt_equ_t_r e
			where a.station_guid=b.guid and STAT_APP_Type='LM' and a.guid=e.guid(+)
				and substr(app_code,1,length(app_code)-12)='T' and b.net_guid=c.guid AND c.NET_SVN='LY02'
				and b.stat_type=d.cn(+) and d.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_MMDS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_MMDS" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
    from rsbt_station a,RSBT_FREQ D,rsbt_code_dic b
    where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
      and (a.stat_type='MMDS')
      and ((FREQ_TYPE='0' AND FREQ_UC>=1000) OR (FREQ_TYPE='1' AND FREQ_EFB>=1000))
      and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_MMDS_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_MMDS_R" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
    from rsbt_station_r a,RSBT_FREQ_r D,rsbt_code_dic b
    where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
      and (a.stat_type='MMDS')
      and ((FREQ_TYPE='0' AND FREQ_UC>=1000) OR (FREQ_TYPE='1' AND FREQ_EFB>=1000))
      and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_MS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_MS" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
    from rsbt_station a,RSBT_FREQ D,rsbt_code_dic b
    where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
      and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME')
      and ((FREQ_TYPE='0' AND FREQ_UC>=1000) OR (FREQ_TYPE='1' AND FREQ_EFB>=1000))
      and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_MS_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_MS_P" AS 
select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org f,
			(select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station a,RSBT_FREQ D
         where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
       and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME')) b
		where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=f.guid(+)
      and (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200')
  union all
    select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_applyitem_detail a,rsbt_org f,
      (select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station a,RSBT_FREQ D
         where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
       and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME')) b
    where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=f.guid(+)
      and (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200');

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_MS_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_MS_R" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
    from rsbt_station_r a,RSBT_FREQ_r D,rsbt_code_dic b
    where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
      and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME')
      and ((FREQ_TYPE='0' AND FREQ_UC>=1000) OR (FREQ_TYPE='1' AND FREQ_EFB>=1000))
      and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_NET_SEL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_NET_SEL" AS 
select  a.cn net_svn,nvl(a.code_chi_name,a.import_name||'(已过期)') net_svn_v, b.cn net_ts,b.code_chi_name net_ts_v
from rsbt_code_dic a ,rsbt_code_dic b
where  (substr(b.cn,0,4)=a.cn ) and
a.code_data_type='00452006' and b.code_data_type='00012006'
union all
select n.cn net_svn,nvl(n.code_chi_name,n.import_name||'(已过期)') net_svn_v ,'' net_ts,'' net_ts_v
from rsbt_code_dic n
where n.code_data_type='00452006' and
 n.co not in
(
 select a.co
from rsbt_code_dic a ,rsbt_code_dic b
where  (substr(b.cn,0,4)=a.cn ) and
a.code_data_type='00452006' and b.code_data_type='00012006'
);

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_ORG_SEL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_ORG_SEL" AS 
select a."GUID",a."ORG_CODE",a."ORG_NAME",a."ORG_ADDR",a."ORG_LINK_PERSON",a."AREA_CODE",b.code_chi_name area_name from (
select  a.guid,a.org_code,a.org_name,a.org_addr,a.org_link_person,a.org_area_code area_code
from rsbt_org a
where trim(org_name) is not null and (a.org_type='001' or a.org_type='004' or a.org_type='005' or a.org_type='007')
union all
select a.guid,'' org_code,b.app_pa_name org_name ,b.app_pa_contact_addr org_addr,b.app_pa_name org_link_person,substr(a.app_code,-12,4)||'00' area_code
from rsbt_apply a,rsbt_apply_pa b
where a.guid=b.app_guid) a,rsbt_code_dic b
where a.area_code=b.cn(+) and  b.code_data_type(+)='00032006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_OTHER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_OTHER" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
from rsbt_station a,(
select stat_guid from v_rim_rsm_count_as
union
    select stat_guid from v_rim_rsm_count_bc
union
    select stat_guid from v_rim_rsm_count_bt
union
    select stat_guid from v_rim_rsm_count_bw
union
    select stat_guid from v_rim_rsm_count_cdma
union
    select stat_guid from v_rim_rsm_count_gsm
union
    select stat_guid from v_rim_rsm_count_wcdma
union
    select stat_guid from v_rim_rsm_count_td_scdma
union
    select stat_guid from v_rim_rsm_count_gd
union
    select stat_guid from v_rim_rsm_count_gx
union
    select stat_guid from v_rim_rsm_count_ha
union
    select stat_guid from v_rim_rsm_count_hf
union
    select stat_guid from v_rim_rsm_count_jq
union
    select stat_guid from v_rim_rsm_count_la
union
    select stat_guid  from v_rim_rsm_count_lf
union
    select stat_guid from v_rim_rsm_count_ms
union
    select stat_guid from v_rim_rsm_count_pb
union
    select stat_guid from v_rim_rsm_count_sf
union
    select stat_guid from v_rim_rsm_count_spm
union
    select stat_guid from v_rim_rsm_count_ss
union
    select stat_guid from v_rim_rsm_count_ws
union
    select stat_guid from v_rim_rsm_count_wx
union
    select stat_guid from v_rim_rsm_count_yy where stat_app_type<>'LM') b,rsbt_code_dic c
where a.guid=b.stat_guid(+) and b.stat_guid is  null and a.stat_app_type<>'LM' and a.stat_status='1'
      and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006'
union all
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,et_equ_no
from rsbt_equ d,rsbt_equ_t e,rsbt_station a,(
select stat_guid from v_rim_rsm_count_sm
union
    select stat_guid from v_rim_rsm_count_lj
union
    select stat_guid from v_rim_rsm_count_hm
union
    select stat_guid from v_rim_rsm_count_yy where stat_app_type='LM') b,rsbt_code_dic c
where d.guid=e.guid(+) and d.station_guid=a.guid(+) and a.guid=b.stat_guid(+) and b.stat_guid is null and
      a.stat_app_type='LM'  and a.stat_status='1' and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_OTHER_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_OTHER_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org f
		where a.dept_pay=f.guid(+)
			and ((item_code='810000' and decode(substr(freq_note,-3,3),'KHz',nvl(to_number(translate(freq_note,'KMGHz－',' ')),0)/1000,'GHz',nvl(to_number(translate(freq_note,'KMGHz－',' ')),0)*1000,nvl(to_number(translate(freq_note,'KMGHz－',' ')),0))<30)
        or (item_code='910000' and decl_code like 'R%'))
  union all
    select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_applyitem_detail a,rsbt_org f
    where a.dept_pay=f.guid(+)
      and ((item_code='810000' and decode(substr(freq_note,-3,3),'KHz',nvl(to_number(translate(freq_note,'KMGHz－',' ')),0)/1000,'GHz',nvl(to_number(translate(freq_note,'KMGHz－',' ')),0)*1000,nvl(to_number(translate(freq_note,'KMGHz－',' ')),0))<30)
        or (item_code='910000' and decl_code like 'R%'));

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_OTHER_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_OTHER_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
from rsbt_station_r a,(
select stat_guid from v_rim_rsm_count_as_r
union
    select stat_guid from v_rim_rsm_count_bc_r
union
    select stat_guid from v_rim_rsm_count_bt_r
union
    select stat_guid from v_rim_rsm_count_bw_r
union
    select stat_guid from v_rim_rsm_count_cdma_r
union
    select stat_guid from v_rim_rsm_count_gsm_r
union
    select stat_guid from v_rim_rsm_count_wcdma_r
union
    select stat_guid from v_rim_rsm_count_td_scdma_r
union
    select stat_guid from v_rim_rsm_count_gd_r
union
    select stat_guid from v_rim_rsm_count_gx_r
union
    select stat_guid from v_rim_rsm_count_ha_r
union
    select stat_guid from v_rim_rsm_count_hf_r
union
    select stat_guid from v_rim_rsm_count_jq_r
union
    select stat_guid from v_rim_rsm_count_la_r
union
    select stat_guid from v_rim_rsm_count_ms_r
union
    select stat_guid from v_rim_rsm_count_pb_r
union
    select stat_guid from v_rim_rsm_count_sf_r
union
    select stat_guid from v_rim_rsm_count_spm_r
union
    select stat_guid from v_rim_rsm_count_ss_r
union
    select stat_guid from v_rim_rsm_count_ws_r
union
    select stat_guid from v_rim_rsm_count_wx_r
union
    select stat_guid from v_rim_rsm_count_yy_r where stat_app_type<>'LM') b,rsbt_code_dic c
where a.guid=b.stat_guid(+) and b.stat_guid is  null and a.stat_app_type<>'LM'
      and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006'
union all
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,et_equ_no
from rsbt_equ_r d,rsbt_equ_t_r e,rsbt_station_r a,(
select stat_guid from v_rim_rsm_count_sm_r
union
    select stat_guid from v_rim_rsm_count_lj_r
union
    select stat_guid from v_rim_rsm_count_hm_r
union
    select stat_guid from v_rim_rsm_count_yy_r where stat_app_type='LM') b,rsbt_code_dic c
where d.guid=e.guid(+) and d.station_guid=a.guid(+) and a.guid=b.stat_guid(+) and b.stat_guid is null and
      a.stat_app_type='LM'  and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_PAPER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_PAPER" AS 
select sum(nvl(licen_count,0)) licen_count,b.cn area_code from t_rim_rsm_licensepapergd a,rsbt_code_dic b
where a.licen_status='0' and a.area_code(+)=b.cn and code_data_type(+)='00032006' group by b.cn;

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_PB
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_PB" AS 
select c.NET_SVN,a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
			d.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
	from rsbt_station a,rsbt_net c,rsbt_code_dic d
		where a.net_guid=c.guid(+) and STAT_APP_Type='V' AND nvl(c.NET_SVN,'null')='LY06' and substr(app_code,1,length(app_code)-12)='T'and STAT_Status='1'
			and a.stat_type=d.cn(+) and d.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_PB_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_PB_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org c
    where a.dept_pay=c.guid(+) and (item_code='310000' or item_code='320000' or item_code='330000')
  union all
  select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_applyitem_detail a,rsbt_org c
    where a.dept_pay=c.guid(+) and (item_code='310000' or item_code='320000' or item_code='330000');

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_PB_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_PB_R" AS 
select c.NET_SVN,a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
			d.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
	from rsbt_station_r a,rsbt_net_r c,rsbt_code_dic d
		where a.net_guid=c.guid(+) and STAT_APP_Type='V' AND nvl(c.NET_SVN,'null')='LY06' and substr(app_code,1,length(app_code)-12)='T'
			and a.stat_type=d.cn(+) and d.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SF
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SF" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
    from rsbt_station a,rsbt_freq b,rsbt_code_dic c
    where STAT_APP_Type='H' and a.guid=b.station_guid(+)
      and substr(app_code,1,length(app_code)-12)='T'and STAT_Status='1'
   --   and a.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<30)
      AND a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SF_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SF_P" AS 
select stat_guid,net_guid,item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from (select null stat_guid,null net_guid,item_no,null apply_code,null decl_code,a.dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,a.item_code,item_name,b.fee_pay,count_mode,freq_note,amount,a.sum_count,to_char(derate)||'%' derate,sum_pay
  from t_rim_rsm_pay_deptnetitem a,rsbt_FEESTANDERD b,t_rim_rsm_pay_deptcount c
  where a.item_code=b.item_code
        and a.dept_pay=c.dept_pay(+) and a.area_code=c.area_code(+) and a.count_year=c.count_year(+)) a,rsbt_org f
   	where a.dept_pay=f.guid(+) and item_code='810000'
    and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,to_number(translate(freq_note,'KMGHz',' '))) between 0 and 30
union all
    select stat_guid,net_guid,item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
    from (select null stat_guid,d.net_guid net_guid,item_no,d.app_code apply_code, null decl_code,a.dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,a.item_code,item_name,count_mode,freq_note,b.fee_pay,1 amount,a.sum_count,to_char(derate)||'%' derate,to_char(pay_rate)||'%' pay_rate,sum_pay
  from t_rim_rsm_pay_applynetitem a,rsbt_FEESTANDERD b,t_rim_rsm_pay_applycount c,(select distinct net_guid,app_code app_code from rsbt_apply where app_type<>'F') d
  where a.item_code=b.item_code
        and a.apply_code=c.apply_code(+) and a.dept_pay=c.dept_pay(+) and a.area_code=c.area_code(+)
        and a.count_year=c.count_year(+) and to_char(a.apply_code)=substr(d.app_code,-12,12)) a,rsbt_org f
    where a.dept_pay=f.guid(+) and item_code='810000'
    and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,to_number(translate(freq_note,'KMGHz',' '))) between 0 and 30;

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SF_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SF_R" AS 
select distinct a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
    from rsbt_station_r a,rsbt_freq_r b,rsbt_code_dic c
    where STAT_APP_Type='H' and a.guid=b.station_guid(+)
      and substr(app_code,1,length(app_code)-12)='T'
   --   and a.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<30)
      AND a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SM" AS 
select b.guid Stat_guid,b.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,b.stat_name,b.stat_addr,Stat_app_type,
      d.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,b.org_code,et_equ_no
      from rsbt_equ a,rsbt_station b,rsbt_net c,rsbt_code_dic d,rsbt_equ_t e
      where a.station_guid=b.guid and a.guid=e.guid(+) and b.STAT_APP_Type='LM'and STAT_Status='1' and b.net_guid=c.guid(+)  and substr(app_code,1,length(app_code)-12)='T'
      and b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
      and b.stat_type=d.cn(+) and d.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SM_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SM_P" AS 
select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org c,
			(select distinct app_code,stat_app_type||stat_tdi decl_code  from rsbt_equ a,rsbt_station b,rsbt_net c
      where b.STAT_APP_Type='LM' and a.station_guid=b.guid
				and substr(app_code,1,length(app_code)-12)='T'
				and  b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
				and b.net_guid=c.guid(+) and nvl(c.net_svn,' ')<>'LY02') b
		where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=c.guid(+) and item_code='820000'
	union all
	select item_no,a.apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_applyitem_detail a,rsbt_org c,
			(select distinct app_code,stat_app_type||stat_tdi decl_code  from rsbt_equ a,rsbt_station b,rsbt_net c
      where b.STAT_APP_Type='LM' and a.station_guid=b.guid
				and substr(app_code,1,length(app_code)-12)='T'
				and  b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
				and b.net_guid=c.guid(+) and nvl(c.net_svn,' ')<>'LY02') b
    where a.apply_code=b.app_code and a.decl_code=b.decl_code and a.dept_pay=c.guid(+) and item_code='820000';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SM_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SM_R" AS 
select b.guid Stat_guid,b.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,b.stat_name,b.stat_addr,Stat_app_type,
      d.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,b.org_code,et_equ_no
      from rsbt_equ_r a,rsbt_station_r b,rsbt_net_r c,rsbt_code_dic d,rsbt_equ_t_r e
      where a.station_guid=b.guid and a.guid=e.guid(+) and b.STAT_APP_Type='LM' and b.net_guid=c.guid(+)  and substr(app_code,1,length(app_code)-12)='T'
      and b.guid in (select distinct station_guid from rsbt_freq_r where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
      and b.stat_type=d.cn(+) and d.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SPM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SPM" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
			b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
		from rsbt_station a,rsbt_code_dic b
		where STAT_APP_Type='ME' and substr(app_code,1,length(app_code)-12)='T'and STAT_Status='1'
			 and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SPM_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SPM_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org f
		where decl_code like 'ME%' and a.dept_pay=f.guid(+) and item_code='100100'
	union all
		select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_applyitem_detail a,rsbt_org f
		where decl_code like 'ME%' and a.dept_pay=f.guid(+) and item_code='100100';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SPM_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SPM_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
			b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
		from rsbt_station_r a,rsbt_code_dic b
		where STAT_APP_Type='ME' and substr(app_code,1,length(app_code)-12)='T'
			 and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SS" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
			c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
	from rsbt_station a,rsbt_code_dic c
		where STAT_APP_Type='S' and substr(app_code,1,length(app_code)-12)='T'and STAT_Status='1'
			and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SS_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SS_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org c
		where  a.dept_pay=c.guid(+) and (item_code='610000' or item_code='620000' or item_code='630000')
	union all
	select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_applyitem_detail a,rsbt_org c
    where a.dept_pay=c.guid(+) and (item_code='610000' or item_code='620000' or item_code='630000');

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_SS_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_SS_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
			c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
	from rsbt_station_r a,rsbt_code_dic c
		where STAT_APP_Type='S' and substr(app_code,1,length(app_code)-12)='T'
			and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_TD_SCDMA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_TD_SCDMA" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station a,rsbt_net c,rsbt_code_dic b
    where a.net_guid=c.guid
      and substr(app_code,1,length(app_code)-12)='T'and STAT_Status='1'
      and c.net_ts='LY0104' --TD-SCDMA??
      and (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
      and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
      and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
          and ((FREQ_TYPE='0' and (FREQ_UC>=1880 and FREQ_UC<=1900) or (FREQ_UC>=2010 and FREQ_UC<=2025) or(FREQ_UC>=2320 and FREQ_UC<=2370) or (FREQ_UC>=2570 and FREQ_UC<=2620))
                or (FREQ_TYPE='1' and (FREQ_EFE>=1880 and FREQ_EFB<=1900) or (FREQ_EFE>=2010 and FREQ_EFB<=2025) or (FREQ_EFE>=2320 and FREQ_EFB<=2370) or (FREQ_EFE>=2570 and FREQ_EFB<=2620))));

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_TD_SCDMA_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_TD_SCDMA_P" AS 
select item_no,apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_deptitem_detail a,rsbt_org f,
        (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
 AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND ((FREQ_LC>=1880 AND FREQ_LC<=1900 ) OR (FREQ_LC>=2010 AND FREQ_LC<=2025 )OR (FREQ_LC>=2320 AND FREQ_LC<=2370 )OR (FREQ_LC>=2570 AND FREQ_LC<=2620 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFB>=1880 AND FREQ_EFE<=1900 ) OR (FREQ_EFB>=2010 AND FREQ_EFE<=2025 )OR (FREQ_EFB>=2320 AND FREQ_EFE<=2370 )OR (FREQ_EFB>=2570 AND FREQ_EFE<=2620 ))))) or (STAT_APP_Type='D'))) b
    where a.dept_pay=f.guid(+) and a.apply_code=b.app_code and a.decl_code=b.decl_code
union all
    select  item_no,apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
        from v_rim_rsm_pay_applyitem_detail a,rsbt_org f,
        (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
 AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND ((FREQ_LC>=1880 AND FREQ_LC<=1900 ) OR (FREQ_LC>=2010 AND FREQ_LC<=2025 )OR (FREQ_LC>=2320 AND FREQ_LC<=2370 )OR (FREQ_LC>=2570 AND FREQ_LC<=2620 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFB>=1880 AND FREQ_EFE<=1900 ) OR (FREQ_EFB>=2010 AND FREQ_EFE<=2025 )OR (FREQ_EFB>=2320 AND FREQ_EFE<=2370 )OR (FREQ_EFB>=2570 AND FREQ_EFE<=2620 ))))) or (STAT_APP_Type='D'))) b
    where  a.dept_pay=f.guid(+) and a.apply_code=b.app_code and a.decl_code=b.decl_code;

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_TD_SCDMA_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_TD_SCDMA_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station_r a,rsbt_net_r c,rsbt_code_dic b
    where a.net_guid=c.guid
      and substr(app_code,1,length(app_code)-12)='T'
      and c.net_ts='LY0104' --TD-SCDMA??
      and (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
      and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
      and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
          and ((FREQ_TYPE='0' and (FREQ_UC>=1880 and FREQ_UC<=1900) or (FREQ_UC>=2010 and FREQ_UC<=2025) or(FREQ_UC>=2320 and FREQ_UC<=2370) or (FREQ_UC>=2570 and FREQ_UC<=2620))
                or (FREQ_TYPE='1' and (FREQ_EFE>=1880 and FREQ_EFB<=1900) or (FREQ_EFE>=2010 and FREQ_EFB<=2025) or (FREQ_EFE>=2320 and FREQ_EFB<=2370) or (FREQ_EFE>=2570 and FREQ_EFB<=2620))));

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_WCDMA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_WCDMA" AS 
select  a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station a,rsbt_net c,rsbt_code_dic b
    where a.net_guid=c.guid
      and substr(app_code,1,length(app_code)-12)='T'and STAT_Status='1'
     AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
     --and c.net_ts='LY0103' --WCDMA??
     and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
     and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
     AND ((FREQ_TYPE='0' AND (FREQ_UC>=2130 AND FREQ_UC<=2145 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=2130 AND FREQ_EFB<=2145 ))));

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_WCDMA_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_WCDMA_P" AS 
select item_no,apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
    from v_rim_rsm_pay_deptitem_detail a,rsbt_org f,
        (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
  AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND (FREQ_LC>=2130 AND FREQ_LC<=2145 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFB>=2130 AND FREQ_EFE<=2145 )))) or (STAT_APP_Type='D'))) b
    where a.dept_pay=f.guid(+) and a.apply_code=b.app_code and a.decl_code=b.decl_code
union all
    select item_no,apply_code,a.decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
        from v_rim_rsm_pay_applyitem_detail a,rsbt_org f,
        (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
  AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND (FREQ_LC>=2130 AND FREQ_LC<=2145 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFB>=2130 AND FREQ_EFE<=2145 )))) or (STAT_APP_Type='D'))) b
    where a.dept_pay=f.guid(+) and a.apply_code=b.app_code and a.decl_code=b.decl_code;

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_WCDMA_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_WCDMA_R" AS 
select  a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
    from rsbt_station_r a,rsbt_net_r c,rsbt_code_dic b
    where a.net_guid=c.guid
      and substr(app_code,1,length(app_code)-12)='T'
     AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
     --and c.net_ts='LY0103' --WCDMA??
     and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
     and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
     AND ((FREQ_TYPE='0' AND (FREQ_UC>=2130 AND FREQ_UC<=2145 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=2130 AND FREQ_EFB<=2145 ))));

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_WS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_WS" AS 
select  a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
        b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
      from rsbt_station a,rsbt_net c ,rsbt_code_dic b
      where  a.net_guid=c.guid and  STAT_APP_Type='C' and substr(app_code,1,length(app_code)-12)='T'and STAT_Status='1'
           and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
           and c.net_ts<>'LY0104' --避免与TD-SCDMA系统的台站重复
           and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
               AND ((FREQ_TYPE='0' AND (FREQ_UC>=1900 AND FREQ_UC<=1920 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=1900 AND FREQ_EFB<=1920 ))));

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_WS_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_WS_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org f
		where a.dept_pay=f.guid(+) and (item_code='120200' or item_code='410000')
	union all
		select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_applyitem_detail a,rsbt_org f
    where a.dept_pay=f.guid(+) and (item_code='120200' or item_code='410000');

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_WS_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_WS_R" AS 
select  a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
        b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
      from rsbt_station_r a,rsbt_net_r c ,rsbt_code_dic b
      where  a.net_guid=c.guid and  STAT_APP_Type='C' and substr(app_code,1,length(app_code)-12)='T'and STAT_Status='1'
           and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
           and c.net_ts<>'LY0104' --避免与TD-SCDMA系统的台站重复
           and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
               AND ((FREQ_TYPE='0' AND (FREQ_UC>=1900 AND FREQ_UC<=1920 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=1900 AND FREQ_EFB<=1920 ))));

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_WX
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_WX" AS 
select stat_type, a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
    from rsbt_station a,rsbt_code_dic b
    where substr(app_code,1,length(app_code)-12)='T'and STAT_Status='1'
       and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
       AND STAT_APP_Type='TF'
       and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
       AND ((FREQ_TYPE='0' AND (FREQ_UC>=223 AND FREQ_UC<=235) or (FREQ_UC>=866 AND FREQ_UC<=870))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=223 AND FREQ_EFB<=235 ) or (FREQ_EFE>=866 AND FREQ_EFB<=870 ))));

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_WX_P
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_WX_P" AS 
select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,'100%' pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_deptitem_detail a,rsbt_org f
		where a.dept_pay=f.guid(+) and item_code='140100'
	union all
		select item_no,apply_code,decl_code,dept_pay,area_code,count_year,type_name,
       item_code,item_name,count_mode,freq_note,fee_pay,amount,sum_count,derate,pay_rate,sum_pay,org_name
		from v_rim_rsm_pay_applyitem_detail a,rsbt_org f
    where a.dept_pay=f.guid(+) and item_code='140100';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_WX_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_WX_R" AS 
select stat_type, a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
    from rsbt_station_r a,rsbt_code_dic b
    where substr(app_code,1,length(app_code)-12)='T'
       and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
       AND STAT_APP_Type='TF'
       and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
       AND ((FREQ_TYPE='0' AND (FREQ_UC>=223 AND FREQ_UC<=235) or (FREQ_UC>=866 AND FREQ_UC<=870))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=223 AND FREQ_EFB<=235 ) or (FREQ_EFE>=866 AND FREQ_EFB<=870 ))));

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_YY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_YY" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
       from rsbt_station a,rsbt_code_dic b
       where substr(app_code,1,length(app_code)-12)='PA' AND STAT_APP_Type<>'LM'and STAT_Status='1'
          and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
  union all
    select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,et_equ_no
       from rsbt_equ c,rsbt_station a,rsbt_code_dic b,rsbt_equ_t d
       where c.station_guid=a.guid and a.guid=d.guid(+) and substr(app_code,1,length(app_code)-12)='PA'and STAT_Status='1'
           AND STAT_APP_Type='LM' and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_COUNT_YY_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_COUNT_YY_R" AS 
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,'' et_equ_no
       from rsbt_station_r a,rsbt_code_dic b
       where substr(app_code,1,length(app_code)-12)='PA' AND STAT_APP_Type<>'LM'
          and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006'
  union all
    select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
      b.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,org_code,et_equ_no
       from rsbt_equ_r c,rsbt_station_r a,rsbt_code_dic b,rsbt_equ_t_r d
       where c.station_guid=a.guid and a.guid=d.guid(+) and substr(app_code,1,length(app_code)-12)='PA'
           AND STAT_APP_Type='LM' and a.stat_type=b.cn(+) and b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_DATA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_DATA" AS 
select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_EFB,FREQ_LC),0) freq_emit,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_RFB,FREQ_UC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
     and (b.STAT_APP_Type='V' or b.STAT_APP_Type='TF') and B.STAT_Status=1 AND NET_SVN='LY05' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_DEPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_DEPT" AS 
select substr(a.app_code,-12,12) apply_code,a.app_code,
         decode(substr(a.app_code,0,1) ,'T','T','P','PA') APP_TYPE,
         decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,-12,4)||'00'),a.STAT_AREA_CODE) area_code,
         a.STAT_APP_Type||a.STAT_TDI decl_code,
		     b.ORG_GUID dept_set,decode(nvl(b.FEE_GUID,''),'',d.guid,b.FEE_GUID) dept_pay,
         d.org_name dept_name,d.org_code,
         a.STAT_Date_Start,b.guid net_guid,d.org_sys_code
	  from RSBT_STATION a,RSBT_NET b,
    --v_rim_rsm_rsbt_feeeveryyear c ,
        rsbt_org d
	 where a.net_guid=b.guid(+)
   -- and a.guid=c.station_guid(+)
         and b.fee_guid=d.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_DEPT_IN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_DEPT_IN" AS 
select substr(a.app_code,-12,12) apply_code,decode(substr(app_code,0,1) ,'T','T','P','PA') APP_TYPE,
    decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.STAT_AREA_CODE) area_code,a.STAT_APP_Type||a.STAT_TDI decl_code,
			b.ORG_GUID dept_set,decode(nvl(b.FEE_GUID,''),'',c.org_guid,b.FEE_GUID) dept_pay,a.STAT_Date_Start,b.guid net_guid
	  from RSBT_STATION a,RSBT_NET b,rsbt_feeeveryyear c
	 where a.net_guid=b.guid(+) and a.guid=c.station_guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_DISCARD_EQU
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_DISCARD_EQU" AS 
select a.app_code app_code,substr(a.app_code,-12,12) app_codedes,nvl(a.STAT_AREA_CODE,a.org_code) stat_area_code,stat_area_code area_code,
       b.guid net_guid, a.guid station_guid,b.net_name,decode(substr(a.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(a.app_code),c.org_name) org_name,a.STAT_APP_Type|| a.stat_tdi decl_code,
	 d.guid app_guid,decode(substr(a.app_code,1,1),'P','PA','T') as app_type,decode(substr(a.app_code,1,1),'P','业余电台申请','无线电台申请') as app_type_Name
	 ,b.org_guid,e.guid equ_guid,f.et_equ_no,e.equ_menu,e.equ_model,e.equ_code, '1' discard_status,'报废' equ_status_v, to_char(e.timestamp,'yyyy-mm-dd')  timestamp
 from rsbt_equ_h e,rsbt_equ_t_h f,rsbt_station a ,rsbt_net b ,rsbt_org c,rsbt_apply d,t_rim_rsm_equ_expand m
 where e.station_guid=a.guid and e.guid=f.guid(+) and a.net_guid = b.guid(+) and a.app_code=d.app_code(+) and e.guid=m.guid(+) and m.equ_status='2'
 and b.org_guid = c.guid(+) and a.stat_app_type='LM'
 union
 select a.app_code app_code,substr(a.app_code,-12,12) app_codedes,nvl(a.STAT_AREA_CODE,a.org_code) stat_area_code,stat_area_code area_code,
       b.guid net_guid, a.guid station_guid,b.net_name,decode(substr(a.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(a.app_code),c.org_name) org_name,a.STAT_APP_Type|| a.stat_tdi decl_code,
	 d.guid app_guid,decode(substr(a.app_code,1,1),'P','PA','T') as app_type,decode(substr(a.app_code,1,1),'P','业余电台申请','无线电台申请') as app_type_Name
	 ,b.org_guid,e.guid equ_guid,f.et_equ_no,e.equ_menu,e.equ_model,e.equ_code, '2' equ_status,'报废' equ_status_v, to_char(e.timestamp,'yyyy-mm-dd')  timestamp
 from rsbt_equ_h e,rsbt_equ_t_h f,rsbt_station_h a ,rsbt_net b ,rsbt_org c,rsbt_apply d,t_rim_rsm_equ_expand m
 where e.station_guid=a.guid and e.guid=f.guid(+) and a.net_guid = b.guid(+)  and a.app_code=d.app_code(+) and e.guid=m.guid(+) and m.equ_status='2'
 and b.org_guid = c.guid(+) and a.stat_app_type='LM';

-- ----------------------------
-- View structure for V_RIM_RSM_DISCARD_STAT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_DISCARD_STAT" AS 
select s.guid,s.guid station_guid,s.app_code,s.stat_app_type,s.org_code,s.stat_tdi,s.stat_name,s.stat_addr,s.stat_area_code,s.stat_type,to_char(s.stat_date_start,'yyyy-mm-dd') stat_date_start,
       to_char(s.timestamp,'yyyy-mm-dd')  timestamp,apply.guid app_guid,apply.app_type, s.stat_app_type || s.stat_tdi as decl_code,decode(s.stat_status,'2','报废','') statusDesc,n.org_guid,o.org_name
  ,'1' apply_status ,'在用' apply_status_v
  from rsbt_station_h s ,rsbt_net n ,rsbt_org o,rsbt_apply apply
where s.net_guid  = n.guid and s.stat_status='2'
  and n.org_guid  = o.guid and s.app_code(+)=apply.app_code
union all
select s.guid,s.guid station_guid,s.app_code,s.stat_app_type,s.org_code,s.stat_tdi,s.stat_name,s.stat_addr,s.stat_area_code,s.stat_type,to_char(s.stat_date_start,'yyyy-mm-dd') stat_date_start,
       to_char(s.timestamp,'yyyy-mm-dd')  timestamp,apply.guid app_guid,apply.app_type, s.stat_app_type || s.stat_tdi as decl_code,decode(s.stat_status,'2','报废','') statusDesc,n.org_guid,o.org_name
  ,m.apply_status,decode(m.apply_status,'0','封存','2','报废') apply_status_v
  from rsbt_station_h s ,rsbt_net n ,rsbt_org o,rsbt_apply_h apply,t_rim_rsm_apply_status m
where s.net_guid  = n.guid and s.stat_status='2'
  and n.org_guid  = o.guid and s.app_code(+)=apply.app_code;

-- ----------------------------
-- View structure for V_RIM_RSM_EQU_CHECK
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EQU_CHECK" AS 
select a.guid ,a.eck_code,a.eck_corp,a.eck_date,a.eck_pass,decode(a.eck_pass,'1','合格','0','不合格') eck_pass_v,a.remark from t_rim_rsm_equ_check a;

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_ANTFEED
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_ANTFEED" AS 
select a."GUID",a."STATION_GUID",a."ANT_WORK_TYPE",a."ANT_POLE",a."ANT_RPOLE",a."ANT_EPOLE",a."ANT_TYPE",a."ANT_MODEL",a."ANT_MENU",a."ANT_HIGHT",a."ANT_GAIN",a."ANT_EGAIN",a."ANT_RGAIN",a."ANT_ANGLE",a."ANT_SIZE",a."FEED_MENU",a."FEED_MODEL",a."FEED_LENGTH",a."FEED_LOSE",a."ANT_CODE",a."FEED_CODE",
--
t.at_ant_no,t.at_ant_upang,t.at_lel,t.at_bwid,t.AT_ANG_E,t.at_ang_b,t.at_ccode,t.at_unit_type,
t.at_3dbe,t.at_sspeed,t.at_rnt,t.at_qua,t.at_se_e,t.at_eang,t.at_updn,t.at_h_hpic,
t.at_se_b,t.at_csgn,t.at_3dbr,t.at_rang,t.at_sum,t.at_h_vpic,
--c
'1' opttype,
--c
'1' antpage,
'' CINDEX,
'' station_code_b,
--
decode(ANT_EGain ,null,'', ANT_EGain ) || ' dBi' ANT_EGain_Desc,
decode(ANT_Gain ,null,'', ANT_Gain ) || ' dBi' ANT_Gain_Desc,
decode(FEED_Lose ,null,'', FEED_Lose ) || ' dB' FEED_Lose_Desc ,
--
j.code_chi_name ANT_Type_Name,j.code1 ANT_Type_code0,
j1.Import_Code ANT_Type_code1,
ANT_WORK_TYPE.code_chi_name ANT_WORK_TYPE_Name,ANT_WORK_TYPE.Import_Code ANT_WORK_TYPE_code0,
ANT_POLE.code_chi_name ANT_POLE_Name,ANT_POLE.Import_Code ANT_POLE_code0,
ANT_RPOLE.code_chi_name ANT_RPOLE_Name,ANT_RPOLE.Import_Code ANT_RPOLE_code0,
ANT_EPOLE.code_chi_name ANT_EPOLE_Name,ANT_EPOLE.Import_Code ANT_EPOLE_code0,
AT_UPDN.code_chi_name AT_UPDN_Name ,AT_UPDN.Import_Code AT_UPDN_code0,t.at_ant_tfcode
from rsbt_antfeed a,rsbt_antfeed_t t ,RSBT_CODE_DIC j,RSBT_CODE_DIC j1
 ,RSBT_CODE_DIC ANT_WORK_TYPE,RSBT_CODE_DIC ANT_POLE,RSBT_CODE_DIC ANT_RPOLE
 ,RSBT_CODE_DIC ANT_EPOLE,RSBT_CODE_DIC AT_UPDN
where a.guid = t.guid(+)
and (a.ant_type = j.cn(+) and j.code_data_type(+) = '00172006')
and (a.ant_type = j1.cn(+) and j1.code_data_type(+) = '00172006')
and (a.ANT_WORK_TYPE = ANT_WORK_TYPE.cn(+) and ANT_WORK_TYPE.code_data_type(+) = '00322006')
and (a.ANT_POLE = ANT_POLE.cn(+) and ANT_POLE.code_data_type(+) = '00202006')
and (a.ANT_RPOLE = ANT_RPOLE.cn(+) and ANT_RPOLE.code_data_type(+) = '00202006')
and (a.ANT_EPOLE = ANT_EPOLE.cn(+) and ANT_EPOLE.code_data_type(+) = '00202006')
and (t.AT_UPDN = AT_UPDN.cn(+) and AT_UPDN.code_data_type(+) = '00422006');

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_ANTFEED_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_ANTFEED_R" AS 
select a."GUID",a."STATION_GUID",a."ANT_WORK_TYPE",a."ANT_POLE",a."ANT_RPOLE",a."ANT_EPOLE",a."ANT_TYPE",a."ANT_MODEL",a."ANT_MENU",a."ANT_HIGHT",a."ANT_GAIN",a."ANT_EGAIN",a."ANT_RGAIN",a."ANT_ANGLE",a."ANT_SIZE",a."FEED_MENU",a."FEED_MODEL",a."FEED_LENGTH",a."FEED_LOSE",a."ANT_CODE",a."FEED_CODE",
--
t.at_ant_no,t.at_ant_upang,t.at_lel,t.at_bwid,t.AT_ANG_E,t.at_ang_b,t.at_ccode,t.at_unit_type,
t.at_3dbe,t.at_sspeed,t.at_rnt,t.at_qua,t.at_se_e,t.at_eang,t.at_updn,t.at_h_hpic,
t.at_se_b,t.at_csgn,t.at_3dbr,t.at_rang,t.at_sum,t.at_h_vpic,
--c
'1' opttype,
--c
'1' antpage,
'' CINDEX,
'' station_code_b,
--
decode(ANT_EGain ,null,'', ANT_EGain ) || ' dBi' ANT_EGain_Desc,
decode(ANT_Gain ,null,'', ANT_Gain ) || ' dBi' ANT_Gain_Desc,
decode(FEED_Lose ,null,'', FEED_Lose ) || ' dB' FEED_Lose_Desc ,
--
j.code_chi_name ANT_Type_Name,j.code1 ANT_Type_code0,
j1.Import_Code ANT_Type_code1,
ANT_WORK_TYPE.code_chi_name ANT_WORK_TYPE_Name,ANT_WORK_TYPE.Import_Code ANT_WORK_TYPE_code0,
ANT_POLE.code_chi_name ANT_POLE_Name,ANT_POLE.Import_Code ANT_POLE_code0,
ANT_RPOLE.code_chi_name ANT_RPOLE_Name,ANT_RPOLE.Import_Code ANT_RPOLE_code0,
ANT_EPOLE.code_chi_name ANT_EPOLE_Name,ANT_EPOLE.Import_Code ANT_EPOLE_code0,
AT_UPDN.code_chi_name AT_UPDN_Name ,AT_UPDN.Import_Code AT_UPDN_code0,t.at_ant_tfcode
from rsbt_antfeed_r a,rsbt_antfeed_t_r t ,RSBT_CODE_DIC j,RSBT_CODE_DIC j1
 ,RSBT_CODE_DIC ANT_WORK_TYPE,RSBT_CODE_DIC ANT_POLE,RSBT_CODE_DIC ANT_RPOLE
 ,RSBT_CODE_DIC ANT_EPOLE,RSBT_CODE_DIC AT_UPDN
where a.guid = t.guid(+)
and (a.ant_type = j.cn(+) and j.code_data_type(+) = '00172006')
and (a.ant_type = j1.cn(+) and j1.code_data_type(+) = '00172006')
and (a.ANT_WORK_TYPE = ANT_WORK_TYPE.cn(+) and ANT_WORK_TYPE.code_data_type(+) = '00322006')
and (a.ANT_POLE = ANT_POLE.cn(+) and ANT_POLE.code_data_type(+) = '00202006')
and (a.ANT_RPOLE = ANT_RPOLE.cn(+) and ANT_RPOLE.code_data_type(+) = '00202006')
and (a.ANT_EPOLE = ANT_EPOLE.cn(+) and ANT_EPOLE.code_data_type(+) = '00202006')
and (t.AT_UPDN = AT_UPDN.cn(+) and AT_UPDN.code_data_type(+) = '00422006');

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_APPCLUBS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_APPCLUBS" AS 
select '1' as opttype ,
a."GUID",a."APP_GUID",a."APP_CLUBS_NAME",a."APP_CLUBS_SUP_ORG",a."APP_CLUBS_MEMBER_CODE"
from RSBT_APPCLUBS a;

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_APPCLUBS_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_APPCLUBS_R" AS 
select '1' as opttype ,
a."GUID",a."APP_GUID",a."APP_CLUBS_NAME",a."APP_CLUBS_SUP_ORG",a."APP_CLUBS_MEMBER_CODE"
from RSBT_APPCLUBS_r a;

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_APPFREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_APPFREQ" AS 
select 'RSBT_FACTFREQ' as tablename,'1' as opttype ,
a."GUID",a."APP_GUID",a."APP_CODE",a."APP_FREQ_LC",a."APP_FREQ_UC",a."APP_FREQ_LFB",a."APP_FREQ_LFE",a."APP_FREQ_LB",a."APP_FREQ_UFB",a."APP_FREQ_UFE",a."APP_FREQ_UB",a."APP_FREQ_CODE",a."APP_FREQ_TYPE" ,
to_char(to_number(App_freq_lfb),'fm999999990.0999999')||' MHz' as App_freq_lfb_v0,to_char(to_number(app_freq_lfe),'fm999999990.0999999')  ||' MHz' as app_freq_lfe_v1,
to_char(to_number(app_freq_ufb),'fm999999990.0999999') ||' MHz' as app_freq_ufb_v2,to_char(to_number(app_freq_ufe),'fm999999990.0999999') ||' MHz' as app_freq_ufe_v3
from RSBT_APPFREQ a;

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_APPFREQ_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_APPFREQ_R" AS 
select 'RSBT_FACTFREQ' as tablename,'1' as opttype ,
a."GUID",a."APP_GUID",a."APP_CODE",a."APP_FREQ_LC",a."APP_FREQ_UC",a."APP_FREQ_LFB",a."APP_FREQ_LFE",a."APP_FREQ_LB",a."APP_FREQ_UFB",a."APP_FREQ_UFE",a."APP_FREQ_UB",a."APP_FREQ_CODE",a."APP_FREQ_TYPE" ,
to_char(to_number(App_freq_lfb),'fm999999990.0999999')||' MHz' as App_freq_lfb_v0,to_char(to_number(app_freq_lfe),'fm999999990.0999999')  ||' MHz' as app_freq_lfe_v1,
to_char(to_number(app_freq_ufb),'fm999999990.0999999') ||' MHz' as app_freq_ufb_v2,to_char(to_number(app_freq_ufe),'fm999999990.0999999') ||' MHz' as app_freq_ufe_v3
from RSBT_APPFREQ_r a;

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_APPLY" AS 
select 'RSBT_SAPPLY' as tablename,'1' as opttype,substr(a.app_code,-12,12) tapp_code ,'0' SFLAG,
a."GUID",a."ORG_GUID",a."NET_GUID",a."ORG_MANAGER_GUID",a."APP_CODE",a."APP_TYPE",a."APP_SUB_TYPE",a."APP_OBJECT_TYPE",a."APP_DATE",a."APP_FTLB",a."APP_FTLE",a."MEMO",
'' FILENAME0,'' FILENAME1,'' FILENAME2,
to_char(app_ftlb,'yyyy-MM-dd') as app_ftlbDes,to_char(app_ftle,'yyyy-MM-dd') as app_ftleDes,
to_char(app_date,'yyyy-MM-dd') as app_dateDes
from rsbt_apply a;

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_APPLY_PA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_APPLY_PA" AS 
select '1' as opttype ,
a."GUID",a."APP_GUID",a."APP_PA_NAME",a."APP_PA_GENDER",a."APP_PA_BIRTHDAY",a."APP_PA_NATION",a."APP_PA_DEGREE",a."APP_PA_ID_CARD",a."APP_PA_SERV_ORG",a."APP_PA_SERV_POST",a."APP_PA_LIVE_ADDR",a."APP_PA_LIVE_POST",a."APP_PA_CONTACT_ADDR",a."APP_PA_CONTACT_POST",a."APP_PA_EMAIL",a."APP_PA_ORG_PHONE",a."APP_PA_HOME_PHONE",a."APP_PA_MOBILE",a."APP_PA_OTHER_INFO",a."APP_PA_STAT_TYPE",a."APP_PA_ENTITY_TYPE",a."APP_PA_STAT_ADDR",a."APP_PA_OPE_DEGREE",a."APP_PA_OPE_CODE",a."APP_PA_CALL_SIGN",a."MEMO" ,
  to_char(APP_PA_BIRTHDAY,'yyyy-MM-dd') as   APP_PA_BIRTHDAY_DESC,
APP_PA_STAT_Type.CODE_CHI_NAME APP_PA_STAT_Type_Name,APP_PA_STAT_Type.Import_Code APP_PA_STAT_Type_code0,
APP_PA_Entity_Type.CODE_CHI_NAME APP_PA_Entity_Type_Name,APP_PA_Entity_Type.Import_Code APP_PA_Entity_Type_code0 ,
APP_PA_Gender.CODE_CHI_NAME APP_PA_Gender_Name,APP_PA_Gender.Import_Code APP_PA_Gender_code0
from RSBT_APPLY_PA a , RSBT_CODE_DIC APP_PA_STAT_Type, RSBT_CODE_DIC APP_PA_Entity_Type , RSBT_CODE_DIC APP_PA_Gender
where
 a.APP_PA_STAT_Type = APP_PA_STAT_Type.cn(+) and APP_PA_STAT_Type.code_data_type(+) = '00492006'
 and  a.APP_PA_Entity_Type = APP_PA_Entity_Type.cn(+) and APP_PA_Entity_Type.code_data_type(+) = '00402006'
 and  a.APP_PA_Gender = APP_PA_Gender.cn(+) and APP_PA_Gender.code_data_type(+) = '00542006';

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_APPLY_PA_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_APPLY_PA_R" AS 
select '1' as opttype ,
a."GUID",a."APP_GUID",a."APP_PA_NAME",a."APP_PA_GENDER",a."APP_PA_BIRTHDAY",a."APP_PA_NATION",a."APP_PA_DEGREE",a."APP_PA_ID_CARD",a."APP_PA_SERV_ORG",a."APP_PA_SERV_POST",a."APP_PA_LIVE_ADDR",a."APP_PA_LIVE_POST",a."APP_PA_CONTACT_ADDR",a."APP_PA_CONTACT_POST",a."APP_PA_EMAIL",a."APP_PA_ORG_PHONE",a."APP_PA_HOME_PHONE",a."APP_PA_MOBILE",a."APP_PA_OTHER_INFO",a."APP_PA_STAT_TYPE",a."APP_PA_ENTITY_TYPE",a."APP_PA_STAT_ADDR",a."APP_PA_OPE_DEGREE",a."APP_PA_OPE_CODE",a."APP_PA_CALL_SIGN",a."MEMO" ,
  to_char(APP_PA_BIRTHDAY,'yyyy-MM-dd') as   APP_PA_BIRTHDAY_DESC,
APP_PA_STAT_Type.CODE_CHI_NAME APP_PA_STAT_Type_Name,APP_PA_STAT_Type.Import_Code APP_PA_STAT_Type_code0,
APP_PA_Entity_Type.CODE_CHI_NAME APP_PA_Entity_Type_Name,APP_PA_Entity_Type.Import_Code APP_PA_Entity_Type_code0 ,
APP_PA_Gender.CODE_CHI_NAME APP_PA_Gender_Name,APP_PA_Gender.Import_Code APP_PA_Gender_code0
from RSBT_APPLY_PA_r a , RSBT_CODE_DIC APP_PA_STAT_Type, RSBT_CODE_DIC APP_PA_Entity_Type , RSBT_CODE_DIC APP_PA_Gender
where
 a.APP_PA_STAT_Type = APP_PA_STAT_Type.cn(+) and APP_PA_STAT_Type.code_data_type(+) = '00492006'
 and  a.APP_PA_Entity_Type = APP_PA_Entity_Type.cn(+) and APP_PA_Entity_Type.code_data_type(+) = '00402006'
 and  a.APP_PA_Gender = APP_PA_Gender.cn(+) and APP_PA_Gender.code_data_type(+) = '00542006';

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_APPLY_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_APPLY_R" AS 
select 'RSBT_SAPPLY' as tablename,'1' as opttype,substr(a.app_code,-12,12) tapp_code ,'0' SFLAG,
a."GUID",a."ORG_GUID",a."NET_GUID",a."ORG_MANAGER_GUID",a."APP_CODE",a."APP_TYPE",a."APP_SUB_TYPE",a."APP_OBJECT_TYPE",a."APP_DATE",a."APP_FTLB",a."APP_FTLE",a."MEMO",
'' FILENAME0,'' FILENAME1,'' FILENAME2,
to_char(app_ftlb,'yyyy-MM-dd') as app_ftlbDes,to_char(app_ftle,'yyyy-MM-dd') as app_ftleDes,
to_char(app_date,'yyyy-MM-dd') as app_dateDes
from rsbt_apply_r a;

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_EQU
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_EQU" AS 
select m."GUID",m."STATION_GUID",m."EQU_TYPE",m."EQU_MODEL",m."EQU_AUTH",m."EQU_MENU",m."EQU_CODE",m."EQU_PF",m."EQU_MB",m."EQU_POW",
--
t.et_equ_pwid2,t.et_equ_pup,t.et_equ_senerr,t.et_pow_u,t.et_equ_pr,t.et_equ_type_id,
t.et_equ_upu,t.et_equ_cl,t.et_equ_fntval,t.et_equ_pf,t.et_equ_no,t.et_equ_upow,
t.et_equ_code,t.et_equ_tl,t.et_equ_epos,t.et_equ_apos,t.et_equ_chrip,t.et_equ_rnq,t.et_equ_name,
t.et_equ_use,t.et_equ_ccode,t.et_eirp,t.et_equ_rwid,t.et_equ_esgn,t.et_equ_atype,
t.et_equ_pow_avg,t.et_equ_pow_max,t.et_equ_dnu,t.et_af_type,t.et_equ_dpow,t.et_equ_type,
t.et_equ_senu,t.et_equ_sen,t.et_equ_mt,t.et_equ_sum,t.et_equ_pdn,t.et_equ_euse,t.et_equ_pwid1,
t.ET_EQU_RF,t.ET_EQU_RF_BAND,
--lm,h,e
decode(ET_EQU_SEN,null,'', ET_EQU_SEN || ' '||ET_EQU_SENU.code_chi_name) ET_EQU_SEN_desc,
decode(ET_EQU_SEN,null,'', ET_EQU_SEN) ET_EQU_SEN_True_desc,
'' ET_EQU_SEN_W_DESC,
--
'' et_equ_tl_W_V,
decode(EQU_PF,null,'Y',EQU_PF)||'-'||f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) ||' '|| NVL(et_pow_unit.code_chi_name,'W') EQU_POW_PF_desc,
f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) ||' '|| NVL(et_pow_unit.code_chi_name,'W') EQU_POW_desc,
f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) EQU_POW_true_desc,
decode(ET_EQU_UPOW,null,'', ET_EQU_UPOW || ' '||ET_EQU_UPOW.code_chi_name) ET_EQU_UPOW_desc,
decode(ET_EQU_DPOW,null,'', ET_EQU_DPOW || ' '||ET_EQU_DPOW.code_chi_name) ET_EQU_DPOW_desc,
'' ET_EQU_UPOW_V,'' ET_EQU_DPOW_V,
--c
'1' Cindex,
--c
'1' opttype,
--c
'1' equpage,
-- c 天线里
'' AT_CCode,'' At_ang_b ,'' At_ang_e,'' AT_CSGN,'' AT_RANG,'' AT_EANG,
'' station_code_b,'' FT_FREQ_NO,
--
EQU_MB.code_chi_name EQU_MB_Name,EQU_MB.Import_Code EQU_MB_code0,
ET_AF_Type.code_chi_name ET_AF_Type_Name,ET_AF_Type.Import_Code ET_AF_Type_code0,
ET_EQU_Atype.code_chi_name ET_EQU_Atype_Name,ET_EQU_Atype.Code1 ET_EQU_Atype_code0,
ET_EQU_SENU.code_chi_name ET_EQU_SENU_Name,ET_EQU_SENU.Import_Code ET_EQU_SENU_code0,
ET_EQU_SENERR.code_chi_name ET_EQU_SENERR_Name,ET_EQU_SENERR.Import_Code ET_EQU_SENERR_code0,
j.code_chi_name EQU_PF_Name,j.Import_Code EQU_PF_code0,
et_pow_unit.code_chi_name ET_POW_U_Name,et_pow_unit.Import_Code ET_POW_U_code0,
ET_EQU_UPOW.code_chi_name ET_EQU_UPOW_U_Name,ET_EQU_UPOW.Import_Code ET_EQU_UPOW_U_code0,
ET_EQU_DPOW.code_chi_name ET_EQU_DPOW_U_Name,ET_EQU_DPOW.Import_Code ET_EQU_DPOW_U_code0,
ET_EQU_MT.code_chi_name ET_EQU_MT_Name ,ET_EQU_MT.Import_Code ET_EQU_MT_code0,t.et_equ_tfcode
from rsbt_equ m ,rsbt_equ_t t,RSBT_CODE_DIC j,RSBT_CODE_DIC et_pow_unit
 ,RSBT_CODE_DIC EQU_MB ,RSBT_CODE_DIC ET_AF_Type,RSBT_CODE_DIC ET_EQU_Atype
 ,RSBT_CODE_DIC ET_EQU_SENU,RSBT_CODE_DIC ET_EQU_SENERR,RSBT_CODE_DIC ET_EQU_MT,
 RSBT_CODE_DIC ET_EQU_UPOW ,RSBT_CODE_DIC ET_EQU_DPOW
where m.guid = t.guid(+)
and (t.ET_pow_u = et_pow_unit.cn(+) and et_pow_unit.code_data_type(+) = '00282006')
and (m.equ_pf = j.cn(+) and j.code_data_type(+) = '00082006')
and (m.EQU_MB  = EQU_MB.cn(+) and EQU_MB.code_data_type(+) = '00342006')
and (t.ET_AF_Type  = ET_AF_Type.cn(+) and ET_AF_Type.code_data_type(+) = '00392006')
and (t.ET_EQU_Atype  = ET_EQU_Atype.cn(+) and ET_EQU_Atype.code_data_type(+) = '00172006')
and (t.ET_EQU_SENU  = ET_EQU_SENU.cn(+) and ET_EQU_SENU.code_data_type(+) = '00332006')
and (t.ET_EQU_SENERR  = ET_EQU_SENERR.cn(+) and ET_EQU_SENERR.code_data_type(+) = '00482006')
and (t.ET_EQU_UPU  = ET_EQU_UPOW.cn(+) and ET_EQU_UPOW.code_data_type(+) = '00282006')
and (t.ET_EQU_DNU  = ET_EQU_DPOW.cn(+) and ET_EQU_DPOW.code_data_type(+) = '00282006')
and (t.ET_EQU_MT  = ET_EQU_MT.cn(+) and ET_EQU_MT.code_data_type(+) = '00272006');

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_EQU_ANT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_EQU_ANT_R" AS 
select a."GUID",a."STATION_GUID",a."EQU_TYPE",a."EQU_MODEL",a."EQU_AUTH",a."EQU_MENU",a."EQU_CODE",a."EQU_PF",a."EQU_POW",a."EQU_MB",a."ET_EQU_PWID2",a."ET_EQU_PUP",a."ET_EQU_SENERR",a."ET_POW_U",a."ET_EQU_PR",a."ET_EQU_TYPE_ID",a."ET_EQU_UPU",a."ET_EQU_CL",a."ET_EQU_FNTVAL",a."ET_EQU_PF",a."ET_EQU_NO",a."ET_EQU_UPOW",a."ET_EQU_CODE",a."ET_EQU_TL",a."ET_EQU_EPOS",a."ET_EQU_APOS",a."ET_EQU_CHRIP",a."ET_EQU_RNQ",a."ET_EQU_NAME",a."ET_EQU_USE",a."ET_EQU_CCODE",a."ET_EIRP",a."ET_EQU_RWID",a."ET_EQU_ESGN",a."ET_EQU_ATYPE",a."ET_EQU_POW_AVG",a."ET_EQU_POW_MAX",a."ET_EQU_DNU",a."ET_AF_TYPE",a."ET_EQU_DPOW",a."ET_EQU_TYPE",a."ET_EQU_SENU",a."ET_EQU_SEN",a."ET_EQU_MT",a."ET_EQU_SUM",a."ET_EQU_PDN",a."ET_EQU_EUSE",a."ET_EQU_PWID1",a."ET_EQU_RF",a."ET_EQU_RF_BAND",a."ET_EQU_SEN_DESC",a."ET_EQU_SEN_TRUE_DESC",a."ET_EQU_SEN_W_DESC",a."ET_EQU_TL_W_V",a."EQU_POW_PF_DESC",a."EQU_POW_DESC",a."EQU_POW_TRUE_DESC",a."ET_EQU_UPOW_DESC",a."ET_EQU_DPOW_DESC",a."ET_EQU_UPOW_V",a."ET_EQU_DPOW_V",a."CINDEX",a."OPTTYPE",a."EQUPAGE",a."AT_CCODE",a."AT_ANG_B",a."AT_ANG_E",a."AT_CSGN",a."AT_RANG",a."AT_EANG",a."STATION_CODE_B",a."FT_FREQ_NO",a."EQU_MB_NAME",a."EQU_MB_CODE0",a."ET_AF_TYPE_NAME",a."ET_AF_TYPE_CODE0",a."ET_EQU_ATYPE_NAME",a."ET_EQU_ATYPE_CODE0",a."ET_EQU_SENU_NAME",a."ET_EQU_SENU_CODE0",a."ET_EQU_SENERR_NAME",a."ET_EQU_SENERR_CODE0",a."EQU_PF_NAME",a."EQU_PF_CODE0",a."ET_POW_U_NAME",a."ET_POW_U_CODE0",a."ET_EQU_UPOW_U_NAME",a."ET_EQU_UPOW_U_CODE0",a."ET_EQU_DPOW_U_NAME",a."ET_EQU_DPOW_U_CODE0",a."ET_EQU_MT_NAME",a."ET_EQU_MT_CODE0",a."ET_EQU_TFCODE" ,
--lm
b.ant_gain,b.ant_gain ||' dBi' bant_gaindesc ,'1' ant_gain_unit
--
from v_rim_rsm_exp_rsbt_equ_r a ,rsbt_antfeed b ,rsbt_antfeed_t t
where a.guid =b.guid(+) and b.guid = t.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_EQU_ANTFEED
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_EQU_ANTFEED" AS 
select a."GUID",a."STATION_GUID",a."EQU_TYPE",a."EQU_MODEL",a."EQU_AUTH",a."EQU_MENU",a."EQU_CODE",a."EQU_PF",a."EQU_MB",a."EQU_POW",a."ET_EQU_PWID2",a."ET_EQU_PUP",a."ET_EQU_SENERR",a."ET_POW_U",a."ET_EQU_PR",a."ET_EQU_TYPE_ID",a."ET_EQU_UPU",a."ET_EQU_CL",a."ET_EQU_FNTVAL",a."ET_EQU_PF",a."ET_EQU_NO",a."ET_EQU_UPOW",a."ET_EQU_CODE",a."ET_EQU_TL",a."ET_EQU_EPOS",a."ET_EQU_APOS",a."ET_EQU_CHRIP",a."ET_EQU_RNQ",a."ET_EQU_NAME",a."ET_EQU_USE",a."ET_EQU_CCODE",a."ET_EIRP",a."ET_EQU_RWID",a."ET_EQU_ESGN",a."ET_EQU_ATYPE",a."ET_EQU_POW_AVG",a."ET_EQU_POW_MAX",a."ET_EQU_DNU",a."ET_AF_TYPE",a."ET_EQU_DPOW",a."ET_EQU_TYPE",a."ET_EQU_SENU",a."ET_EQU_SEN",a."ET_EQU_MT",a."ET_EQU_SUM",a."ET_EQU_PDN",a."ET_EQU_EUSE",a."ET_EQU_PWID1",a."ET_EQU_RF",a."ET_EQU_RF_BAND",a."ET_EQU_SEN_DESC",a."ET_EQU_SEN_TRUE_DESC",a."ET_EQU_SEN_W_DESC",a."ET_EQU_TL_W_V",a."EQU_POW_PF_DESC",a."EQU_POW_DESC",a."EQU_POW_TRUE_DESC",a."ET_EQU_UPOW_DESC",a."ET_EQU_DPOW_DESC",a."ET_EQU_UPOW_V",a."ET_EQU_DPOW_V",a."CINDEX",a."OPTTYPE",a."EQUPAGE",a."AT_CCODE",a."AT_ANG_B",a."AT_ANG_E",a."AT_CSGN",a."AT_RANG",a."AT_EANG",a."STATION_CODE_B",a."FT_FREQ_NO",a."EQU_MB_NAME",a."EQU_MB_CODE0",a."ET_AF_TYPE_NAME",a."ET_AF_TYPE_CODE0",a."ET_EQU_ATYPE_NAME",a."ET_EQU_ATYPE_CODE0",a."ET_EQU_SENU_NAME",a."ET_EQU_SENU_CODE0",a."ET_EQU_SENERR_NAME",a."ET_EQU_SENERR_CODE0",a."EQU_PF_NAME",a."EQU_PF_CODE0",a."ET_POW_U_NAME",a."ET_POW_U_CODE0",a."ET_EQU_UPOW_U_NAME",a."ET_EQU_UPOW_U_CODE0",a."ET_EQU_DPOW_U_NAME",a."ET_EQU_DPOW_U_CODE0",a."ET_EQU_MT_NAME",a."ET_EQU_MT_CODE0",a."ET_EQU_TFCODE" ,
--lm
b.ant_gain,b.ant_gain ||' dBi' bant_gaindesc ,'1' ant_gain_unit
--
from v_rim_rsm_exp_rsbt_equ a ,rsbt_antfeed b ,rsbt_antfeed_t t
where a.guid =b.guid(+) and b.guid = t.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_EQU_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_EQU_FREQ" AS 
select a."GUID",a."STATION_GUID",a."EQU_TYPE",a."EQU_MODEL",a."EQU_AUTH",a."EQU_MENU",a."EQU_CODE",a."EQU_PF",a."EQU_MB",a."EQU_POW",a."ET_EQU_PWID2",a."ET_EQU_PUP",a."ET_EQU_SENERR",a."ET_POW_U",a."ET_EQU_PR",a."ET_EQU_TYPE_ID",a."ET_EQU_UPU",a."ET_EQU_CL",a."ET_EQU_FNTVAL",a."ET_EQU_PF",a."ET_EQU_NO",a."ET_EQU_UPOW",a."ET_EQU_CODE",a."ET_EQU_TL",a."ET_EQU_EPOS",a."ET_EQU_APOS",a."ET_EQU_CHRIP",a."ET_EQU_RNQ",a."ET_EQU_NAME",a."ET_EQU_USE",a."ET_EQU_CCODE",a."ET_EIRP",a."ET_EQU_RWID",a."ET_EQU_ESGN",a."ET_EQU_ATYPE",a."ET_EQU_POW_AVG",a."ET_EQU_POW_MAX",a."ET_EQU_DNU",a."ET_AF_TYPE",a."ET_EQU_DPOW",a."ET_EQU_TYPE",a."ET_EQU_SENU",a."ET_EQU_SEN",a."ET_EQU_MT",a."ET_EQU_SUM",a."ET_EQU_PDN",a."ET_EQU_EUSE",a."ET_EQU_PWID1",a."ET_EQU_RF",a."ET_EQU_RF_BAND",a."ET_EQU_SEN_DESC",a."ET_EQU_SEN_TRUE_DESC",a."ET_EQU_SEN_W_DESC",a."ET_EQU_TL_W_V",a."EQU_POW_PF_DESC",a."EQU_POW_DESC",a."EQU_POW_TRUE_DESC",a."ET_EQU_UPOW_DESC",a."ET_EQU_DPOW_DESC",a."ET_EQU_UPOW_V",a."ET_EQU_DPOW_V",a."CINDEX",a."OPTTYPE",a."EQUPAGE",a."AT_CCODE",a."AT_ANG_B",a."AT_ANG_E",a."AT_CSGN",a."AT_RANG",a."AT_EANG",a."STATION_CODE_B",a."FT_FREQ_NO",a."EQU_MB_NAME",a."EQU_MB_CODE0",a."ET_AF_TYPE_NAME",a."ET_AF_TYPE_CODE0",a."ET_EQU_ATYPE_NAME",a."ET_EQU_ATYPE_CODE0",a."ET_EQU_SENU_NAME",a."ET_EQU_SENU_CODE0",a."ET_EQU_SENERR_NAME",a."ET_EQU_SENERR_CODE0",a."EQU_PF_NAME",a."EQU_PF_CODE0",a."ET_POW_U_NAME",a."ET_POW_U_CODE0",a."ET_EQU_UPOW_U_NAME",a."ET_EQU_UPOW_U_CODE0",a."ET_EQU_DPOW_U_NAME",a."ET_EQU_DPOW_U_CODE0",a."ET_EQU_MT_NAME",a."ET_EQU_MT_CODE0",a."ET_EQU_TFCODE" ,
--s,a
b.FREQ_TYPE,decode(b.FREQ_TYPE,'0','频点','频段') freq_type_name,
decode(FREQ_TYPE,'0', FREQ_LC,'1', decode(FREQ_EFB,null,'', FREQ_EFB )) FREQ_EFB_V ,decode(FREQ_EFE,null,'',FREQ_EFE) FREQ_EFE_V ,
decode(FREQ_TYPE,'0', FREQ_LC,'1', decode(FREQ_EFB,null,'',FREQ_EFB)) || ' MHz' FREQ_EFB_VDesc ,decode(FREQ_EFE,null,'',FREQ_EFE  || ' MHz' )  FREQ_EFE_VDesc
--
from v_rim_rsm_exp_rsbt_equ a , rsbt_freq b
where a.guid =b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_EQU_FREQ_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_EQU_FREQ_R" AS 
select a."GUID",a."STATION_GUID",a."EQU_TYPE",a."EQU_MODEL",a."EQU_AUTH",a."EQU_MENU",a."EQU_CODE",a."EQU_PF",a."EQU_POW",a."EQU_MB",a."ET_EQU_PWID2",a."ET_EQU_PUP",a."ET_EQU_SENERR",a."ET_POW_U",a."ET_EQU_PR",a."ET_EQU_TYPE_ID",a."ET_EQU_UPU",a."ET_EQU_CL",a."ET_EQU_FNTVAL",a."ET_EQU_PF",a."ET_EQU_NO",a."ET_EQU_UPOW",a."ET_EQU_CODE",a."ET_EQU_TL",a."ET_EQU_EPOS",a."ET_EQU_APOS",a."ET_EQU_CHRIP",a."ET_EQU_RNQ",a."ET_EQU_NAME",a."ET_EQU_USE",a."ET_EQU_CCODE",a."ET_EIRP",a."ET_EQU_RWID",a."ET_EQU_ESGN",a."ET_EQU_ATYPE",a."ET_EQU_POW_AVG",a."ET_EQU_POW_MAX",a."ET_EQU_DNU",a."ET_AF_TYPE",a."ET_EQU_DPOW",a."ET_EQU_TYPE",a."ET_EQU_SENU",a."ET_EQU_SEN",a."ET_EQU_MT",a."ET_EQU_SUM",a."ET_EQU_PDN",a."ET_EQU_EUSE",a."ET_EQU_PWID1",a."ET_EQU_RF",a."ET_EQU_RF_BAND",a."ET_EQU_SEN_DESC",a."ET_EQU_SEN_TRUE_DESC",a."ET_EQU_SEN_W_DESC",a."ET_EQU_TL_W_V",a."EQU_POW_PF_DESC",a."EQU_POW_DESC",a."EQU_POW_TRUE_DESC",a."ET_EQU_UPOW_DESC",a."ET_EQU_DPOW_DESC",a."ET_EQU_UPOW_V",a."ET_EQU_DPOW_V",a."CINDEX",a."OPTTYPE",a."EQUPAGE",a."AT_CCODE",a."AT_ANG_B",a."AT_ANG_E",a."AT_CSGN",a."AT_RANG",a."AT_EANG",a."STATION_CODE_B",a."FT_FREQ_NO",a."EQU_MB_NAME",a."EQU_MB_CODE0",a."ET_AF_TYPE_NAME",a."ET_AF_TYPE_CODE0",a."ET_EQU_ATYPE_NAME",a."ET_EQU_ATYPE_CODE0",a."ET_EQU_SENU_NAME",a."ET_EQU_SENU_CODE0",a."ET_EQU_SENERR_NAME",a."ET_EQU_SENERR_CODE0",a."EQU_PF_NAME",a."EQU_PF_CODE0",a."ET_POW_U_NAME",a."ET_POW_U_CODE0",a."ET_EQU_UPOW_U_NAME",a."ET_EQU_UPOW_U_CODE0",a."ET_EQU_DPOW_U_NAME",a."ET_EQU_DPOW_U_CODE0",a."ET_EQU_MT_NAME",a."ET_EQU_MT_CODE0",a."ET_EQU_TFCODE" ,
--s,a
b.FREQ_TYPE,decode(b.FREQ_TYPE,'0','频点','频段') freq_type_name,
decode(FREQ_TYPE,'0', FREQ_LC,'1', decode(FREQ_EFB,null,'', FREQ_EFB )) FREQ_EFB_V ,decode(FREQ_EFE,null,'',FREQ_EFE) FREQ_EFE_V ,
decode(FREQ_TYPE,'0', FREQ_LC,'1', decode(FREQ_EFB,null,'',FREQ_EFB)) || ' MHz' FREQ_EFB_VDesc ,decode(FREQ_EFE,null,'',FREQ_EFE  || ' MHz' )  FREQ_EFE_VDesc
--
from v_rim_rsm_exp_rsbt_equ_r a , rsbt_freq b
where a.guid =b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_EQU_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_EQU_R" AS 
select m."GUID",m."STATION_GUID",m."EQU_TYPE",m."EQU_MODEL",m."EQU_AUTH",m."EQU_MENU",m."EQU_CODE",m."EQU_PF",m."EQU_POW",m."EQU_MB",
--
t.et_equ_pwid2,t.et_equ_pup,t.et_equ_senerr,t.et_pow_u,t.et_equ_pr,t.et_equ_type_id,
t.et_equ_upu,t.et_equ_cl,t.et_equ_fntval,t.et_equ_pf,t.et_equ_no,t.et_equ_upow,
t.et_equ_code,t.et_equ_tl,t.et_equ_epos,t.et_equ_apos,t.et_equ_chrip,t.et_equ_rnq,t.et_equ_name,
t.et_equ_use,t.et_equ_ccode,t.et_eirp,t.et_equ_rwid,t.et_equ_esgn,t.et_equ_atype,
t.et_equ_pow_avg,t.et_equ_pow_max,t.et_equ_dnu,t.et_af_type,t.et_equ_dpow,t.et_equ_type,
t.et_equ_senu,t.et_equ_sen,t.et_equ_mt,t.et_equ_sum,t.et_equ_pdn,t.et_equ_euse,t.et_equ_pwid1,
t.ET_EQU_RF,t.ET_EQU_RF_BAND,
--lm,h,e
decode(ET_EQU_SEN,null,'', ET_EQU_SEN || ' '||ET_EQU_SENU.code_chi_name) ET_EQU_SEN_desc,
decode(ET_EQU_SEN,null,'', ET_EQU_SEN) ET_EQU_SEN_True_desc,
'' ET_EQU_SEN_W_DESC,
--
'' et_equ_tl_W_V,
decode(EQU_PF,null,'Y',EQU_PF)||'-'||f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) ||' '|| NVL(et_pow_unit.code_chi_name,'W') EQU_POW_PF_desc,
f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) ||' '|| NVL(et_pow_unit.code_chi_name,'W') EQU_POW_desc,
f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) EQU_POW_true_desc,
decode(ET_EQU_UPOW,null,'', ET_EQU_UPOW || ' '||ET_EQU_UPOW.code_chi_name) ET_EQU_UPOW_desc,
decode(ET_EQU_DPOW,null,'', ET_EQU_DPOW || ' '||ET_EQU_DPOW.code_chi_name) ET_EQU_DPOW_desc,
'' ET_EQU_UPOW_V,'' ET_EQU_DPOW_V,
--c
'1' Cindex,
--c
'1' opttype,
--c
'1' equpage,
-- c 天线里
'' AT_CCode,'' At_ang_b ,'' At_ang_e,'' AT_CSGN,'' AT_RANG,'' AT_EANG,
'' station_code_b,'' FT_FREQ_NO,
--
EQU_MB.code_chi_name EQU_MB_Name,EQU_MB.Import_Code EQU_MB_code0,
ET_AF_Type.code_chi_name ET_AF_Type_Name,ET_AF_Type.Import_Code ET_AF_Type_code0,
ET_EQU_Atype.code_chi_name ET_EQU_Atype_Name,ET_EQU_Atype.Code1 ET_EQU_Atype_code0,
ET_EQU_SENU.code_chi_name ET_EQU_SENU_Name,ET_EQU_SENU.Import_Code ET_EQU_SENU_code0,
ET_EQU_SENERR.code_chi_name ET_EQU_SENERR_Name,ET_EQU_SENERR.Import_Code ET_EQU_SENERR_code0,
j.code_chi_name EQU_PF_Name,j.Import_Code EQU_PF_code0,
et_pow_unit.code_chi_name ET_POW_U_Name,et_pow_unit.Import_Code ET_POW_U_code0,
ET_EQU_UPOW.code_chi_name ET_EQU_UPOW_U_Name,ET_EQU_UPOW.Import_Code ET_EQU_UPOW_U_code0,
ET_EQU_DPOW.code_chi_name ET_EQU_DPOW_U_Name,ET_EQU_DPOW.Import_Code ET_EQU_DPOW_U_code0,
ET_EQU_MT.code_chi_name ET_EQU_MT_Name ,ET_EQU_MT.Import_Code ET_EQU_MT_code0,t.et_equ_tfcode
from rsbt_equ_r m ,rsbt_equ_t_r t,RSBT_CODE_DIC j,RSBT_CODE_DIC et_pow_unit
 ,RSBT_CODE_DIC EQU_MB ,RSBT_CODE_DIC ET_AF_Type,RSBT_CODE_DIC ET_EQU_Atype
 ,RSBT_CODE_DIC ET_EQU_SENU,RSBT_CODE_DIC ET_EQU_SENERR,RSBT_CODE_DIC ET_EQU_MT,
 RSBT_CODE_DIC ET_EQU_UPOW ,RSBT_CODE_DIC ET_EQU_DPOW
where m.guid = t.guid(+)
and (t.ET_pow_u = et_pow_unit.cn(+) and et_pow_unit.code_data_type(+) = '00282006')
and (m.equ_pf = j.cn(+) and j.code_data_type(+) = '00082006')
and (m.EQU_MB  = EQU_MB.cn(+) and EQU_MB.code_data_type(+) = '00342006')
and (t.ET_AF_Type  = ET_AF_Type.cn(+) and ET_AF_Type.code_data_type(+) = '00392006')
and (t.ET_EQU_Atype  = ET_EQU_Atype.cn(+) and ET_EQU_Atype.code_data_type(+) = '00172006')
and (t.ET_EQU_SENU  = ET_EQU_SENU.cn(+) and ET_EQU_SENU.code_data_type(+) = '00332006')
and (t.ET_EQU_SENERR  = ET_EQU_SENERR.cn(+) and ET_EQU_SENERR.code_data_type(+) = '00482006')
and (t.ET_EQU_UPU  = ET_EQU_UPOW.cn(+) and ET_EQU_UPOW.code_data_type(+) = '00282006')
and (t.ET_EQU_DNU  = ET_EQU_DPOW.cn(+) and ET_EQU_DPOW.code_data_type(+) = '00282006')
and (t.ET_EQU_MT  = ET_EQU_MT.cn(+) and ET_EQU_MT.code_data_type(+) = '00272006');

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_FREQ" AS 
select f."GUID",f."STATION_GUID",f."FREQ_TYPE",f."FREQ_LC",f."FREQ_UC",f."FREQ_EFB",f."FREQ_EFE",f."FREQ_E_BAND",f."FREQ_RFB",f."FREQ_RFE",f."FREQ_R_BAND",f."FREQ_MOD",f."FREQ_MB",f."FREQ_CODE",
t.ft_freq_timee,t.ft_freq_mc2,t.ft_freq_mc,t.ft_freq_type,t.ft_freq_frp,
t.ft_freq_dupdn,t.ft_freq_pow_avg,t.ft_freq_epow,t.ft_freq_hcl,t.ft_freq_pow_max,t.ft_freq_eirp,
t.ft_freq_ccode,t.ft_freq_mc3,t.ft_freq_csgn,t.ft_freq_mc1,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) ft_freq_unit_type,t.ft_freq_powflag,
t.ft_freq_fep,t.ft_freq_info_type,t.ft_freq_no,t.ft_freq_timeb,
--
decode(FREQ_TYPE,'0', FREQ_LC,'1', decode(FREQ_EFB,null,'', FREQ_EFB )) FREQ_EFB_V ,decode(FREQ_EFE,null,'',FREQ_EFE) FREQ_EFE_V ,
decode(FREQ_TYPE,'0', FREQ_UC,'1', decode(FREQ_rFB,null,'',FREQ_rFB)) FREQ_RFB_V,decode(FREQ_RFE,null,'',FREQ_RFE) FREQ_RFE_V,
decode(FREQ_TYPE,'0', FREQ_LC,'1', decode(FREQ_EFB,null,'',FREQ_EFB)) || ' MHz' FREQ_EFB_VDesc ,decode(FREQ_EFE,null,'',FREQ_EFE  || ' MHz' )  FREQ_EFE_VDesc,
decode(FREQ_TYPE,'0', FREQ_UC,'1', decode(FREQ_RFB,null,'',FREQ_RFB)) || ' MHz' FREQ_RFB_VDesc,decode(FREQ_RFE,null,'',FREQ_RFE  || ' MHz')  FREQ_RFE_VDesc,
decode(FREQ_E_Band,null,'', to_char(to_number(FREQ_E_BAND),'fm999999990.0999999')  || ' MHz') band_v,decode(FREQ_R_Band,null,'',  to_char(to_number(FREQ_r_BAND),'fm999999990.0999999') || ' MHz') band_v_R,
--
FT_FREQ_POWFLAG || decode(FT_FREQ_EPOW,null,'', to_char(to_number(FT_FREQ_EPOW),'fm999999990.0999999')) ||'W'  FT_FREQ_POW_desc,
FT_FREQ_POWFLAG || '-' || decode(FT_FREQ_EPOW,null,'', to_char(to_number(FT_FREQ_EPOW),'fm999999990.0999999')) ||' W'  FT_FREQ_POW_PF_desc,
--me
FT_FREQ_MC1  ||'*'||FT_FREQ_MC2||'*'||FT_FREQ_MC3 FT_FREQ_MCDesc,
--b
to_char(ft_freq_timeb,'hh24:mi') ft_freq_timebDes ,to_char(ft_freq_timee,'hh24:mi') ft_freq_timeeDes,
'' FT_FREQ_EIRP_DESC,
--c
'1' Cindex,
--c
'1' opttype,
--c
'1' freqtype,'' equfreqtype,
-- c 天线里
'' AT_CCode,'' At_ang_b ,'' At_ang_e,'' AT_CSGN,'' AT_RANG,'' AT_EANG,
decode(FREQ_TYPE,'0','频点','频段') freq_type_name,
decode(ft_freq_eirp,null,'', ft_freq_eirp ) || ' dBw'  ft_freq_eirpDesc,
decode(FT_FREQ_POW_MAX,null,'', FT_FREQ_POW_MAX ) || ' kW'  FT_FREQ_POW_MAXDesc,
decode(FT_FREQ_POW_AVG,null,'', FT_FREQ_POW_AVG ) || ' W'  FT_FREQ_POW_AVGDesc,
--
g.code_chi_name FREQ_MOD_Name,g.import_code FREQ_MOD_code0,
freq_mod_R.code_chi_name FREQ_MOD_R_Name,freq_mod_R.import_code FREQ_MOD_R_code0,
FREQ_MB.Code_Chi_Name FREQ_MB_Name,FREQ_MB.Import_Code FREQ_MB_code0,
FT_FREQ_INFO_Type.Code_Chi_Name FT_FREQ_INFO_Type_Name,FT_FREQ_INFO_Type.Import_Code FT_FREQ_INFO_Type_code0,
FT_FREQ_Type.Code_Chi_Name FT_FREQ_Type_Name,FT_FREQ_Type.Import_Code FT_FREQ_Type_code0,
FT_FREQ_DUPDN.Code_Chi_Name FT_FREQ_DUPDN_Name,FT_FREQ_DUPDN.Import_Code FT_FREQ_DUPDN_code0,
FT_FREQ_FEP.Code_Chi_Name FT_FREQ_FEP_Name,FT_FREQ_FEP.Import_Code FT_FREQ_FEP_code0,
FT_FREQ_FRP.Code_Chi_Name FT_FREQ_FRP_Name,FT_FREQ_FRP.Import_Code FT_FREQ_FRP_code0,
FT_FREQ_POWFLAG.Code_Chi_Name FT_FREQ_POWFLAG_Name,FT_FREQ_POWFLAG.Import_Code FT_FREQ_POWFLAG_code0,
'' station_code_b,t.ft_freq_tfcode
 from rsbt_freq f ,rsbt_freq_t t,RSBT_CODE_DIC g,RSBT_CODE_DIC c,RSBT_CODE_DIC FT_FREQ_Unit_Type
 ,RSBT_CODE_DIC FREQ_MB ,RSBT_CODE_DIC FT_FREQ_INFO_Type,RSBT_CODE_DIC FT_FREQ_Type,RSBT_CODE_DIC freq_mod_R
 ,RSBT_CODE_DIC FT_FREQ_DUPDN,RSBT_CODE_DIC FT_FREQ_FEP,RSBT_CODE_DIC FT_FREQ_FRP,RSBT_CODE_DIC FT_FREQ_POWFLAG
 where f.guid = t.guid(+)
 and (f.freq_mod = g.cn(+) and   g.code_data_type(+) = '00272006')
 and (f.freq_mod = freq_mod_R.cn(+) and   freq_mod_R.code_data_type(+) = '01012006')
 and (f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)=FT_FREQ_Unit_Type.cn(+) and FT_FREQ_Unit_Type.code_data_type(+)='00292006')
 and (f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)=c.cn(+) and c.code_data_type(+)='00292006')
 and (f.FREQ_MB = FREQ_MB.cn(+) and   FREQ_MB.code_data_type(+) = '00342006')
 and (t.FT_FREQ_INFO_Type = FT_FREQ_INFO_Type.cn(+) and   FT_FREQ_INFO_Type.code_data_type(+) = '00182006')
 and (t.FT_FREQ_Type = FT_FREQ_Type.cn(+) and   FT_FREQ_Type.code_data_type(+) = '00412006')
 and (t.FT_FREQ_DUPDN = FT_FREQ_DUPDN.cn(+) and   FT_FREQ_DUPDN.code_data_type(+) = '00422006')
 and (t.FT_FREQ_FEP = FT_FREQ_FEP.cn(+) and   FT_FREQ_FEP.code_data_type(+) = '00202006')
 and (t.FT_FREQ_FRP = FT_FREQ_FRP.cn(+) and   FT_FREQ_FRP.code_data_type(+) = '00202006')
 and (t.FT_FREQ_POWFLAG = FT_FREQ_POWFLAG.cn(+) and   FT_FREQ_POWFLAG.code_data_type(+) = '00082006');

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_FREQ_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_FREQ_R" AS 
select f."GUID",f."STATION_GUID",f."FREQ_TYPE",f."FREQ_LC",f."FREQ_UC",f."FREQ_EFB",f."FREQ_EFE",f."FREQ_E_BAND",f."FREQ_RFB",f."FREQ_RFE",f."FREQ_R_BAND",f."FREQ_MOD",f."FREQ_MB",f."FREQ_CODE",
t.ft_freq_timee,t.ft_freq_mc2,t.ft_freq_mc,t.ft_freq_type,t.ft_freq_frp,
t.ft_freq_dupdn,t.ft_freq_pow_avg,t.ft_freq_epow,t.ft_freq_hcl,t.ft_freq_pow_max,t.ft_freq_eirp,
t.ft_freq_ccode,t.ft_freq_mc3,t.ft_freq_csgn,t.ft_freq_mc1,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) ft_freq_unit_type,t.ft_freq_powflag,
t.ft_freq_fep,t.ft_freq_info_type,t.ft_freq_no,t.ft_freq_timeb,
--
decode(FREQ_TYPE,'0', FREQ_LC,'1', decode(FREQ_EFB,null,'', FREQ_EFB )) FREQ_EFB_V ,decode(FREQ_EFE,null,'',FREQ_EFE) FREQ_EFE_V ,
decode(FREQ_TYPE,'0', FREQ_UC,'1', decode(FREQ_rFB,null,'',FREQ_rFB)) FREQ_RFB_V,decode(FREQ_RFE,null,'',FREQ_RFE) FREQ_RFE_V,
decode(FREQ_TYPE,'0', FREQ_LC,'1', decode(FREQ_EFB,null,'',FREQ_EFB)) || ' MHz' FREQ_EFB_VDesc ,decode(FREQ_EFE,null,'',FREQ_EFE  || ' MHz' )  FREQ_EFE_VDesc,
decode(FREQ_TYPE,'0', FREQ_UC,'1', decode(FREQ_RFB,null,'',FREQ_RFB)) || ' MHz' FREQ_RFB_VDesc,decode(FREQ_RFE,null,'',FREQ_RFE  || ' MHz')  FREQ_RFE_VDesc,
decode(FREQ_E_Band,null,'', to_char(to_number(FREQ_E_BAND),'fm999999990.0999999')  || ' MHz') band_v,decode(FREQ_R_Band,null,'',  to_char(to_number(FREQ_r_BAND),'fm999999990.0999999') || ' MHz') band_v_R,
--
FT_FREQ_POWFLAG || decode(FT_FREQ_EPOW,null,'', to_char(to_number(FT_FREQ_EPOW),'fm999999990.0999999')) ||'W'  FT_FREQ_POW_desc,
FT_FREQ_POWFLAG || '-' || decode(FT_FREQ_EPOW,null,'', to_char(to_number(FT_FREQ_EPOW),'fm999999990.0999999')) ||' W'  FT_FREQ_POW_PF_desc,
--me
FT_FREQ_MC1  ||'*'||FT_FREQ_MC2||'*'||FT_FREQ_MC3 FT_FREQ_MCDesc,
--b
to_char(ft_freq_timeb,'hh24:mi') ft_freq_timebDes ,to_char(ft_freq_timee,'hh24:mi') ft_freq_timeeDes,
'' FT_FREQ_EIRP_DESC,
--c
'1' Cindex,
--c
'1' opttype,
--c
'1' freqtype,'' equfreqtype,
-- c 天线里
'' AT_CCode,'' At_ang_b ,'' At_ang_e,'' AT_CSGN,'' AT_RANG,'' AT_EANG,
decode(FREQ_TYPE,'0','频点','频段') freq_type_name,
decode(ft_freq_eirp,null,'', ft_freq_eirp ) || ' dBw'  ft_freq_eirpDesc,
decode(FT_FREQ_POW_MAX,null,'', FT_FREQ_POW_MAX ) || ' kW'  FT_FREQ_POW_MAXDesc,
decode(FT_FREQ_POW_AVG,null,'', FT_FREQ_POW_AVG ) || ' W'  FT_FREQ_POW_AVGDesc,
--
g.code_chi_name FREQ_MOD_Name,g.import_code FREQ_MOD_code0,
freq_mod_R.code_chi_name FREQ_MOD_R_Name,freq_mod_R.import_code FREQ_MOD_R_code0,
FREQ_MB.Code_Chi_Name FREQ_MB_Name,FREQ_MB.Import_Code FREQ_MB_code0,
FT_FREQ_INFO_Type.Code_Chi_Name FT_FREQ_INFO_Type_Name,FT_FREQ_INFO_Type.Import_Code FT_FREQ_INFO_Type_code0,
FT_FREQ_Type.Code_Chi_Name FT_FREQ_Type_Name,FT_FREQ_Type.Import_Code FT_FREQ_Type_code0,
FT_FREQ_DUPDN.Code_Chi_Name FT_FREQ_DUPDN_Name,FT_FREQ_DUPDN.Import_Code FT_FREQ_DUPDN_code0,
FT_FREQ_FEP.Code_Chi_Name FT_FREQ_FEP_Name,FT_FREQ_FEP.Import_Code FT_FREQ_FEP_code0,
FT_FREQ_FRP.Code_Chi_Name FT_FREQ_FRP_Name,FT_FREQ_FRP.Import_Code FT_FREQ_FRP_code0,
FT_FREQ_POWFLAG.Code_Chi_Name FT_FREQ_POWFLAG_Name,FT_FREQ_POWFLAG.Import_Code FT_FREQ_POWFLAG_code0,
'' station_code_b,t.ft_freq_tfcode
 from rsbt_freq_r f ,rsbt_freq_t_r t,RSBT_CODE_DIC g,RSBT_CODE_DIC c,RSBT_CODE_DIC FT_FREQ_Unit_Type
 ,RSBT_CODE_DIC FREQ_MB ,RSBT_CODE_DIC FT_FREQ_INFO_Type,RSBT_CODE_DIC FT_FREQ_Type,RSBT_CODE_DIC freq_mod_R
 ,RSBT_CODE_DIC FT_FREQ_DUPDN,RSBT_CODE_DIC FT_FREQ_FEP,RSBT_CODE_DIC FT_FREQ_FRP,RSBT_CODE_DIC FT_FREQ_POWFLAG
 where f.guid = t.guid(+)
 and (f.freq_mod = g.cn(+) and   g.code_data_type(+) = '00272006')
 and (f.freq_mod = freq_mod_R.cn(+) and   freq_mod_R.code_data_type(+) = '01012006')
 and (f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)=FT_FREQ_Unit_Type.cn(+) and FT_FREQ_Unit_Type.code_data_type(+)='00292006')
 and (f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)=c.cn(+) and c.code_data_type(+)='00292006')
 and (f.FREQ_MB = FREQ_MB.cn(+) and   FREQ_MB.code_data_type(+) = '00342006')
 and (t.FT_FREQ_INFO_Type = FT_FREQ_INFO_Type.cn(+) and   FT_FREQ_INFO_Type.code_data_type(+) = '00182006')
 and (t.FT_FREQ_Type = FT_FREQ_Type.cn(+) and   FT_FREQ_Type.code_data_type(+) = '00412006')
 and (t.FT_FREQ_DUPDN = FT_FREQ_DUPDN.cn(+) and   FT_FREQ_DUPDN.code_data_type(+) = '00422006')
 and (t.FT_FREQ_FEP = FT_FREQ_FEP.cn(+) and   FT_FREQ_FEP.code_data_type(+) = '00202006')
 and (t.FT_FREQ_FRP = FT_FREQ_FRP.cn(+) and   FT_FREQ_FRP.code_data_type(+) = '00202006')
 and (t.FT_FREQ_POWFLAG = FT_FREQ_POWFLAG.cn(+) and   FT_FREQ_POWFLAG.code_data_type(+) = '00082006');

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_NET
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_NET" AS 
select  'RSBT_NET' as tablename ,'1' as opttype,
a."GUID",a."ORG_GUID",a."FEE_GUID",a."ORG_CODE",a."NET_NAME",a."NET_SVN",a."NET_SP",a."NET_TS",a."NET_BAND",a."NET_AREA",a."NET_USE",a."NET_SAT_NAME",a."NET_LG",a."NET_START_DATE",a."NET_CONFIRM_DATE",a."NET_EXPIRED_DATE",
d.code_chi_name net_svn_name,d.import_code net_svn_code,
e.code_chi_name as net_sp_name,e.import_code net_sp_code,
f.code_chi_name as net_ts_name,f.import_code net_ts_code,
g.code_chi_name as net_area_name
from rsbt_net A,RSBT_CODE_DIC d,RSBT_CODE_DIC e ,RSBT_CODE_DIC f,RSBT_CODE_DIC g
where  (a.net_svn = d.cn(+) and d.code_data_type(+) = '00452006')
and (a.net_sp = e.cn(+) and e.code_data_type(+) = '00002006')
and (a.net_ts=f.cn(+) and f.code_data_type(+) = '00012006')
and (a.net_area = g.cn(+) and g.code_data_type(+) = '00022006');

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_NET_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_NET_R" AS 
select  'RSBT_NET' as tablename ,'1' as opttype,
a."GUID",a."ORG_GUID",a."FEE_GUID",a."ORG_CODE",a."NET_NAME",a."NET_SVN",a."NET_SP",a."NET_TS",a."NET_BAND",a."NET_AREA",a."NET_USE",a."NET_SAT_NAME",a."NET_LG",a."NET_START_DATE",a."NET_CONFIRM_DATE",a."NET_EXPIRED_DATE",
d.code_chi_name net_svn_name,d.import_code net_svn_code,
e.code_chi_name as net_sp_name,e.import_code net_sp_code,
f.code_chi_name as net_ts_name,f.import_code net_ts_code,
g.code_chi_name as net_area_name
from rsbt_net_r A,RSBT_CODE_DIC d,RSBT_CODE_DIC e ,RSBT_CODE_DIC f,RSBT_CODE_DIC g
where  (a.net_svn = d.cn(+) and d.code_data_type(+) = '00452006')
and (a.net_sp = e.cn(+) and e.code_data_type(+) = '00002006')
and (a.net_ts=f.cn(+) and f.code_data_type(+) = '00012006')
and (a.net_area = g.cn(+) and g.code_data_type(+) = '00022006');

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_ORG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_ORG" AS 
select 'RSBT_ORG' as tablename,'1' as opttype ,
a."GUID",a."ORG_CODE",a."ORG_NAME",a."ORG_AREA_CODE",a."ORG_SYS_CODE",a."ORG_TYPE",a."ORG_LINK_PERSON",a."ORG_PERSON_ID",a."ORG_SUP_CODE",a."ORG_ADDR",a."ORG_POST",a."ORG_PHONE",a."ORG_MOB_PHONE",a."ORG_FAX",a."ORG_BANK",a."ORG_ACCOUNT_NAME",a."ORG_ACCOUNT",a."ORG_HOSTILITY",a."ORG_WEB_SITE",a."ORG_MAIL" ,
d.code_chi_name org_sys_code_name,d.import_code org_sys_code1
from RSBT_ORG a ,RSBT_CODE_DIC d
where (a.org_sys_code = d.cn(+) and d.code_data_type(+) = '00092006');

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_STATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_STATION" AS 
select a."GUID",a."NET_GUID",a."ORG_CODE",a."APP_CODE",a."STAT_APP_TYPE",a."STAT_TDI",a."STAT_NAME",a."STAT_ADDR",a."STAT_AREA_CODE",a."STAT_TYPE",a."STAT_WORK",a."STAT_STATUS",a."STAT_EQU_SUM",a."STAT_LG",a."STAT_LA",a."STAT_AT",a."STAT_DATE_START",a."MEMO",
   f.st_r_emin,f.st_e_pos,f.st_me_sta2,f.st_lmmtr,f.st_a_st,f.st_me_name1,f.st_tf_trans_ca_p,f.st_b_ic,
   f.st_e_com_area,f.st_me_lg2,f.st_me_lg1,f.st_s_cs,f.st_d_type,f.st_s_mmsi,f.st_b_type2,f.st_pos_type,f.st_b_type1,
   f.st_me_fband,f.st_time_e,f.st_c_sum,f.st_a_nrm,f.st_e_sat,f.st_s_t,f.st_a_call_oi,f.st_r_wamin,
   f.st_s_p,f.st_a_call,f.st_me_file_no,f.st_a_piloting,f.st_call_sign,f.st_a_model,f.st_r_emax,
   f.st_b_edu,f.st_s_pn,f.st_me_sta3,f.st_me_sta1,f.st_a_type,f.st_e_net_code,f.st_time_b,f.st_e_multi_addr,
   f.st_e_lg,f.st_ship_name,f.st_tf_code,f.st_b_sgn,f.ST_B_Level,f.st_b_bm,f.st_ship_type,
   f.st_me_sat_name,f.st_c_code,f.st_serv_r,f.st_d_tec_type,f.st_b_cover_area,
   f.st_s_aaic,f.st_user_area,f.st_me_stype,f.st_tf_trans_ca_pu,
   f.st_r_wamax,f.st_a_sgn,f.st_me_name2,
   --h
   to_char(st_time_b,'hh24:mi') st_time_bDes ,to_char(st_time_e,'hh24:mi') st_time_eDes,
   to_char(st_time_b,'hh24') st_time_bDes1 , to_char(st_time_b,'mi') st_time_bDes2 ,
   to_char(st_time_e,'hh24') st_time_eDes1,   to_char(st_time_e,'mi') st_time_eDes2,
   '' obj_type , '' OBJ_NAME,'' OBJ_TDI1,'' OBJ_TDI2,'' OBJ_TDI3,'' OBJ_TDI4,'' OBJ_TDI5,'' OBJ_TDI6,'' OBJ_TDI7,'' OBJ_TDI8,
   --
  decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE0,
  decode(length(app_code) ,14,substr(app_code,3),  substr(app_code,2)) tapp_code,
  '1' opttype,
  --lm
  '1' FREQ_TYPE,
  to_char(stat_date_start,'yyyy-MM-dd') as stat_date_startDes,
  --
  e.code_chi_name stat_work_Name,e.import_code stat_work_code0,
  stat_work_e.code_chi_name stat_work_e_Name,stat_work_e.import_code stat_work_e_code0,
  g.code_chi_name stat_statusDes ,g.import_code stat_status_code0,
  d.code_chi_name stat_typeDes, d.import_code stat_type_code0,
  LMMTR.CODE_CHI_NAME ST_LMMTR_Name,LMMTR.Import_Code ST_LMMTR_code0,
  MULTI_Addr.CODE_CHI_NAME  ST_E_MULTI_Addr_Name,MULTI_Addr.Import_Code ST_E_MULTI_Addr_code0,
  E_COM_Area.CODE_CHI_NAME ST_E_COM_Area_Name,E_COM_Area.Import_Code ST_E_COM_Area_code0,
  POS_Type.CODE_CHI_NAME ST_POS_Type_Name,POS_Type.Import_Code ST_POS_Type_code0,
  B_level.CODE_CHI_NAME ST_B_Level_Name,B_level.Import_Code ST_B_Level_code0,
  ST_B_BM.CODE_CHI_NAME ST_B_BM_Name,ST_B_BM.Import_Code ST_B_BM_code0,
  ST_B_EDU.CODE_CHI_NAME ST_B_EDU_Name,ST_B_EDU.Import_Code ST_B_EDU_code0,
  B_IC.CODE_CHI_NAME ST_B_IC_Name,B_IC.Import_Code ST_B_IC_code0,
  Ship_Type.CODE_CHI_NAME ST_Ship_Type_Name,Ship_Type.Import_Code ST_Ship_Type_code0,
  ST_A_Type.CODE_CHI_NAME ST_A_Type_Name,ST_A_Type.Import_Code ST_A_Type_code0,
  ST_A_Call.CODE_CHI_NAME ST_A_Call_Name,ST_A_Call.Import_Code ST_A_Call_code0,
  ST_A_Piloting.CODE_CHI_NAME ST_A_Piloting_Name,ST_A_Piloting.Import_Code ST_A_Piloting_code0,
  ST_D_TEC_Type.CODE_CHI_NAME  ST_D_TEC_Type_Name,ST_D_TEC_Type.Import_Code ST_D_TEC_Type_code0,
  ST_D_Type.CODE_CHI_NAME   ST_D_Type_Name,ST_D_Type.Import_Code ST_D_Type_code0,
  ST_ME_Stype.CODE_CHI_NAME   ST_ME_Stype_Name,ST_ME_Stype.Import_Code ST_ME_Stype_code0,
  ST_B_TYPE2.CODE_CHI_NAME ST_B_TYPE2_Name,ST_B_TYPE2.Import_Code ST_B_TYPE2_code0,
  ST_B_TYPE1.CODE_CHI_NAME ST_B_TYPE1_Name,ST_B_TYPE1.Import_Code ST_B_TYPE1_code0
from rsbt_station a ,rsbt_station_t f ,RSBT_CODE_DIC d ,RSBT_CODE_DIC e , RSBT_CODE_DIC g,
   RSBT_CODE_DIC LMMTR, RSBT_CODE_DIC MULTI_Addr,RSBT_CODE_DIC E_COM_Area,
   RSBT_CODE_DIC POS_Type, RSBT_CODE_DIC B_level, RSBT_CODE_DIC ST_B_BM,
   RSBT_CODE_DIC ST_B_EDU, RSBT_CODE_DIC B_IC, RSBT_CODE_DIC Ship_Type,
   RSBT_CODE_DIC ST_A_Type , RSBT_CODE_DIC ST_A_Call, RSBT_CODE_DIC ST_A_Piloting,
   RSBT_CODE_DIC ST_D_TEC_Type , RSBT_CODE_DIC ST_D_Type , RSBT_CODE_DIC ST_ME_Stype,
   RSBT_CODE_DIC ST_B_TYPE2 , RSBT_CODE_DIC ST_B_TYPE1 ,RSBT_CODE_DIC stat_work_e
 where   a.guid = f.guid(+)
 and (a.stat_type = d.cn(+) and d.code_data_type(+) = '00052006')
 and (a.stat_work = e.cn(+) and e.code_data_type(+) = '00062006')
 and (a.stat_work = stat_work_e.cn(+) and stat_work_e.code_data_type(+) = '00382006')
 and (a.stat_status = g.cn(+) and g.code_data_type(+) = '00072006')
 and (f.ST_LMMTR = LMMTR.cn(+) and LMMTR.code_data_type(+) = '00392006')
 and (f.ST_E_MULTI_Addr = MULTI_Addr.cn(+) and MULTI_Addr.code_data_type(+) = '00122006')
 and (f.ST_E_COM_Area = E_COM_Area.cn(+) and E_COM_Area.code_data_type(+) = '00362006')
 and (f.ST_POS_Type = POS_Type.cn(+) and POS_Type.code_data_type(+) = '00352006')
 and (f.ST_B_Level = B_level.cn(+) and B_level.code_data_type(+) = '00132006')
 and (f.ST_B_BM = ST_B_BM.cn(+) and ST_B_BM.code_data_type(+) = '00142006')
 and (f.ST_B_EDU = ST_B_EDU.cn(+) and ST_B_EDU.code_data_type(+) = '00392006')
 and (f.ST_B_IC = B_IC.cn(+) and B_IC.code_data_type(+) = '00392006')
 and (f.ST_Ship_Type = Ship_Type.cn(+) and Ship_Type.code_data_type(+) = '00152006')
 and (f.ST_A_Type = ST_A_Type.cn(+) and ST_A_Type.code_data_type(+) = '00162006')
 and (f.ST_A_Call = ST_A_Call.cn(+) and ST_A_Call.code_data_type(+) = '00372006')
 and (f.ST_A_Piloting = ST_A_Piloting.cn(+) and ST_A_Piloting.code_data_type(+) = '00392006')
 and (f.ST_D_TEC_Type = ST_D_TEC_Type.cn(+) and ST_D_TEC_Type.code_data_type(+) = '00012006')
 and (f.ST_D_Type = ST_D_Type.cn(+) and ST_D_Type.code_data_type(+) = '00422006')
 and (f.ST_ME_Stype = ST_ME_Stype.cn(+) and ST_ME_Stype.code_data_type(+) = '00432006')
 and (f.ST_B_TYPE2 = ST_B_TYPE2.cn(+) and ST_B_TYPE2.code_data_type(+) = '00132006')
 and (f.ST_B_TYPE1 = ST_B_TYPE1.cn(+) and ST_B_TYPE1.code_data_type(+) = '00462006');

-- ----------------------------
-- View structure for V_RIM_RSM_EXP_RSBT_STATION_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_EXP_RSBT_STATION_R" AS 
select a."GUID",a."NET_GUID",a."ORG_CODE",a."APP_CODE",a."STAT_APP_TYPE",a."STAT_TDI",a."STAT_NAME",a."STAT_ADDR",a."STAT_AREA_CODE",a."STAT_TYPE",a."STAT_WORK",a."STAT_STATUS",a."STAT_EQU_SUM",a."STAT_LG",a."STAT_LA",a."STAT_AT",a."STAT_DATE_START",a."MEMO",
   f.st_r_emin,f.st_e_pos,f.st_me_sta2,f.st_lmmtr,f.st_a_st,f.st_me_name1,f.st_tf_trans_ca_p,f.st_b_ic,
   f.st_e_com_area,f.st_me_lg2,f.st_me_lg1,f.st_s_cs,f.st_d_type,f.st_s_mmsi,f.st_b_type2,f.st_pos_type,f.st_b_type1,
   f.st_me_fband,f.st_time_e,f.st_c_sum,f.st_a_nrm,f.st_e_sat,f.st_s_t,f.st_a_call_oi,f.st_r_wamin,
   f.st_s_p,f.st_a_call,f.st_me_file_no,f.st_a_piloting,f.st_call_sign,f.st_a_model,f.st_r_emax,
   f.st_b_edu,f.st_s_pn,f.st_me_sta3,f.st_me_sta1,f.st_a_type,f.st_e_net_code,f.st_time_b,f.st_e_multi_addr,
   f.st_e_lg,f.st_ship_name,f.st_tf_code,f.st_b_sgn,f.ST_B_Level,f.st_b_bm,f.st_ship_type,
   f.st_me_sat_name,f.st_c_code,f.st_serv_r,f.st_d_tec_type,f.st_b_cover_area,
   f.st_s_aaic,f.st_user_area,f.st_me_stype,f.st_tf_trans_ca_pu,
   f.st_r_wamax,f.st_a_sgn,f.st_me_name2,
   --h
   to_char(st_time_b,'hh24:mi') st_time_bDes ,to_char(st_time_e,'hh24:mi') st_time_eDes,
   to_char(st_time_b,'hh24') st_time_bDes1 , to_char(st_time_b,'mi') st_time_bDes2 ,
   to_char(st_time_e,'hh24') st_time_eDes1,   to_char(st_time_e,'mi') st_time_eDes2,
   '' obj_type , '' OBJ_NAME,'' OBJ_TDI1,'' OBJ_TDI2,'' OBJ_TDI3,'' OBJ_TDI4,'' OBJ_TDI5,'' OBJ_TDI6,'' OBJ_TDI7,'' OBJ_TDI8,
   --
  decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE0,
  decode(length(app_code) ,14,substr(app_code,3),  substr(app_code,2)) tapp_code,
  '1' opttype,
  --lm
  '1' FREQ_TYPE,
  to_char(stat_date_start,'yyyy-MM-dd') as stat_date_startDes,
  --
  e.code_chi_name stat_work_Name,e.import_code stat_work_code0,
  stat_work_e.code_chi_name stat_work_e_Name,stat_work_e.import_code stat_work_e_code0,
  g.code_chi_name stat_statusDes ,g.import_code stat_status_code0,
  d.code_chi_name stat_typeDes, d.import_code stat_type_code0,
  LMMTR.CODE_CHI_NAME ST_LMMTR_Name,LMMTR.Import_Code ST_LMMTR_code0,
  MULTI_Addr.CODE_CHI_NAME  ST_E_MULTI_Addr_Name,MULTI_Addr.Import_Code ST_E_MULTI_Addr_code0,
  E_COM_Area.CODE_CHI_NAME ST_E_COM_Area_Name,E_COM_Area.Import_Code ST_E_COM_Area_code0,
  POS_Type.CODE_CHI_NAME ST_POS_Type_Name,POS_Type.Import_Code ST_POS_Type_code0,
  B_level.CODE_CHI_NAME ST_B_Level_Name,B_level.Import_Code ST_B_Level_code0,
  ST_B_BM.CODE_CHI_NAME ST_B_BM_Name,ST_B_BM.Import_Code ST_B_BM_code0,
  ST_B_EDU.CODE_CHI_NAME ST_B_EDU_Name,ST_B_EDU.Import_Code ST_B_EDU_code0,
  B_IC.CODE_CHI_NAME ST_B_IC_Name,B_IC.Import_Code ST_B_IC_code0,
  Ship_Type.CODE_CHI_NAME ST_Ship_Type_Name,Ship_Type.Import_Code ST_Ship_Type_code0,
  ST_A_Type.CODE_CHI_NAME ST_A_Type_Name,ST_A_Type.Import_Code ST_A_Type_code0,
  ST_A_Call.CODE_CHI_NAME ST_A_Call_Name,ST_A_Call.Import_Code ST_A_Call_code0,
  ST_A_Piloting.CODE_CHI_NAME ST_A_Piloting_Name,ST_A_Piloting.Import_Code ST_A_Piloting_code0,
  ST_D_TEC_Type.CODE_CHI_NAME  ST_D_TEC_Type_Name,ST_D_TEC_Type.Import_Code ST_D_TEC_Type_code0,
  ST_D_Type.CODE_CHI_NAME   ST_D_Type_Name,ST_D_Type.Import_Code ST_D_Type_code0,
  ST_ME_Stype.CODE_CHI_NAME   ST_ME_Stype_Name,ST_ME_Stype.Import_Code ST_ME_Stype_code0,
  ST_B_TYPE2.CODE_CHI_NAME ST_B_TYPE2_Name,ST_B_TYPE2.Import_Code ST_B_TYPE2_code0,
  ST_B_TYPE1.CODE_CHI_NAME ST_B_TYPE1_Name,ST_B_TYPE1.Import_Code ST_B_TYPE1_code0
from rsbt_station_r a ,rsbt_station_t_r f ,RSBT_CODE_DIC d ,RSBT_CODE_DIC e , RSBT_CODE_DIC g,
   RSBT_CODE_DIC LMMTR, RSBT_CODE_DIC MULTI_Addr,RSBT_CODE_DIC E_COM_Area,
   RSBT_CODE_DIC POS_Type, RSBT_CODE_DIC B_level, RSBT_CODE_DIC ST_B_BM,
   RSBT_CODE_DIC ST_B_EDU, RSBT_CODE_DIC B_IC, RSBT_CODE_DIC Ship_Type,
   RSBT_CODE_DIC ST_A_Type , RSBT_CODE_DIC ST_A_Call, RSBT_CODE_DIC ST_A_Piloting,
   RSBT_CODE_DIC ST_D_TEC_Type , RSBT_CODE_DIC ST_D_Type , RSBT_CODE_DIC ST_ME_Stype,
   RSBT_CODE_DIC ST_B_TYPE2 , RSBT_CODE_DIC ST_B_TYPE1 ,RSBT_CODE_DIC stat_work_e
 where   a.guid = f.guid(+)
 and (a.stat_type = d.cn(+) and d.code_data_type(+) = '00052006')
 and (a.stat_work = e.cn(+) and e.code_data_type(+) = '00062006')
 and (a.stat_work = stat_work_e.cn(+) and stat_work_e.code_data_type(+) = '00382006')
 and (a.stat_status = g.cn(+) and g.code_data_type(+) = '00072006')
 and (f.ST_LMMTR = LMMTR.cn(+) and LMMTR.code_data_type(+) = '00392006')
 and (f.ST_E_MULTI_Addr = MULTI_Addr.cn(+) and MULTI_Addr.code_data_type(+) = '00122006')
 and (f.ST_E_COM_Area = E_COM_Area.cn(+) and E_COM_Area.code_data_type(+) = '00362006')
 and (f.ST_POS_Type = POS_Type.cn(+) and POS_Type.code_data_type(+) = '00352006')
 and (f.ST_B_Level = B_level.cn(+) and B_level.code_data_type(+) = '00132006')
 and (f.ST_B_BM = ST_B_BM.cn(+) and ST_B_BM.code_data_type(+) = '00142006')
 and (f.ST_B_EDU = ST_B_EDU.cn(+) and ST_B_EDU.code_data_type(+) = '00392006')
 and (f.ST_B_IC = B_IC.cn(+) and B_IC.code_data_type(+) = '00392006')
 and (f.ST_Ship_Type = Ship_Type.cn(+) and Ship_Type.code_data_type(+) = '00152006')
 and (f.ST_A_Type = ST_A_Type.cn(+) and ST_A_Type.code_data_type(+) = '00162006')
 and (f.ST_A_Call = ST_A_Call.cn(+) and ST_A_Call.code_data_type(+) = '00372006')
 and (f.ST_A_Piloting = ST_A_Piloting.cn(+) and ST_A_Piloting.code_data_type(+) = '00392006')
 and (f.ST_D_TEC_Type = ST_D_TEC_Type.cn(+) and ST_D_TEC_Type.code_data_type(+) = '00012006')
 and (f.ST_D_Type = ST_D_Type.cn(+) and ST_D_Type.code_data_type(+) = '00422006')
 and (f.ST_ME_Stype = ST_ME_Stype.cn(+) and ST_ME_Stype.code_data_type(+) = '00432006')
 and (f.ST_B_TYPE2 = ST_B_TYPE2.cn(+) and ST_B_TYPE2.code_data_type(+) = '00132006')
 and (f.ST_B_TYPE1 = ST_B_TYPE1.cn(+) and ST_B_TYPE1.code_data_type(+) = '00462006');

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_450M
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_450M" AS 
select
    --------年度【无线接入450MHZ频段】
    substr(b.app_code,-12,12) apply_code,
    decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
		decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
		b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
		to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
		to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
		nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_EFB,FREQ_LC),0) freq_emit,
		nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_RFB,FREQ_UC),0) freq_rece,
		nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
	from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
	where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
         and substr(b.app_code,1,length(b.app_code)-12)='T'
		     and ( b.STAT_APP_Type='C' OR b.STAT_APP_Type='V' OR b.STAT_APP_Type='TF' )
         AND B.STAT_Status=1 AND ( NET_ts='GD0410' AND NET_SVN='GD04' )
         /*
         通信业务/系统类型*-----固定业务_无线接入通信系统----GD04
          技术体制----- 450MHz FDD调频---GD0410
         */
         AND nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_450M_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_450M_APPLY" AS 
select
    ----新台【无线接入450MHZ频段】
    b.app_code as apply_code,
    decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_EFB,FREQ_LC),0) freq_emit,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_RFB,FREQ_UC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
         and substr(b.app_code,1,length(b.app_code)-12)='T'
         and (b.STAT_APP_Type='C' OR b.STAT_APP_Type='V' OR b.STAT_APP_Type='TF')
         and B.STAT_Status=1 AND (NET_TS='GD0410' AND NET_SVN='GD04')
          /*
         通信业务/系统类型*-----固定业务_无线接入通信系统----GD04
          技术体制----- 450MHz FDD调频---GD0410
         */
           and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_A
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_A" AS 
select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(Fee_Derate_Proportion,0)*100 derate,ST_A_Type,nvl(ST_A_ST,0) tonnage,a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and b.guid=c.guid(+) and B.STAT_Status=1
         and substr(b.app_code,1,length(b.app_code)-12)='T'
         and b.STAT_APP_Type='A' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_A_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_A_APPLY" AS 
select
   ----新台【航空器电台】
   substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(Fee_Derate_Proportion,0)*100 derate,ST_A_Type,nvl(ST_A_ST,0) tonnage,a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and b.guid=c.guid(+) and B.STAT_Status=1
         and substr(b.app_code,1,length(b.app_code)-12)='T'
         and b.STAT_APP_Type='A' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_BC
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_BC" AS 
select
    -------广播电台【年度】
    substr(b.app_code,-12,12) apply_code,
    decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    decode(e.ST_B_Level,'1','GJ','2','SJ','3','CJ','XJ') net_range,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    decode(f_rim_rsm_GETFREQ_freq_Unit(FREQ_UC,FREQ_LC,FREQ_EFB,FREQ_RFB),'2',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)/1000)||' GHz','0',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)*1000)||' KHz',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0))||' MHz') freq_note,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_STATION_T e
  where a.GUID=b.NET_GUID and b.GUID=e.GUID  and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+)
         and substr(b.app_code,1,length(b.app_code)-12)='T'
         and b.STAT_APP_Type='B' and B.STAT_Status=1 and e.st_b_type1='0' and nvl(e.ST_B_IC,'0')='0' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_BC_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_BC_APPLY" AS 
select
   ----广播电台【新台】
     substr(b.app_code,-12,12) apply_code,
    decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    decode(e.ST_B_Level,'1','GJ','2','SJ','3','CJ','XJ') net_range,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    decode(f_rim_rsm_GETFREQ_freq_Unit(FREQ_UC,FREQ_LC,FREQ_EFB,FREQ_RFB),'2',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)/1000)||' GHz','0',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)*1000)||' KHz',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0))||' MHz') freq_note,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_STATION_T e
  where a.GUID=b.NET_GUID and b.GUID=e.GUID  and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+)
         and substr(b.app_code,1,length(b.app_code)-12)='T'
         and b.STAT_APP_Type='B' and B.STAT_Status=1 and e.st_b_type1='0' and nvl(e.ST_B_IC,'0')='0' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_BT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_BT" AS 
select
    -------年度【电视】
    substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    decode(f.ST_B_Level,'1','GJ','2','SJ','3','CJ','XJ') net_range,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    decode(f_rim_rsm_GETFREQ_freq_Unit(FREQ_UC,FREQ_LC,FREQ_EFB,FREQ_RFB),'2',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)/1000)||' GHz','0',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)*1000)||' KHz',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0))||' MHz') freq_note,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e,RSBT_STATION_T f
  where a.GUID=b.NET_GUID and b.GUID=f.GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and b.STAT_APP_Type='B' and B.STAT_Status=1 and f.st_b_type1='1' and nvl(f.ST_B_IC,'0')='0' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_BT_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_BT_APPLY" AS 
select
   ---新台【电视】
   substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    decode(f.ST_B_Level,'1','GJ','2','SJ','3','CJ','XJ') net_range,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    decode(f_rim_rsm_GETFREQ_freq_Unit(FREQ_UC,FREQ_LC,FREQ_EFB,FREQ_RFB),'2',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)/1000)||' GHz','0',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)*1000)||' KHz',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0))||' MHz') freq_note,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e,RSBT_STATION_T f
  where a.GUID=b.NET_GUID and b.GUID=f.GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and b.STAT_APP_Type='B' and B.STAT_Status=1 and f.st_b_type1='1' and nvl(f.ST_B_IC,'0')='0' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_DATA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_DATA" AS 
select
    --------年度台站计费【无线数据频段】
    substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
         and substr(b.app_code,1,length(b.app_code)-12)='T'
          and ( b.STAT_APP_Type ='TF' OR b.STAT_APP_Type ='V' )  and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100
           AND a.NET_SVN='LY05';

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_DATA_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_DATA_APPLY" AS 
select
    ----新台【无线数据频段】
    substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
         and substr(b.app_code,1,length(b.app_code)-12)='T'
          and ( b.STAT_APP_Type ='TF' OR b.STAT_APP_Type ='V' )  and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100
           AND a.NET_SVN='LY05';

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_E
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_E" AS 
select
   ----年度【地球站】
   distinct substr(b.app_code,-12,12) apply_code ,substr(b.app_code,0,length(b.app_code)-12) ApplyType ,
   decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(Fee_Derate_Proportion,0)*100 derate,ST_ME_FBand assi_band,a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ e
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and b.guid=c.guid(+)
     and UPPER(nvl(b.STAT_WORK,'ER'))!='R' and (b.STAT_APP_Type='ME' OR b.STAT_APP_Type='E')
     and substr(b.app_code,1,length(b.app_code)-12)='T'
     and B.STAT_Status=1 and b.guid=e.station_guid and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>0
     and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_E_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_E_APPLY" AS 
select
   ----新台【地球站】
  distinct substr(b.app_code,-12,12) apply_code ,substr(b.app_code,0,length(b.app_code)-12) ApplyType ,
   decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(Fee_Derate_Proportion,0)*100 derate,ST_ME_FBand assi_band,a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ e
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and b.guid=c.guid(+)
     and UPPER(nvl(b.STAT_WORK,'ER'))!='R' and (b.STAT_APP_Type='ME' OR b.STAT_APP_Type='E')
     and substr(b.app_code,1,length(b.app_code)-12)='T'
     and B.STAT_Status=1 and b.guid=e.station_guid and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>0
     and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_ECHECK_ENTER1G8
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_ECHECK_ENTER1G8" AS 
select distinct b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,RSBT_ORG d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and A.ORG_GUID=d.Guid and c.guid=e.guid(+)
     and (b.STAT_APP_Type='C' or b.STAT_APP_Type='D') and a.NET_SVN='GD04'
     and substr(b.app_code,1,length(b.app_code)-12)='T'
     and B.STAT_Status=1
     and ((nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>1785 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<1805)
         or (nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=1900 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=1920));

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EE" AS 
select distinct b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(Fee_Derate_Proportion,0)*100 derate,ST_ME_FBand assi_band,a.NET_Start_Date,E.FREQ_E_BAND
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ e
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and b.guid=c.guid(+)
     and UPPER(nvl(b.STAT_WORK,'ER'))!='R' and (b.STAT_APP_Type='ME' OR b.STAT_APP_Type='E')
     and substr(b.app_code,1,length(b.app_code)-12)='T'
     and B.STAT_Status=1 and b.guid=e.station_guid and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>0
     and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_ENTER1G8
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_ENTER1G8" AS 
select distinct substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
		b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
		to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
		to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
		nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
 where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
		and (b.STAT_APP_Type='C' OR b.STAT_APP_Type='D'  OR b.STAT_APP_Type='TF' OR b.STAT_APP_Type='V' OR b.STAT_APP_Type='LM')
    and a.NET_SVN='GD04'
     /*
     “通信系统/业务 类型”
     固定业务_无线接入通信系统----GD04
     */
    and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100
		and ((nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>1785 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<1805)
		     or (nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=1900 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=1920));

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_ENTER1G8_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_ENTER1G8_APPLY" AS 
select
   ---新台【无线接入1.8G】
   distinct b.app_code as apply_code,
   decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
   decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
     and (b.STAT_APP_Type='C' OR b.STAT_APP_Type='D' OR b.STAT_APP_Type='TF' OR b.STAT_APP_Type='V' OR b.STAT_APP_Type='LM')
     and a.NET_SVN='GD04'
     /*
     “通信系统/业务 类型”
     固定业务_无线接入通信系统----GD04
     */
     and substr(b.app_code,1,length(b.app_code)-12)='T'
     and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100
     and ((nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>1785 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<1805)
         or (nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=1900 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=1920));

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_ENTER3G5
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_ENTER3G5" AS 
select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
    and b.STAT_APP_Type='TF' and (a.NET_ts='GD0420' or a.NET_ts='GD0421')
     and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100
    and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>1920;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_ENTER3G5_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_ENTER3G5_APPLY" AS 
select
  ----新台【无线接入3.5G】
   b.app_code as apply_code,
   decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
   decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
    and b.STAT_APP_Type='TF' and (a.NET_ts='GD0420' or a.NET_ts='GD0421')
     and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100
    and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>1920;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_ENTER5G8
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_ENTER5G8" AS 
select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
    and b.STAT_APP_Type='TF' and a.NET_ts='GD0423'
     and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_ENTER5G8_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_ENTER5G8_APPLY" AS 
select
   ----新台【无线接入5.8G】
   b.app_code as apply_code,
   decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
   decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where
    a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
    and b.STAT_APP_Type='TF' and a.NET_ts='GD0423'
     and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQU_V
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQU_V" AS 
select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
         and substr(b.app_code,1,length(b.app_code)-12)='T'  and STAT_APP_Type='V'
           and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUC_MOBILE_PA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUC_MOBILE_PA" AS 
select  b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,H.APP_PA_ID_CARD ID_CARD,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    ET_EQU_NO EQUIP_NO,B.STAT_TYPE
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,RSBT_EQU e,RSBT_EQU_T f,RSBT_APPLY G,RSBT_APPLY_PA H
  where a.GUID=b.NET_GUID  and b.guid=c.guid(+) and b.guid=e.station_guid and e.guid=f.guid
        AND B.APP_CODE=G.APP_CODE(+) AND G.GUID=H.APP_GUID
        and b.STAT_APP_Type='LM' and B.STAT_Status=1 and substr(b.app_code,1,length(b.app_code)-12)='PA'
    --and nvl(NET_SVN,' ')<>'LY01'
    and b.guid in (select STATION_GUID from RSBT_FREQ where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<1000);

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUC_OTHER_PA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUC_OTHER_PA" AS 
SELECT distinct "APPLY_CODE","AREA_CODE","ID_CARD","STAT_TYPE","BEGIN_DATE","BEGIN_YEAR","BEGIN_MONTH","DECL_CODE" FROM
(select DISTINCT  apply_code,area_code,ID_CARD,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code
  from v_rim_rsm_fee_v_PA
  where  freq_emit>0 and freq_emit<=1000
  union all
  select DISTINCT apply_code,area_code,ID_CARD,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code
  from  v_rim_rsm_fee_v_PA
  where  freq_rece>0 and freq_rece<=1000
  union all
  select DISTINCT apply_code,area_code,ID_CARD,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code
  from v_rim_rsm_fee_h_PA where freq_emit>0
  union all
  select DISTINCT apply_code,area_code,ID_CARD,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code
  from v_rim_rsm_fee_h_PA where freq_rece>0);

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_BC
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_BC" AS 
select b.App_Code APPLY_CODE,b.org_code AREA_CODE,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
   nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,rsbt_org d,RSBT_STATION_T f,rsbt_equ g
  where a.GUID=b.NET_GUID and b.GUID=f.GUID and a.org_guid=d.guid and b.guid=g.station_guid
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and b.STAT_APP_Type='B' and B.STAT_Status=1 and f.st_b_type1='0';

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_BT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_BT" AS 
select b.App_Code APPLY_CODE,b.org_code AREA_CODE,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
   nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,rsbt_org d,RSBT_STATION_T f,rsbt_equ g
  where a.GUID=b.NET_GUID and b.GUID=f.GUID and a.org_guid=d.guid and b.guid=g.station_guid
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and b.STAT_APP_Type='B' and B.STAT_Status=1 and f.st_b_type1='1';

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_CDMA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_CDMA" AS 
select b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,rsbt_org d
  where a.GUID=b.NET_GUID and a.org_guid=d.guid
        and (b.STAT_APP_Type='C' OR b.STAT_APP_Type='D') and a.NET_ts='LY0102'
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_DATA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_DATA" AS 
select DISTINCT b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
         and substr(b.app_code,1,length(b.app_code)-12)='T'
         and  b.STAT_APP_Type='TF' and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100
         -- AND NET_SVN='LY05' 无线数据频段修改成按照频率范围统计，并且只统计TF表
         AND ((FREQ_TYPE='0' AND (FREQ_UC>=223 AND FREQ_UC<=235) or (FREQ_UC>=866 AND FREQ_UC<=870))
            OR (FREQ_TYPE='1' AND (FREQ_EFE>=223 AND FREQ_EFB<=235 ) or (FREQ_EFE>=866 AND FREQ_EFB<=870 )));

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_E
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_E" AS 
select distinct b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,rsbt_org d
  where a.GUID=b.NET_GUID(+) and b.guid=c.guid and a.org_guid=d.guid
   -- and UPPER(nvl(b.STAT_WORK,'ER'))!='R' 深圳无委单收站要收设备检测费用，不收取频占费用
      and (b.STAT_APP_Type='ME' OR b.STAT_APP_Type='E')
     and substr(b.app_code,1,length(b.app_code)-12)='T'
     and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_E_PA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_E_PA" AS 
select distinct b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,E.APP_PA_ID_CARD ID_CARD,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_STATION b,RSBT_STATION_T c,RSBT_APPLY D,RSBT_APPLY_PA E
  where b.guid=c.guid AND D.GUID=E.APP_GUID AND D.APP_CODE(+)=B.APP_CODE
     and UPPER(nvl(b.STAT_WORK,'ER'))!='R' and (b.STAT_APP_Type='ME' OR b.STAT_APP_Type='E')
     and substr(b.app_code,1,length(b.app_code)-12)='PA'
     and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_GSM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_GSM" AS 
select b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,rsbt_org d
  where a.GUID=b.NET_GUID and a.org_guid=d.guid
        and (b.STAT_APP_Type='C' OR b.STAT_APP_Type='D') and a.NET_ts='LY0101'
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_JQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_JQ" AS 
select distinct substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,rsbt_org d
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and a.org_guid=d.guid and  (FREQ_EFB>0 or FREQ_UC>0)
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and (b.STAT_APP_Type='C' or b.STAT_APP_Type='D') and B.STAT_Status=1
        -- and a.NET_SVN='LY02' 集群基站修改成按照频率范围统计
        AND ((FREQ_TYPE='0' AND (FREQ_UC>=361 AND FREQ_UC<=368 ) or (FREQ_UC>=382 AND FREQ_UC<=389 ) or (FREQ_UC>=851 AND FREQ_UC<=866 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=361 AND FREQ_EFB<=368 ) or (FREQ_EFE>=382 AND FREQ_EFB<=389 ) or (FREQ_EFE>=851 AND FREQ_EFB<=866 )));

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_KP2G4
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_KP2G4" AS 
select b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,rsbt_org d
  where a.GUID=b.NET_GUID and a.org_guid=d.guid
        and b.STAT_APP_Type='TF' and a.NET_ts='GD0201'
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_KP5G8
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_KP5G8" AS 
select b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,rsbt_org d
  where a.GUID=b.NET_GUID and a.org_guid=d.guid
        and b.STAT_APP_Type='TF' and a.NET_ts='GD0202'
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_LINLESS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_LINLESS" AS 
select distinct b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,rsbt_org d
  where a.GUID=b.NET_GUID and a.org_guid=d.guid and B.STAT_Status=1 and (b.STAT_APP_Type='C' or b.STAT_APP_Type='D')
      and a.NET_SVN='GD04' and b.guid=c.station_guid(+)
     and substr(b.app_code,1,length(b.app_code)-12)='T'
     and not ((nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>1785 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<1805)
         or (nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=1900 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=1920));

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_M
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_M" AS 
select DISTINCT app_code apply_code,a.org_code area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
   a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,rsbt_org d
  where a.GUID=b.NET_GUID and a.org_guid=d.guid
    and b.STAT_APP_Type='TF' and substr(b.app_code,1,length(b.app_code)-12)='T'
    and nvl(NET_SVN,' ')<>'LY05' and nvl(NET_SVN,' ')<>'GD03' and nvl(NET_ts,' ')<>'GD0201' and nvl(NET_ts,' ')<>'GD0202' and nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421'
        and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_MMDS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_MMDS" AS 
select b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,RSBT_ORG d
  where a.GUID=b.NET_GUID and A.ORG_GUID=D.GUID
    and b.STAT_APP_Type='TF'  and NET_SVN='GD03'
    and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_MOBILE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_MOBILE" AS 
select  b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    ET_EQU_NO EQUIP_NO,b.STAT_Type
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_EQU e,RSBT_EQU_T f
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and b.guid=c.guid(+) and b.guid=e.station_guid and e.guid=f.guid
        and b.STAT_APP_Type='LM' and B.STAT_Status=1 and substr(b.app_code,1,length(b.app_code)-12)='T'
    --and nvl(NET_SVN,' ')<>'LY01' 无论是什么业务，设备都要收取检测费用
    and b.guid in (select STATION_GUID from RSBT_FREQ where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<1000);

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_OTHER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_OTHER" AS 
SELECT DISTINCT "APPLY_CODE","AREA_CODE","DEPT_PAY","STAT_TYPE","BEGIN_DATE","BEGIN_YEAR","BEGIN_MONTH","DECL_CODE" FROM
(select DISTINCT  apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code
  from v_rim_rsm_fee_v
  where  freq_emit>0 and freq_emit<=1000
  union all
  select DISTINCT apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code
  from  v_rim_rsm_fee_v
  where  freq_rece>0 and freq_rece<=1000
  union all
  select DISTINCT apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code
  from v_rim_rsm_fee_h where freq_emit>0
  union all
  select DISTINCT apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code
  from v_rim_rsm_fee_h where freq_rece>0);

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_PB
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_PB" AS 
select b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,RSBT_ORG d
  where a.GUID=b.NET_GUID and A.ORG_GUID=D.GUID
        and substr(b.app_code,1,length(b.app_code)-12)='T'
     and b.STAT_APP_Type='V' and B.STAT_Status=1 and a.NET_SVN='LY06';

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_PB_PA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_PB_PA" AS 
select b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,F.APP_PA_ID_CARD ID_CARD,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,RSBT_ORG d,RSBT_APPLY E,RSBT_APPLY_PA F
  where a.GUID=b.NET_GUID and A.ORG_GUID=D.GUID AND E.GUID=F.APP_GUID AND B.APP_CODE=E.APP_CODE(+)
        and substr(b.app_code,1,length(b.app_code)-12)='PA'
     and b.STAT_APP_Type='V' and B.STAT_Status=1 and a.NET_SVN='LY06';

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_R" AS 
select DISTINCT app_code apply_code,a.org_code area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
   a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,rsbt_org d
  where a.GUID=b.NET_GUID and a.org_guid=d.guid
    and b.STAT_APP_Type='R' and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_TDSCDMA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_TDSCDMA" AS 
select b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,rsbt_org d
  where a.GUID=b.NET_GUID and a.org_guid=d.guid
        and (b.STAT_APP_Type='C' OR b.STAT_APP_Type='D') and a.NET_ts='LY0104'
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_EQUCHECK_WCDMA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_EQUCHECK_WCDMA" AS 
select b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code
  from RSBT_NET a,RSBT_STATION b,rsbt_org d
  where a.GUID=b.NET_GUID and a.org_guid=d.guid
        and (b.STAT_APP_Type='C' OR b.STAT_APP_Type='D') and a.NET_ts='LY0103'
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_H
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_H" AS 
select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
   and substr(b.app_code,1,length(b.app_code)-12)='T'
    and STAT_APP_Type='H'
    and nvl(NET_SVN,' ')<>'GD04'
    and nvl(NET_SVN,' ')<>'LY02'
    and nvl(NET_SVN,' ')<>'LY05'
    and nvl(NET_SVN,' ')<>'LY06'
      /*
      不包括以下“通信系统/业务 类型”
      【固定业务_无线接入通信系统----GD04、
      陆地移动业务_集群通信系统----LY02、
      陆地移动业务_无线数据通信系统----LY05、
      陆地移动业务_寻呼通信系统----LY06】
      */
    and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_H_PA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_H_PA" AS 
select b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
       G.APP_PA_ID_CARD ID_CARD,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece
  from RSBT_STATION b,RSBT_FREQ c,RSBT_APPLY F,RSBT_APPLY_PA G
  where  b.GUID=c.STATION_GUID(+)AND F.GUID=G.APP_GUID AND B.APP_CODE=F.APP_CODE(+)
   and substr(b.app_code,1,length(b.app_code)-12)='PA'
    and STAT_APP_Type='H' and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_JQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_JQ" AS 
select
    ---年度【集群台站】
    substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    decode(a.NET_Area,'1','GJ','2','GJ','3','SJ','4','SJ','5','CJ','6','CJ','CJ') net_range,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_EFB,FREQ_LC),0) freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB),'2',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_EFB,FREQ_LC),0)/1000)||' GHz','0',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_EFB,FREQ_LC),0)*1000)||' KHz',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_EFB,FREQ_LC),0))||' MHz') freq_note,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and  (FREQ_EFB>0 or FREQ_LC>0)
    and (b.STAT_APP_Type='C' OR b.STAT_APP_Type='D' OR  b.STAT_APP_Type='V') and B.STAT_Status=1 and a.NET_SVN='LY02' and nvl(d.Fee_Derate_Proportion,0)<100
  union all
  select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    decode(a.NET_Area,'1','GJ','2','GJ','3','SJ','4','SJ','5','CJ','6','CJ','CJ') net_range,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_RFB,FREQ_UC),0) freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB),'2',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_RFB,FREQ_UC),0)/1000)||' GHz','0',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_RFB,FREQ_UC),0)*1000)||' KHz',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_RFB,FREQ_UC),0))||' MHz') freq_note,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and (FREQ_RFB>0 or FREQ_UC>0)
    and (b.STAT_APP_Type='C' OR b.STAT_APP_Type='D' OR  b.STAT_APP_Type='V') and B.STAT_Status=1 and a.NET_SVN='LY02' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_JQ_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_JQ_APPLY" AS 
select
   ----【新台站】集群基站（视图）
    substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    decode(a.NET_Area,'1','GJ','2','GJ','3','SJ','4','SJ','5','CJ','6','CJ','CJ') net_range,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_EFB,FREQ_LC),0) freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB),'2',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_EFB,FREQ_LC),0)/1000)||' GHz','0',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_EFB,FREQ_LC),0)*1000)||' KHz',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_EFB,FREQ_LC),0))||' MHz') freq_note,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and  (FREQ_EFB>0 or FREQ_LC>0)
    and (b.STAT_APP_Type='C' or b.STAT_APP_Type='D' OR b.STAT_APP_Type='V' ) and B.STAT_Status=1 and a.NET_SVN='LY02' and nvl(d.Fee_Derate_Proportion,0)<100
  union all
  select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    decode(a.NET_Area,'1','GJ','2','GJ','3','SJ','4','SJ','5','CJ','6','CJ','CJ') net_range,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_RFB,FREQ_UC),0) freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB),'2',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_RFB,FREQ_UC),0)/1000)||' GHz','0',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_RFB,FREQ_UC),0)*1000)||' KHz',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_RFB,FREQ_UC),0))||' MHz') freq_note,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and (FREQ_RFB>0 or FREQ_UC>0)
    and (b.STAT_APP_Type='C' or b.STAT_APP_Type='D' OR b.STAT_APP_Type='V' ) and B.STAT_Status=1 and a.NET_SVN='LY02' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_KP2G4
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_KP2G4" AS 
select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
        and b.STAT_APP_Type='TF' and a.NET_ts='GD0201'
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_KP2G4_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_KP2G4_APPLY" AS 
select
    ----新台【扩频系统2.4G】
    b.app_code as apply_code,
    decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
        and b.STAT_APP_Type='TF' and a.NET_ts='GD0201'
        and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_KP5G8
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_KP5G8" AS 
select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
     and b.STAT_APP_Type='TF' and a.NET_ts='GD0202'
     and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_KP5G8_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_KP5G8_APPLY" AS 
select
    ----新台【扩频系统5.8G】
    b.app_code as  apply_code,
    decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
     and b.STAT_APP_Type='TF' and a.NET_ts='GD0202'
     and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_LINELESS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_LINELESS" AS 
select
   ---- 年度【无绳电话】
   distinct substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
		nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
		to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
		to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
		nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and B.STAT_Status=1 and (b.STAT_APP_Type='C' or b.STAT_APP_Type='D')
		 and nvl(d.Fee_Derate_Proportion,0)<100 and a.NET_SVN='GD04' and b.guid=c.station_guid(+)
		 and not ((nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>1785 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<1805)
		 	  or (nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=1900 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=1920));

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_LINELESS_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_LINELESS_APPLY" AS 
select
   ----新台【无绳电话】
    distinct substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
		nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
		to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
		to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
		nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and B.STAT_Status=1 and (b.STAT_APP_Type='C' or b.STAT_APP_Type='D')
		 and nvl(d.Fee_Derate_Proportion,0)<100 and a.NET_SVN='GD04' and b.guid=c.station_guid(+)
		 and not ((nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>1785 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<1805)
		 	  or (nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=1900 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=1920));

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_M
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_M" AS 
select  substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
		and b.STAT_APP_Type='TF'
		and nvl(NET_SVN,' ')<>'LY05' and nvl(NET_SVN,' ')<>'GD03' and nvl(NET_ts,' ')<>'GD0201' and nvl(NET_ts,' ')<>'GD0202' and nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421'
    		and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_M_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_M_APPLY" AS 
select
----新台【10G以下微波】
     substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
		and b.STAT_APP_Type='TF'
		and nvl(NET_SVN,' ')<>'LY05' and nvl(NET_SVN,' ')<>'GD03' and nvl(NET_ts,' ')<>'GD0201' and nvl(NET_ts,' ')<>'GD0202' and nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421'
    		and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_MMDS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_MMDS" AS 
select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
    and b.STAT_APP_Type='TF'  and  NET_SVN='GD03'
    /*
    固定业务_2.6GHz MMDS------GD03
    */
    and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_MMDS_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_MMDS_APPLY" AS 
select
    ----新台【MMDS台】
    b.app_code as apply_code,
    decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    e.FT_freq_no,FREQ_E_Band chan_dist,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
    and b.STAT_APP_Type='TF'  and NET_SVN='GD03'
     /*
    固定业务_2.6GHz MMDS------GD03
    */
    and substr(b.app_code,1,length(b.app_code)-12)='T'
        and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_MOBILE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_MOBILE" AS 
select  substr(b.app_code,-12,12) apply_code,
    decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(Fee_Derate_Proportion,0)*100 derate,ET_EQU_NO EQUIP_NO,a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_EQU e,RSBT_EQU_T f
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and b.guid=c.guid(+) and b.guid=e.station_guid and e.guid=f.guid
        and b.STAT_APP_Type='LM' and B.STAT_Status=1 and substr(b.app_code,1,length(b.app_code)-12)='T'
        and  nvl(NET_SVN,' ') <> 'GD04'
        and  nvl( A.NET_SVN,' ' )<> 'LY02'
         /*
         不包括以下“通信系统/业务 类型”
        【固定业务_无线接入通信系统----GD04、
         陆地移动业务_集群通信系统----LY02、】
         */
        and nvl(d.Fee_Derate_Proportion,0)<100
        and b.guid in (select STATION_GUID from RSBT_FREQ where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<1000)
   /*
      and   b.GUID not IN(SELECT station_guid FROM RSBT_freq WHERE
         ((FREQ_Type='0' AND (FREQ_UC>=361 AND FREQ_UC<=368 ) or (FREQ_UC>=382 AND FREQ_UC<=389 ) or (FREQ_UC>=851 AND FREQ_UC<=866 ))
                   OR (FREQ_Type='1' AND (FREQ_EFE>=361 AND FREQ_EFB<=368 ) or (FREQ_EFE>=382 AND FREQ_EFB<=389 ) or (FREQ_EFE>=851 AND FREQ_EFB<=866 ))))
;
*/;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_MOBILE_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_MOBILE_APPLY" AS 
select
  ----移动台
substr(b.app_code,-12,12) apply_code,
    decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(Fee_Derate_Proportion,0)*100 derate,ET_EQU_NO EQUIP_NO,a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_EQU e,RSBT_EQU_T f
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and b.guid=c.guid(+) and b.guid=e.station_guid and e.guid=f.guid
        and b.STAT_APP_Type='LM' and B.STAT_Status=1 and substr(b.app_code,1,length(b.app_code)-12)='T'
        and  nvl(NET_SVN,' ') <> 'GD04'
        and  nvl( A.NET_SVN,' ' )<> 'LY02'
         /*
         不包括以下“通信系统/业务 类型”
        【固定业务_无线接入通信系统----GD04、
         陆地移动业务_集群通信系统----LY02、】
         */
        and nvl(d.Fee_Derate_Proportion,0)<100
        and b.guid in (select STATION_GUID from RSBT_FREQ where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<1000)
   /*
      and   b.GUID not IN(SELECT station_guid FROM RSBT_freq WHERE
         ((FREQ_Type='0' AND (FREQ_UC>=361 AND FREQ_UC<=368 ) or (FREQ_UC>=382 AND FREQ_UC<=389 ) or (FREQ_UC>=851 AND FREQ_UC<=866 ))
                   OR (FREQ_Type='1' AND (FREQ_EFE>=361 AND FREQ_EFB<=368 ) or (FREQ_EFE>=382 AND FREQ_EFB<=389 ) or (FREQ_EFE>=851 AND FREQ_EFB<=866 ))))
;
*/;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_NO
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_NO" AS 
select item_no
    from T_RIM_RSM_pay_deptcount
  union all
  select item_no
    from T_RIM_RSM_pay_applycount
  union all
  select item_no
    from T_RIM_RSM_PAY_EQUPADEPTCOUNT
  union all
  select item_no
   from T_RIM_RSM_PAY_EQUPA_APPLYCOUNT;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_OTHER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_OTHER" AS 
select
    ---- 年度【其它固定台】其它固定台(1000MHz以下的无线电台(固定电台)--'810000')
    ----【国无管表13 无线电台(站)技术资料申报表----V】
    ---【国无管表3  30MHz以下无线电台(站)技术资料申报表----H】
    apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code,
    freq_emit freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(freq_emit,freq_emit,freq_emit,freq_emit),'2',TO_CHAR(freq_emit/1000)||' GHz','0',TO_CHAR(freq_emit*1000)||' KHz',TO_CHAR(freq_emit)||' MHz') freq_note,
    derate,net_guid
  from v_rim_rsm_fee_v
  where  freq_emit>0 and freq_emit<=1000


  union all

  select apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code,
    freq_rece freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(freq_rece,freq_rece,freq_rece,freq_rece),'2',TO_CHAR(freq_rece/1000)||' GHz','0',TO_CHAR(freq_rece*1000)||' KHz',TO_CHAR(freq_rece)||' MHz') freq_note,
    derate,net_guid
  from v_rim_rsm_fee_v
  where  freq_rece>0 and freq_rece<=1000


  union all

  select apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code,
    freq_emit freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(freq_emit,freq_emit,freq_emit,freq_emit),'2',TO_CHAR(freq_emit/1000)||' GHz','0',TO_CHAR(freq_emit*1000)||' KHz',TO_CHAR(freq_emit)||' MHz') freq_note,
    derate,net_guid
  from v_rim_rsm_fee_h where freq_emit>0 and freq_emit <1000



  union all
  select apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code,
    freq_rece freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(freq_rece,freq_rece,freq_rece,freq_rece),'2',TO_CHAR(freq_rece/1000)||' GHz','0',TO_CHAR(freq_rece*1000)||' KHz',TO_CHAR(freq_rece)||' MHz') freq_note,
    derate,net_guid
  from v_rim_rsm_fee_h where freq_rece>0;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_OTHER_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_OTHER_APPLY" AS 
select
    ----新台【其它固定台】其它固定台(1000MHz以下的无线电台(固定电台)--'810000')
    ----【国无管表13 无线电台(站)技术资料申报表----V】
    ---【国无管表3  30MHz以下无线电台(站)技术资料申报表----H】
     apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code,
    freq_emit freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(freq_emit,freq_emit,freq_emit,freq_emit),'2',TO_CHAR(freq_emit/1000)||' GHz','0',TO_CHAR(freq_emit*1000)||' KHz',TO_CHAR(freq_emit)||' MHz') freq_note,
    derate,net_guid
  from v_rim_rsm_fee_v
  where  freq_emit>0 and freq_emit<=1000


  union all

  select apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code,
    freq_rece freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(freq_rece,freq_rece,freq_rece,freq_rece),'2',TO_CHAR(freq_rece/1000)||' GHz','0',TO_CHAR(freq_rece*1000)||' KHz',TO_CHAR(freq_rece)||' MHz') freq_note,
    derate,net_guid
  from v_rim_rsm_fee_v
  where  freq_rece>0 and freq_rece<=1000


  union all

  select apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code,
    freq_emit freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(freq_emit,freq_emit,freq_emit,freq_emit),'2',TO_CHAR(freq_emit/1000)||' GHz','0',TO_CHAR(freq_emit*1000)||' KHz',TO_CHAR(freq_emit)||' MHz') freq_note,
    derate,net_guid
  from v_rim_rsm_fee_h where freq_emit>0 AND freq_emit<1000


  union all
  select apply_code,area_code,dept_pay,stat_type,begin_date,begin_YEAR,begin_MONTH,decl_code,
    freq_rece freq,
    decode(f_rim_rsm_GETFREQ_freq_Unit(freq_rece,freq_rece,freq_rece,freq_rece),'2',TO_CHAR(freq_rece/1000)||' GHz','0',TO_CHAR(freq_rece*1000)||' KHz',TO_CHAR(freq_rece)||' MHz') freq_note,
    derate,net_guid
  from v_rim_rsm_fee_h where freq_rece>0;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_PB
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_PB" AS 
select
    --年度台站（寻呼系统LY06--陆地移动业务_寻呼通信系统【00452006】）
    substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    decode(a.NET_Area,'1','GJ','2','GJ','3','SJ','4','SJ','5','CJ','6','CJ','CJ') net_range,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    decode(f_rim_rsm_GETFREQ_freq_Unit(FREQ_UC,FREQ_LC,FREQ_EFB,FREQ_RFB),'2',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)/1000)||' GHz','0',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)*1000)||' KHz',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0))||' MHz') freq_note,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+)
        and substr(b.app_code,1,length(b.app_code)-12)='T'
     and b.STAT_APP_Type='V' and B.STAT_Status=1 and a.NET_SVN='LY06' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_PB_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_PB_APPLY" AS 
select
   --新台站（寻呼系统LY06--陆地移动业务_寻呼通信系统【00452006】）
   substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    decode(a.NET_Area,'1','GJ','2','GJ','3','SJ','4','SJ','5','CJ','6','CJ','CJ') net_range,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    decode(f_rim_rsm_GETFREQ_freq_Unit(FREQ_UC,FREQ_LC,FREQ_EFB,FREQ_RFB),'2',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)/1000)||' GHz','0',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)*1000)||' KHz',TO_CHAR(nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0))||' MHz') freq_note,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+)
        and substr(b.app_code,1,length(b.app_code)-12)='T'
     and b.STAT_APP_Type='V' and B.STAT_Status=1 and a.NET_SVN='LY06' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_R" AS 
select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
	b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
	to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
	to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
	nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
	e.FT_freq_no,FREQ_E_Band chan_dist,
	nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
where  a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
	and b.STAT_APP_Type='R' and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_R_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_R_APPLY" AS 
select
----新台【雷达站10G以下(按照微波站收费)】
  b.app_code as apply_code,
  decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
  decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
  b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
  to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
  to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
  nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
  e.FT_freq_no,FREQ_E_Band chan_dist,
  nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
 and substr(b.app_code,1,length(b.app_code)-12)='T'
  and b.STAT_APP_Type='R' and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_S
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_S" AS 
select  substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
		nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
		to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
		to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
		nvl(Fee_Derate_Proportion,0)*100 derate,ST_Ship_Type SHIP_TYPE,nvl(ST_S_P,0) power,nvl(ST_S_T,0) tonnage,a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and b.guid=c.guid(+) and B.STAT_Status=1
		and b.STAT_APP_Type='S' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_S_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_S_APPLY" AS 
select
----新台【船舶电台】
   substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
		nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
		to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
		to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
		nvl(Fee_Derate_Proportion,0)*100 derate,ST_Ship_Type SHIP_TYPE,nvl(ST_S_P,0) power,nvl(ST_S_T,0) tonnage,a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,v_rim_rsm_RSBT_FEEEVERYYEAR d
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and b.guid=c.guid(+) and B.STAT_Status=1
		and b.STAT_APP_Type='S' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_U
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_U" AS 
select  substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
		nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
		to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
		to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
		nvl(Fee_Derate_Proportion,0)*100 derate,ET_EQU_NO EQUIP_NO,a.NET_Start_Date
  from RSBT_NET a,RSBT_STATION b,RSBT_STATION_T c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_EQU e,RSBT_EQU_T f
  where a.GUID=b.NET_GUID and b.GUID=d.STATION_GUID(+) and b.guid=c.guid(+) and b.guid=e.station_guid and e.guid=f.guid
    and b.STAT_APP_Type='LM' and B.STAT_Status=1 AND STAT_TYPE<>'JT' and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_V
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_V" AS 
select substr(b.app_code,-12,12) apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
    decode(nvl(a.FEE_GUID,''),'',d.ORG_GUID,a.FEE_GUID) dept_pay,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece,
    nvl(Fee_Derate_Proportion,0)*100 derate,a.NET_Start_Date,b.net_guid
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,v_rim_rsm_RSBT_FEEEVERYYEAR d,RSBT_FREQ_T e
	where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and b.GUID=d.STATION_GUID(+) and c.guid=e.guid(+)
		  and STAT_APP_Type='V'
      and  nvl(NET_SVN,' ')<>'GD04'
      and nvl(NET_SVN,' ')<>'LY02'
      and nvl(NET_SVN,' ')<>'LY05'
      and nvl(NET_SVN,' ')<>'LY06'
      /*
      不包括以下“通信系统/业务 类型”
      【固定业务_无线接入通信系统----GD04、
      陆地移动业务_集群通信系统----LY02、
      陆地移动业务_无线数据通信系统----LY05、
      陆地移动业务_寻呼通信系统----LY06】
      */
     and B.STAT_Status=1 and nvl(d.Fee_Derate_Proportion,0)<100;

-- ----------------------------
-- View structure for V_RIM_RSM_FEE_V_PA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FEE_V_PA" AS 
select b.app_code apply_code,decode(b.STAT_AREA_CODE,null,decode(substr(b.app_code,1,1),'9','000000',substr(b.app_code,1,4)||'00'),b.STAT_AREA_CODE) area_code,
   G.APP_PA_ID_CARD ID_CARD,
    b.stat_type,nvl(b.STAT_Date_Start,to_date(substr(substr(b.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD')) begin_date,
    to_number(nvl(to_char(b.STAT_Date_Start,'YYYY'),substr(substr(b.app_code,-12,12),5,4))) begin_YEAR,
    to_number(nvl(to_char(b.STAT_Date_Start,'MM'),'1')) begin_MONTH,b.STAT_APP_Type||b.STAT_TDI decl_code,
    nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0) freq_emit,
    nvl(decode(FREQ_Type,'0',FREQ_LC,'1',FREQ_RFB,FREQ_LC),0) freq_rece
  from RSBT_NET a,RSBT_STATION b,RSBT_FREQ c,RSBT_ORG d,RSBT_FREQ_T e,RSBT_APPLY F,RSBT_APPLY_PA G
  where a.GUID=b.NET_GUID and b.GUID=c.STATION_GUID and A.FEE_GUID=d.Guid(+) and c.guid=e.guid(+) AND
        F.GUID=G.APP_GUID AND B.APP_CODE=F.APP_CODE(+)
         and substr(b.app_code,1,length(b.app_code)-12)='PA'
         and STAT_APP_Type='V' and B.STAT_Status=1;

-- ----------------------------
-- View structure for V_RIM_RSM_FREQ_ALERT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FREQ_ALERT" AS 
select t.GUID,t.ORG_GUID,t.NET_GUID,t.ORG_MANAGER_GUID,t.APP_CODE,t.APP_TYPE,t.APP_SUB_TYPE,t.APP_OBJECT_TYPE,
decode(t.APP_OBJECT_TYPE,'0','网络','1','台站','2','设备','3','频率','天线') APP_OBJUCT_TYPE_NAME,t.APP_DATE,t.APP_FTLB,t.APP_FTLE,t.MEMO,
o.org_mail,o.org_link_person,o.org_phone,o.Org_Mob_Phone,o.org_area_code,o.org_name,nvl(i.print_count,0) print_count,f_rim_rsm_isalert(i.end_date,i.isalert)  isalert
from rsbt_apply t,rsbt_org o, t_rim_rsm_alert_info  i where t.org_guid = o.guid(+)
and t.guid = i.object_guid(+) and  i.object_type(+) = '0';

-- ----------------------------
-- View structure for V_RIM_RSM_FREQ_ALERT_PRINT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FREQ_ALERT_PRINT" AS 
select t.GUID,a.guid AppFreqGuid,t.APP_CODE,F_FormatToShortDate(t.APP_DATE) APP_DATE,F_FormatToShortDate(t.APP_FTLB) app_ftlb,F_FormatToShortDate(t.APP_FTLE) app_ftle,
decode(APP_FREQ_Type,'0',f_to_char(nvl(a.APP_FREQ_LC,0)),f_to_char(nvl(APP_FREQ_LFB,0))||'-'||f_to_char(nvl(APP_FREQ_LFE,0))) freq_ef,
decode(APP_FREQ_Type,'0',f_to_char(nvl(a.APP_FREQ_UC,0)),f_to_char(nvl(APP_FREQ_UFB,0))||'-'||f_to_char(nvl(APP_FREQ_UFE,0))) freq_rf,o.org_name,nvl( o.org_mail,'') org_mail
from rsbt_apply t,rsbt_appfreq a,rsbt_org o where t.guid = a.app_guid(+) and t.org_guid = o.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_FREQAPPLY_INQUIRE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_FREQAPPLY_INQUIRE" AS 
select a.guid app_guid,a.net_guid,b.org_guid,b.fee_guid,a.app_code, a.app_code  app_codeDes,
      c.org_name,d.org_name fee_name,b.net_name,a.app_date,
      a.APP_FTLB,APP_FTLe,d.org_area_code
from rsbt_apply a,rsbt_net b,rsbt_org c,rsbt_org d
where  a.net_guid=b.guid and b.org_guid=c.guid(+) and b.fee_guid=d.guid(+) and a.app_type='F';

-- ----------------------------
-- View structure for V_RIM_RSM_GETANTFEED
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETANTFEED" AS 
select ra."GUID",ra."STATION_GUID",ra."ANT_WORK_TYPE",ra."ANT_POLE",ra."ANT_RPOLE",ra."ANT_EPOLE",ra."ANT_TYPE",ra."ANT_MODEL",ra."ANT_MENU",ra."ANT_HIGHT",ra."ANT_GAIN",ra."ANT_EGAIN",ra."ANT_RGAIN",ra."ANT_ANGLE",ra."ANT_SIZE",ra."FEED_MENU",ra."FEED_MODEL",ra."FEED_LENGTH",ra."FEED_LOSE",ra."ANT_CODE",ra."FEED_CODE"
,rat."AT_ANT_NO",rat."AT_SE_B",rat."AT_SE_E",rat."AT_ANG_B",rat."AT_ANG_E",rat."AT_RNT",rat."AT_BWID",rat."AT_LEL",rat."AT_SSPEED",rat."AT_CCODE",rat."AT_3DBE",rat."AT_3DBR",rat."AT_RANG",rat."AT_EANG",rat."AT_CSGN",rat."AT_UPDN",rat."AT_SUM",rat."AT_QUA",rat."AT_UNIT_TYPE",rat."AT_H_HPIC",rat."AT_H_VPIC",rat."AT_ANT_UPANG",rat."AT_ANT_TFCODE"
from RSBT_ANTFEED_T rat,RSBT_ANTFEED ra where ra.GUID = rat.GUID(+)
order by cast(nvl(TRANSLATE(rat."AT_ANT_NO",
'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ',
'0123456789'),'0') as int),rat.at_ant_no;

-- ----------------------------
-- View structure for V_RIM_RSM_GETANTFEED_H
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETANTFEED_H" AS 
select ra."GUID",ra."STATION_GUID",ra."ANT_WORK_TYPE",ra."ANT_POLE",ra."ANT_RPOLE",ra."ANT_EPOLE",ra."ANT_TYPE",ra."ANT_MODEL",ra."ANT_MENU",ra."ANT_HIGHT",ra."ANT_GAIN",ra."ANT_EGAIN",ra."ANT_RGAIN",ra."ANT_ANGLE",ra."ANT_SIZE",ra."FEED_MENU",ra."FEED_MODEL",ra."FEED_LENGTH",ra."FEED_LOSE",ra."ANT_CODE",ra."FEED_CODE"
,rat."AT_ANT_NO",rat."AT_SE_B",rat."AT_SE_E",rat."AT_ANG_B",rat."AT_ANG_E",rat."AT_RNT",rat."AT_BWID",rat."AT_LEL",rat."AT_SSPEED",rat."AT_CCODE",rat."AT_3DBE",rat."AT_3DBR",rat."AT_RANG",rat."AT_EANG",rat."AT_CSGN",rat."AT_UPDN",rat."AT_SUM",rat."AT_QUA",rat."AT_UNIT_TYPE",rat."AT_H_HPIC",rat."AT_H_VPIC",rat."AT_ANT_UPANG",
rat."AT_ANT_TFCODE",rat."TIMESTAMP"
from RSBT_ANTFEED_T_h rat,RSBT_ANTFEED_h ra where ra.GUID = rat.GUID(+)
order by cast(nvl(TRANSLATE(rat."AT_ANT_NO",
'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ',
'0123456789'),'0') as int),rat.at_ant_no;

-- ----------------------------
-- View structure for V_RIM_RSM_GETANTFEED_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETANTFEED_R" AS 
select ra."GUID",ra."STATION_GUID",ra."ANT_WORK_TYPE",ra."ANT_POLE",ra."ANT_RPOLE",ra."ANT_EPOLE",ra."ANT_TYPE",ra."ANT_MODEL",ra."ANT_MENU",ra."ANT_HIGHT",ra."ANT_GAIN",ra."ANT_EGAIN",ra."ANT_RGAIN",ra."ANT_ANGLE",ra."ANT_SIZE",ra."FEED_MENU",ra."FEED_MODEL",ra."FEED_LENGTH",ra."FEED_LOSE",ra."ANT_CODE",ra."FEED_CODE"
,rat."AT_ANT_NO",rat."AT_SE_B",rat."AT_SE_E",rat."AT_ANG_B",rat."AT_ANG_E",rat."AT_RNT",rat."AT_BWID",rat."AT_LEL",rat."AT_SSPEED",rat."AT_CCODE",rat."AT_3DBE",rat."AT_3DBR",rat."AT_RANG",rat."AT_EANG",rat."AT_CSGN",rat."AT_UPDN",rat."AT_SUM",rat."AT_QUA",rat."AT_UNIT_TYPE",rat."AT_H_HPIC",rat."AT_H_VPIC",rat."AT_ANT_UPANG",rat."AT_ANT_TFCODE"
from RSBT_ANTFEED_T_r rat,RSBT_ANTFEED_r ra where ra.GUID = rat.GUID(+)
order by cast(nvl(TRANSLATE(rat."AT_ANT_NO",
'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ',
'0123456789'),'0') as int),rat.at_ant_no;

-- ----------------------------
-- View structure for V_RIM_RSM_GETEQU
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETEQU" AS 
select re."GUID",re."STATION_GUID",re."EQU_TYPE",re."EQU_MODEL",re."EQU_AUTH",re."EQU_MENU",re."EQU_CODE",re."EQU_PF",re."EQU_POW",re."EQU_MB",
ret."ET_EQU_NO",ret."ET_AF_TYPE",ret."ET_POW_U",ret."ET_EQU_CL",ret."ET_EQU_TL",ret."ET_EQU_RNQ",ret."ET_EQU_TYPE_ID",ret."ET_EQU_NAME",ret."ET_EQU_CODE",
ret."ET_EQU_ESGN",ret."ET_EQU_EPOS",ret."ET_EQU_ATYPE",ret."ET_EQU_APOS",ret."ET_EQU_SUM",ret."ET_EQU_EUSE",ret."ET_EQU_FNTVAL",ret."ET_EQU_PUP",ret."ET_EQU_PDN",
ret."ET_EQU_CHRIP",ret."ET_EQU_PWID1",ret."ET_EQU_PWID2",ret."ET_EQU_PR",ret."ET_EQU_PF",ret."ET_EQU_RF",ret."ET_EQU_RF_BAND",ret."ET_EIRP",ret."ET_EQU_SEN",
ret."ET_EQU_SENU",ret."ET_EQU_SENERR",ret."ET_EQU_RWID",ret."ET_EQU_MT",ret."ET_EQU_CCODE",ret."ET_EQU_UPU",ret."ET_EQU_DNU",ret."ET_EQU_TYPE",ret."ET_EQU_USE",
ret."ET_EQU_POW_MAX",ret."ET_EQU_POW_AVG",ret."ET_EQU_UPOW",ret."ET_EQU_DPOW",ret."ET_EQU_TFCODE"
from RSBT_EQU re,RSBT_EQU_T ret where re.GUID=ret.GUID(+)
order by cast(nvl(TRANSLATE(ret."ET_EQU_NO",
'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ',
'0123456789'),'0') as int),ret.et_equ_no;

-- ----------------------------
-- View structure for V_RIM_RSM_GETEQU_ALL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETEQU_ALL" AS 
select  a."GUID",a."STATION_GUID",a."EQU_TYPE",a."EQU_MODEL",a."EQU_AUTH",a."EQU_MENU",a."EQU_CODE",a."EQU_PF",a."EQU_POW",a."EQU_MB",a."ET_EQU_NO",a."ET_AF_TYPE",a."ET_POW_U",a."ET_EQU_CL",a."ET_EQU_TL",a."ET_EQU_RNQ",a."ET_EQU_TYPE_ID",a."ET_EQU_NAME",a."ET_EQU_CODE",a."ET_EQU_ESGN",a."ET_EQU_EPOS",a."ET_EQU_ATYPE",a."ET_EQU_APOS",a."ET_EQU_SUM",a."ET_EQU_EUSE",a."ET_EQU_FNTVAL",a."ET_EQU_PUP",a."ET_EQU_PDN",a."ET_EQU_CHRIP",a."ET_EQU_PWID1",a."ET_EQU_PWID2",a."ET_EQU_PR",a."ET_EQU_PF",a."ET_EQU_RF",a."ET_EQU_RF_BAND",a."ET_EIRP",a."ET_EQU_SEN",a."ET_EQU_SENU",a."ET_EQU_SENERR",a."ET_EQU_RWID",a."ET_EQU_MT",a."ET_EQU_CCODE",a."ET_EQU_UPU",a."ET_EQU_DNU",a."ET_EQU_TYPE",a."ET_EQU_USE",a."ET_EQU_POW_MAX",a."ET_EQU_POW_AVG",a."ET_EQU_UPOW",a."ET_EQU_DPOW",a."ET_EQU_TFCODE",'1' equ_status from
v_rim_rsm_getequ a;

-- ----------------------------
-- View structure for V_RIM_RSM_GETEQU_DISCARD
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETEQU_DISCARD" AS 
select "GUID","STATION_GUID","EQU_TYPE","EQU_MODEL","EQU_AUTH","EQU_MENU","EQU_CODE","EQU_PF","EQU_POW","EQU_MB","ET_EQU_NO","ET_AF_TYPE","ET_POW_U","ET_EQU_CL","ET_EQU_TL","ET_EQU_RNQ","ET_EQU_TYPE_ID","ET_EQU_NAME","ET_EQU_CODE","ET_EQU_ESGN","ET_EQU_EPOS","ET_EQU_ATYPE","ET_EQU_APOS","ET_EQU_SUM","ET_EQU_EUSE","ET_EQU_FNTVAL","ET_EQU_PUP","ET_EQU_PDN","ET_EQU_CHRIP","ET_EQU_PWID1","ET_EQU_PWID2","ET_EQU_PR","ET_EQU_PF","ET_EQU_RF","ET_EQU_RF_BAND","ET_EIRP","ET_EQU_SEN","ET_EQU_SENU","ET_EQU_SENERR","ET_EQU_RWID","ET_EQU_MT","ET_EQU_CCODE","ET_EQU_UPU","ET_EQU_DNU","ET_EQU_TYPE","ET_EQU_USE","ET_EQU_POW_MAX","ET_EQU_POW_AVG","ET_EQU_UPOW","ET_EQU_DPOW","ET_EQU_TFCODE","TIMESTAMP","EQU_STATUS" from (
select re."GUID",re."STATION_GUID",re."EQU_TYPE",re."EQU_MODEL",re."EQU_AUTH",re."EQU_MENU",re."EQU_CODE",re."EQU_PF",re."EQU_POW",re."EQU_MB",
ret."ET_EQU_NO",ret."ET_AF_TYPE",ret."ET_POW_U",ret."ET_EQU_CL",ret."ET_EQU_TL",ret."ET_EQU_RNQ",ret."ET_EQU_TYPE_ID",ret."ET_EQU_NAME",ret."ET_EQU_CODE",
ret."ET_EQU_ESGN",ret."ET_EQU_EPOS",ret."ET_EQU_ATYPE",ret."ET_EQU_APOS",ret."ET_EQU_SUM",ret."ET_EQU_EUSE",ret."ET_EQU_FNTVAL",ret."ET_EQU_PUP",ret."ET_EQU_PDN",
ret."ET_EQU_CHRIP",ret."ET_EQU_PWID1",ret."ET_EQU_PWID2",ret."ET_EQU_PR",ret."ET_EQU_PF",ret."ET_EQU_RF",ret."ET_EQU_RF_BAND",ret."ET_EIRP",ret."ET_EQU_SEN",
ret."ET_EQU_SENU",ret."ET_EQU_SENERR",ret."ET_EQU_RWID",ret."ET_EQU_MT",ret."ET_EQU_CCODE",ret."ET_EQU_UPU",ret."ET_EQU_DNU",ret."ET_EQU_TYPE",ret."ET_EQU_USE",
ret."ET_EQU_POW_MAX",ret."ET_EQU_POW_AVG",ret."ET_EQU_UPOW",ret."ET_EQU_DPOW",ret."ET_EQU_TFCODE",to_date('') "TIMESTAMP",'1' equ_status
from RSBT_EQU re,RSBT_EQU_T ret where re.GUID=ret.GUID(+)
union all
select re."GUID",re."STATION_GUID",re."EQU_TYPE",re."EQU_MODEL",re."EQU_AUTH",re."EQU_MENU",re."EQU_CODE",re."EQU_PF",re."EQU_POW",re."EQU_MB",
ret."ET_EQU_NO",ret."ET_AF_TYPE",ret."ET_POW_U",ret."ET_EQU_CL",ret."ET_EQU_TL",ret."ET_EQU_RNQ",ret."ET_EQU_TYPE_ID",ret."ET_EQU_NAME",ret."ET_EQU_CODE",
ret."ET_EQU_ESGN",ret."ET_EQU_EPOS",ret."ET_EQU_ATYPE",ret."ET_EQU_APOS",ret."ET_EQU_SUM",ret."ET_EQU_EUSE",ret."ET_EQU_FNTVAL",ret."ET_EQU_PUP",ret."ET_EQU_PDN",
ret."ET_EQU_CHRIP",ret."ET_EQU_PWID1",ret."ET_EQU_PWID2",ret."ET_EQU_PR",ret."ET_EQU_PF",ret."ET_EQU_RF",ret."ET_EQU_RF_BAND",ret."ET_EIRP",ret."ET_EQU_SEN",
ret."ET_EQU_SENU",ret."ET_EQU_SENERR",ret."ET_EQU_RWID",ret."ET_EQU_MT",ret."ET_EQU_CCODE",ret."ET_EQU_UPU",ret."ET_EQU_DNU",ret."ET_EQU_TYPE",ret."ET_EQU_USE",
ret."ET_EQU_POW_MAX",ret."ET_EQU_POW_AVG",ret."ET_EQU_UPOW",ret."ET_EQU_DPOW",ret."ET_EQU_TFCODE",ret."TIMESTAMP",exp.equ_status
from RSBT_EQU_h re,RSBT_EQU_T_h ret ,t_rim_rsm_equ_expand exp where re.GUID=ret.GUID(+) and re.guid=exp.guid(+)
)  order by cast(nvl(TRANSLATE(ET_EQU_NO,
'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ',
'0123456789'),'0') as int),et_equ_no;

-- ----------------------------
-- View structure for V_RIM_RSM_GETEQU_H
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETEQU_H" AS 
select re."GUID",re."STATION_GUID",re."EQU_TYPE",re."EQU_MODEL",re."EQU_AUTH",re."EQU_MENU",re."EQU_CODE",re."EQU_PF",re."EQU_POW",re."EQU_MB",
ret."ET_EQU_NO",ret."ET_AF_TYPE",ret."ET_POW_U",ret."ET_EQU_CL",ret."ET_EQU_TL",ret."ET_EQU_RNQ",ret."ET_EQU_TYPE_ID",ret."ET_EQU_NAME",ret."ET_EQU_CODE",
ret."ET_EQU_ESGN",ret."ET_EQU_EPOS",ret."ET_EQU_ATYPE",ret."ET_EQU_APOS",ret."ET_EQU_SUM",ret."ET_EQU_EUSE",ret."ET_EQU_FNTVAL",ret."ET_EQU_PUP",ret."ET_EQU_PDN",
ret."ET_EQU_CHRIP",ret."ET_EQU_PWID1",ret."ET_EQU_PWID2",ret."ET_EQU_PR",ret."ET_EQU_PF",ret."ET_EQU_RF",ret."ET_EQU_RF_BAND",ret."ET_EIRP",ret."ET_EQU_SEN",
ret."ET_EQU_SENU",ret."ET_EQU_SENERR",ret."ET_EQU_RWID",ret."ET_EQU_MT",ret."ET_EQU_CCODE",ret."ET_EQU_UPU",ret."ET_EQU_DNU",ret."ET_EQU_TYPE",ret."ET_EQU_USE",
ret."ET_EQU_POW_MAX",ret."ET_EQU_POW_AVG",ret."ET_EQU_UPOW",ret."ET_EQU_DPOW",ret."ET_EQU_TFCODE",ret."TIMESTAMP"
from RSBT_EQU_h re,RSBT_EQU_T_h ret where re.GUID=ret.GUID(+)
order by cast(nvl(TRANSLATE(ret."ET_EQU_NO",
'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ',
'0123456789'),'0') as int),ret.et_equ_no;

-- ----------------------------
-- View structure for V_RIM_RSM_GETEQU_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETEQU_R" AS 
select re."GUID",re."STATION_GUID",re."EQU_TYPE",re."EQU_MODEL",re."EQU_AUTH",re."EQU_MENU",re."EQU_CODE",re."EQU_PF",re."EQU_POW",re."EQU_MB",
ret."ET_EQU_NO",ret."ET_AF_TYPE",ret."ET_POW_U",ret."ET_EQU_CL",ret."ET_EQU_TL",ret."ET_EQU_RNQ",ret."ET_EQU_TYPE_ID",ret."ET_EQU_NAME",ret."ET_EQU_CODE",
ret."ET_EQU_ESGN",ret."ET_EQU_EPOS",ret."ET_EQU_ATYPE",ret."ET_EQU_APOS",ret."ET_EQU_SUM",ret."ET_EQU_EUSE",ret."ET_EQU_FNTVAL",ret."ET_EQU_PUP",ret."ET_EQU_PDN",
ret."ET_EQU_CHRIP",ret."ET_EQU_PWID1",ret."ET_EQU_PWID2",ret."ET_EQU_PR",ret."ET_EQU_PF",ret."ET_EQU_RF",ret."ET_EQU_RF_BAND",ret."ET_EIRP",ret."ET_EQU_SEN",
ret."ET_EQU_SENU",ret."ET_EQU_SENERR",ret."ET_EQU_RWID",ret."ET_EQU_MT",ret."ET_EQU_CCODE",ret."ET_EQU_UPU",ret."ET_EQU_DNU",ret."ET_EQU_TYPE",ret."ET_EQU_USE",
ret."ET_EQU_POW_MAX",ret."ET_EQU_POW_AVG",ret."ET_EQU_UPOW",ret."ET_EQU_DPOW",ret."ET_EQU_TFCODE"
from RSBT_EQU_r re,RSBT_EQU_T_r ret where re.GUID=ret.GUID(+)
order by cast(nvl(TRANSLATE(ret."ET_EQU_NO",
'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ',
'0123456789'),'0') as int),ret.et_equ_no;

-- ----------------------------
-- View structure for V_RIM_RSM_GETFREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETFREQ" AS 
select rf."GUID",rf."STATION_GUID",rf."FREQ_TYPE",rf."FREQ_LC",rf."FREQ_UC",rf."FREQ_EFB",rf."FREQ_EFE",rf."FREQ_E_BAND",rf."FREQ_RFB",rf."FREQ_RFE",rf."FREQ_R_BAND",
rf."FREQ_MOD",rf."FREQ_MB",rf."FREQ_CODE",rft."FT_FREQ_NO",to_char(rft.FT_FREQ_TIMEB,'hh24:mi')  FT_FREQ_TIMEB,to_char(rft.FT_FREQ_TIMEE,'hh24:mi') FT_FREQ_TIMEE,
rft."FT_FREQ_INFO_TYPE",rft."FT_FREQ_HCL",rft."FT_FREQ_TYPE",rft."FT_FREQ_MC",rft."FT_FREQ_MC1",rft."FT_FREQ_MC2",rft."FT_FREQ_MC3",rft."FT_FREQ_CCODE",rft."FT_FREQ_CSGN",
rft."FT_FREQ_DUPDN",rft."FT_FREQ_UNIT_TYPE",rft."FT_FREQ_FEP",rft."FT_FREQ_FRP",rft."FT_FREQ_EPOW",rft."FT_FREQ_POWFLAG",rft."FT_FREQ_EIRP",rft."FT_FREQ_POW_MAX",
rft."FT_FREQ_POW_AVG",rft."FT_FREQ_TFCODE"
 from RSBT_FREQ_T rft,RSBT_FREQ rf
 where rf.GUID = rft.GUID(+)  order by cast(nvl(TRANSLATE(rft."FT_FREQ_NO",
'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ',
'0123456789'),'0') as int),rft.ft_freq_no;

-- ----------------------------
-- View structure for V_RIM_RSM_GETFREQ_H
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETFREQ_H" AS 
select rf."GUID",rf."STATION_GUID",rf."FREQ_TYPE",rf."FREQ_LC",rf."FREQ_UC",rf."FREQ_EFB",rf."FREQ_EFE",rf."FREQ_E_BAND",rf."FREQ_RFB",rf."FREQ_RFE",rf."FREQ_R_BAND",
rf."FREQ_MOD",rf."FREQ_MB",rf."FREQ_CODE",rft."FT_FREQ_NO",to_char(rft.FT_FREQ_TIMEB,'hh24:mi')  FT_FREQ_TIMEB,to_char(rft.FT_FREQ_TIMEE,'hh24:mi') FT_FREQ_TIMEE,
rft."FT_FREQ_INFO_TYPE",rft."FT_FREQ_HCL",rft."FT_FREQ_TYPE",rft."FT_FREQ_MC",rft."FT_FREQ_MC1",rft."FT_FREQ_MC2",rft."FT_FREQ_MC3",rft."FT_FREQ_CCODE",rft."FT_FREQ_CSGN",
rft."FT_FREQ_DUPDN",rft."FT_FREQ_UNIT_TYPE",rft."FT_FREQ_FEP",rft."FT_FREQ_FRP",rft."FT_FREQ_EPOW",rft."FT_FREQ_POWFLAG",rft."FT_FREQ_EIRP",rft."FT_FREQ_POW_MAX",
rft."FT_FREQ_POW_AVG",rft."FT_FREQ_TFCODE",rft."TIMESTAMP"
 from RSBT_FREQ_T_h rft,RSBT_FREQ_h rf
 where rf.GUID = rft.GUID(+)order by cast(nvl(TRANSLATE(rft."FT_FREQ_NO",
'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ',
'0123456789'),'0') as int),rft.ft_freq_no;

-- ----------------------------
-- View structure for V_RIM_RSM_GETFREQ_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETFREQ_R" AS 
select rf."GUID",rf."STATION_GUID",rf."FREQ_TYPE",rf."FREQ_LC",rf."FREQ_UC",rf."FREQ_EFB",rf."FREQ_EFE",rf."FREQ_E_BAND",rf."FREQ_RFB",rf."FREQ_RFE",rf."FREQ_R_BAND",
rf."FREQ_MOD",rf."FREQ_MB",rf."FREQ_CODE",rft."FT_FREQ_NO",to_char(rft.FT_FREQ_TIMEB,'hh24:mi')  FT_FREQ_TIMEB,to_char(rft.FT_FREQ_TIMEE,'hh24:mi') FT_FREQ_TIMEE,
rft."FT_FREQ_INFO_TYPE",rft."FT_FREQ_HCL",rft."FT_FREQ_TYPE",rft."FT_FREQ_MC",rft."FT_FREQ_MC1",rft."FT_FREQ_MC2",rft."FT_FREQ_MC3",rft."FT_FREQ_CCODE",rft."FT_FREQ_CSGN",
rft."FT_FREQ_DUPDN",rft."FT_FREQ_UNIT_TYPE",rft."FT_FREQ_FEP",rft."FT_FREQ_FRP",rft."FT_FREQ_EPOW",rft."FT_FREQ_POWFLAG",rft."FT_FREQ_EIRP",rft."FT_FREQ_POW_MAX",
rft."FT_FREQ_POW_AVG",rft."FT_FREQ_TFCODE"
 from RSBT_FREQ_T_r rft,RSBT_FREQ_r rf
 where rf.GUID = rft.GUID(+) order by cast(nvl(TRANSLATE(rft."FT_FREQ_NO",
'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ',
'0123456789'),'0') as int),rft.ft_freq_no;

-- ----------------------------
-- View structure for V_RIM_RSM_GETSTATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETSTATION" AS 
select rs."GUID",rs."NET_GUID",rs."ORG_CODE",rs."APP_CODE",rs."STAT_APP_TYPE",rs."STAT_TDI",rs."STAT_NAME",rs."STAT_ADDR",rs."STAT_AREA_CODE",rs."STAT_TYPE",rs."STAT_WORK",rs."STAT_STATUS",rs."STAT_EQU_SUM",rs."STAT_LG",rs."STAT_LA",rs."STAT_AT",to_char(rs."STAT_DATE_START",'yyyy-MM-dd') STAT_DATE_START ,rs."MEMO",to_char(rst.ST_TIME_B,'hh24:mi') ST_TIME_B,to_char(rst.ST_TIME_E,'hh24:mi')  ST_TIME_E,rst."ST_LMMTR",rst."ST_USER_AREA",rst."ST_TF_CODE",rst."ST_TF_TRANS_CA_PU",rst."ST_TF_TRANS_CA_P",rst."ST_E_NET_CODE",rst."ST_E_MULTI_ADDR",rst."ST_E_COM_AREA",rst."ST_POS_TYPE",rst."ST_E_POS",rst."ST_E_SAT",rst."ST_E_LG",rst."ST_B_SGN",rst."ST_B_LEVEL",rst."ST_B_BM",rst."ST_B_EDU",rst."ST_B_IC",rst."ST_B_COVER_AREA",rst."ST_SHIP_TYPE",rst."ST_CALL_SIGN",rst."ST_S_MMSI",rst."ST_S_CS",rst."ST_SHIP_NAME",rst."ST_S_PN",rst."ST_S_AAIC",rst."ST_S_T",rst."ST_S_P",rst."ST_A_MODEL",rst."ST_A_TYPE",rst."ST_A_CALL",rst."ST_A_CALL_OI",rst."ST_A_SGN",rst."ST_A_ST",rst."ST_A_PILOTING",rst."ST_A_NRM",rst."ST_R_WAMIN",rst."ST_R_WAMAX",rst."ST_R_EMIN",rst."ST_R_EMAX",rst."ST_C_CODE",rst."ST_C_SUM",rst."ST_SERV_R",rst."ST_D_TEC_TYPE",rst."ST_D_TYPE",rst."ST_ME_SAT_NAME",rst."ST_ME_STA1",rst."ST_ME_STA2",rst."ST_ME_STA3",rst."ST_ME_STYPE",rst."ST_ME_NAME1",rst."ST_ME_NAME2",rst."ST_ME_LG1",rst."ST_ME_LG2",rst."ST_ME_FBAND",rst."ST_B_TYPE1",rst."ST_B_TYPE2",rst."ST_ME_FILE_NO"
 from RSBT_STATION rs,RSBT_STATION_T rst
 where rs.GUID = rst.GUID(+);

-- ----------------------------
-- View structure for V_RIM_RSM_GETSTATION_H
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETSTATION_H" AS 
select rs."GUID",rs."NET_GUID",rs."ORG_CODE",rs."APP_CODE",rs."STAT_APP_TYPE",rs."STAT_TDI",rs."STAT_NAME",rs."STAT_ADDR",rs."STAT_AREA_CODE",rs."STAT_TYPE",rs."STAT_WORK",rs."STAT_STATUS",rs."STAT_EQU_SUM",rs."STAT_LG",rs."STAT_LA",rs."STAT_AT",to_char(rs."STAT_DATE_START",'yyyy-MM-dd') STAT_DATE_START ,rs."MEMO",to_char(rst.ST_TIME_B,'hh24:mi') ST_TIME_B,to_char(rst.ST_TIME_E,'hh24:mi')  ST_TIME_E,rst."ST_LMMTR",rst."ST_USER_AREA",rst."ST_TF_CODE",rst."ST_TF_TRANS_CA_PU",rst."ST_TF_TRANS_CA_P",rst."ST_E_NET_CODE",rst."ST_E_MULTI_ADDR",rst."ST_E_COM_AREA",rst."ST_POS_TYPE",rst."ST_E_POS",rst."ST_E_SAT",rst."ST_E_LG",rst."ST_B_SGN",rst."ST_B_LEVEL",rst."ST_B_BM",rst."ST_B_EDU",rst."ST_B_IC",rst."ST_B_COVER_AREA",rst."ST_SHIP_TYPE",rst."ST_CALL_SIGN",rst."ST_S_MMSI",rst."ST_S_CS",rst."ST_SHIP_NAME",rst."ST_S_PN",rst."ST_S_AAIC",rst."ST_S_T",rst."ST_S_P",rst."ST_A_MODEL",rst."ST_A_TYPE",rst."ST_A_CALL",rst."ST_A_CALL_OI",rst."ST_A_SGN",rst."ST_A_ST",rst."ST_A_PILOTING",rst."ST_A_NRM",rst."ST_R_WAMIN",rst."ST_R_WAMAX",rst."ST_R_EMIN",rst."ST_R_EMAX",rst."ST_C_CODE",rst."ST_C_SUM",rst."ST_SERV_R",rst."ST_D_TEC_TYPE",rst."ST_D_TYPE",rst."ST_ME_SAT_NAME",rst."ST_ME_STA1",rst."ST_ME_STA2",rst."ST_ME_STA3",rst."ST_ME_STYPE",rst."ST_ME_NAME1",rst."ST_ME_NAME2",rst."ST_ME_LG1",rst."ST_ME_LG2",rst."ST_ME_FBAND",rst."ST_B_TYPE1",rst."ST_B_TYPE2",
rst."ST_ME_FILE_NO",rst."TIMESTAMP"
 from RSBT_STATION_h rs,RSBT_STATION_T_h rst
 where rs.GUID = rst.GUID(+);

-- ----------------------------
-- View structure for V_RIM_RSM_GETSTATION_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETSTATION_R" AS 
select rs."GUID",rs."NET_GUID",rs."ORG_CODE",rs."APP_CODE",rs."STAT_APP_TYPE",rs."STAT_TDI",rs."STAT_NAME",rs."STAT_ADDR",rs."STAT_AREA_CODE",rs."STAT_TYPE",rs."STAT_WORK",rs."STAT_STATUS",rs."STAT_EQU_SUM",rs."STAT_LG",rs."STAT_LA",rs."STAT_AT",to_char(rs."STAT_DATE_START",'yyyy-MM-dd') STAT_DATE_START ,rs."MEMO",to_char(rst.ST_TIME_B,'hh24:mi') ST_TIME_B,to_char(rst.ST_TIME_E,'hh24:mi')  ST_TIME_E,rst."ST_LMMTR",rst."ST_USER_AREA",rst."ST_TF_CODE",rst."ST_TF_TRANS_CA_PU",rst."ST_TF_TRANS_CA_P",rst."ST_E_NET_CODE",rst."ST_E_MULTI_ADDR",rst."ST_E_COM_AREA",rst."ST_POS_TYPE",rst."ST_E_POS",rst."ST_E_SAT",rst."ST_E_LG",rst."ST_B_SGN",rst."ST_B_LEVEL",rst."ST_B_BM",rst."ST_B_EDU",rst."ST_B_IC",rst."ST_B_COVER_AREA",rst."ST_SHIP_TYPE",rst."ST_CALL_SIGN",rst."ST_S_MMSI",rst."ST_S_CS",rst."ST_SHIP_NAME",rst."ST_S_PN",rst."ST_S_AAIC",rst."ST_S_T",rst."ST_S_P",rst."ST_A_MODEL",rst."ST_A_TYPE",rst."ST_A_CALL",rst."ST_A_CALL_OI",rst."ST_A_SGN",rst."ST_A_ST",rst."ST_A_PILOTING",rst."ST_A_NRM",rst."ST_R_WAMIN",rst."ST_R_WAMAX",rst."ST_R_EMIN",rst."ST_R_EMAX",rst."ST_C_CODE",rst."ST_C_SUM",rst."ST_SERV_R",rst."ST_D_TEC_TYPE",rst."ST_D_TYPE",rst."ST_ME_SAT_NAME",rst."ST_ME_STA1",rst."ST_ME_STA2",rst."ST_ME_STA3",rst."ST_ME_STYPE",rst."ST_ME_NAME1",rst."ST_ME_NAME2",rst."ST_ME_LG1",rst."ST_ME_LG2",rst."ST_ME_FBAND",rst."ST_B_TYPE1",rst."ST_B_TYPE2",rst."ST_ME_FILE_NO"
 from RSBT_STATION_r rs,RSBT_STATION_T_r rst
 where rs.GUID = rst.GUID(+);

-- ----------------------------
-- View structure for V_RIM_RSM_GETSTATIONFREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETSTATIONFREQ" AS 
select o."GUID",o."ORG_CODE",o."ORG_NAME",o."ORG_AREA_CODE",o."ORG_SYS_CODE",o."ORG_TYPE",o."ORG_LINK_PERSON",o."ORG_PERSON_ID",o."ORG_SUP_CODE",o."ORG_ADDR",o."ORG_POST",o."ORG_PHONE",o."ORG_MOB_PHONE",o."ORG_FAX",o."ORG_BANK",o."ORG_ACCOUNT_NAME",o."ORG_ACCOUNT",o."ORG_HOSTILITY",o."ORG_WEB_SITE",o."ORG_MAIL",b.code_chi_name dept_type
from rsbt_org o,RSBT_CODE_DIC b
where  o.org_type = b.cn(+) and b.code_data_type(+)='00262006' and o.guid<>'null';

-- ----------------------------
-- View structure for V_RIM_RSM_GETSTATIONFREQ_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_GETSTATIONFREQ_R" AS 
select o."GUID",o."ORG_CODE",o."ORG_NAME",o."ORG_AREA_CODE",o."ORG_SYS_CODE",o."ORG_TYPE",o."ORG_LINK_PERSON",o."ORG_PERSON_ID",o."ORG_SUP_CODE",o."ORG_ADDR",o."ORG_POST",o."ORG_PHONE",o."ORG_MOB_PHONE",o."ORG_FAX",o."ORG_BANK",o."ORG_ACCOUNT_NAME",o."ORG_ACCOUNT",o."ORG_HOSTILITY",o."ORG_WEB_SITE",o."ORG_MAIL",b.code_chi_name dept_type
from rsbt_org o,RSBT_CODE_DIC b
where  o.org_type = b.cn(+) and b.code_data_type(+)='00262006' and o.guid<>'null';

-- ----------------------------
-- View structure for V_RIM_RSM_IMP_EAF
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_IMP_EAF" AS 
select eaf."GUID",eaf."STATION_GUID",eaf."EQU_GUID",eaf."ANT_GUID",eaf."FREQ_GUID",stat.net_guid,freq.freq_type,freq.freq_uc,freq.freq_efb,freq.freq_efe from RSBT_EAF eaf,rsbt_station stat,rsbt_freq freq
where eaf.station_guid = stat.guid and freq.guid=eaf.freq_guid
and stat.stat_app_type='TF';

-- ----------------------------
-- View structure for V_RIM_RSM_IMP_EAF_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_IMP_EAF_R" AS 
select eaf."GUID",eaf."STATION_GUID",eaf."EQU_GUID",eaf."ANT_GUID",eaf."FREQ_GUID",stat.net_guid,freq.freq_type,freq.freq_uc,freq.freq_efb,freq.freq_efe from RSBT_EAF_r eaf,rsbt_station_r stat,rsbt_freq_r freq
where eaf.station_guid = stat.guid and freq.guid=eaf.freq_guid
and stat.stat_app_type='TF';

-- ----------------------------
-- View structure for V_RIM_RSM_IMP_RSBT_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_IMP_RSBT_APPLY" AS 
select a.GUID, a.ORG_GUID, a.NET_GUID,
   a.ORG_MANAGER_GUID, a.APP_CODE, a.APP_TYPE,o.org_name,
   a.APP_SUB_TYPE, a.APP_OBJECT_TYPE,
   to_char(a.app_date,'yyyy-MM-dd') app_date,to_char(a.app_ftlb,'yyyy-MM-dd') app_ftlb,
   to_char(a.app_ftle,'yyyy-MM-dd') app_ftle,
   MEMO,o.org_area_code from rsbt_apply a,rsbt_org o
where a.org_guid = o.guid(+) and app_type<>'F';

-- ----------------------------
-- View structure for V_RIM_RSM_IMP_RSBT_APPLY_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_IMP_RSBT_APPLY_R" AS 
select a.GUID, a.ORG_GUID, a.NET_GUID,
   a.ORG_MANAGER_GUID, a.APP_CODE, a.APP_TYPE,o.org_name,
   a.APP_SUB_TYPE, a.APP_OBJECT_TYPE,
   to_char(a.app_date,'yyyy-MM-dd') app_date,to_char(a.app_ftlb,'yyyy-MM-dd') app_ftlb,
   to_char(a.app_ftle,'yyyy-MM-dd') app_ftle,
   MEMO,o.org_area_code from rsbt_apply_r a,rsbt_org o
where a.org_guid = o.guid(+) and app_type<>'F';

-- ----------------------------
-- View structure for V_RIM_RSM_INCREDIBLECORP
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_INCREDIBLECORP" AS 
select i.guid,i.org_guid,i.corporation,decode(i.inc_type,1,'干扰',2,'违规',3,'违法',4,'提供虚假信息','其他') inc_type_name,i.inc_type,
i.inc_date,i.description,o.org_name,o.org_code,o.org_area_code,o.org_sys_code,o.org_type,o.org_link_person,o.org_addr,
o.org_phone,o.org_mob_phone from t_rim_rsm_incrediblecorp i,rsbt_org o where i.org_guid = o.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_LIC_PN_SEL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LIC_PN_SEL" AS 
select a."GUID",a."STATION_GUID",a."APP_CODE",a."STAT_TDI",a."STAT_APP_TYPE",a."LICENSE_TYPE",a."LICENSE_CODE",
e.org_name "LICENSE_ORG_NAME",a."LICENSE_MANAGER",a."APPLY_CODE",a."LICENSE_DATE_B",a."LICENSE_DATE_E",a."LICENSE_DATE",
a."MEMO",a."LICSTATUES_GUID",a."EQUIP_NO",a."LICE_OK",a."NOTE",a."STAT_TDI_LIC",a."ORG_CODE",a."LICE_STATUS",
b.org_code area_code,c.input_status,a.rqcode,c.PRINT_DATE
from v_rim_rsm_licmage a,rsbt_station b,t_rim_rsm_lice_print_log c,rsbt_net d,rsbt_org e
where a.station_guid=b.guid(+) and a.rqcode=c.rqcode and b.net_guid=d.guid and d.org_guid=e.guid;

-- ----------------------------
-- View structure for V_RIM_RSM_LICE_HISTORY_VIEW
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICE_HISTORY_VIEW" AS 
select a.guid,lice_code,user_id,cache_type,cache_date,lice_begin_date,lice_end_date,b.username,a.memo,
  decode(cache_type,'0','生成执照信息','1','取消执照信息','2','打印执照','3','执照年审','4','执照停用','5','执照换发','6','取消执照年审','7','执照注销','8','执照恢复',cache_type) cache_type_name
from t_rim_rsm_lice_cache a ,t_rim_comm_user b
where upper(a.user_id)=upper(b.userid(+)) order by cache_date desc;

-- ----------------------------
-- View structure for V_RIM_RSM_LICE_ORGCOUNT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICE_ORGCOUNT" AS 
select a.license_type,b.license_code, e.org_area_code area_code,a.license_date, f_rim_rsm_licevalidcheck(a.license_date_e,b.lice_ok) lice_status,
       DECODE(a.license_type,'1','A类执照','0','B类执照') license_type_v,decode(nvl(b.printstatus,'0'),'0','未打印','1','已打印') printstatus,
       decode(d.app_type,'T', e.org_name,'PA',f.app_pa_name) org_name,decode(d.app_type,'T', e.org_addr,'PA',f.app_pa_contact_addr) org_addr,
       decode(d.app_type,'T', e.guid,'PA',f.guid) org_guid,h.code_chi_name area_name
from rsbt_license a ,t_rim_rsm_lic_statues b,rsbt_apply d,rsbt_org e,rsbt_apply_pa f,rsbt_code_dic h
where a.guid=b.guid and a.app_code=d.app_code(+) and d.org_guid=e.guid(+) and d.guid=f.guid(+)
and  e.org_area_code=h.cn(+) and  h.code_data_type(+)='00032006' and decode(d.app_type,'T', e.org_name,'PA',f.app_pa_name) is not null;

-- ----------------------------
-- View structure for V_RIM_RSM_LICE_PN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICE_PN" AS 
select a.guid,a.papernum,a.area_code,c.license_code,b.guid license_guid,b.station_guid station_guid,a.useredtype,a.note,a.enterdate, b.license_org_name,b.app_code,b.stat_tdi stat_tdino,b.stat_app_type,b.stat_app_type||b.stat_tdi stat_tdi,b.license_date_e,
c.equip_no,f_rim_rsm_licevalidcheck(b.license_date_e,c.lice_ok) lice_status,decode(b.license_type,'0','B类执照','1','A类执照') LICE_type,d.guid app_guid,a.rqcode
from  t_rim_rsm_lice_pn a, rsbt_license b,t_rim_rsm_lic_statues c,rsbt_apply d
where a.license_guid=b.guid(+) and b.guid=c.guid(+) and b.app_code=d.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_LICE_PN_ALLOT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICE_PN_ALLOT" AS 
select a.guid,a.papernum_b||' — '||a.papernum_e paperNum,a.papernum_b,a.papernum_e, a.allotdate,b.org_name ,b.org_area_code
from t_rim_rsm_lice_pn_allot a,rsbt_org b where a.org_guid=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_LICE_PN_ALLOTGD
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICE_PN_ALLOTGD" AS 
select A.guid, b.code_chi_name org_name, a.licen_count,a.licen_date,a.area_code,
decode(a.licen_status,'0','领用','1','报废')licen_status,memo,a.licen_status status
  from t_rim_rsm_licensepapergd a,rsbt_code_dic b
  where a.area_code=b.cn(+) and b.code_data_type='00032006';

-- ----------------------------
-- View structure for V_RIM_RSM_LICE_PRINT_LOG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICE_PRINT_LOG" AS 
select t.guid,t.license_guid,t.license_code,t.print_date,t.input_status,t.status_desc,t.assessor,t.note,t.Rqcode,t.Area_Code,
decode(t.input_status,'0','已打印未登记','1','已打印已登记','2','取消') input_status_v,
  log_status,decode(t.log_status,'1','正常','2','报废取消','3','故障取消') log_status_v,
  use_status,decode(t.use_status,'1',decode(t.log_status,'1','在用'),'0','无效') use_status_v,f.org_name
  from t_rim_rsm_lice_print_log t,t_rim_rsm_lic_statues b ,rsbt_station c,rsbt_net d ,rsbt_org f
  where t.license_guid=b.guid(+) and b.station_guid=c.guid(+) and c.net_guid=d.guid(+) and d.org_guid=f.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_ALERT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_ALERT" AS 
select b.guid license_guid, d.guid org_guid,a.net_guid,a.guid station_guid,a.app_code,substr(a.app_code,-12,12) app_codedes,a.STAT_APP_Type||a.STAT_TDI STAT_TDI,a.STAT_TDI stat_tdino,'' equ_code,'' equ_menu,
  nvl(a.org_code,substr(substr(a.app_code,-12,12),1,4)||'00') area_code,decode(substr(a.APP_CODE,1,1) ,'P',f_rim_rsm_GetPaNameByAppCode(a.app_code),d.org_name) org_name,
  a.stat_addr,a.stat_type stat_type_code,a.STAT_Date_Start,b.guid lic_guid,b.license_type,f_rim_rsm_licevalidcheck(b.license_date_e,b.lice_ok) lice_status,b.license_code,nvl(b.equip_no,'1') equip_no,
  b.license_date_b,b.license_date_e, b.license_date,b.memo,a.STAT_APP_Type decl_key ,d.org_sys_code,'A' as LICE_type,nvl( d.org_mail,'') org_mail,nvl(i.print_count,0) print_count,f_rim_rsm_isalert(i.end_date,i.isalert)  isalert
  ,decode(nvl(b.printstatus,0),'0','未打印','已打印') printstatus,b.rqcode
from v_rim_rsm_licmage b,rsbt_station a,rsbt_net c,rsbt_org d, t_rim_rsm_alert_info  i
where b.station_guid=a.guid(+) and a.net_guid=c.guid(+) and c.org_guid=d.guid(+)
and a.STAT_APP_Type<>'LM' and b.license_type='1' and b.guid = i.object_guid(+) and  i.object_type(+) = '1'
union all
  select b.guid license_guid, d.guid org_guid,a.net_guid,a.station_guid station_guid,a.app_code,substr(a.app_code,-12,12) app_codedes,a.STAT_APP_Type||a.STAT_TDI stat_tdi,a.STAT_TDI stat_tdino, a.EQU_Code,a.EQU_MENU,
  decode(a.org_code,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.org_code) area_code,decode(substr(a.APP_CODE,1,1) ,'P',f_rim_rsm_GetPaNameByAppCode(a.app_code),d.org_name) org_name,
  a.stat_addr,a.stat_type stat_type_code,a.STAT_Date_Start,b.guid lic_guid, b.license_type,
   f_rim_rsm_licevalidcheck(b.license_date_e,b.lice_ok) lice_status,b.license_code,decode(nvl(b.equip_no,''),'',a.et_equ_no,b.equip_no) equip_no,b.license_date_b,
  b.license_date_e,b.license_date, b.memo,a.STAT_APP_Type decl_key,d.org_sys_code,'B' as LICE_type,nvl( d.org_mail,'') org_mail,nvl(i.print_count,0) print_count,f_rim_rsm_isalert(i.end_date,i.isalert)  isalert
  ,decode(nvl(b.printstatus,0),'0','未打印','已打印') printstatus,b.rqcode
  from V_rim_rsm_STAT_EQU a,v_rim_rsm_licmage b,rsbt_station s,rsbt_net c,rsbt_org d,RSBT_CODE_DIC g,t_rim_rsm_alert_info i
  where a.STAT_APP_Type='LM' and a.STAT_Status='1' and b.station_guid=s.guid
  and  a.STATION_GUID=b.station_guid and a.ET_EQU_NO=b.equip_no
  and s.net_guid=c.guid(+)
  and c.ORG_GUID=d.guid(+) and b.guid = i.object_guid(+) and i.object_type(+)='1'
  and s.org_code=g.cn(+) and g.code_data_type(+)='00032006';

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_ALL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_ALL" AS 
select b.guid,b.licstatues_guid as license_guid, d.guid org_guid,a.net_guid,a.guid station_guid,b.app_code,substr(a.app_code,-12,12) app_codedes,b.STAT_APP_Type||b.STAT_TDI STAT_TDI,
b.STAT_TDI stat_tdino,'' equ_code,'' equ_menu,
  nvl(a.org_code,substr(substr(a.app_code,-12,12),1,4)||'00') area_code,decode(substr(a.APP_CODE,1,1) ,'P',f_rim_rsm_GetPaNameByAppCode(a.app_code),d.org_name) org_name,
  a.stat_addr,a.stat_type stat_type_code,a.STAT_Date_Start,b.guid lic_guid,b.license_type,
  f_rim_rsm_licevalidcheck(b.license_date_e,b.lice_ok) lice_status ,f_rim_rsm_licevalidcheckFlag(b.license_date_e,b.lice_ok) as lice_statusFLAG,
  b.license_code,nvl(b.equip_no,'1') equip_no,
  b.license_date_b,b.license_date_e, b.license_date,b.memo,a.STAT_APP_Type decl_key ,d.org_sys_code,'A' as LICE_type,nvl( d.org_mail,'') org_mail
  ,decode(nvl(b.printstatus,0),'0','未打印','已打印') printstatus,decode(nvl(b.printstatus,0),'0','0','1') printstatusFLAG
from v_rim_rsm_licmage b,rsbt_station a,rsbt_net c,rsbt_org d
where b.station_guid=a.guid(+) and a.net_guid=c.guid(+) and c.org_guid=d.guid(+)
and a.STAT_APP_Type<>'LM' and b.license_type='1'
union all
  select b.guid,b.licstatues_guid as license_guid, d.guid org_guid,a.net_guid,a.station_guid station_guid,b.app_code,substr(a.app_code,-12,12) app_codedes,b.STAT_APP_Type||b.STAT_TDI stat_tdi,
  b.STAT_TDI stat_tdino, a.EQU_Code,a.EQU_MENU,
  decode(a.org_code,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.org_code) area_code,
  decode(substr(a.APP_CODE,1,1) ,'P',f_rim_rsm_GetPaNameByAppCode(a.app_code),d.org_name) org_name,
  a.stat_addr,a.stat_type stat_type_code,a.STAT_Date_Start,b.guid lic_guid, b.license_type,
   f_rim_rsm_licevalidcheck(b.license_date_e,b.lice_ok) lice_status,f_rim_rsm_licevalidcheckFlag(b.license_date_e,b.lice_ok) as lice_statusFLAG,
   b.license_code,decode(nvl(b.equip_no,''),'',a.et_equ_no,b.equip_no) equip_no,b.license_date_b,
  b.license_date_e,b.license_date, b.memo,a.STAT_APP_Type decl_key,d.org_sys_code,'B' as LICE_type,nvl( d.org_mail,'') org_mail
  ,decode(nvl(b.printstatus,0),'0','未打印','已打印') printstatus,decode(nvl(b.printstatus,0),'0','0','1') printstatusFLAG
  from V_rim_rsm_STAT_EQU a,v_rim_rsm_licmage b,rsbt_station s,rsbt_net c,rsbt_org d,RSBT_CODE_DIC g
  where a.STAT_APP_Type='LM' and a.STAT_Status='1' and b.station_guid=s.guid
  and  a.STATION_GUID=b.station_guid and a.ET_EQU_NO=b.equip_no
  and s.net_guid=c.guid(+)
  and c.ORG_GUID=d.guid(+)
  and s.org_code=g.cn(+) and g.code_data_type(+)='00032006';

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_ANTFEED
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_ANTFEED" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,ANT_MODeL,ANT_MENU,ANT_HIGHT,ANT_GAIN,
    ANT_EGAIN,ANT_RGAIN,ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
    AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,
    AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,AT_H_VPIC,AT_ANT_UPANG,
    c.app_code,c.STAT_APP_Type||c.stat_tdi stat_tdi,d.code_chi_name ANT_Type_V,e.code_chi_name ANT_Work_V,
    f.code_chi_name AT_UNIT_TYPE_NAME
from rsbt_ANTFEED a,rsbt_ANTFEED_t b,rsbt_station c,RSBT_CODE_DIC d,RSBT_CODE_DIC e,RSBT_CODE_DIC f
  where a.guid=b.guid(+) and a.station_guid=c.guid(+)
    and a.ANT_Type=d.cn(+) and d.code_data_type(+)='00172006'
    and a.ANT_WORK_TYPE=e.cn(+) and e.code_data_type(+)='00322006'
    and B.AT_UNIT_TYPE=f.cn(+) and f.code_data_type(+)='00302006';

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_APPLY" AS 
select a.GUID,a.ORG_GUID,NET_GUID,ORG_Manager_GUID, app_code,APP_Type,APP_SUB_Type,APP_Object_Type,APP_Date,APP_FTLB,
        APP_FTLE,a.MEMO,decode(a.app_type,'T',org_name,'PA',e.app_pa_name,org_name) org_name,d.code_chi_name NET_Area_V
from rsbt_apply a,rsbt_org b,rsbt_net c,RSBT_CODE_DIC d,RSBT_APPLY_PA e
where a.org_guid=b.guid(+) and a.net_guid=c.guid(+) and c.NET_Area=d.cn(+) and a.guid=e.app_guid(+)
      and a.app_type<>'F' and d.code_data_type(+)='00022006';

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_AUDIT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_AUDIT" AS 
select a.guid LICENSE_guid,b.guid audit_guid,a.station_guid, a.app_code,A.STAT_TDI,a.stat_app_type||A.STAT_TDI stat_decl,d.LICENSE_CODE,A.LICENSE_TYPE,f.org_name LICENSE_ORG_NAME,decode(A.LICENSE_TYPE,'1','A类执照','0','B类执照') LICENSE_TYPE_NAME,
A.LICENSE_DATE_B,A.LICENSE_DATE_E,A.LICENSE_DATE, b.audit_year ,decode(b.audit_pass,'0','不合格','1','合格','未年审') audit_pass,
b.audit_result,decode(substr(a.app_code,1,1),'P',substr(a.app_code,3,4),substr(a.app_code,2,4))||'00' area_code,
c.stat_date_start,to_number(to_char(c.stat_date_start,'yyyy')) as stat_year_start
from rsbt_license a,t_Rim_Rsm_Lice_Audit b,rsbt_station c,t_rim_rsm_lic_statues d,rsbt_net e, rsbt_org f
where a.guid=b.License_Guid(+) and a.station_guid=c.guid(+) and a.guid=d.guid(+) and c.net_guid=e.guid(+) and e.fee_guid=f.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_EQU
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_EQU" AS 
SELECT A.GUID,STATION_GUID,EQU_TYPE,EQU_MODEL,EQU_AUTH,EQU_MENU,EQU_CODE,EQU_PF,EQU_POW,EQU_MB,
    ET_EQU_NO,ET_AF_TYPE,ET_EIRP,ET_POW_U,ET_EQU_CL,ET_EQU_TL,ET_EQU_RNQ,ET_EQU_TYPE_ID,
    ET_EQU_NAME,ET_EQU_CODE,ET_EQU_ESGN,ET_EQU_EPOS,ET_EQU_ATYPE,ET_EQU_APOS,ET_EQU_SUM,ET_EQU_EUSE,
    ET_EQU_FNTVAL,ET_EQU_PUP,ET_EQU_PDN,ET_EQU_CHRIP,ET_EQU_PWID1,ET_EQU_PWID2,ET_EQU_PR,ET_EQU_PF,
    ET_EQU_SEN,ET_EQU_SENU,ET_EQU_SENERR,ET_EQU_RWID,ET_EQU_MT,ET_EQU_CCODE,ET_EQU_UPU,ET_EQU_DNU,
    ET_EQU_TYPE,ET_EQU_USE,ET_EQU_POW_MAX,ET_EQU_POW_AVG ,b.ET_EQU_UPOW,b.ET_EQU_DPOW,b.ET_EQU_RF,
    b.ET_EQU_RF_BAND,c.app_code,c.STAT_APP_Type||c.stat_tdi stat_tdi,
    f_RIM_RSM_GETPOWER_W(a.equ_pow,b.ET_POW_U) EQU_POW_V,d.code_chi_name ET_POW_U_V,
    f_RIM_RSM_GETPOWER_W(b.ET_EQU_UPOW,b.ET_EQU_UPU) ET_EQU_UPOW_V,e.code_chi_name ET_EQU_UPU_V,
    f_RIM_RSM_GETPOWER_W(b.ET_EQU_DPOW,b.ET_EQU_DNU) ET_EQU_DPOW_V,f.code_chi_name ET_EQU_DNU_V
from rsbt_EQU a,rsbt_EQU_t b,rsbt_station c,RSBT_CODE_DIC d,RSBT_CODE_DIC e,RSBT_CODE_DIC f
  where a.guid=b.guid(+) and a.station_guid=c.guid(+)
        and b.ET_POW_U=d.cn(+) and d.code_data_type(+)='00282006'
        and b.ET_EQU_UPU=e.cn(+) and e.code_data_type(+)='00282006'
        and b.ET_EQU_DNU=f.cn(+) and f.code_data_type(+)='00282006';

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_EQU_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_EQU_FREQ" AS 
select T0.equ_model,T0.equ_pow,T0.equ_pf,T0.equ_mb,T0.equ_type,T0.equ_auth,T0.station_guid,
  T0.equ_menu,T0.guid,T0.equ_code,T1.et_equ_pwid2,T1.et_equ_pup,
  T1.et_equ_senerr,T1.et_pow_u,T1.et_equ_pr,T1.et_equ_type_id,T1.et_equ_upu,
  T1.et_equ_cl,T1.et_equ_fntval,T1.et_equ_pf,T1.et_equ_no,T1.et_equ_code,T1.et_equ_tl,
  T1.et_equ_epos,T1.et_equ_apos,T1.et_equ_chrip,T1.et_equ_rnq,T1.et_equ_name,T1.et_equ_use,
  T1.et_equ_ccode,T1.et_eirp,T1.et_equ_rwid,T1.et_equ_esgn,T1.et_equ_atype,T1.et_equ_pow_avg,
  T1.et_equ_pow_max,T1.et_equ_dnu,T1.et_af_type,T1.et_equ_type,T1.et_equ_senu,T1.et_equ_sen,
  T1.et_equ_mt,T1.et_equ_sum,T1.et_equ_pdn,T1.et_equ_euse,T1.et_equ_pwid1,T2.freq_mod,T2.freq_type,
  T2.freq_efe,decode(t2.FREQ_TYPE,'0', t2.FREQ_UC,'1', t2.FREQ_EFB) FREQ_EFB,T2.freq_mb,T2.freq_code,
  T2.freq_r_band,decode(t2.FREQ_TYPE,'0', t2.FREQ_LC,'1', t2.FREQ_RFB) FREQ_RFB,T2.freq_uc,
  T2.freq_e_band,T2.freq_lc,T2.freq_rfe,T3.ft_freq_type,T3.ft_freq_csgn,T3.ft_freq_mc1,
  T3.ft_freq_timee,T3.ft_freq_dupdn,T3.ft_freq_no,T3.ft_freq_hcl,T3.ft_freq_mc,T3.ft_freq_timeb,
  T3.ft_freq_mc2,T3.ft_freq_mc3,f_rim_rsm_GETFREQ_freq_Unit(FREQ_UC,FREQ_LC,FREQ_EFB,FREQ_RFB) ft_freq_unit_type,T3.ft_freq_info_type,T3.ft_freq_ccode,
  t1.ET_EQU_UPOW,t1.ET_EQU_DPOW,T1.ET_EQU_RF,  T1.ET_EQU_RF_BAND,
  FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_EPOW,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG,
  f_rim_rsm_GETPOWER_W(T0.equ_pow,T1.ET_POW_U) EQU_POW_V,T4.code_chi_name ET_POW_U_V,
  T5.app_code,T5.STAT_APP_Type,T5.stat_tdi
  from RSBT_EQU T0,RSBT_EQU_T T1,RSBT_freq T2,RSBT_freq_T T3,RSBT_CODE_DIC T4,rsbt_station T5
  where T0.Guid = T1.Guid(+) and t0.guid = t2.guid(+) and t0.guid = t3.guid(+) and T0.station_guid=T5.guid(+)
         and T1.ET_POW_U=T4.cn(+) and T4.code_data_type(+)='00282006';

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_FREQ" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,FREQ_LC,FREQ_UC,FREQ_EFB ,FREQ_EFE,FREQ_E_BAND,FREQ_RFB,FREQ_RFE,
      FREQ_R_BAND,FREQ_MOD,FREQ_MB,FREQ_CODE,FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,
      FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,
      FT_FREQ_DUPDN,f_RIM_RSM_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_EPOW,FT_FREQ_POWFLAG,FT_FREQ_EIRP,
      FT_FREQ_POW_MAX,FT_FREQ_POW_AVG,c.app_code,c.STAT_APP_Type||c.stat_tdi decl_code,d.code_chi_name FT_FREQ_Unit_Type_V,
      f_RIM_RSM_GETFREQ_R(FREQ_LC,f_RIM_RSM_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC_V,f_RIM_RSM_GETFREQ_R(FREQ_UC,f_RIM_RSM_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC_V,
      f_RIM_RSM_GETFREQ_R(FREQ_EFB,f_RIM_RSM_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_EFB_V,f_RIM_RSM_GETFREQ_R(FREQ_EFE,f_RIM_RSM_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_EFE_V,
      f_RIM_RSM_GETFREQ_R(FREQ_RFB,f_RIM_RSM_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_RFB_V,f_RIM_RSM_GETFREQ_R(FREQ_RFE,f_RIM_RSM_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_RFE_V,
      b.ft_freq_tfcode stat_code_b
  from rsbt_freq a,rsbt_freq_t b,rsbt_station c,RSBT_CODE_DIC d
  where a.guid=b.guid(+) and a.station_guid=c.guid(+) and f_RIM_RSM_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)=d.cn(+) and d.code_data_type(+)='00292006';

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_HISTORY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_HISTORY" AS 
select a.guid LICENSE_guid,a.station_guid, a.app_code,A.STAT_TDI,a.stat_app_type||A.STAT_TDI stat_decl,A.LICENSE_CODE,A.LICENSE_TYPE,A.LICENSE_ORG_NAME,decode(A.LICENSE_TYPE,'1','A类执照','0','B类执照') LICENSE_TYPE_NAME,
A.LICENSE_DATE_B,A.LICENSE_DATE_E,A.LICENSE_DATE ,
decode(substr(a.app_code,1,1),'P',substr(a.app_code,3,4),substr(a.app_code,2,4))||'00' area_code
from v_rim_rsm_licmage a,rsbt_station b
where a.station_guid=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_INQUIRE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_INQUIRE" AS 
select d.guid org_guid,a.net_guid,a.guid station_guid,apply.guid app_guid,a.app_code,a.STAT_APP_Type||a.STAT_TDI stat_tdi,'' equ_code,
        '' equ_menu,'A类执照' lice_type,
        decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.STAT_AREA_CODE)  area_code,
        --d.org_name
        DECODE(SUBSTR(a.app_code,0,2),'PA',f_rim_rsm_getpaname_QueryLice(a.app_code),d.org_name) as  org_name,----单位名称
        a.stat_addr,e.code_chi_name stat_type_v,
        a.stat_type,a.STAT_Date_Start,b.lice_ok,f_rim_rsm_licevalidcheck(b.license_date_e,b.lice_ok) lice_status,b.license_code,'A' lice_type_code,
        nvl(b.equip_no,'1') equip_no,b.license_date_b,b.license_date_e,b.license_date,b.note,a.stat_app_type decl_key,b.rqcode,decode(nvl(b.printstatus,0),'0','未打印','已打印') printstatus
  from rsbt_station a,v_rim_rsm_licmage b,rsbt_net c,rsbt_org d,RSBT_CODE_DIC e,rsbt_apply apply
  where b.station_guid(+)=a.guid and a.net_guid=c.guid(+) and a.stat_status='1'
        and c.ORG_GUID=d.guid(+) and a.stat_type=e.cn(+) and e.code_data_type(+)='00052006' and a.STAT_APP_Type<>'LM'
        and a.app_code = apply.app_code(+)
union all
    select a.org_guid ,a.net_guid,a. station_guid,apply.guid app_guid,a.app_code,a.stat_tdi,a.EQU_Code,
        a.EQU_MENU,'B类执照' lice_type,a.area_code,
        --a.org_name,
        DECODE(SUBSTR(a.app_code,0,2),'PA',f_rim_rsm_getpaname_QueryLice(a.app_code),a.org_name) as  org_name,----单位名称
        a.stat_addr,a.stat_type stat_type_v,
        a.stat_type_code stat_type,a.STAT_Date_Start,a.lice_ok,f_rim_rsm_licevalidcheck(a.license_date_e,a.lice_ok) lice_status,a.license_code,'A' lice_type_code,
        nvl(a.equip_no,'1') equip_no,a.license_date_b,a.license_date_e,a.license_date,a.memo,a.decl_key,a.rqcode,decode(nvl(a.printstatus,0),'0','未打印','已打印') printstatus
  from v_rim_rsm_license_lm a ,rsbt_apply apply
  where  a.app_code=apply.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_INQUIRE_AAA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_INQUIRE_AAA" AS 
select
  ----执照综合查询
  A."ORG_GUID",A."NET_GUID",A."STATION_GUID",A."APP_GUID",A."APP_CODE",A."STAT_TDI",A."EQU_CODE",A."EQU_MENU",A."LICE_TYPE",A."AREA_CODE",A."ORG_NAME",A."STAT_ADDR",A."STAT_TYPE_V",A."STAT_TYPE",A."STAT_DATE_START",A."LICE_OK",A."LICE_STATUS",A."LICENSE_CODE",A."LICE_TYPE_CODE",A."EQUIP_NO",A."LICENSE_DATE_B",A."LICENSE_DATE_E",A."LICENSE_DATE",A."NOTE",A."DECL_KEY",A."RQCODE",A."PRINTSTATUS",
  Substr(A.license_code,length(substr(A.app_code,0,length(A.app_code)-12))+1,length(A.license_code)) as license_code_TEmp
  from v_rim_rsm_license_inquire A;

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_LM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_LM" AS 
select d.guid org_guid,a.net_guid,a.station_guid station_guid,a.app_code,substr(a.app_code,-12,12) app_codedes,a.STAT_APP_Type||a.STAT_TDI stat_tdi,a.EQU_Code,a.EQU_MENU,a.STAT_TDI stat_tdino,b.guid lic_guid,
  decode(a.org_code,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.org_code) area_code,decode(substr(a.APP_CODE,1,1) ,'P',f_rim_rsm_GetPaNameByAppCode(a.app_code),d.org_name) org_name,
  a.stat_addr,e.code_chi_name stat_type,a.stat_type stat_type_code,a.STAT_Date_Start,b.lice_ok,b.license_date_e,f_rim_rsm_licevalidcheck(b.license_date_e,b.lice_ok) lice_status,b.license_code,decode(nvl(b.equip_no,''),'',a.et_equ_no,b.equip_no) equip_no,b.license_date_b,
  b.license_date,b.memo,a.STAT_APP_Type decl_key,d.org_sys_code,g.code_chi_name AREA_VIEW,a.equ_status,decode(nvl(b.printstatus,0),'0','未打印','已打印') printstatus,b.rqcode,decode(b.input_status,'0','未登记','1','已登记','未登记') input_status
  from V_rim_rsm_STAT_EQU a,v_rim_rsm_licmage b,rsbt_station s,rsbt_net c,rsbt_org d,RSBT_CODE_DIC e,RSBT_CODE_DIC g
  where a.STAT_APP_Type='LM' and a.STAT_Status='1' and a.station_guid=s.guid
  and  a.STATION_GUID=b.station_guid(+) and a.ET_EQU_NO=b.equip_no(+)
  and s.net_guid=c.guid(+)
  and c.ORG_GUID=d.guid(+)
  and s.stat_type=e.cn(+) and e.code_data_type(+)='00052006'
  and s.org_code=g.cn(+) and g.code_data_type(+)='00032006';

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_LM_AAA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_LM_AAA" AS 
select
  ----执照打印视图（B类执照）
    A."ORG_GUID",A."NET_GUID",A."STATION_GUID",A."APP_CODE",A."APP_CODEDES",A."STAT_TDI",A."EQU_CODE",A."EQU_MENU",A."STAT_TDINO",A."LIC_GUID",A."AREA_CODE",A."ORG_NAME",A."STAT_ADDR",A."STAT_TYPE",A."STAT_TYPE_CODE",A."STAT_DATE_START",A."LICE_OK",A."LICENSE_DATE_E",A."LICE_STATUS",A."LICENSE_CODE",A."EQUIP_NO",A."LICENSE_DATE_B",A."LICENSE_DATE",A."MEMO",A."DECL_KEY",A."ORG_SYS_CODE",A."AREA_VIEW",A."EQU_STATUS",A."PRINTSTATUS",A."RQCODE",A."INPUT_STATUS",
  Substr(A.license_code,length(substr(A.app_code,0,length(A.app_code)-12))+1,length(A.license_code)) as license_code_TEmp
    from v_rim_rsm_license_lm A
    where A.equ_status='1';

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_OTHER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_OTHER" AS 
select d.guid org_guid,a.net_guid,a.guid station_guid,a.app_code,substr(a.app_code,-12,12) app_codedes,a.STAT_APP_Type||a.STAT_TDI stat_tdi,'' equ_code,'' equ_menu,a.stat_tdi stat_tdino,b.guid lic_guid,
  decode(a.org_code,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.org_code) area_code,decode(substr(a.APP_CODE,1,1) ,'P',f_rim_rsm_getpanamebyappcode(a.app_code),d.org_name) org_name,
  a.stat_addr,e.code_chi_name stat_type,a.stat_type stat_type_code,a.STAT_Date_Start,b.lice_ok,b.license_date_e,f_rim_rsm_licevalidcheck(b.license_date_e,b.lice_ok) lice_status,b.license_code,nvl(b.equip_no,'1') equip_no,b.license_date_b,
  b.license_date,b.memo,a.STAT_APP_Type decl_key, d.org_sys_code,g.code_chi_name AREA_VIEW,decode(nvl(b.printstatus,0),'0','未打印','已打印') printstatus,b.rqcode,decode(b.input_status,'0','未登记','1','已登记','未登记') input_status
from rsbt_station a,v_rim_rsm_licmage b,rsbt_net c,rsbt_org d,RSBT_CODE_DIC e,RSBT_CODE_DIC g
where a.STAT_APP_Type<>'LM' and instr(nvl(b.stat_tdi,'ww'),'LM')=0
  and a.stat_status='1'
  and a.app_code=b.app_code(+) and a.STAT_APP_Type||a.STAT_TDI=b.stat_tdi_lic(+)
  and a.net_guid=c.guid(+)
  and c.ORG_GUID=d.guid(+)
  and a.stat_type=e.cn(+) and e.code_data_type(+)='00052006'
  and a.org_code=g.cn(+) and g.code_data_type(+)='00032006';

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_OTHER_AAA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_OTHER_AAA" AS 
select
  ----执照打印视图（A类执照）
    A."ORG_GUID",A."NET_GUID",A."STATION_GUID",A."APP_CODE",A."APP_CODEDES",A."STAT_TDI",A."EQU_CODE",A."EQU_MENU",A."STAT_TDINO",A."LIC_GUID",A."AREA_CODE",A."ORG_NAME",A."STAT_ADDR",A."STAT_TYPE",A."STAT_TYPE_CODE",A."STAT_DATE_START",A."LICE_OK",A."LICENSE_DATE_E",A."LICE_STATUS",A."LICENSE_CODE",A."EQUIP_NO",A."LICENSE_DATE_B",A."LICENSE_DATE",A."MEMO",A."DECL_KEY",A."ORG_SYS_CODE",A."AREA_VIEW",A."PRINTSTATUS",A."RQCODE",A."INPUT_STATUS",
  Substr(A.license_code,length(substr(A.app_code,0,length(A.app_code)-12))+1,length(A.license_code)) as license_code_TEmp
    from v_rim_rsm_license_other A;

-- ----------------------------
-- View structure for V_RIM_RSM_LICENSE_STATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICENSE_STATION" AS 
select a.GUID,NET_GUID,a.ORG_CODE, app_code,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,ST_ME_NAME2,
    ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,st_b_type1,ST_B_TYPE2,ST_ME_FILE_NO,STAT_APP_Type||STAT_TDI decl_code,
    c.code_chi_name ST_A_Type_V,d.code_chi_name STAT_TYPE_V,e.code_chi_name ST_B_BM_V,f.code_chi_name ST_E_MULTI_Addr_V,
    g.code_chi_name ST_TF_TRANS_CA_PU_V,b.ST_TF_CODE,h.code_chi_name st_b_type1_name,i.code_chi_name st_d_type_name,
    k.code_chi_name net_area_name
from rsbt_station a,rsbt_station_t b,rsbt_net j,RSBT_CODE_DIC c,RSBT_CODE_DIC d,RSBT_CODE_DIC e,RSBT_CODE_DIC f,RSBT_CODE_DIC g,
     rsbt_code_dic h,rsbt_code_dic i,rsbt_code_dic k
where a.guid=b.guid(+) and a.net_guid=j.guid and b.ST_A_Type=c.cn(+) and c.code_data_type(+)='00162006'
    and a.stat_type=d.cn(+) and d.code_data_type(+)='00052006'
    and b.ST_B_BM=e.cn(+) and e.code_data_type(+)='00142006'
    and b.ST_E_MULTI_Addr=f.cn(+) and f.code_data_type(+)='00122006'
    and b.ST_TF_TRANS_CA_PU=g.cn(+) and g.code_data_type(+)='00312006'
    and b.st_b_type1=h.cn(+) and h.code_data_type(+)='00462006'
    and b.st_d_type=i.cn(+) and i.code_data_type(+)='00422006'
    and j.net_area=k.cn(+) and k.code_data_type(+)='00022006';

-- ----------------------------
-- View structure for V_RIM_RSM_LICMAGE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LICMAGE" AS 
select
a.guid,a.station_guid,a.app_code,a.stat_tdi,a.stat_app_type,a.license_type,b.license_code,a.license_org_name,a.license_manager,substr(a.app_code,-12,12) apply_code,
       a.license_date_b,a.license_date_e,a.license_date,a.memo,b.guid licstatues_guid,b.equip_no,b.lice_ok,b.note,a.stat_app_type||a.stat_tdi stat_tdi_lic,substr(a.license_code,0,4)||'00' org_code,
f_rim_rsm_licevalidcheck(a.license_date_e,b.lice_ok) lice_status,b.printstatus,b.rqcode,c.input_status
from rsbt_license a ,t_rim_rsm_lic_statues b,t_rim_rsm_lice_print_log c where a.guid=b.guid(+) and b.guid=c.license_guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_LINK_DATA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LINK_DATA" AS 
select a.guid,a.net_guid_a,a.station_guid_a,l.st_tf_code station_code_a,a.net_guid_b,a.station_guid_b,b.org_code org_code_a,c.org_code org_code_b,b.stat_lg stat_lg_a,b.stat_la stat_la_a,c.stat_lg stat_lg_b,c.stat_la stat_la_b,
 				b.stat_app_type stat_app_type_a,c.stat_app_type stat_app_type_b, '' org_name_a,'' org_name_b, b.stat_name stat_name_a,c.stat_name stat_name_b,b.stat_addr stat_addr_a,c.stat_addr stat_addr_b,
 				m.st_tf_code station_code_b,b.app_code app_code_a,b.STAT_APP_Type||b.stat_tdi decl_code_a,
 				c.app_code app_code_b,c.STAT_APP_Type||c.stat_tdi decl_code_b,
 				l.st_tf_code || '--' || m.st_tf_code link_name,
                decode(nvl(f.FREQ_EFB,0),0,'单向',decode(nvl(g.FREQ_EFB,0),0,'单向','双向')) link_type,
                decode(f.freq_type,'1',decode(f.FREQ_EFB,null,'',f_rim_rsm_GETFREQ_R(f.FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(f.FREQ_LC,f.FREQ_UC,f.FREQ_EFB,f.FREQ_RFB))||'-'||f_rim_rsm_GETFREQ_R(f.FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(f.FREQ_LC,f.FREQ_UC,f.FREQ_EFB,f.FREQ_RFB))||j.code_chi_name),
                decode(f.FREQ_LC,null,decode(f.FREQ_UC,null,'',f_rim_rsm_GETFREQ_R(f.FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(f.FREQ_LC,f.FREQ_UC,f.FREQ_EFB,f.FREQ_RFB))||j.code_chi_name),f_rim_rsm_GETFREQ_R(f.FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(f.FREQ_LC,f.FREQ_UC,f.FREQ_EFB,f.FREQ_RFB))||j.code_chi_name)) freq_v_a,
 				decode(g.freq_type,'1',decode(g.FREQ_EFB,null,'',f_rim_rsm_GETFREQ_R(g.FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(g.FREQ_LC,g.FREQ_UC,g.FREQ_EFB,g.FREQ_RFB))||'-'||f_rim_rsm_GETFREQ_R(g.FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(g.FREQ_LC,g.FREQ_UC,g.FREQ_EFB,g.FREQ_RFB))||k.code_chi_name),
        decode(g.FREQ_LC,null,decode(g.FREQ_UC,null,'',f_rim_rsm_GETFREQ_R(g.FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(g.FREQ_LC,g.FREQ_UC,g.FREQ_EFB,g.FREQ_RFB))||k.code_chi_name),f_rim_rsm_GETFREQ_R(g.FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(g.FREQ_LC,g.FREQ_UC,g.FREQ_EFB,g.FREQ_RFB))||k.code_chi_name)) freq_v_b
 from rsbt_link a,rsbt_station b,rsbt_station c,rsbt_eaf d,rsbt_eaf e,
 		rsbt_freq f,rsbt_freq g,RSBT_CODE_DIC j,RSBT_CODE_DIC k,rsbt_station_t l,rsbt_station_t m
 where a.station_guid_a=b.guid and a.station_guid_b=c.guid and a.guid_eaf_a=d.guid and a.guid_eaf_b=e.guid
 			and d.freq_guid=f.guid and e.freq_guid=g.guid and a.station_guid_a is not null and a.station_guid_b is not null
 			and f_rim_rsm_GETFREQ_freq_Unit(f.FREQ_LC,f.FREQ_UC,f.FREQ_EFB,f.FREQ_RFB)=j.cn(+) and j.code_data_type(+)='00292006'
 			and f_rim_rsm_GETFREQ_freq_Unit(g.FREQ_LC,g.FREQ_UC,g.FREQ_EFB,g.FREQ_RFB)=k.cn(+) and k.code_data_type(+)='00292006'
 			and b.guid=l.guid and c.guid=m.guid;

-- ----------------------------
-- View structure for V_RIM_RSM_LINK_DATA_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LINK_DATA_R" AS 
select a.guid,a.net_guid_a,a.station_guid_a,l.st_tf_code station_code_a,a.net_guid_b,a.station_guid_b,
         b.stat_app_type stat_app_type_a,c.stat_app_type stat_app_type_b, '' org_name_a,'' org_name_b, b.stat_name stat_name_a,c.stat_name stat_name_b,b.stat_addr stat_addr_a,c.stat_addr stat_addr_b,
 	 m.st_tf_code station_code_b,b.app_code app_code_a,b.STAT_APP_Type||b.stat_tdi decl_code_a,
         c.app_code app_code_b,c.STAT_APP_Type||c.stat_tdi decl_code_b,
         l.st_tf_code || '--' || m.st_tf_code link_name,
                decode(nvl(f.FREQ_EFB,0),0,'单向',decode(nvl(g.FREQ_EFB,0),0,'单向','双向')) link_type,
                decode(f.freq_type,'1',decode(f.FREQ_EFB,null,'',f_rim_rsm_GETFREQ_R(f.FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(f.FREQ_LC,f.FREQ_UC,f.FREQ_EFB,f.FREQ_RFB))||'-'||f_rim_rsm_GETFREQ_R(f.FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(f.FREQ_LC,f.FREQ_UC,f.FREQ_EFB,f.FREQ_RFB))||j.code_chi_name),
                decode(f.FREQ_LC,null,decode(f.FREQ_UC,null,'',f_rim_rsm_GETFREQ_R(f.FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(f.FREQ_LC,f.FREQ_UC,f.FREQ_EFB,f.FREQ_RFB))||j.code_chi_name),f_rim_rsm_GETFREQ_R(f.FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(f.FREQ_LC,f.FREQ_UC,f.FREQ_EFB,f.FREQ_RFB))||j.code_chi_name)) freq_v_a,
         decode(g.freq_type,'1',decode(g.FREQ_EFB,null,'',f_rim_rsm_GETFREQ_R(g.FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(g.FREQ_LC,g.FREQ_UC,g.FREQ_EFB,g.FREQ_RFB))||'-'||f_rim_rsm_GETFREQ_R(g.FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(g.FREQ_LC,g.FREQ_UC,g.FREQ_EFB,g.FREQ_RFB))||k.code_chi_name),
        decode(g.FREQ_LC,null,decode(g.FREQ_UC,null,'',f_rim_rsm_GETFREQ_R(g.FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(g.FREQ_LC,g.FREQ_UC,g.FREQ_EFB,g.FREQ_RFB))||k.code_chi_name),f_rim_rsm_GETFREQ_R(g.FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(g.FREQ_LC,g.FREQ_UC,g.FREQ_EFB,g.FREQ_RFB))||k.code_chi_name)) freq_v_b
 from rsbt_link_r a,rsbt_station_r b,rsbt_station_r c,rsbt_eaf_r d,rsbt_eaf_r e,
     rsbt_freq_r f,rsbt_freq_r g,RSBT_CODE_DIC j,RSBT_CODE_DIC k,rsbt_station_t_r l,rsbt_station_t_r m
 where a.station_guid_a=b.guid and a.station_guid_b=c.guid and a.guid_eaf_a=d.guid and a.guid_eaf_b=e.guid
       and d.freq_guid=f.guid and e.freq_guid=g.guid and a.station_guid_a is not null and a.station_guid_b is not null
       and f_rim_rsm_GETFREQ_freq_Unit(f.FREQ_LC,f.FREQ_UC,f.FREQ_EFB,f.FREQ_RFB)=j.cn(+) and j.code_data_type(+)='00292006'
       and f_rim_rsm_GETFREQ_freq_Unit(g.FREQ_LC,g.FREQ_UC,g.FREQ_EFB,g.FREQ_RFB)=k.cn(+) and k.code_data_type(+)='00292006'
       and b.guid=l.guid and c.guid=m.guid;

-- ----------------------------
-- View structure for V_RIM_RSM_LINK_DETAIL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LINK_DETAIL" AS 
select a."GUID",a."NET_GUID_A",a."STATION_GUID_A",a."GUID_EAF_A",a."NET_GUID_B",a."STATION_GUID_B",a."GUID_EAF_B",stat_t_a.st_tf_code||'--'||stat_t_b.st_tf_code link_name,org_a.org_name org_name_a,dic_a.code_chi_name stat_type_a, stat_a.stat_la stat_la_a,stat_a.stat_lg stat_lg_a,stat_a.stat_addr stat_addr_a,stat_a.app_code app_code_a,stat_a.stat_app_type||stat_a.stat_tdi stat_tdi_a,stat_a.stat_name stat_name_a,stat_t_a.st_tf_code stat_code_a,
         eaf_a.tf_code tf_code_a,eaf_a.ft_freq_no ft_freq_no_a,eaf_a.freq_title freq_title_a,eaf_a.EQU_CODE equ_code_a,eaf_a.equ_model equ_model_a,
         eaf_a.et_equ_no et_equ_no_a,eaf_a.at_ant_no at_ant_no_a,eaf_a.ant_title ant_title_a,eaf_a.ant_angle ant_angle_a,
         org_b.org_name org_name_b,dic_b.code_chi_name stat_type_b,stat_b.stat_la stat_la_b,stat_b.stat_lg stat_lg_b,stat_b.stat_addr stat_addr_b,stat_b.app_code app_code_b,stat_b.stat_app_type||stat_b.stat_tdi stat_tdi_b,
         stat_b.stat_name stat_name_b,stat_t_b.st_tf_code stat_code_b,eaf_b.tf_code tf_code_b,eaf_b.ft_freq_no ft_freq_no_b,eaf_b.freq_title freq_title_b,
         eaf_b.EQU_CODE equ_code_b,eaf_b.equ_model equ_model_b,eaf_b.et_equ_no et_equ_no_b,eaf_b.ant_title ant_title_b,eaf_b.at_ant_no at_ant_no_b,eaf_b.ant_angle ant_angle_b
    from rsbt_link a,rsbt_station stat_a,rsbt_station_t stat_t_a,rsbt_station stat_b,rsbt_station_t stat_t_b, v_rim_rsm_stat_eaf eaf_a,v_rim_rsm_stat_eaf eaf_b,rsbt_net net_a, rsbt_net net_b,
    rsbt_org org_a,rsbt_org org_b,rsbt_code_dic dic_a ,rsbt_code_dic dic_b
where a.station_guid_a=stat_a.guid and stat_a.guid=stat_t_a.guid(+) and a.station_guid_b=stat_b.guid  and stat_b.guid=stat_t_b.guid(+) and  a.guid_eaf_a=eaf_a.guid and a.guid_eaf_b=eaf_b.guid
and stat_a.net_guid=net_a.guid(+) and stat_b.net_guid=net_b.guid(+) and net_a.org_guid=org_a.guid(+) and net_b.org_guid=org_b.guid(+)
and stat_a.stat_type=dic_a.cn(+) and dic_a.code_data_type(+)='00052006' and stat_b.stat_type=dic_b.cn(+) and dic_b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_LINK_EAF
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LINK_EAF" AS 
select distinct station_guid,freq_guid,st_tf_code,tf_code_b stat_code_b from
(select a.station_guid_a station_guid,b.freq_guid,c.st_tf_code,c.st_tf_code tf_code_b
from rsbt_link a,rsbt_eaf b,rsbt_station_t c where a.guid_eaf_b=b.guid and a.station_guid_a=c.guid
union all
select a.station_guid_b station_guid,b.freq_guid,c.st_tf_code,c.st_tf_code tf_code_b
from rsbt_link a,rsbt_eaf b,rsbt_station_t c where a.guid_eaf_a=b.guid and a.station_guid_b=c.guid);

-- ----------------------------
-- View structure for V_RIM_RSM_LINK_EAF_A
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LINK_EAF_A" AS 
select
----取地面固定业务台（站）技术资料申请表（转化通讯对象的站代号）
distinct station_guid,Station_GUID_B,freq_guid,equ_guid,ant_guid,st_tf_code,tf_code_b stat_code_b,FT_FREQ_NO
from
(select a.station_guid_a station_guid,a.Station_GUID_B Station_GUID_B,b.freq_guid,
b.equ_guid,b.ant_guid,c.st_tf_code,e.st_tf_code tf_code_b,T1.FT_FREQ_NO
from rsbt_link a,rsbt_eaf b,rsbt_station_t c,rsbt_eaf d,rsbt_station_t e,RSBT_FREQ_T T1
where a.guid_eaf_a=b.guid and a.station_guid_a=c.guid and a.guid_eaf_b=d.guid and a.station_guid_b=e.guid
and b.freq_guid=t1.guid
union
select a.station_guid_b station_guid,a.Station_GUID_a Station_GUID_B,b.freq_guid,
b.equ_guid,b.ant_guid,c.st_tf_code,e.st_tf_code tf_code_b,T2.FT_FREQ_NO
from rsbt_link a,rsbt_eaf b,rsbt_station_t c,rsbt_eaf d,rsbt_station_t e,RSBT_FREQ_T T2
where a.guid_eaf_b=b.guid and a.station_guid_b=c.guid and a.guid_eaf_a=d.guid
and a.station_guid_a=e.guid and b.freq_guid=t2.guid) order by stat_code_b,FT_FREQ_NO;

-- ----------------------------
-- View structure for V_RIM_RSM_LINK_EAF_B
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LINK_EAF_B" AS 
SELECT
 ------取地面固定业务台（站）技术资料申请表（转化通讯对象的站代号）
 ----没有关联关系的频率Guid---FREQ_GUID
  A.FREQ_GUID,A.GUID,A.STATION_GUID FROM V_RIM_RSM_LINK_EAF_BB A where A.guid is Null;

-- ----------------------------
-- View structure for V_RIM_RSM_LINK_EAF_BB
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LINK_EAF_BB" AS 
select
 ------取地面固定业务台（站）技术资料申请表（转化通讯对象的站代号）
 ----没有关联关系的频率Guid---FREQ_GUID（转换视图）
a.guid freq_guid,c.freq_guid guid,a.station_guid,b.ft_freq_no
from rsbt_freq a,RSBT_FREQ_T b,
( select distinct freq_guid from
 (select e_a.freq_guid from rsbt_link l_a,rsbt_eaf e_a where l_a.guid_eaf_a=e_a.guid
union
  select e_b.freq_guid from rsbt_link l_b,rsbt_eaf e_b where l_b.guid_eaf_b=e_b.guid)) c
where a.guid=c.freq_guid(+) and a.guid=b.guid
 order by b.ft_freq_no;

-- ----------------------------
-- View structure for V_RIM_RSM_LINK_EAF_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LINK_EAF_R" AS 
select distinct station_guid,freq_guid,st_tf_code,tf_code_b stat_code_b from
(select a.station_guid_a station_guid,b.freq_guid,c.st_tf_code,c.st_tf_code tf_code_b
from rsbt_link_r a,rsbt_eaf_r b,rsbt_station_t_r c where a.guid_eaf_b=b.guid and a.station_guid_a=c.guid
union all
select a.station_guid_b station_guid,b.freq_guid,c.st_tf_code,c.st_tf_code tf_code_b
from rsbt_link_r a,rsbt_eaf_r b,rsbt_station_t_r c where a.guid_eaf_a=b.guid and a.station_guid_b=c.guid);

-- ----------------------------
-- View structure for V_RIM_RSM_LINK_SEL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_LINK_SEL" AS 
select a."GUID",a."NET_GUID_A",a."STATION_GUID_A",a."GUID_EAF_A",a."NET_GUID_B",a."STATION_GUID_B",a."GUID_EAF_B",stat_t_a.st_tf_code||'--'||stat_t_b.st_tf_code link_name,org_a.org_name org_name_a,dic_a.code_chi_name stat_type_a, stat_a.stat_la stat_la_a,stat_a.stat_lg stat_lg_a,stat_a.stat_addr stat_addr_a,
       stat_a.app_code app_code_a,stat_a.stat_app_type||stat_a.stat_tdi stat_tdi_a,stat_a.stat_name stat_name_a,stat_t_a.st_tf_code stat_code_a,
         eaf_a.tf_code tf_code_a,eaf_a.ft_freq_no ft_freq_no_a,eaf_a.freq_title freq_title_a,eaf_a.FREQ_EFB freq_efb_a,eaf_a.FREQ_EFE freq_efe_a,eaf_a.EQU_CODE equ_code_a,eaf_a.equ_model equ_model_a,
         eaf_a.et_equ_no et_equ_no_a,eaf_a.at_ant_no at_ant_no_a,eaf_a.ant_title ant_title_a,eaf_a.ant_angle ant_angle_a,
         org_b.org_name org_name_b,dic_b.code_chi_name stat_type_b,dic_b.cn stat_type_code,stat_b.stat_la stat_la_b,stat_b.stat_lg stat_lg_b,stat_b.stat_addr stat_addr_b,stat_b.app_code app_code_b,stat_b.stat_app_type||stat_b.stat_tdi stat_tdi_b,
         stat_b.stat_name stat_name_b,stat_t_b.st_tf_code stat_code_b,eaf_b.tf_code tf_code_b,eaf_b.ft_freq_no ft_freq_no_b,eaf_b.freq_title freq_title_b,eaf_b.FREQ_EFB freq_efb_b,eaf_b.FREQ_EFE freq_efe_b,
         eaf_b.EQU_CODE equ_code_b,eaf_b.equ_model equ_model_b,eaf_b.et_equ_no et_equ_no_b,eaf_b.ant_title ant_title_b,eaf_b.at_ant_no at_ant_no_b,eaf_b.ant_angle ant_angle_b,stat_a.org_code area_code
    from rsbt_link a,rsbt_station stat_a,rsbt_station_t stat_t_a,rsbt_station stat_b,rsbt_station_t stat_t_b, v_rim_rsm_stat_eaf eaf_a,v_rim_rsm_stat_eaf eaf_b,rsbt_net net_a, rsbt_net net_b,
    rsbt_org org_a,rsbt_org org_b,rsbt_code_dic dic_a ,rsbt_code_dic dic_b
where a.station_guid_a=stat_a.guid and stat_a.guid=stat_t_a.guid(+) and a.station_guid_b=stat_b.guid  and stat_b.guid=stat_t_b.guid(+) and  a.guid_eaf_a=eaf_a.guid and a.guid_eaf_b=eaf_b.guid
and stat_a.net_guid=net_a.guid(+) and stat_b.net_guid=net_b.guid(+) and net_a.org_guid=org_a.guid(+) and net_b.org_guid=org_b.guid(+)
and stat_a.stat_type=dic_a.cn(+) and dic_a.code_data_type(+)='00052006' and stat_b.stat_type=dic_b.cn(+) and dic_b.code_data_type(+)='00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_NET_RSAPPLYBYNAMES
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_NET_RSAPPLYBYNAMES" AS 
select GUID,
  ORG_GUID,
  FEE_GUID,
  ORG_CODE,
  NET_NAME,
  NET_SVN,
  decode(NET_NAME,null,'空网络名称',NET_NAME) || '_' || decode(svn.code_chi_name,null,'无通信业务',svn.code_chi_name) || '_' || decode(ts.code_chi_name,null,'无技术体制',ts.code_chi_name) net_names,
  NET_SP,
  NET_TS,
  NET_BAND,
  NET_AREA,
  NET_USE,
  NET_SAT_NAME,
  NET_LG,
  NET_START_DATE,
  NET_CONFIRM_DATE,
  NET_EXPIRED_DATE
  from rsbt_net t,rsbt_code_dic svn,rsbt_code_dic ts
  where t.net_svn = svn.cn(+) and t.net_ts = ts.cn(+)
  and org_guid != 'null';

-- ----------------------------
-- View structure for V_RIM_RSM_NET_RSAPPLYBYNAMES_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_NET_RSAPPLYBYNAMES_R" AS 
select GUID,
  ORG_GUID,
  FEE_GUID,
  ORG_CODE,
  NET_NAME,
  NET_SVN,
  decode(NET_NAME,null,'空网络名称',NET_NAME) || '_' || decode(svn.code_chi_name,null,'无通信业务',svn.code_chi_name) || '_' || decode(ts.code_chi_name,null,'无技术体制',ts.code_chi_name) net_names,
  NET_SP,
  NET_TS,
  NET_BAND,
  NET_AREA,
  NET_USE,
  NET_SAT_NAME,
  NET_LG,
  NET_START_DATE,
  NET_CONFIRM_DATE,
  NET_EXPIRED_DATE
  from rsbt_net_r t,rsbt_code_dic svn,rsbt_code_dic ts
  where t.net_svn = svn.cn(+) and t.net_ts = ts.cn(+)
  and org_guid != 'null';

-- ----------------------------
-- View structure for V_RIM_RSM_OPERATORINFO
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_OPERATORINFO" AS 
select "OP_GUID","ORG_NAME","NAME","GENDER","CARDID","EMAIL","PHONE","MOBILEPHONE","FAX","ADDRESS","POST","WEBSITE","BIRTHDAY","OP_TYPE","QUALIFICATIONID" from t_rim_rsm_operator;

-- ----------------------------
-- View structure for V_RIM_RSM_ORG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_ORG" AS 
select c.Guid,decode(length(c.ORG_Code),9,substr(c.ORG_Code,1,8)||'-'||substr(c.ORG_Code,9,1),c.ORG_Code) org_code,c.ORG_Name,F_rim_rsm_Getareacode(c.ORG_Area_Code) ORG_Area_Code,c.ORG_SYS_Code,c.ORG_Type,b.code_chi_name dept_type,c.org_link_person,
c.org_person_id,c.org_sup_code,c.org_addr,c.org_post,c.org_phone,c.org_mob_phone,c.org_fax,c.org_bank,c.org_account_name,c.org_account,
c.org_mail,c.org_web_site,c.org_hostility,e.code_chi_name dept_sys_code,h.code_chi_name dept_area,i.code_chi_name host,
j.org_guid stat_org_guid,decode(j.org_guid,null,'N','Y') is_stat
from rsbt_org c,RSBT_CODE_DIC b,RSBT_CODE_DIC e,RSBT_CODE_DIC h,RSBT_CODE_DIC i,
     (select distinct org_guid from rsbt_net
     union select distinct fee_guid as org_guid from rsbt_net
     union select distinct org_guid from rsbt_apply) j
where c.org_type = b.cn(+) and b.code_data_type(+)='00262006' and c.guid<>'null'
   and (c.org_sys_code = e.cn(+) and e.code_data_type(+)='00092006')
   and (c.org_area_code = h.cn(+) and h.code_data_type(+)='00032006')
   and (to_char(c.org_hostility) = i.cn(+) and i.code_data_type(+)='00552006') and c.guid=j.org_guid(+)
   and c.org_type not in ('000','008');

-- ----------------------------
-- View structure for V_RIM_RSM_ORG_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_ORG_APPLY" AS 
select
t1."GUID",t1."ORG_CODE",t1."ORG_NAME",t1."ORG_AREA_CODE",t1."ORG_SYS_CODE",t1."ORG_TYPE",t1."ORG_LINK_PERSON",t1."ORG_PERSON_ID",t1."ORG_SUP_CODE",t1."ORG_ADDR",t1."ORG_POST",t1."ORG_PHONE",t1."ORG_MOB_PHONE",t1."ORG_FAX",t1."ORG_BANK",t1."ORG_ACCOUNT_NAME",t1."ORG_ACCOUNT",t1."ORG_HOSTILITY",t1."ORG_WEB_SITE",t1."ORG_MAIL",
t2.code_chi_name org_type_name,
t3.code_chi_name org_area_name,
t4.code_chi_name org_sys_name,
t5.code_chi_name ORG_Hostility_name
from
rsbt_org t1,
rsbt_code_dic t2,
rsbt_code_dic t3,
rsbt_code_dic t4,
rsbt_code_dic t5
where
t1.org_type = t2.cn(+) and t2.code_data_type(+)='00262006' and t1.guid<>'null'
and (t1.org_sys_code = t3.cn(+) and t3.code_data_type(+)='00092006')
and (t1.org_area_code = t4.cn(+) and t4.code_data_type(+)='00032006')
and (to_char(t1.ORG_Hostility) = t5.cn(+) and t5.code_data_type(+)='00552006')
and org_type not in ('000','008');

-- ----------------------------
-- View structure for V_RIM_RSM_ORG_APPLY_ABC
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_ORG_APPLY_ABC" AS 
select c.Guid,decode(length(c.ORG_Code),9,substr(c.ORG_Code,1,8)||'-'||substr(c.ORG_Code,9,1),c.ORG_Code) org_code,c.ORG_Name,F_rim_rsm_Getareacode(c.ORG_Area_Code) ORG_Area_Code,c.ORG_SYS_Code,c.ORG_Type,b.code_chi_name dept_type,c.org_link_person,
c.org_person_id,c.org_sup_code,c.org_addr,c.org_post,c.org_phone,c.org_mob_phone,c.org_fax,c.org_bank,c.org_account_name,c.org_account,
c.org_mail,c.org_web_site,c.org_hostility,e.code_chi_name dept_sys_code,h.code_chi_name dept_area,i.code_chi_name host,
j.org_guid stat_org_guid,decode(j.org_guid,null,'N','Y') is_stat,r.parent_org_guid parentId
from rsbt_org c,RSBT_CODE_DIC b,RSBT_CODE_DIC e,RSBT_CODE_DIC h,RSBT_CODE_DIC i,t_rim_rsm_org_relev r,
     (select distinct org_guid from rsbt_net
     union select distinct fee_guid as org_guid from rsbt_net
     union select distinct org_guid from rsbt_apply) j
where c.org_type = b.cn(+) and b.code_data_type(+)='00262006' and c.guid<>'null'
   and (c.org_sys_code = e.cn(+) and e.code_data_type(+)='00092006')
   and (c.org_area_code = h.cn(+) and h.code_data_type(+)='00032006')
   and (to_char(c.org_hostility) = i.cn(+) and i.code_data_type(+)='00552006') and c.guid=j.org_guid(+)
   and c.org_type not in ('000','008') and c.guid = r.child_org_guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_ORG_MANAGER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_ORG_MANAGER" AS 
select c.Guid,decode(length(c.ORG_Code),9,substr(c.ORG_Code,1,8)||'-'||substr(c.ORG_Code,9,1),c.ORG_Code) org_code,c.ORG_Name,

F_rim_rsm_Getareacode(c.ORG_Area_Code) ORG_Area_Code,
c.ORG_SYS_Code,
c.ORG_Type,
b.code_chi_name dept_type,c.org_link_person,
c.org_person_id,c.org_sup_code,c.org_addr,c.org_post,c.org_phone,c.org_mob_phone,c.org_fax,c.org_bank,c.org_account_name,c.org_account,
c.org_mail,c.org_web_site,c.org_hostility,e.code_chi_name dept_sys_code,h.code_chi_name dept_area,i.code_chi_name host,
j.org_guid stat_org_guid,decode(j.org_guid,null,'N','Y') is_stat
from 
rsbt_org c,
RSBT_CODE_DIC b,
RSBT_CODE_DIC e,
RSBT_CODE_DIC h,
RSBT_CODE_DIC i,

 (select distinct org_guid from rsbt_net
     union select distinct fee_guid as org_guid from rsbt_net
     union select distinct org_guid from rsbt_apply) j
where c.org_type = b.cn(+) and b.code_data_type(+)='00262006' and c.guid<>'null'
   and (c.org_sys_code = e.cn(+) and e.code_data_type(+)='00092006')
   and (c.org_area_code = h.cn(+) and h.code_data_type(+)='00032006')
   and (to_char(c.org_hostility) = i.cn(+) and i.code_data_type(+)='00552006') and c.guid=j.org_guid(+)
   and c.org_type ='000';

-- ----------------------------
-- View structure for V_RIM_RSM_ORG_RELEV
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_ORG_RELEV" AS 
select o.GUID,o.ORG_CODE,o.ORG_NAME,o.ORG_AREA_CODE,o.ORG_SYS_CODE,o.ORG_TYPE,o.ORG_LINK_PERSON,o.ORG_PERSON_ID,o.ORG_SUP_CODE,
  o.ORG_ADDR,o.ORG_POST,o.ORG_PHONE,o.ORG_MOB_PHONE,o.ORG_FAX,o.ORG_BANK,o.ORG_ACCOUNT_NAME,o.ORG_ACCOUNT,o.ORG_HOSTILITY,o.ORG_WEB_SITE,o.ORG_MAIL
,r.parent_org_guid,r.guid relev_guid,po.org_name parent_org_name,dq.code_chi_name Org_Area_Name,lx.code_chi_name Org_Type_Name
    from rsbt_org o,rsbt_org po, t_rim_rsm_org_relev r,rsbt_code_dic dq,rsbt_code_dic lx where o.org_area_code = dq.cn(+) and o.org_type = lx.cn(+) and o.guid = r.child_org_guid(+) and r.parent_org_guid = po.guid(+) and o.org_type<>'000';

-- ----------------------------
-- View structure for V_RIM_RSM_PA_EQUCHECKCOUNT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PA_EQUCHECKCOUNT" AS 
select
  B.APP_PA_ID_CARD,A.APP_CODE,E.STAT_APP_TYPE||E.STAT_TDI STAT_TDI,B.APP_PA_NAME,Decode(B.APP_PA_GENDER,'0','男','女') as APP_PA_GENDER,B.APP_PA_BIRTHDAY,
  B.APP_PA_NATION,B.APP_PA_DEGREE,B.APP_PA_SERV_ORG,B.APP_PA_SERV_POST,
  B.APP_PA_LIVE_ADDR,B.APP_PA_LIVE_POST,B.APP_PA_CONTACT_ADDR,B.APP_PA_CONTACT_POST,
  B.APP_PA_EMAIL,
  B.APP_PA_ORG_PHONE,B.APP_PA_HOME_PHONE,B.APP_PA_MOBILE,B.APP_PA_OTHER_INFO,B.App_Pa_Stat_Addr,B.App_Pa_Call_Sign,
  B.APP_PA_NAME as APP_PA_NAME_A,
   to_char(A.APP_Date,'yyyy-MM-dd') as APP_Date,
  B.MEMO,C.ORG_AREA_CODE,E.STAT_DATE_START
  from RSBT_APPLY A,RSBT_APPLY_PA B,RSBT_ORG C,rsbt_station e
where A.GUID=B.APP_GUID and  c.guid(+)=a.org_guid and e.app_code=a.app_code and A.APP_TYPE='PA';

-- ----------------------------
-- View structure for V_RIM_RSM_PAREACODE_IMP_LOG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAREACODE_IMP_LOG" AS 
SELECT a.app_code,a.imp_app_code,(a.areacode || '00') AS areacode, user_area_code,a.sysid
FROM t_rim_rsm_rsbt_imp_log a, t_rim_rsm_pareacode_log b
WHERE a.app_code=b.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAREACODE_IMP_LOG_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAREACODE_IMP_LOG_R" AS 
SELECT a.app_code,a.imp_app_code,(a.areacode || '00') AS areacode, user_area_code,a.sysid FROM t_rim_rsm_rsbt_imp_log_r a, t_rim_rsm_pareacode_log_r b
WHERE a.app_code=b.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAREACODE_STAT_LOG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAREACODE_STAT_LOG" AS 
SELECT a.app_code,b.user_area_code FROM rsbt_apply a, t_rim_rsm_pareacode_log b
WHERE a.guid=b.app_guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAREACODE_STAT_LOG_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAREACODE_STAT_LOG_R" AS 
SELECT a.app_code,b.user_area_code FROM rsbt_apply_r a, t_rim_rsm_pareacode_log_r b
WHERE a.guid=b.app_guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAREACODE_TECHMGR
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAREACODE_TECHMGR" AS 
SELECT a.user_area_code,a.userid,b.guid,b.app_guid,b.app_type,b.stat_app_type,b.app_code,b.techid,b.org_name,b.org_code,b.stat_name,b.stat_addr,b.statusdesc,b.stat_date_start,b.org_guid FROM t_rim_rsm_pareacode_log a,v_rim_rsm_techmgr b
WHERE b.app_guid(+)= a.app_guid;

-- ----------------------------
-- View structure for V_RIM_RSM_PAREACODE_TECHMGR_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAREACODE_TECHMGR_R" AS 
SELECT a.user_area_code,a.userid,b.guid,b.app_guid,b.app_type,b.stat_app_type,b.app_code,b.techid,b.org_name,b.org_code,b.stat_name,b.stat_addr,b.statusdesc,b.stat_date_start,b.org_guid FROM t_rim_rsm_pareacode_log_r a,v_rim_rsm_techmgr_r b
WHERE b.app_guid(+)= a.app_guid;

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_ALERT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_ALERT" AS 
select
  ----费用缴费提醒
  '单位' org_type, item_no,'' apply_code,dept_pay,dept_name,is_check,check_date,count_year,area_code
      , pay_stat,sum_count,confirm,paid,guid org_guid,code_chi_name,'年度缴费' as pay_type,'0' type_id,sum_paid,nvl(i.print_count,0) print_count,f_rim_rsm_isalert(i.end_date,i.isalert) isalert
      from v_rim_rsm_pay_deptconfirm,t_rim_rsm_alert_info i where item_no = i.object_guid(+) and i.object_type(+) = '2'
union all
select '单位' org_type,item_no,apply_code,dept_pay,dept_name,is_check,check_date,count_year,area_code
      , pay_stat,sum_count,confirm,paid,guid org_guid,code_chi_name,'新台缴费' as pay_type,'1' type_id,sum_paid,nvl(i.print_count,0) print_count,f_rim_rsm_isalert(i.end_date,i.isalert)  isalert
      from v_rim_rsm_pay_applyconfirm,t_rim_rsm_alert_info i where item_no = i.object_guid(+) and i.object_type(+) = '2';

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_ALL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_ALL" AS 
select "ORG_TYPE","ITEM_NO","APPLY_CODE","DEPT_PAY","DEPT_NAME","IS_CHECK","CHECK_DATE","COUNT_YEAR","AREA_CODE","PAY_STAT","SUM_COUNT","CONFIRM","PAID","ORG_GUID","CODE_CHI_NAME","PAY_TYPE","TYPE_ID","SUM_PAID" From (select org_type, item_no,'' apply_code,dept_pay,dept_name,is_check,check_date,count_year,area_code
			, pay_stat,sum_count,confirm,paid,guid org_guid,code_chi_name,'年度缴费' as pay_type,'0' type_id,sum_paid
      from v_rim_rsm_pay_deptconfirm
union all
select  org_type,item_no,apply_code,dept_pay,dept_name,is_check,check_date,count_year,area_code
			, pay_stat,sum_count,confirm,paid,guid org_guid,code_chi_name,'新台缴费' as pay_type,'1' type_id,sum_paid
      from v_rim_rsm_pay_applyconfirm ) order by org_type;

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_APPLYCONFIRM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_APPLYCONFIRM" AS 
select '单位' org_type,'1' OrgTypeFlag, 
a.item_no,c.app_code apply_code,
a.apply_code app_code,b.org_name dept_name,
decode(confirm,'N','否','是') is_check,check_date,count_year,
a.area_code,
decode(paid,'0','未缴费','1','全缴','部分缴费') pay_stat,sum_count,
a.confirm,
a.paid,sum_paid,
a.dept_pay,

a.handler,
a.handle_date,
a.checker,

b.guid org_guid,b."GUID",b."ORG_CODE",b."ORG_NAME",b."ORG_AREA_CODE",b."ORG_SYS_CODE",b."ORG_LINK_PERSON",b."ORG_PERSON_ID",b."ORG_SUP_CODE",b."ORG_ADDR",b."ORG_POST",b."ORG_PHONE",b."ORG_MOB_PHONE",b."ORG_FAX",b."ORG_BANK",b."ORG_ACCOUNT_NAME",b."ORG_ACCOUNT",b."ORG_HOSTILITY",b."ORG_WEB_SITE",b."ORG_MAIL",c.net_guid net_guid,e.code_chi_name
    
from 

t_rim_rsm_pay_applycount a,
rsbt_org b,RSBT_CODE_DIC e,(select app_code,min(net_guid) net_guid from rsbt_apply where app_type='T' group by app_type,app_code) c
    where a.dept_pay=b.guid and to_char('T'||a.apply_code)=c.app_code and b.org_sys_code = e.cn(+) and e.code_data_type(+) = '00092006'
    union all
select '个人' org_type,'2' OrgTypeFlag, item_no,apply_code,apply_code app_code,b.app_pa_name dept_name,
decode(confirm,'N','否','是') is_check,check_date,count_year,
a.area_code
      ,decode(paid,'0','未缴费','1','全缴','部分缴费') pay_stat,sum_count,
a.confirm,
a.paid,
a.sum_paid,
a.IDENTIFICATION_CARD dept_pay,

a.handler,
a.handle_date,
a.checker,

      '' org_guid, '' guid,'' ORG_CODE,b.app_pa_name ORG_NAME,'' ORG_AREA_CODE,'' ORG_SYS_CODE,b.app_pa_name ORG_LINK_PERSON,b.app_pa_id_card ORG_PERSON_ID,'' ORG_SUP_CODE,b.app_pa_live_addr ORG_ADDR,b.app_pa_live_post ORG_POST,b.app_pa_mobile ORG_PHONE,'' ORG_MOB_PHONE,'' ORG_FAX,'' ORG_BANK,'' ORG_ACCOUNT_NAME,'' ORG_ACCOUNT,0 ORG_HOSTILITY,'' ORG_WEB_SITE,b.app_pa_email ORG_MAIL, '' net_guid,'业余电台' code_chi_name
      from T_RIM_RSM_PAY_EQUPA_APPLYCOUNT a,rsbt_apply_pa b
      where a.IDENTIFICATION_CARD=b.app_pa_id_card(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_APPLYCOUNT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_APPLYCOUNT" AS 
select item_no,a.apply_code,a.area_code,dept_pay,org_name,count_year,sum_count,handler,to_char(handle_date,'YYYY-MM-DD') handle_date,checker,to_char(check_date,'YYYY-MM-DD') check_date,confirm,decode(confirm,'N','否','是') is_check,paid,sum_paid
  from t_rim_rsm_pay_applycount a,rsbt_org b
   where a.dept_pay=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_APPLYCOUNT_PA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_APPLYCOUNT_PA" AS 
select item_no,a.apply_code,a.area_code,identification_card dept_pay,b.app_pa_name org_name,count_year,sum_count,handler,to_char(handle_date,'YYYY-MM-DD') handle_date,checker,to_char(check_date,'YYYY-MM-DD') check_date,confirm,decode(confirm,'N','否','是') is_check,paid,sum_paid
  from T_RIM_RSM_PAY_EQUPA_APPLYCOUNT a,rsbt_apply_pa b
   where a.IDENTIFICATION_CARD=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_APPLYITEM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_APPLYITEM" AS 
select org_type,apply_code,dept_pay,area_code,count_year,type_name,min(fee_pay) fee_pay,item_code,item_type,min(item_name) item_name,min(count_mode) count_mode,sum(amount) amount,sum(sum_count) sum_count,derate,min(pay_rate) pay_rate,sum(sum_pay) sum_pay
  from v_rim_rsm_pay_applyitem_in
  group by org_type,apply_code,dept_pay,area_code,count_year,type_name,item_type,item_code,derate;

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_APPLYITEM_DETAIL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_APPLYITEM_DETAIL" AS 
select  '单位' org_type,item_no,a.applytype||a.apply_code  apply_code,a.decl_code,a.dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,a.item_code,item_name,count_mode,freq_note,b.fee_pay,1 amount,a.sum_count,to_char(derate)||'%' derate,to_char(pay_rate)||'%' pay_rate,sum_pay
  from t_rim_rsm_pay_applynetitem a,rsbt_FEESTANDERD b,t_rim_rsm_pay_applycount c
  where a.item_code=b.item_code
        and a.apply_code=c.apply_code(+) and a.dept_pay=c.dept_pay(+) and a.area_code=c.area_code(+)
        and a.count_year=c.count_year(+)
  union all
  select '单位' org_type,item_no,a.applytype||a.apply_code,a.decl_code,a.dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,a.item_code,item_name,count_mode,'－－' freq_note,b.fee_pay,amount,a.sum_count,to_char(derate)||'%' derate,to_char(pay_rate)||'%' pay_rate,sum_pay
  from t_rim_rsm_pay_applyitem a,rsbt_FEESTANDERD b,t_rim_rsm_pay_applycount c
  where a.item_code=b.item_code
        and a.apply_code=c.apply_code(+) and a.dept_pay=c.dept_pay(+) and a.area_code=c.area_code(+) and a.count_year=c.count_year(+)
  union all
  select org_type,item_no,a.applytype||a.apply_code apply_code,a.decl_code,a.dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,null item_code,item_name,null count_mode,'－－' freq_note,fee_pay,1 amount,fee_pay sum_count,'0%' derate,'100%' pay_rate,fee_pay sum_pay
  from t_rim_rsm_pay_applyother a,t_rim_rsm_pay_applycount c
  where  a.apply_code=c.apply_code(+) and a.dept_pay=c.dept_pay(+) and a.area_code=c.area_code(+)
        and a.count_year=c.count_year(+)
  union all
  select '单位' org_type,item_no,a.APPLYTYPE||a.apply_code,a.decl_code,a.dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,a.item_code,item_name,count_mode,'－－' freq_note,b.fee_pay,amount,sum_pay sum_count,'0%' derate,'0%' pay_rate,sum_pay
  from t_rim_rsm_pay_equcheck_appitem a,t_rim_rsm_pay_equcheckstandard b,t_rim_rsm_pay_applycount c
  where a.item_code=b.item_code
   and a.apply_code=c.apply_code(+) and a.dept_pay=c.dept_pay(+) and a.area_code=c.area_code(+) and a.count_year=c.count_year(+)
  union all
  select '个人' org_type,item_no,a.APPLYTYPE||a.apply_code,a.decl_code,a.identification_card dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,a.item_code,item_name,count_mode,'－－' freq_note,b.fee_pay,amount,sum_pay sum_count,'0%' derate,'0%' pay_rate,sum_pay
  from t_rim_rsm_pay_equpa_applyitem a,t_rim_rsm_pay_equcheckstandard b,t_rim_rsm_pay_equpa_applycount c
  where a.item_code=b.item_code
        and a.apply_code=c.apply_code(+) and a.identification_card=c.identification_card(+) and a.area_code=c.area_code(+) and a.count_year=c.count_year(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_APPLYITEM_IN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_APPLYITEM_IN" AS 
select '单位' org_type, apply_code,dept_pay,area_code,to_char(count_year) count_year,type_name,b.fee_pay,a.item_code,b.item_type,item_name,count_mode,freq_note,1 amount,sum_count,to_char(derate)||'%' derate,to_char(pay_rate)||'%' pay_rate,sum_pay
  from t_rim_rsm_pay_applynetitem a,rsbt_FEESTANDERD b
  where a.item_code=b.item_code
  union all
  select '单位' org_type,apply_code,dept_pay,area_code,to_char(count_year) count_year,type_name,b.fee_pay,a.item_code,b.item_type,item_name,count_mode,'－－' freq_note,amount,sum_count,to_char(derate)||'%' derate,to_char(pay_rate)||'%' pay_rate,sum_pay
  from (select apply_code,dept_pay,area_code,count_year,item_code,sum(amount) amount,sum(sum_count) sum_count,derate,max(pay_rate) pay_rate,sum(sum_pay) sum_pay from t_rim_rsm_pay_applyitem group by apply_code,dept_pay,area_code,count_year,item_code,derate)
   a,rsbt_FEESTANDERD b
  where a.item_code=b.item_code
  union all
    select  org_type,apply_code,dept_pay,area_code,to_char(count_year) count_year,type_name,fee_pay,null item_code,item_type,item_name,null count_mode,'－－' freq_note,1 amount,fee_pay sum_count,'0%' derate,'100%' pay_rate,fee_pay sum_pay
  from t_rim_rsm_pay_applyother
  union all
    select '单位' org_type,apply_code,dept_pay,area_code,to_char(count_year) count_year,b.type_name,b.fee_pay,b.item_code,b.item_type,b.item_name,b.count_mode,'－－' freq_note,a.amount,decode(a.item_code,'118000',fee_pay*amount,'111121',fee_pay*amount,'115000',fee_pay*amount,'116000',fee_pay*amount,fee_pay)  sum_count,'0%' derate,'100%' pay_rate,a.sum_pay
   from T_RIM_RSM_PAY_EQUCHECK_APPITEM a,t_rim_rsm_pay_equcheckstandard b where a.item_code=b.item_code
   union all
    select '个人' org_type,apply_code,IDENTIFICATION_CARD dept_pay,area_code,to_char(count_year) count_year,b.type_name,b.fee_pay,b.item_code,b.item_type,b.item_name,b.count_mode,'－－' freq_note,a.amount,decode(a.item_code,'118000',fee_pay*amount,'111121',fee_pay*amount,'115000',fee_pay*amount,'116000',fee_pay*amount,fee_pay)  sum_count,'0%' derate,'100%' pay_rate,a.sum_pay
    from T_RIM_RSM_PAY_EQUPA_APPLYITEM a,t_rim_rsm_pay_equcheckstandard b where a.item_code=b.item_code;

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_APPLYLISTPRINT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_APPLYLISTPRINT" AS 
select  b.item_no,a.apply_code,a.decl_code,a.dept_pay,c.org_name dept_name,a.area_code,a.count_year,a.type_name,a.item_code,a.item_name,a.count_mode,a.freq_note,a.fee_pay,a.amount,a.sum_count,a.derate,a.pay_rate,a.sum_pay
  from v_rim_rsm_pay_applyitem_detail a,T_rim_rsm_pay_applycount b,rsbt_org c
  where a.org_type='单位' and a.apply_code=b.apply_code(+) and a.dept_pay=b.dept_pay(+) and a.area_code=b.area_code(+)
  	and a.count_year=b.count_year(+) and a.dept_pay=c.guid(+)
 union all
 select  b.item_no,a.apply_code,a.decl_code,a.dept_pay, c.app_pa_name dept_name,a.area_code,a.count_year,a.type_name,a.item_code,a.item_name,a.count_mode,a.freq_note,a.fee_pay,a.amount,a.sum_count,a.derate,a.pay_rate,a.sum_pay
  from v_rim_rsm_pay_applyitem_detail a,t_rim_rsm_pay_equpa_applycount b,rsbt_apply_pa c
  where a.org_type='个人' and a.apply_code=b.apply_code(+) and a.dept_pay=b.identification_card(+) and a.area_code=b.area_code(+)
  	and a.count_year=b.count_year(+) and a.dept_pay=c.app_pa_id_card(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_APPLYPRINT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_APPLYPRINT" AS 
select a.org_type,'1' OrgTypeFlag,c.org_name dept_name,a.dept_pay,a.apply_code,a.area_code,b.item_no,a.item_type,a.item_name,a.type_name,a.fee_pay,a.count_mode,
       a.amount,a.derate,a.pay_rate,a.sum_pay,a.sum_count pay_count,b.sum_count,f_rim_rsm_money(b.sum_count) sum_cn,a.count_year,b.handler,b.checker
  from v_RIM_RSM_pay_applyitem a,T_RIM_RSM_pay_applycount b,rsbt_org c
  where  a.org_type='单位' and a.apply_code=b.apply_code(+) and a.dept_pay=b.dept_pay(+) and a.area_code=b.area_code(+)
  	and a.count_year=b.count_year(+) and a.dept_pay=c.guid(+)
union all
select a.org_type,'2' OrgTypeFlag,c.app_pa_name dept_name,a.dept_pay,a.apply_code,a.area_code,b.item_no,a.item_type,a.item_name,a.type_name,a.fee_pay,a.count_mode,
       a.amount,a.derate,a.pay_rate,a.sum_pay,a.sum_count pay_count,b.sum_count,f_rim_rsm_money(b.sum_count) sum_cn,a.count_year,b.handler,b.checker
  from v_RIM_RSM_pay_applyitem a,t_rim_rsm_pay_equpa_applycount b,rsbt_apply_pa c
  where  a.org_type='个人' and a.apply_code=b.apply_code(+) and a.dept_pay=b.identification_card(+) and a.area_code=b.area_code(+)
  	and a.count_year=b.count_year(+) and a.dept_pay=c.app_pa_id_card(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_DEPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_DEPT" AS 
select a.apply_code,APP_TYPE,a.area_code,decl_code,dept_set,dept_pay,ORG_Name DEPT_NAME,org_code,
       STAT_Date_Start,a.net_guid,b.org_sys_code
    from v_rim_rsm_pay_dept_in a,rsbt_org b
   where a.dept_pay=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_DEPT_IN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_DEPT_IN" AS 
select a.app_code apply_code,decode(substr(app_code,0,1) ,'T','T','P','PA') APP_TYPE,
    decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.STAT_AREA_CODE) area_code,a.STAT_APP_Type||a.STAT_TDI decl_code,
			b.ORG_GUID dept_set,decode(nvl(b.FEE_GUID,''),'',c.org_guid,b.FEE_GUID) dept_pay,a.STAT_Date_Start,b.guid net_guid
	  from RSBT_STATION a,RSBT_NET b,rsbt_feeeveryyear c
	 where a.net_guid=b.guid(+) and a.guid=c.station_guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_DEPTCONFIRM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_DEPTCONFIRM" AS 
select 
'单位' org_type,
'1' OrgTypeFlag,item_no,
a.dept_pay,org_name dept_name,
decode(confirm,'N','否','是') is_check,
check_date,
count_year,
a.area_code,
decode(paid,
'0',
'未缴费',
'1',
'全缴',
'部分缴费') pay_stat,
sum_count,
a.confirm,
a.paid,
a.sum_paid,

a.handler,
a.handle_date,
a.checker,

b.guid org_guid,
b."GUID",
b."ORG_CODE",
b."ORG_NAME",
b."ORG_AREA_CODE",
b."ORG_SYS_CODE",
b."ORG_LINK_PERSON",
b."ORG_PERSON_ID",
b."ORG_SUP_CODE",b."ORG_ADDR",b."ORG_POST",b."ORG_PHONE",b."ORG_MOB_PHONE",b."ORG_FAX",b."ORG_BANK",b."ORG_ACCOUNT_NAME",b."ORG_ACCOUNT",b."ORG_HOSTILITY",b."ORG_WEB_SITE",b."ORG_MAIL",e.code_chi_name
      from t_Rim_Rsm_Pay_Deptcount a,rsbt_org b,RSBT_CODE_DIC e
      where a.dept_pay=b.guid and b.org_sys_code = e.cn(+) and e.code_data_type(+) = '00092006'
      union all
select 
'个人' org_type,
'2' OrgTypeFlag, 
item_no,
a.identification_card dept_pay,
b.app_pa_name dept_name,
decode(confirm,'N','否','是') is_check,check_date,count_year,
a.area_code
      ,
decode(paid,'0','未缴费','1','全缴','部分缴费') pay_stat,sum_count,
a.confirm,
a.paid,
a.sum_paid,

a.handler,
a.handle_date,
a.checker,

a.IDENTIFICATION_CARD org_guid, 
b.GUID, 
'' ORG_CODE,b.app_pa_name ORG_NAME,'' ORG_AREA_CODE,'' ORG_SYS_CODE,b.app_pa_name ORG_LINK_PERSON,b.app_pa_id_card ORG_PERSON_ID,'' ORG_SUP_CODE,b.app_pa_live_addr ORG_ADDR,b.app_pa_live_post ORG_POST,b.app_pa_mobile ORG_PHONE,'' ORG_MOB_PHONE,'' ORG_FAX,'' ORG_BANK,'' ORG_ACCOUNT_NAME,'' ORG_ACCOUNT,0 ORG_HOSTILITY,'' ORG_WEB_SITE,b.app_pa_email ORG_MAIL,'业余电台' code_chi_name
      from T_RIM_RSM_PAY_EQUPADEPTCOUNT a,rsbt_apply_pa b
      where a.IDENTIFICATION_CARD=b.app_pa_id_card(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_DEPTCOUNT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_DEPTCOUNT" AS 
select item_no,a.area_code,a.dept_pay,org_name,count_year,sum_count,handler,to_char(handle_date,'YYYY-MM-DD') handle_date,checker,to_char(check_date,'YYYY-MM-DD') check_date,confirm,decode(confirm,'N','否','是') is_check,paid,sum_paid
  from t_rim_rsm_pay_deptcount a,rsbt_org b
   where a.dept_pay=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_DEPTCOUNT_PA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_DEPTCOUNT_PA" AS 
select item_no,a.area_code,a.identification_card dept_pay,b.app_pa_name org_name,count_year,sum_count,handler,to_char(handle_date,'YYYY-MM-DD') handle_date,checker,to_char(check_date,'YYYY-MM-DD') check_date,confirm,decode(confirm,'N','否','是') is_check,paid,sum_paid
  from T_RIM_RSM_PAY_EQUPADEPTCOUNT a,rsbt_apply_pa b
   where a.IDENTIFICATION_CARD=b.app_pa_id_card(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_DEPTITEM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_DEPTITEM" AS 
select min(org_type) org_type, dept_pay,area_code,count_year,type_name,min(fee_pay) fee_pay,item_code,item_type,min(item_name) item_name,min(count_mode) count_mode,sum(amount) amount,sum(sum_count) sum_count,derate,sum(sum_pay) sum_pay
	from v_rim_rsm_pay_deptitem_in
	group by dept_pay,area_code,count_year,type_name,item_type,item_code,derate;

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_DEPTITEM_DETAIL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_DEPTITEM_DETAIL" AS 
select '单位' org_type, item_no,a.applytype||A.apply_code as apply_code,A.decl_code,a.dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,a.item_code,item_name,b.fee_pay,count_mode,freq_note,amount,a.sum_count,to_char(derate)||'%' derate,sum_pay
  from t_rim_rsm_pay_deptnetitem a,rsbt_FEESTANDERD b,t_rim_rsm_pay_deptcount c
  where a.item_code=b.item_code
        and a.dept_pay=c.dept_pay(+) and a.area_code=c.area_code(+) and a.count_year=c.count_year(+)
  union all
  select '单位' org_type,item_no,a.applytype||a.apply_code as apply_code,a.decl_code,a.dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,a.item_code,item_name,b.fee_pay,count_mode,'－－' freq_note,amount,a.sum_count,to_char(derate)||'%' derate,sum_pay
  from t_rim_rsm_pay_deptitem a,rsbt_FEESTANDERD b,t_rim_rsm_pay_deptcount c
  where a.item_code=b.item_code
        and a.dept_pay=c.dept_pay(+) and a.area_code=c.area_code(+) and a.count_year=c.count_year(+)
  union all
  select org_type,item_no,a.applytype||a.apply_code as apply_code,a.decl_code,a.dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,null item_code,item_name,fee_pay,null count_mode,'－－' freq_note,1 amount,fee_pay sum_count,'0%' derate,fee_pay sum_pay
   from t_rim_rsm_pay_deptother a,t_rim_rsm_pay_deptcount c
   where a.dept_pay=c.dept_pay(+) and a.area_code=c.area_code(+) and a.count_year=c.count_year(+)
  union all
  select '单位' org_type,item_no,a.applytype||a.apply_code as apply_code,a.decl_code,a.dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,a.item_code,item_name,b.fee_pay,count_mode,'－－' freq_note,amount,sum_pay sum_count,'0%' derate,sum_pay
  from t_rim_rsm_pay_equcheckitem a,t_rim_rsm_pay_equcheckstandard b,t_rim_rsm_pay_deptcount c
  where a.item_code=b.item_code(+)
        and a.dept_pay=c.dept_pay(+) and a.area_code=c.area_code(+) and a.count_year=c.count_year(+)
  union all
  select '个人' org_type,item_no,a.applytype||a.apply_code as apply_code,a.decl_code ,a.identification_card dept_pay,a.area_code,to_char(a.count_year) count_year,type_name,a.item_code,item_name,b.fee_pay,count_mode,'－－' freq_note,amount,sum_pay sum_count,'0%' derate,sum_pay
  from t_rim_rsm_pay_equpadeptitem a,t_rim_rsm_pay_equcheckstandard b,t_rim_rsm_pay_equpadeptcount c
  where a.item_code=b.item_code(+)
        and a.identification_card=c.identification_card(+) and a.area_code=c.area_code(+) and a.count_year=c.count_year(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_DEPTITEM_IN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_DEPTITEM_IN" AS 
select '单位' org_type, dept_pay,area_code,to_char(count_year) count_year,type_name,a.item_code,b.item_type,item_name,b.fee_pay,count_mode,freq_note,amount,sum_count,to_char(derate)||'%' derate,sum_pay
  from t_rim_rsm_pay_deptnetitem a,rsbt_FEESTANDERD b
  where a.item_code=b.item_code
  union all
  select '单位' org_type, dept_pay,area_code,to_char(count_year) count_year,type_name,a.item_code,b.item_type,item_name,b.fee_pay,count_mode,'－－' freq_note,amount,sum_count,to_char(derate)||'%' derate,sum_pay
  from (select dept_pay,area_code,count_year,item_code,sum(amount) amount,sum(sum_count) sum_count,derate,sum(sum_pay) sum_pay from t_rim_rsm_pay_deptitem group by count_year,dept_pay,area_code,item_code,derate)
   a,rsbt_FEESTANDERD b
  where a.item_code=b.item_code
  union all
  select org_type, dept_pay,area_code,to_char(count_year) count_year,type_name,null item_code,item_type,item_name,fee_pay,null count_mode,'－－' freq_note,1 amount,fee_pay sum_count,'0%' derate,fee_pay sum_pay
   from t_rim_rsm_pay_deptother
   union all
  select '单位' org_type,dept_pay,area_code,to_char(count_year) count_year,b.type_name,b.item_code,b.item_type,b.item_name,b.fee_pay,b.count_mode,'－－' freq_note,a.amount, decode(a.item_code,'118000',fee_pay*amount,'111121',fee_pay*amount,'115000',fee_pay*amount,'116000',fee_pay*amount,fee_pay)  sum_count,'0%' derate,a.sum_pay
   from T_RIM_RSM_PAY_EQUCHECKITEM a,t_rim_rsm_pay_equcheckstandard b where a.item_code=b.item_code
  union all
   select '个人' org_type,IDENTIFICATION_CARD dept_pay,area_code,to_char(count_year) count_year,b.type_name,b.item_code,b.item_type,b.item_name,b.fee_pay,b.count_mode,'－－' freq_note,a.amount, decode(a.item_code,'118000',fee_pay*amount,'111121',fee_pay*amount,'115000',fee_pay*amount,'116000',fee_pay*amount,fee_pay)  sum_count,'0%' derate,a.sum_pay
   from T_RIM_RSM_PAY_EQUPADEPTITEM a,t_rim_rsm_pay_equcheckstandard b where a.item_code=b.item_code;

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_DEPTLISTPRINT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_DEPTLISTPRINT" AS 
select b.item_no,a.apply_code,a.decl_code,a.dept_pay,c.org_name dept_name,a.area_code,a.count_year,a.type_name,a.item_code,a.item_name,a.count_mode,a.freq_note,a.fee_pay,a.amount,a.sum_count,a.derate,a.sum_pay
  from v_rim_rsm_pay_deptitem_detail a,T_RIM_RSM_pay_deptcount b,rsbt_org c
  where a.org_type='单位' and  a.dept_pay=b.dept_pay(+) and a.area_code=b.area_code(+)
  	and a.count_year=b.count_year(+) and a.dept_pay=c.guid(+)
union all
select b.item_no,a.apply_code,a.decl_code,a.dept_pay, c.app_pa_name dept_name,a.area_code,a.count_year,a.type_name,a.item_code,a.item_name,a.count_mode,a.freq_note,a.fee_pay,a.amount,a.sum_count,a.derate,a.sum_pay
  from v_rim_rsm_pay_deptitem_detail a,t_rim_rsm_pay_equpadeptcount b,rsbt_apply_pa c
  where a.org_type='个人' and  a.dept_pay=b.identification_card(+) and a.area_code=b.area_code(+)
  	and a.count_year=b.count_year(+) and a.dept_pay=c.app_pa_id_card(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_DEPTPRINT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_DEPTPRINT" AS 
select a.org_type,'1' OrgTypeFlag, b.item_no,a.area_code,a.dept_pay,c.org_name dept_name,a.count_year,a.item_name,a.type_name,
       a.item_type,a.fee_pay,a.count_mode,a.sum_pay,a.amount,a.sum_count pay_count,derate,b.sum_count,F_RIM_RSM_money(b.sum_count) sum_cn,b.handler,b.checker
  from v_RIM_RSM_pay_deptitem a,T_RIM_RSM_pay_deptcount b,rsbt_org c
  where a.org_type='单位' and  a.dept_pay=b.dept_pay(+) and a.area_code=b.area_code(+) and a.count_year=b.count_year(+) and
       a.dept_pay=c.guid(+)
union all
select a.org_type,'2' OrgTypeFlag,b.item_no,a.area_code,a.dept_pay,c.org_name dept_name,a.count_year,a.item_name,a.type_name,
       a.item_type,a.fee_pay,a.count_mode,a.sum_pay,a.amount,a.sum_count pay_count,derate,b.sum_count,F_RIM_RSM_money(b.sum_count) sum_cn,b.handler,b.checker
  from v_RIM_RSM_pay_deptitem a,t_rim_rsm_pay_equpadeptcount b,rsbt_org c
  where a.org_type='个人' and a.dept_pay=b.identification_card(+) and a.area_code=b.area_code(+) and a.count_year=b.count_year(+) and
       a.dept_pay=c.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_RATIO
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_RATIO" AS 
select apply.guid app_guid,c.guid,a.net_guid,a.guid station_guid,decode(nvl(b.fee_guid,''),'',c.org_guid,b.fee_guid) org_guid,
  a.app_code app_codedes,a.app_code,a.STAT_APP_Type||a.stat_tdi stat_tdi,a.stat_date_start,d.org_name,a.stat_addr,
  decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.STAT_AREA_CODE) stat_area_code,
  decode(c.Fee_Derate_Proportion,null,0) Fee_Derate_Proportion ,to_char(nvl(c.Fee_Derate_Proportion,0)*100,'990.9')||'%' derate,c.memo,d.org_sys_code,e.code_chi_name
from rsbt_station a,rsbt_net b,rsbt_feeeveryyear c,rsbt_org d,RSBT_CODE_DIC e,rsbt_apply apply
where a.net_guid=b.guid(+) and a.guid=c.station_guid(+) and a.stat_status='1'
      and decode(nvl(b.fee_guid,''),'',c.org_guid,b.fee_guid)=d.guid and a.Net_guid<>'null'
      and (d.org_sys_code = e.cn(+) and e.code_data_type(+) = '00092006')
      and a.app_code=apply.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_RESULT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_RESULT" AS 
select '1' count_type, '单位' org_type , null app_guid,item_no,null net_guid,null apply_code,'0' type_id,'年度缴费' pay_type,a.area_code,dept_pay,org_name,count_year,sum_count,confirm,decode(paid,'0','未缴费','1','已缴费','部分缴费') pay_stat,sum_paid,a.handler,a.handle_date,a.checker,a.check_date,a.note,a.invoice_no,paid,b.org_sys_code,e.code_chi_name,
b.ORG_Link_Person,b.ORG_Person_ID,b.ORG_SUP_Code,b.ORG_ADDR,b.ORG_POST,b.ORG_Phone,
b.ORG_MOB_Phone,b.ORG_FAX,b.ORG_Bank,b.ORG_Account_Name,b.ORG_Account,decode(b.ORG_Hostility,'0','否','是') ORG_Hostility,b.ORG_WEB_Site,b.ORG_Mail
    from t_rim_rsm_pay_deptcount a,rsbt_org b,RSBT_CODE_DIC e
    where a.dept_pay=b.guid(+) and confirm='Y' and b.org_sys_code = e.cn(+) and e.code_data_type(+) = '00092006'
  union all
  select '2' count_type, '单位' org_type, apply.guid app_guid,item_no,apply.net_guid,apply.app_code apply_code,'1' type_id,'新台缴费' pay_type,a.area_code,dept_pay,org_name,count_year,sum_count,confirm,decode(paid,'0','未缴费','1','已缴费','部分缴费') pay_stat,sum_paid,handler,handle_date,checker,check_date,a.note,a.invoice_no,paid,b.org_sys_code,e.code_chi_name,
b.ORG_Link_Person,b.ORG_Person_ID,b.ORG_SUP_Code,b.ORG_ADDR,b.ORG_POST,b.ORG_Phone,
b.ORG_MOB_Phone,b.ORG_FAX,b.ORG_Bank,b.ORG_Account_Name,b.ORG_Account,decode(b.ORG_Hostility,'0','否','是') ORG_Hostility,b.ORG_WEB_Site,b.ORG_Mail
  from T_RIM_RSM_pay_applycount a,rsbt_org b,RSBT_CODE_DIC e,rsbt_apply apply
    where  a.dept_pay=b.guid(+) and apply.app_type='T' and a.apply_code=substr(apply.app_code(+),-12,12) and confirm='Y'
    and b.org_sys_code = e.cn(+) and e.code_data_type(+) = '00092006'
  union all
 select '3' count_type, '个人' org_type, b.app_guid,item_no,null net_guid,null apply_code,'0' type_id,'年度缴费' pay_type,a.area_code,b.app_pa_id_card dept_pay,b.app_pa_name org_name,count_year,sum_count,confirm,decode(paid,'0','未缴费','1','已缴费','部分缴费') pay_stat,sum_paid,a.handler,a.handle_date,a.checker,a.check_date,a.note,a.invoice_no,paid,'' org_sys_code,'业余电台'code_chi_name,
b.app_pa_name ORG_Link_Person,b.app_pa_id_card ORG_Person_ID, '' ORG_SUP_Code,b.app_pa_live_addr ORG_ADDR,b.app_pa_serv_post ORG_POST,'' ORG_Phone,
 b.app_pa_mobile ORG_MOB_Phone,'' ORG_FAX,'' ORG_Bank,'' ORG_Account_Name,'' ORG_Account,'否' ORG_Hostility,'' ORG_WEB_Site,b.app_pa_email ORG_Mail
    from T_RIM_RSM_PAY_EQUPADEPTCOUNT a,rsbt_apply_pa b
    where a.identification_card=b.app_pa_id_card(+) and confirm='Y'
 union all
  select '4' count_type, '个人' org_type, b.app_guid,item_no,null net_guid,null apply_code,'1' type_id,'新台缴费' pay_type,a.area_code,b.app_pa_id_card dept_pay,b.app_pa_name org_name,count_year,sum_count,confirm,decode(paid,'0','未缴费','1','已缴费','部分缴费') pay_stat,sum_paid,a.handler,a.handle_date,a.checker,a.check_date,a.note,a.invoice_no,paid,'' org_sys_code,'业余电台'code_chi_name,
b.app_pa_name ORG_Link_Person,b.app_pa_id_card ORG_Person_ID, '' ORG_SUP_Code,b.app_pa_live_addr ORG_ADDR,b.app_pa_serv_post ORG_POST,'' ORG_Phone,
 b.app_pa_mobile ORG_MOB_Phone,'' ORG_FAX,'' ORG_Bank,'' ORG_Account_Name,'' ORG_Account,'否' ORG_Hostility,'' ORG_WEB_Site,b.app_pa_email ORG_Mail
    from T_RIM_RSM_PAY_EQUPA_APPLYCOUNT a,rsbt_apply_pa b
    where a.identification_card=b.app_pa_id_card(+) and confirm='Y';

-- ----------------------------
-- View structure for V_RIM_RSM_PAY_RESULT_AAA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_PAY_RESULT_AAA" AS 
select
  -----综合缴费数据查询视图
A."ORG_TYPE",A."APP_GUID",A."ITEM_NO",A."NET_GUID",A."APPLY_CODE",A."TYPE_ID",A."PAY_TYPE",A."AREA_CODE",A."DEPT_PAY",A."ORG_NAME",A."COUNT_YEAR",A."SUM_COUNT",A."CONFIRM",A."PAY_STAT",A."SUM_PAID",A."HANDLER",A."HANDLE_DATE",A."CHECKER",A."CHECK_DATE",A."NOTE",A."INVOICE_NO",A."PAID",A."ORG_SYS_CODE",A."CODE_CHI_NAME",A."ORG_LINK_PERSON",A."ORG_PERSON_ID",A."ORG_SUP_CODE",A."ORG_ADDR",A."ORG_POST",A."ORG_PHONE",A."ORG_MOB_PHONE",A."ORG_FAX",A."ORG_BANK",A."ORG_ACCOUNT_NAME",A."ORG_ACCOUNT",A."ORG_HOSTILITY",A."ORG_WEB_SITE",A."ORG_MAIL",
F_rim_rsm_AppCode_ByDept_Pay(A.dept_pay) as APPLY_CODE_Temp,F_rim_rsm_App_GUID_ByDept_Pay(A.dept_pay) as  APP_GUID_TEMP
from v_rim_rsm_pay_result A order by ITEM_NO desc,APPLY_CODE desc,COUNT_YEAR desc;

-- ----------------------------
-- View structure for V_RIM_RSM_RADIO_APPLY_T
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RADIO_APPLY_T" AS 
select
  ----无线电台（站）设置申请表表(报表打印视图)T
  C.GUID,C.APP_CODE,
  Substr(c.app_code,2,4) as Area_Code, Substr(c.app_code,6,4) as Year_Code,
  Substr(c.app_code,10,4) as Sequence_Number,
  Decode(c.app_sub_type,'0','新设','1','变更','2','撤消','3','封存','4','启封') as App_SubType,
  b.ORG_NAME,e.code_chi_name as SYS_Code,B.ORG_SYS_Code,
  b.ORG_CODE,b.ORG_POST,b.ORG_ADDR,b.ORG_LINK_PERSON,b.ORG_PHONE,b.ORG_FAX,
  b.ORG_MOB_PHONE,b.ORG_MAIL,
  a.NET_NAME,a.NET_SAT_NAME,a.NET_LG,
  f_rim_rsm_GETFREQ_R(a.NET_BAND,f_rim_rsm_GETFREQ_freq_Unit(a.NET_BAND,0,0,0)) as NET_BAND,
  Decode(f_rim_rsm_GETFREQ_freq_Unit(a.NET_BAND,0,0,0),'0','kHz','1','MHz','2','GHz') as  FREQ_Unit,
  F_rim_rsm_GetCodeName(a.NET_SVN,'00452006') as NET_SVN_NAME,a.NET_SVN,
  F_rim_rsm_GetCodeName(a.NET_SP,'00002006') as NET_SP,F_rim_rsm_GetCodeName(a.NET_TS,'00012006') as NET_TS_NAME,a.NET_TS,
  d.code_chi_name as NET_AREA,a.NET_USE,
  c.app_ftlb,c.app_ftle,
  f.ORG_NAME as org_name_A,F_rim_rsm_GetCodeName(f.ORG_SYS_CODE,'00092006') as SYS_Code_A ,f.ORG_SYS_CODE ORG_SYS_CODE_A,
  f.ORG_CODE as org_code_A,f.ORG_POST as ORG_Post_A,f.ORG_ADDR as org_ADDR_A,
  f.ORG_LINK_PERSON as ORG_LINK_PERSON_A ,f.ORG_PHONE as ORG_PHONE_A,f.ORG_FAX as ORG_FAX_A,
  f.ORG_MOB_PHONE as ORG_MOB_PHONE_A,f.ORG_MAIL as ORG_MAIL_A,
  f.ORG_Bank ,f.ORG_Account_Name,f.ORG_Account,
  b.ORG_LINK_PERSON as ORG_LINK_PERSON_B ,c.APP_Date,
  c.MEMO
from Rsbt_Net a,rsbt_org b,rsbt_APPly c,rsbt_code_dic d,rsbt_code_dic e,rsbt_org f
where a.GUID=c.Net_Guid and a.org_guid=b.GUID and a.fee_guid=f.guid(+) and c.app_type='T'
      and net_area=d.cn(+) and d.code_data_type(+)='00022006'
      and b.org_sys_code=e.cn(+) and e.code_data_type(+)='00092006';

-- ----------------------------
-- View structure for V_RIM_RSM_RADIO_APPLY_T_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RADIO_APPLY_T_R" AS 
select
  ----无线电台（站）设置申请表表(报表打印视图)T
  C.GUID,C.APP_CODE,
  Substr(c.app_code,2,4) as Area_Code, Substr(c.app_code,6,4) as Year_Code,
  Substr(c.app_code,10,4) as Sequence_Number,
  Decode(c.app_sub_type,'0','新设','1','变更','2','撤消','3','封存','4','启封') as App_SubType,
  b.ORG_NAME,e.code_chi_name as SYS_Code,B.ORG_SYS_Code,
  b.ORG_CODE,b.ORG_POST,b.ORG_ADDR,b.ORG_LINK_PERSON,b.ORG_PHONE,b.ORG_FAX,
  b.ORG_MOB_PHONE,b.ORG_MAIL,
  a.NET_NAME,a.NET_SAT_NAME,a.NET_LG,
  f_rim_rsm_GETFREQ_R(a.NET_BAND,f_rim_rsm_GETFREQ_freq_Unit(a.NET_BAND,0,0,0)) as NET_BAND,
  Decode(f_rim_rsm_GETFREQ_freq_Unit(a.NET_BAND,0,0,0),'0','kHz','1','MHz','2','GHz') as  FREQ_Unit,
  F_rim_rsm_GetCodeName(a.NET_SVN,'00452006') as NET_SVN_NAME,a.NET_SVN,
  F_rim_rsm_GetCodeName(a.NET_SP,'00002006') as NET_SP,F_rim_rsm_GetCodeName(a.NET_TS,'00012006') as NET_TS_NAME,a.NET_TS,
  d.code_chi_name as NET_AREA,a.NET_USE,
  c.app_ftlb,c.app_ftle,
  f.ORG_NAME as org_name_A,F_rim_rsm_GetCodeName(f.ORG_SYS_CODE,'00092006') as SYS_Code_A ,f.ORG_SYS_CODE ORG_SYS_CODE_A,
  f.ORG_CODE as org_code_A,f.ORG_POST as ORG_Post_A,f.ORG_ADDR as org_ADDR_A,
  f.ORG_LINK_PERSON as ORG_LINK_PERSON_A ,f.ORG_PHONE as ORG_PHONE_A,f.ORG_FAX as ORG_FAX_A,
  f.ORG_MOB_PHONE as ORG_MOB_PHONE_A,f.ORG_MAIL as ORG_MAIL_A,
  f.ORG_Bank ,f.ORG_Account_Name,f.ORG_Account,
  b.ORG_LINK_PERSON as ORG_LINK_PERSON_B ,c.APP_Date,
  c.MEMO
from Rsbt_Net_r a,rsbt_org b,rsbt_APPly_r c,rsbt_code_dic d,rsbt_code_dic e,rsbt_org f
where a.GUID=c.Net_Guid and a.org_guid=b.GUID and a.fee_guid=f.guid(+) and c.app_type='T'
      and net_area=d.cn(+) and d.code_data_type(+)='00022006'
      and b.org_sys_code=e.cn(+) and e.code_data_type(+)='00092006';

-- ----------------------------
-- View structure for V_RIM_RSM_RADIO_APPLY_T1
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RADIO_APPLY_T1" AS 
select
  ----无线电台（站）设置申请表表(报表打印视图)T
  ----信（波）道----（0：信（波）道）
  A.GUID,B.APP_FREQ_LC,B.APP_FREQ_UC,
B.APP_FREQ_LFB,B.APP_FREQ_LFE,B.APP_FREQ_UFB,B.APP_FREQ_UFE,
B.APP_FREQ_TYPE
from RSBT_APPLY A,RSBT_APPFREQ B
WHERE A.GUID=B.APP_GUID AND  A.APP_TYPE='T' and B.APP_FREQ_TYPE='0';

-- ----------------------------
-- View structure for V_RIM_RSM_RADIO_APPLY_T1_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RADIO_APPLY_T1_R" AS 
select
  ----无线电台（站）设置申请表表(报表打印视图)T
  ----信（波）道----（0：信（波）道）
  A.GUID,B.APP_FREQ_LC,B.APP_FREQ_UC,
B.APP_FREQ_LFB,B.APP_FREQ_LFE,B.APP_FREQ_UFB,B.APP_FREQ_UFE,
B.APP_FREQ_TYPE
from RSBT_APPLY_r A,RSBT_APPFREQ_r B
WHERE A.GUID=B.APP_GUID AND  A.APP_TYPE='T' and B.APP_FREQ_TYPE='0';

-- ----------------------------
-- View structure for V_RIM_RSM_RADIO_APPLY_T2
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RADIO_APPLY_T2" AS 
select
  ----无线电台（站）设置申请表表(报表打印视图)T
  ----频段范围(1：频段范围)
  A.GUID,B.APP_FREQ_LC,B.APP_FREQ_UC,
B.APP_FREQ_LFB,B.APP_FREQ_LFE,B.APP_FREQ_UFB,B.APP_FREQ_UFE,
B.APP_FREQ_TYPE
from RSBT_APPLY A,RSBT_APPFREQ B
WHERE A.GUID=B.APP_GUID AND  A.APP_TYPE='T' and B.APP_FREQ_TYPE='1';

-- ----------------------------
-- View structure for V_RIM_RSM_RADIO_APPLY_T2_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RADIO_APPLY_T2_R" AS 
select
  ----无线电台（站）设置申请表表(报表打印视图)T
  ----频段范围(1：频段范围)
  A.GUID,B.APP_FREQ_LC,B.APP_FREQ_UC,
B.APP_FREQ_LFB,B.APP_FREQ_LFE,B.APP_FREQ_UFB,B.APP_FREQ_UFE,
B.APP_FREQ_TYPE
from RSBT_APPLY_r A,RSBT_APPFREQ_r B
WHERE A.GUID=B.APP_GUID AND  A.APP_TYPE='T' and B.APP_FREQ_TYPE='1';

-- ----------------------------
-- View structure for V_RIM_RSM_RADIO_APPLY_T3
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RADIO_APPLY_T3" AS 
select
  ----无线电台（站）设置申请表表(报表打印视图)T
  ----申请表文件列表
  B.GUID, A.APP_FILE_NO
 from RSBT_APPFILELIST A,RSBT_APPLY B
 where A.APP_GUID=B.GUID;

-- ----------------------------
-- View structure for V_RIM_RSM_RADIO_APPLY_T3_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RADIO_APPLY_T3_R" AS 
select
  ----无线电台（站）设置申请表表(报表打印视图)T
  ----申请表文件列表
  B.GUID, A.APP_FILE_NO
 from RSBT_APPFILELIST_r A,RSBT_APPLY_r B
 where A.APP_GUID=B.GUID;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,ANT_MODeL,ANT_MENU,ANT_HIGHT,
    f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
    ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
		AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,
		AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,AT_H_VPIC,AT_ANT_UPANG
from rsbt_ANTFEED a,rsbt_ANTFEED_t b
where a.guid=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_AA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_AA" AS 
select
  ----扇区数据视图
  A.GUID,A.STATION_GUID,b.stat_app_type,A.AT_CCODE,A.AT_ANG_E,A.AT_CSGN,
  A.AT_RANG,A.AT_EANG
  from V_rim_rsm_RSBT_ANTFEED A ,rsbt_station b
  where a.station_guid=b.guid
  order by A.AT_CCODE ASC;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_AA_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_AA_R" AS 
select
  ----扇区数据视图
  A.GUID,A.STATION_GUID,b.stat_app_type,A.AT_CCODE,A.AT_ANG_E,A.AT_CSGN,
  A.AT_RANG,A.AT_EANG
  from V_rim_rsm_RSBT_ANTFEED_r A ,rsbt_station_r b
  where a.station_guid=b.guid
  order by A.AT_CCODE ASC;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_B_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_B_RPT" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,ANT_MODeL,ANT_MENU,ANT_HIGHT,
    f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
    decode(ANT_ANGLE,null,'ND',To_char(ANT_ANGLE)) ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
    AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,    AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,AT_H_VPIC,AT_ANT_UPANG,c.code_chi_name ant_pole_name
from rsbt_ANTFEED a,rsbt_ANTFEED_t b,rsbt_code_dic c
where a.guid=b.guid(+) and (a.ant_pole=c.cn(+) and c.code_data_type(+)='00202006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_B_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_B_RPT_R" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,ANT_MODeL,ANT_MENU,ANT_HIGHT,
    f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
    decode(ANT_ANGLE,null,'ND',To_char(ANT_ANGLE)) ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
    AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,    AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,AT_H_VPIC,AT_ANT_UPANG,c.code_chi_name ant_pole_name
from rsbt_ANTFEED_r a,rsbt_ANTFEED_t_r b,rsbt_code_dic c
where a.guid=b.guid(+) and (a.ant_pole=c.cn(+) and c.code_data_type(+)='00202006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_BB
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_BB" AS 
select
  ----天馈线数据视图
  A.GUID,A.STATION_GUID,A.AT_CCODE,
  A.ANT_TYPE,B.CODE_CHI_NAME as ANT_TYPE_NAME,
  A.ANT_MODeL,
  A.ANT_POLE,C.CODE_CHI_NAME as ANT_POLE_NAME,
  A.AT_3DBE,A.AT_3DBR,A.ANT_EGAIN,A.ANT_RGAIN,A.ANT_MENU,A.ANT_HIGHT,
  A.FEED_LOSE
  from V_rim_rsm_RSBT_ANTFEED A,RSBT_CODE_DIC B,RSBT_CODE_DIC C
  where (A.ANT_TYPE=B.CN(+) and B.CODE_DATA_TYPE(+) = '00172006' ) and
  (A.ANT_POLE = C.CN(+) and C.CODE_DATA_TYPE(+) ='00202006' );

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_BB_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_BB_R" AS 
select
  ----天馈线数据视图
  A.GUID,A.STATION_GUID,A.AT_CCODE,
  A.ANT_TYPE,B.CODE_CHI_NAME as ANT_TYPE_NAME,
  A.ANT_MODeL,
  A.ANT_POLE,C.CODE_CHI_NAME as ANT_POLE_NAME,
  A.AT_3DBE,A.AT_3DBR,A.ANT_EGAIN,A.ANT_RGAIN,A.ANT_MENU,A.ANT_HIGHT,
  A.FEED_LOSE
  from V_rim_rsm_RSBT_ANTFEED_r A,RSBT_CODE_DIC B,RSBT_CODE_DIC C
  where (A.ANT_TYPE=B.CN(+) and B.CODE_DATA_TYPE(+) = '00172006' ) and
  (A.ANT_POLE = C.CN(+) and C.CODE_DATA_TYPE(+) ='00202006' );

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_E_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_E_RPT" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,ANT_MODeL,ANT_MENU,ANT_HIGHT,
    f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
    ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
    AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,
    AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,
    AT_H_VPIC,AT_ANT_UPANG,c.code_chi_name ant_type_name,e.code_chi_name ANT_EPOLE_NAME,
    f.code_chi_name ANT_RPOLE_NAME
from rsbt_ANTFEED a,rsbt_ANTFEED_t b,rsbt_code_dic c,rsbt_code_dic e,rsbt_code_dic f
where a.guid=b.guid(+) and (a.ant_type=c.cn(+) and c.code_data_type(+)='00172006') and (a.ANT_EPOLE=e.cn(+) and e.code_data_type(+)='00202006') and (a.ANT_RPOLE=f.cn(+) and f.code_data_type(+)='00202006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_E_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_E_RPT_R" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,ANT_MODeL,ANT_MENU,ANT_HIGHT,
    f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
    ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
    AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,
    AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,
    AT_H_VPIC,AT_ANT_UPANG,c.code_chi_name ant_type_name,e.code_chi_name ANT_EPOLE_NAME,
    f.code_chi_name ANT_RPOLE_NAME
from rsbt_ANTFEED_r a,rsbt_ANTFEED_t_r b,rsbt_code_dic c,rsbt_code_dic e,rsbt_code_dic f
where a.guid=b.guid(+) and (a.ant_type=c.cn(+) and c.code_data_type(+)='00172006') and (a.ANT_EPOLE=e.cn(+) and e.code_data_type(+)='00202006') and (a.ANT_RPOLE=f.cn(+) and f.code_data_type(+)='00202006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_H_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_H_RPT" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,d.code_chi_name ANT_TYPE_NAME,ANT_MODeL,ANT_MENU,ANT_HIGHT,
  f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
  decode(ANT_ANGLE,null,'ND',To_char(ANT_ANGLE)) ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
  AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,
  AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,AT_H_VPIC,AT_ANT_UPANG,
    c.code_chi_name ant_pole_name
from rsbt_ANTFEED a,rsbt_ANTFEED_t b,rsbt_code_dic c,rsbt_code_dic D
where a.guid=b.guid(+) and a.ant_pole=c.cn(+) and c.code_data_type='00202006'
and a.ant_type=d.cn(+) and d.code_data_type='00172006';

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_H_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_H_RPT_R" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,d.code_chi_name ANT_TYPE_NAME,ANT_MODeL,ANT_MENU,ANT_HIGHT,
  f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
  decode(ANT_ANGLE,null,'ND',To_char(ANT_ANGLE)) ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
  AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,
  AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,AT_H_VPIC,AT_ANT_UPANG,
    c.code_chi_name ant_pole_name
from rsbt_ANTFEED_r a,rsbt_ANTFEED_t_r b,rsbt_code_dic c,rsbt_code_dic D
where a.guid=b.guid(+) and a.ant_pole=c.cn(+) and c.code_data_type='00202006'
and a.ant_type=d.cn(+) and d.code_data_type='00172006';

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_R" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,ANT_MODeL,ANT_MENU,ANT_HIGHT,
    f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
    ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
		AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,
		AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,AT_H_VPIC,AT_ANT_UPANG
from rsbt_ANTFEED_r a,rsbt_ANTFEED_t_r b
where a.guid=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_R_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_R_RPT" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,ANT_MODeL,ANT_MENU,ANT_HIGHT,
    f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
    ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
    AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,
    AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,AT_H_VPIC,AT_ANT_UPANG,c.code_chi_name ANT_POLE_NAME,d.code_chi_name ANT_TYPE_NAME
from rsbt_ANTFEED a,rsbt_ANTFEED_t b,rsbt_code_dic c,rsbt_code_dic d
where a.guid=b.guid(+) and (a.ANT_POLE=c.cn(+) and c.code_data_type(+)='00202006')and (a.ANT_TYPE=d.cn(+) and d.code_data_type(+)='00172006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_R_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_R_RPT_R" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,ANT_MODeL,ANT_MENU,ANT_HIGHT,
    f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
    ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
    AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,
    AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,AT_H_VPIC,AT_ANT_UPANG,c.code_chi_name ANT_POLE_NAME,d.code_chi_name ANT_TYPE_NAME
from rsbt_ANTFEED_r a,rsbt_ANTFEED_t_r b,rsbt_code_dic c,rsbt_code_dic d
where a.guid=b.guid(+) and (a.ANT_POLE=c.cn(+) and c.code_data_type(+)='00202006')and (a.ANT_TYPE=d.cn(+) and d.code_data_type(+)='00172006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_V_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_V_RPT" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,ANT_MODeL,ANT_MENU,ANT_HIGHT,
    f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
    decode(ANT_ANGLE,null,'ND',To_char(ANT_ANGLE)) ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
    AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,
    AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,
    AT_H_VPIC,AT_ANT_UPANG,c.code_chi_name ant_type_name,d.code_chi_name ant_pole_name
from rsbt_ANTFEED a,rsbt_ANTFEED_t b,rsbt_code_dic c,rsbt_code_dic d
where a.guid=b.guid(+) and (a.ant_type=c.cn(+) and c.code_data_type(+)='00172006')
 and (a.ant_pole=d.cn(+) and d.code_data_type(+)='00202006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_ANTFEED_V_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_ANTFEED_V_RPT_R" AS 
SELECT A.GUID,STATION_GUID,ANT_WORK_TYPE,ANT_POLE,ANT_RPOLE,ANT_EPOLE,ANT_TYPE,ANT_MODeL,ANT_MENU,ANT_HIGHT,
    f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN,
    decode(ANT_ANGLE,null,'ND',To_char(ANT_ANGLE)) ANT_ANGLE,ANT_SIZE,FEED_MENU,FEED_MODeL,FEED_LENGTH,FEED_LOSE,ANT_CODE,FEED_CODE,
    AT_ANT_NO,AT_SE_B,AT_SE_E,AT_ANG_B,AT_ANG_E,AT_RNT,AT_BWID,AT_LEL,
    AT_SSPEED,AT_CCODE,AT_3DBE,AT_3DBR,AT_RANG,AT_EANG,AT_CSGN,AT_UPDN,AT_SUM,AT_QUA,AT_UNIT_TYPE,
    AT_H_VPIC,AT_ANT_UPANG,c.code_chi_name ant_type_name,d.code_chi_name ant_pole_name
from rsbt_ANTFEED_r a,rsbt_ANTFEED_t_r b,rsbt_code_dic c,rsbt_code_dic d
where a.guid=b.guid(+) and (a.ant_type=c.cn(+) and c.code_data_type(+)='00172006')
 and (a.ant_pole=d.cn(+) and d.code_data_type(+)='00202006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_APPLY_STATMGR
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_APPLY_STATMGR" AS 
Select app_code,substr(a.app_code,-12,12) app_codeDes,a.net_guid,net_name,a.org_guid,decode(app_type,'PA',app_pa_name, b.org_name) org_name,b.org_sys_code,app_type,
       c.code_chi_name app_type_name,'' Tech_Type,d.org_code,e.org_area_code
from rsbt_apply a,rsbt_org b,rsbt_code_dic c,rsbt_net d,rsbt_org e,rsbt_apply_pa f
where a.org_guid=b.guid(+) and a.net_guid=d.guid(+) and a.org_manager_guid=e.guid(+) and a.guid=f.app_guid(+)
    and (a.app_type=c.cn(+) and c.code_data_type(+)='00522006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_CCODE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_CCODE" AS 
select distinct stat.guid,stat.net_guid, stat_t.st_c_code,app.app_code,stat.stat_tdi,app.app_type from rsbt_station stat,rsbt_station_t stat_t,rsbt_apply app
where stat_t.guid=stat.guid and app.app_code=stat.app_code and stat.stat_app_type='C' and stat_t.st_c_code is not null;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_CCODE_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_CCODE_R" AS 
select distinct stat.guid,stat.net_guid, stat_t.st_c_code,app.app_code,stat.stat_tdi,app.app_type from rsbt_station_r stat,rsbt_station_t_r stat_t,rsbt_apply_r app
where stat_t.guid=stat.guid and app.app_code=stat.app_code and stat.stat_app_type='c' and stat_t.st_c_code is not null;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_EQU
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_EQU" AS 
SELECT A.GUID,STATION_GUID,EQU_TYPE,EQU_MODEL,EQU_AUTH,EQU_MENU,EQU_CODE,EQU_PF,f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) EQU_POW,EQU_MB,
    ET_EQU_NO,ET_AF_TYPE,ET_EIRP,ET_POW_U,ET_EQU_CL,ET_EQU_TL,ET_EQU_RNQ,ET_EQU_TYPE_ID,
    ET_EQU_NAME,ET_EQU_CODE,ET_EQU_ESGN,ET_EQU_EPOS,ET_EQU_ATYPE,ET_EQU_APOS,ET_EQU_SUM,ET_EQU_EUSE,
    ET_EQU_FNTVAL,ET_EQU_PUP,ET_EQU_PDN,ET_EQU_CHRIP,ET_EQU_PWID1,ET_EQU_PWID2,ET_EQU_PR,ET_EQU_PF,
    ET_EQU_SEN,ET_EQU_SENU,ET_EQU_SENERR,ET_EQU_RWID,ET_EQU_MT,ET_EQU_CCODE,ET_EQU_UPU,ET_EQU_DNU,
		ET_EQU_TYPE,ET_EQU_USE,ET_EQU_POW_MAX,ET_EQU_POW_AVG,b.ET_EQU_UPOW,b.ET_EQU_DPOW,b.ET_EQU_RF,
		b.ET_EQU_RF_BAND
from rsbt_EQU a,rsbt_EQU_t b
where a.guid=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_EQU_ANT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_EQU_ANT" AS 
select T0.equ_model,f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) equ_pow,T0.equ_pf,T0.equ_mb,T0.equ_type,T0.equ_auth,T0.station_guid,T0.equ_menu,
  T0.guid,t2.guid ant_guid,T0.equ_code,T1.et_equ_pwid2,T1.et_equ_pup,T1.et_equ_senerr,T1.et_pow_u,T1.et_equ_pr,
  T1.et_equ_type_id,T1.et_equ_upu,T1.et_equ_cl,T1.et_equ_fntval,T1.et_equ_pf,T1.et_equ_no,T1.et_equ_code,
  T1.et_equ_tl,T1.et_equ_epos,T1.et_equ_apos,T1.et_equ_chrip,T1.et_equ_rnq,T1.et_equ_name,T1.et_equ_use,
  T1.et_equ_ccode,T1.et_eirp,T1.et_equ_rwid,T1.et_equ_esgn,T1.et_equ_atype,T1.et_equ_pow_avg,T1.et_equ_pow_max,
  T1.et_equ_dnu,T1.et_af_type,T1.et_equ_type,T1.et_equ_senu,T1.et_equ_sen,T1.et_equ_mt,T1.et_equ_sum,T1.ET_EQU_RF,
  T1.ET_EQU_RF_BAND,
  T1.et_equ_pdn,T1.et_equ_euse,T1.et_equ_pwid1,T2.ant_rpole, T2.ant_model,T2.ant_epole,T2.ant_code,
  T2.feed_code,T2.ANT_WORK_TYPE,T2.feed_menu,T2.ant_angle,T2.feed_lose,T2.ant_hight,T2.ant_menu,T2.feed_length,
  T2.ant_size,T2.ant_type, T2.feed_model,T2.ant_pole, T3.at_ant_no,T3.at_lel,
  T3.at_bwid,T3.AT_ANG_E,T3.at_ang_b,T3.at_ccode,T3.at_unit_type,T3.at_3dbe,T3.at_sspeed,T3.at_rnt,T3.at_qua,
  T3.at_se_e,T3.at_eang,T3.at_updn,T3.at_se_b,T3.at_csgn,T3.at_3dbr,T3.at_rang,T3.at_sum
  ,t1.ET_EQU_UPOW,t1.ET_EQU_DPOW,AT_H_HPIC,AT_H_VPIC,AT_ANT_UPANG,
  f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN
 from RSBT_EQU T0,RSBT_EQU_T T1, RSBT_ANTFEED T2,RSBT_ANTFEED_T T3,t_rim_rsm_equ_expand e_exp
 where  t0.guid =t2.guid(+)  and T0.guid  = T1.Guid(+) and t0.guid=e_exp.guid(+) and nvl(e_exp.equ_status,'1')='1'
   and    t2.guid  = t3.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_EQU_ANT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_EQU_ANT_R" AS 
select T0.equ_model,f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) equ_pow,T0.equ_pf,T0.equ_mb,T0.equ_type,T0.equ_auth,T0.station_guid,T0.equ_menu,
  T0.guid,t2.guid ant_guid,T0.equ_code,T1.et_equ_pwid2,T1.et_equ_pup,T1.et_equ_senerr,T1.et_pow_u,T1.et_equ_pr,
  T1.et_equ_type_id,T1.et_equ_upu,T1.et_equ_cl,T1.et_equ_fntval,T1.et_equ_pf,T1.et_equ_no,T1.et_equ_code,
  T1.et_equ_tl,T1.et_equ_epos,T1.et_equ_apos,T1.et_equ_chrip,T1.et_equ_rnq,T1.et_equ_name,T1.et_equ_use,
  T1.et_equ_ccode,T1.et_eirp,T1.et_equ_rwid,T1.et_equ_esgn,T1.et_equ_atype,T1.et_equ_pow_avg,T1.et_equ_pow_max,
  T1.et_equ_dnu,T1.et_af_type,T1.et_equ_type,T1.et_equ_senu,T1.et_equ_sen,T1.et_equ_mt,T1.et_equ_sum,T1.ET_EQU_RF,
  T1.ET_EQU_RF_BAND,
  T1.et_equ_pdn,T1.et_equ_euse,T1.et_equ_pwid1,T2.ant_rpole, T2.ant_model,T2.ant_epole,T2.ant_code,
  T2.feed_code,T2.ANT_WORK_TYPE,T2.feed_menu,T2.ant_angle,T2.feed_lose,T2.ant_hight,T2.ant_menu,T2.feed_length,
  T2.ant_size,T2.ant_type, T2.feed_model,T2.ant_pole, T3.at_ant_no,T3.at_lel,
  T3.at_bwid,T3.AT_ANG_E,T3.at_ang_b,T3.at_ccode,T3.at_unit_type,T3.at_3dbe,T3.at_sspeed,T3.at_rnt,T3.at_qua,
  T3.at_se_e,T3.at_eang,T3.at_updn,T3.at_se_b,T3.at_csgn,T3.at_3dbr,T3.at_rang,T3.at_sum
  ,t1.ET_EQU_UPOW,t1.ET_EQU_DPOW,AT_H_HPIC,AT_H_VPIC,AT_ANT_UPANG,
  f_rim_rsm_GETGAIN_I(ANT_GAIN,AT_Unit_Type) ANT_GAIN,f_rim_rsm_GETGAIN_I(ANT_EGAIN,AT_Unit_Type)  ANT_EGAIN, f_rim_rsm_GETGAIN_I(ANT_RGAIN,AT_Unit_Type)  ANT_RGAIN
 from RSBT_EQU_r T0,RSBT_EQU_T_r T1, RSBT_ANTFEED_r T2,RSBT_ANTFEED_T_r T3
 where  t0.guid =t2.guid(+)  and T0.guid  = T1.Guid(+)
   and    t2.guid  = t3.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_EQU_FREQ_A_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_EQU_FREQ_A_RPT" AS 
select T0.equ_model,f_rim_rsm_GETPOWER_W(EQU_POW,2) equ_pow,T0.equ_pf,T0.equ_mb,T0.equ_type,T0.equ_auth,T0.station_guid,
  T0.equ_menu,T0.guid,t2.guid freq_guid,T0.equ_code,T1.et_equ_pwid2,T1.et_equ_pup,
  T1.et_equ_senerr,T1.et_pow_u,T1.et_equ_pr,T1.et_equ_type_id,T1.et_equ_upu,
  T1.et_equ_cl,T1.et_equ_fntval,T1.et_equ_pf,T1.et_equ_no,T1.et_equ_code,T1.et_equ_tl,
  T1.et_equ_epos,T1.et_equ_apos,T1.et_equ_chrip,T1.et_equ_rnq,T1.et_equ_name,T1.et_equ_use,
  T1.et_equ_ccode,T1.et_eirp,T1.et_equ_rwid,T1.et_equ_esgn,T1.et_equ_atype,T1.et_equ_pow_avg,
  T1.et_equ_pow_max,T1.et_equ_dnu,T1.et_af_type,T1.et_equ_type,T1.et_equ_senu,T1.et_equ_sen,
  T1.et_equ_mt,T1.et_equ_sum,T1.et_equ_pdn,T1.et_equ_euse,T1.et_equ_pwid1,T1.ET_EQU_RF,
  T1.ET_EQU_RF_BAND,T2.freq_mod,
  T2.freq_type, T2.freq_mb,T2.freq_code,  --频率数据处理
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) ft_freq_unit_type,
  f_rim_rsm_GETFREQ_R(freq_uc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_uc,
  f_rim_rsm_GETFREQ_R(freq_lc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_lc,
  decode(t2.FREQ_TYPE,'0',f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_efe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_efe,
  decode(t2.FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ,'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_rfe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_rfe,
  T3.ft_freq_type,T3.ft_freq_csgn,T3.ft_freq_mc1,
  T3.ft_freq_timee,T3.ft_freq_dupdn,T3.ft_freq_no,T3.ft_freq_hcl,T3.ft_freq_mc,T3.ft_freq_timeb,
  T3.ft_freq_mc2,T3.ft_freq_mc3,T3.ft_freq_info_type,T3.ft_freq_ccode
  ,t1.ET_EQU_UPOW,t1.ET_EQU_DPOW
  ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
  ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
  ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
  ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
      --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit,T4.Code_Chi_Name et_equ_esgn_name,T5.Code_Chi_Name et_equ_atype_name
  from RSBT_EQU T0,RSBT_EQU_T T1,RSBT_freq T2,RSBT_freq_T T3,RSBT_CODE_DIC T4,RSBT_CODE_DIC T5
  where  t0.guid =t2.guid(+) and T0.guid  = T1.Guid(+)
  and    t2.guid  = t3.guid(+)
  and ( T1.Et_Equ_Esgn = T4.cn(+) and T4.code_data_type(+)='00252006')
  and ( T1.Et_Equ_Atype=T5.cn(+) and T5.code_data_type(+)='00172006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_EQU_FREQ_A_RPTR
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_EQU_FREQ_A_RPTR" AS 
select T0.equ_model,f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) equ_pow,T0.equ_pf,T0.equ_mb,T0.equ_type,T0.equ_auth,T0.station_guid,
  T0.equ_menu,T0.guid,t2.guid freq_guid,T0.equ_code,T1.et_equ_pwid2,T1.et_equ_pup,
  T1.et_equ_senerr,T1.et_pow_u,T1.et_equ_pr,T1.et_equ_type_id,T1.et_equ_upu,
  T1.et_equ_cl,T1.et_equ_fntval,T1.et_equ_pf,T1.et_equ_no,T1.et_equ_code,T1.et_equ_tl,
  T1.et_equ_epos,T1.et_equ_apos,T1.et_equ_chrip,T1.et_equ_rnq,T1.et_equ_name,T1.et_equ_use,
  T1.et_equ_ccode,T1.et_eirp,T1.et_equ_rwid,T1.et_equ_esgn,T1.et_equ_atype,T1.et_equ_pow_avg,
  T1.et_equ_pow_max,T1.et_equ_dnu,T1.et_af_type,T1.et_equ_type,T1.et_equ_senu,T1.et_equ_sen,
  T1.et_equ_mt,T1.et_equ_sum,T1.et_equ_pdn,T1.et_equ_euse,T1.et_equ_pwid1,T1.ET_EQU_RF,
  T1.ET_EQU_RF_BAND,T2.freq_mod,
  T2.freq_type, T2.freq_mb,T2.freq_code,  --频率数据处理
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) ft_freq_unit_type,
  f_rim_rsm_GETFREQ_R(freq_uc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_uc,
  f_rim_rsm_GETFREQ_R(freq_lc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_lc,
  decode(t2.FREQ_TYPE,'0',f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_efe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_efe,
  decode(t2.FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ,'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_rfe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_rfe,
  T3.ft_freq_type,T3.ft_freq_csgn,T3.ft_freq_mc1,
  T3.ft_freq_timee,T3.ft_freq_dupdn,T3.ft_freq_no,T3.ft_freq_hcl,T3.ft_freq_mc,T3.ft_freq_timeb,
  T3.ft_freq_mc2,T3.ft_freq_mc3,T3.ft_freq_info_type,T3.ft_freq_ccode
  ,t1.ET_EQU_UPOW,t1.ET_EQU_DPOW
  ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
  ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
  ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
  ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
      --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit,T4.Code_Chi_Name et_equ_esgn_name,T5.Code_Chi_Name et_equ_atype_name
  from RSBT_EQU_r T0,RSBT_EQU_T_r T1,RSBT_freq_r T2,RSBT_freq_T_r T3,RSBT_CODE_DIC T4,RSBT_CODE_DIC T5
  where  t0.guid =t2.guid(+) and T0.guid  = T1.Guid(+)
  and    t2.guid  = t3.guid(+)
  and ( T1.Et_Equ_Esgn = T4.cn(+) and T4.code_data_type(+)='00252006')
  and ( T1.Et_Equ_Atype=T5.cn(+) and T5.code_data_type(+)='00172006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_EQU_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_EQU_R" AS 
SELECT A.GUID,STATION_GUID,EQU_TYPE,EQU_MODEL,EQU_AUTH,EQU_MENU,EQU_CODE,EQU_PF,f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) EQU_POW,EQU_MB,
    ET_EQU_NO,ET_AF_TYPE,ET_EIRP,ET_POW_U,ET_EQU_CL,ET_EQU_TL,ET_EQU_RNQ,ET_EQU_TYPE_ID,
    ET_EQU_NAME,ET_EQU_CODE,ET_EQU_ESGN,ET_EQU_EPOS,ET_EQU_ATYPE,ET_EQU_APOS,ET_EQU_SUM,ET_EQU_EUSE,
    ET_EQU_FNTVAL,ET_EQU_PUP,ET_EQU_PDN,ET_EQU_CHRIP,ET_EQU_PWID1,ET_EQU_PWID2,ET_EQU_PR,ET_EQU_PF,
    ET_EQU_SEN,ET_EQU_SENU,ET_EQU_SENERR,ET_EQU_RWID,ET_EQU_MT,ET_EQU_CCODE,ET_EQU_UPU,ET_EQU_DNU,
		ET_EQU_TYPE,ET_EQU_USE,ET_EQU_POW_MAX,ET_EQU_POW_AVG,b.ET_EQU_UPOW,b.ET_EQU_DPOW,b.ET_EQU_RF,
		b.ET_EQU_RF_BAND
from rsbt_EQU_r a,rsbt_EQU_t_r b
where a.guid=b.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_EQU_R_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_EQU_R_RPT" AS 
SELECT A.GUID,STATION_GUID,EQU_TYPE,EQU_MODEL,EQU_AUTH,EQU_MENU,EQU_CODE,EQU_PF,f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) EQU_POW,EQU_MB,
    ET_EQU_NO,ET_AF_TYPE,ET_EIRP,ET_POW_U,ET_EQU_CL,ET_EQU_TL,ET_EQU_RNQ,ET_EQU_TYPE_ID,
    ET_EQU_NAME,ET_EQU_CODE,ET_EQU_ESGN,ET_EQU_EPOS,ET_EQU_ATYPE,ET_EQU_APOS,ET_EQU_SUM,ET_EQU_EUSE,
    ET_EQU_FNTVAL,ET_EQU_PUP,ET_EQU_PDN,ET_EQU_CHRIP,ET_EQU_PWID1,ET_EQU_PWID2,ET_EQU_PR,ET_EQU_PF,
    ET_EQU_SEN,ET_EQU_SENU,ET_EQU_SENERR,ET_EQU_RWID,ET_EQU_MT,ET_EQU_CCODE,ET_EQU_UPU,ET_EQU_DNU,
    ET_EQU_TYPE,ET_EQU_USE,ET_EQU_POW_MAX,ET_EQU_POW_AVG,b.ET_EQU_UPOW,b.ET_EQU_DPOW,b.ET_EQU_RF,
    b.ET_EQU_RF_BAND,c.code_chi_name et_equ_mt_name,D.CODE_CHI_NAME ET_EQU_SENU_V
from rsbt_EQU a,rsbt_EQU_t b,rsbt_code_dic c,RSBT_CODE_DIC D
where a.guid=b.guid(+) and (b.et_equ_mt = c.cn(+) and c.code_data_type(+)='00272006')
      AND B.ET_EQU_SENU=D.CN(+) AND D.CODE_DATA_TYPE(+)='00332006';

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_EQU_R_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_EQU_R_RPT_R" AS 
SELECT A.GUID,STATION_GUID,EQU_TYPE,EQU_MODEL,EQU_AUTH,EQU_MENU,EQU_CODE,EQU_PF,f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) EQU_POW,EQU_MB,
    ET_EQU_NO,ET_AF_TYPE,ET_EIRP,ET_POW_U,ET_EQU_CL,ET_EQU_TL,ET_EQU_RNQ,ET_EQU_TYPE_ID,
    ET_EQU_NAME,ET_EQU_CODE,ET_EQU_ESGN,ET_EQU_EPOS,ET_EQU_ATYPE,ET_EQU_APOS,ET_EQU_SUM,ET_EQU_EUSE,
    ET_EQU_FNTVAL,ET_EQU_PUP,ET_EQU_PDN,ET_EQU_CHRIP,ET_EQU_PWID1,ET_EQU_PWID2,ET_EQU_PR,ET_EQU_PF,
    ET_EQU_SEN,ET_EQU_SENU,ET_EQU_SENERR,ET_EQU_RWID,ET_EQU_MT,ET_EQU_CCODE,ET_EQU_UPU,ET_EQU_DNU,
    ET_EQU_TYPE,ET_EQU_USE,ET_EQU_POW_MAX,ET_EQU_POW_AVG,b.ET_EQU_UPOW,b.ET_EQU_DPOW,b.ET_EQU_RF,
    b.ET_EQU_RF_BAND,c.code_chi_name et_equ_mt_name,D.CODE_CHI_NAME ET_EQU_SENU_V
from rsbt_EQU_r a,rsbt_EQU_t_r b,rsbt_code_dic c,RSBT_CODE_DIC D
where a.guid=b.guid(+) and (b.et_equ_mt = c.cn(+) and c.code_data_type(+)='00272006')
      AND B.ET_EQU_SENU=D.CN(+) AND D.CODE_DATA_TYPE(+)='00332006';

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FEEEVERYYEAR
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FEEEVERYYEAR" AS 
select "GUID","ORG_GUID","NET_GUID","STATION_GUID","FEE_TYPE","FEE_SUM","FEE_DERATE_PROPORTION","FEE_DERATE_ACCORDING","FEE_START_DATE","FEE_END_DATE","FEE_PAY_MONTH","FEE_OPERATION","FEE_OPERATION_DATE","FEE_AUDIT","FEE_AUDIT_DATE","MEMO"
from RSBT_FEEEVERYYEAR
where fee_derate_proportion>0;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
  f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
  f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
    ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
    ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,c.st_tf_code station_code_a,'' station_code_b,b.ft_freq_tfcode
from rsbt_freq a,rsbt_freq_t b,rsbt_station_t c,rsbt_station d
where a.guid=b.guid(+) and c.guid = d.guid and a.station_guid=d.guid;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_2
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_2" AS 
select
  -----设备数据报表
  A.GUID,A.STATION_GUID,A.EQU_MENU,A.EQU_MODEL,B.ET_EQU_TL,A.EQU_AUTH,A.Equ_Pf,
  f_rim_rsm_GETPOWER_W(A.EQU_POW,B.ET_POW_U) EQU_POW,B.ET_POW_U,C.CODE_CHI_NAME,
  B.ET_EQU_RNQ,A.EQU_CODE,B.ET_EQU_NO
  from RSBT_EQU A,RSBT_EQU_T B,RSBT_CODE_DIC C
  where A.GUID=B.GUID(+) and
  (B.ET_POW_U= C.CN(+) and C.code_data_type(+) = '00282006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_2_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_2_R" AS 
select
  -----设备数据报表
  A.GUID,A.STATION_GUID,A.EQU_MENU,A.EQU_MODEL,B.ET_EQU_TL,A.EQU_AUTH,A.Equ_Pf,
  f_rim_rsm_GETPOWER_W(A.EQU_POW,B.ET_POW_U) EQU_POW,B.ET_POW_U,C.CODE_CHI_NAME,
  B.ET_EQU_RNQ,A.EQU_CODE,B.ET_EQU_NO
  from RSBT_EQU_r A,RSBT_EQU_T_r B,RSBT_CODE_DIC C
  where A.GUID=B.GUID(+) and
  (B.ET_POW_U= C.CN(+) and C.code_data_type(+) = '00282006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_3
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_3" AS 
select
  ----天线数据报表
  A.GUID,A.STATION_GUID,A.ANT_MODEL,A.ANT_MENU, A.ANT_TYPE,C.CODE_CHI_NAME,
  f_rim_rsm_GETGAIN_I(A.ANT_GAIN,B.AT_Unit_Type) ANT_GAIN,B.AT_ANT_UPANG,
  A.ANT_HIGHT,A.ANT_SIZE,A.Ant_Angle
  from RSBT_ANTFEED A,RSBT_ANTFEED_T B,RSBT_CODE_DIC C
  where A.guid=B.guid(+) and
  (A.ANT_TYPE= C.CN(+) and C.code_data_type(+) = '00172006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_3_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_3_R" AS 
select
  ----天线数据报表
  A.GUID,A.STATION_GUID,A.ANT_MODEL,A.ANT_MENU, A.ANT_TYPE,C.CODE_CHI_NAME,
  f_rim_rsm_GETGAIN_I(A.ANT_GAIN,B.AT_Unit_Type) ANT_GAIN,B.AT_ANT_UPANG,
  A.ANT_HIGHT,A.ANT_SIZE,A.Ant_Angle
  from RSBT_ANTFEED_r A,RSBT_ANTFEED_T_r B,RSBT_CODE_DIC C
  where A.guid=B.guid(+) and
  (A.ANT_TYPE= C.CN(+) and C.code_data_type(+) = '00172006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_4
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_4" AS 
select
  ----馈线数据报表
  A.GUID,A.STATION_GUID,A.ANT_MENU,A.Feed_Model,A.FEED_LENGTH,A.Feed_Menu,
  A.Feed_Lose
  from RSBT_ANTFEED A;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_4_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_4_R" AS 
select
  ----馈线数据报表
  A.GUID,A.STATION_GUID,A.ANT_MENU,A.Feed_Model,A.FEED_LENGTH,A.Feed_Menu,
  A.Feed_Lose
  from RSBT_ANTFEED_r A;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_A
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_A" AS 
select
  ----地面固定业务台（站）技术资料申报表
  ----频率数据信息（视图）
  B.STATION_GUID,B.GUID,
C.FT_FREQ_NO,
B.FREQ_TYPE,
Decode(B.FREQ_TYPE,'1','频段','0','中心频率') as FREQ_TYPE_NAME,B.FREQ_MOD,
D.Code_CHI_Name,E.Code_CHI_Name as Code_CHI_Name_A,F.Code_CHI_Name as Code_CHI_Name_B,
f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
decode(B.FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
decode(B.freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
decode(B.FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
decode(B.freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
f_rim_rsm_GETFREQ_R(B.FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(B.FREQ_E_BAND)) FREQ_E_BAND,
f_rim_rsm_GETFREQ_Band_Unit(B.FREQ_E_BAND) FREQ_E_BAND_Unit,
f_rim_rsm_GETFREQ_R(B.FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(B.FREQ_E_BAND)) FREQ_R_BAND,
f_rim_rsm_GETFREQ_Band_Unit(B.FREQ_E_BAND) FREQ_R_BAND_UNIT,c.Ft_Freq_Type,C.FT_FREQ_FEP
from RSBT_FREQ B,RSBT_FREQ_T C,
RSBT_CODE_DIC D,RSBT_CODE_DIC E,RSBT_CODE_DIC F
where B.GUID=C.GUID(+)
 and (c.ft_FREQ_TYPE= D.CN(+) and D.code_data_type(+) = '00412006')
 and (C.FT_FREQ_FEP= E.CN(+) and E.code_data_type(+) = '00202006')
 and (B.Freq_Mod = F.CN(+) and F.code_data_type(+) = '00272006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_A_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_A_R" AS 
select
  ----地面固定业务台（站）技术资料申报表
  ----频率数据信息（视图）
  B.STATION_GUID,B.GUID,
C.FT_FREQ_NO,
B.FREQ_TYPE,
Decode(B.FREQ_TYPE,'1','频段','0','中心频率') as FREQ_TYPE_NAME,B.FREQ_MOD,
D.Code_CHI_Name,E.Code_CHI_Name as Code_CHI_Name_A,F.Code_CHI_Name as Code_CHI_Name_B,
f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
decode(B.FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
decode(B.freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
decode(B.FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
decode(B.freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
f_rim_rsm_GETFREQ_R(B.FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(B.FREQ_E_BAND)) FREQ_E_BAND,
f_rim_rsm_GETFREQ_Band_Unit(B.FREQ_E_BAND) FREQ_E_BAND_Unit,
f_rim_rsm_GETFREQ_R(B.FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(B.FREQ_E_BAND)) FREQ_R_BAND,
f_rim_rsm_GETFREQ_Band_Unit(B.FREQ_E_BAND) FREQ_R_BAND_UNIT,c.Ft_Freq_Type,C.FT_FREQ_FEP
from Rsbt_Freq_r B,Rsbt_Freq_t_r C,
RSBT_CODE_DIC D,RSBT_CODE_DIC E,RSBT_CODE_DIC F
where B.GUID=C.GUID(+)
 and (c.ft_FREQ_TYPE= D.CN(+) and D.code_data_type(+) = '00412006')
 and (C.FT_FREQ_FEP= E.CN(+) and E.code_data_type(+) = '00202006')
 and (B.Freq_Mod = F.CN(+) and F.code_data_type(+) = '00272006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_AA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_AA" AS 
select
  ----地面固定业务台（站）技术资料申报表
  ----频率数据信息（视图）
  ----中心频率（"0"）
  distinct A.GUID,A.STATION_GUID,A.FT_FREQ_NO,A.FREQ_TYPE,A.FREQ_TYPE_NAME,A.FREQ_MOD,
A.Code_CHI_Name,A.Code_CHI_Name_A,A.Code_CHI_Name_B,A.FT_FREQ_UNIT_TYPE,A.FREQ_LC,A.FREQ_UC,
A.FREQ_EFB,A.FREQ_EFE,A.FREQ_RFB,A.FREQ_RFE,A.FREQ_E_BAND,A.FREQ_E_BAND_Unit,A.FREQ_R_BAND,
A.FREQ_R_BAND_UNIT,A.FT_FREQ_FEP,A.Ft_Freq_Type,
B.CODE_CHI_NAME as UNIT_TYPE_NAME,
  C.CODE_CHI_NAME as BAND_UNIT_NAME
from  V_RIM_RSM_RSBT_FREQ_A A,RSBT_CODE_DIC B,RSBT_CODE_DIC C
    where A.FREQ_TYPE='0' and
    (A.FT_FREQ_UNIT_TYPE= B.CN(+) and B.code_data_type(+) = '00292006') and
    (A.FREQ_E_BAND_Unit= C.CN(+) and C.code_data_type(+) = '01272006')
    order by A.FT_FREQ_NO ASC;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_AA_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_AA_R" AS 
select
  ----地面固定业务台（站）技术资料申报表
  ----频率数据信息（视图）
  ----中心频率（"0"）
  distinct A.GUID,A.STATION_GUID,A.FT_FREQ_NO,A.FREQ_TYPE,A.FREQ_TYPE_NAME,A.FREQ_MOD,
A.Code_CHI_Name,A.Code_CHI_Name_A,A.Code_CHI_Name_B,A.FT_FREQ_UNIT_TYPE,A.FREQ_LC,A.FREQ_UC,
A.FREQ_EFB,A.FREQ_EFE,A.FREQ_RFB,A.FREQ_RFE,A.FREQ_E_BAND,A.FREQ_E_BAND_Unit,A.FREQ_R_BAND,
A.FREQ_R_BAND_UNIT,A.FT_FREQ_FEP,A.Ft_Freq_Type,
B.CODE_CHI_NAME as UNIT_TYPE_NAME,
  C.CODE_CHI_NAME as BAND_UNIT_NAME
from  V_RIM_RSM_RSBT_FREQ_A_r A,RSBT_CODE_DIC B,RSBT_CODE_DIC C
    where A.FREQ_TYPE='0' and
    (A.FT_FREQ_UNIT_TYPE= B.CN(+) and B.code_data_type(+) = '00292006') and
    (A.FREQ_E_BAND_Unit= C.CN(+) and C.code_data_type(+) = '01272006')
    order by A.FT_FREQ_NO ASC;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_BB
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_BB" AS 
select
  ----地面固定业务台（站）技术资料申报表
  ----频率数据信息（视图）
  ----频段（"1"）
  distinct A.GUID,A.STATION_GUID,A.FT_FREQ_NO,A.FREQ_TYPE,A.FREQ_TYPE_NAME,A.FREQ_MOD,
A.Code_CHI_Name,A.Code_CHI_Name_A,A.Code_CHI_Name_B,A.FT_FREQ_UNIT_TYPE,A.FREQ_LC,A.FREQ_UC,
A.FREQ_EFB,A.FREQ_EFE,A.FREQ_RFB,A.FREQ_RFE,A.FREQ_E_BAND,A.FREQ_E_BAND_Unit,A.FREQ_R_BAND,
A.FREQ_R_BAND_UNIT,A.FT_FREQ_FEP,A.Ft_Freq_Type,
  B.CODE_CHI_NAME as UNIT_TYPE_NAME,
  C.CODE_CHI_NAME as BAND_UNIT_NAME
    from  V_RIM_RSM_RSBT_FREQ_A A,RSBT_CODE_DIC B,RSBT_CODE_DIC C
    where A.FREQ_TYPE='1' and
    (A.FT_FREQ_UNIT_TYPE= B.CN(+) and B.code_data_type(+) = '00292006')
    --and B.CODE_USE_RANGE like '%TF/%'
    and(A.FREQ_E_BAND_Unit= C.CN(+) and C.code_data_type(+) = '01272006'
    and C.CODE_USE_RANGE like '%TF/%')
    order by A.FT_FREQ_NO ASC;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_BB_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_BB_R" AS 
select
  ----地面固定业务台（站）技术资料申报表
  ----频率数据信息（视图）
  ----频段（"1"）
  distinct A.GUID,A.STATION_GUID,A.FT_FREQ_NO,A.FREQ_TYPE,A.FREQ_TYPE_NAME,A.FREQ_MOD,
A.Code_CHI_Name,A.Code_CHI_Name_A,A.Code_CHI_Name_B,A.FT_FREQ_UNIT_TYPE,A.FREQ_LC,A.FREQ_UC,
A.FREQ_EFB,A.FREQ_EFE,A.FREQ_RFB,A.FREQ_RFE,A.FREQ_E_BAND,A.FREQ_E_BAND_Unit,A.FREQ_R_BAND,
A.FREQ_R_BAND_UNIT,A.FT_FREQ_FEP,A.Ft_Freq_Type,
  B.CODE_CHI_NAME as UNIT_TYPE_NAME,
  C.CODE_CHI_NAME as BAND_UNIT_NAME
    from  V_RIM_RSM_RSBT_FREQ_A_r A,RSBT_CODE_DIC B,RSBT_CODE_DIC C
    where A.FREQ_TYPE='1' and
    (A.FT_FREQ_UNIT_TYPE= B.CN(+) and B.code_data_type(+) = '00292006')
    --and B.CODE_USE_RANGE like '%TF/%'
    and(A.FREQ_E_BAND_Unit= C.CN(+) and C.code_data_type(+) = '01272006'
    and C.CODE_USE_RANGE like '%TF/%')
    order by A.FT_FREQ_NO ASC;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_D_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_D_RPT" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
  f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
  f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
    ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
    ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,c.st_tf_code station_code_a,c.stat_code_b station_code_b,e.code_chi_name ft_freq_fep_name
from rsbt_freq a,rsbt_freq_t b,v_rim_rsm_link_eaf c,rsbt_station d,rsbt_code_dic e
where a.guid=b.guid(+) and a.guid = c.freq_guid(+) and a.station_guid=d.guid and (b.ft_freq_fep=e.cn(+) and e.code_data_type(+)='00202006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_D_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_D_RPT_R" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
  f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
  f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
    ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
    ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,e.code_chi_name ft_freq_fep_name
from rsbt_freq_r a,rsbt_freq_t_r b,rsbt_station_r d,rsbt_code_dic e
where a.guid=b.guid(+)  and a.station_guid=d.guid and (b.ft_freq_fep=e.cn(+) and e.code_data_type(+)='00202006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_E_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_E_RPT" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
  f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
  f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
    ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
    ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, '1') FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,c.code_chi_name freq_mod_name
from rsbt_freq a,rsbt_freq_t b,rsbt_station d,rsbt_code_dic c
where a.guid=b.guid(+) and a.station_guid=d.guid and (a.freq_mod = c.cn(+) and c.code_data_type(+)='00272006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_E_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_E_RPT_R" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
  f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
  f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
    ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
    ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, '1') FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,c.code_chi_name freq_mod_name
from rsbt_freq_r a,rsbt_freq_t_r b,rsbt_station d,rsbt_code_dic c
where a.guid=b.guid(+) and a.station_guid=d.guid and (a.freq_mod = c.cn(+) and c.code_data_type(+)='00272006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_H_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_H_RPT" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
  f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
  f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
    ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
    ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,c.st_tf_code station_code_a,c.stat_code_b station_code_b,e.code_chi_name ft_freq_info_type_name,f.code_chi_name freq_mod_name
from rsbt_freq a,rsbt_freq_t b,v_RIM_RSM_link_eaf c,rsbt_station d,rsbt_code_dic e,rsbt_code_dic f
where a.guid=b.guid(+) and a.guid = c.freq_guid(+) and a.station_guid=d.guid and (b.ft_freq_info_type=e.cn(+) and e.code_data_type(+)='00182006') and (a.freq_mod=f.cn(+) and f.code_data_type(+)='00272006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_H_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_H_RPT_R" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
  f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
  f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
    ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
    ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,e.code_chi_name ft_freq_info_type_name,f.code_chi_name freq_mod_name
from rsbt_freq_r a,rsbt_freq_t_r b,rsbt_station_r d,rsbt_code_dic e,rsbt_code_dic f
where a.guid=b.guid(+)  and a.station_guid=d.guid and (b.ft_freq_info_type=e.cn(+) and e.code_data_type(+)='00182006') and (a.freq_mod=f.cn(+) and f.code_data_type(+)='00272006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_LM_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_LM_RPT" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
  f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
  f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
    ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
    ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,c.code_chi_name freq_mod_name
from rsbt_freq a,rsbt_freq_t b,rsbt_station d,rsbt_code_dic c
where a.guid=b.guid(+)
and a.station_guid=d.guid and
(a.freq_mod = c.cn(+) and c.code_data_type(+)='00272006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_LM_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_LM_RPT_R" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
  f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
  f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
    ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
    ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,c.code_chi_name freq_mod_name
from rsbt_freq_r a,rsbt_freq_t_r b,rsbt_station_r d,rsbt_code_dic c
where a.guid=b.guid(+)
and a.station_guid=d.guid and
(a.freq_mod = c.cn(+) and c.code_data_type(+)='00272006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_R" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) FT_FREQ_UNIT_TYPE,
  f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_UC,
  f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) FREQ_LC,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB ,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_EFE,
    decode(FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
    decode(freq_type,'1',f_rim_rsm_GETFREQ_R(FREQ_RFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
    ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
    ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,c.st_tf_code station_code_a,'' station_code_b
from rsbt_freq_r a,rsbt_freq_t_r b,rsbt_station_t_r c,rsbt_station_r d
where a.guid=b.guid(+) and c.guid = d.guid and a.station_guid=d.guid;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_R_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_R_RPT" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  b.FT_FREQ_UNIT_TYPE,
  FREQ_LC ,
  FREQ_UC ,
    decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) FREQ_EFB ,
    decode(freq_type,'1', FREQ_EFE,null) FREQ_EFE,
    decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) FREQ_RFB,
    decode(freq_type,'1', FREQ_RFE,null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,FREQ_E_BAND
    ,FREQ_R_BAND
    --必要带宽单位
    ,'' FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,e.code_chi_name freq_mod_name
from rsbt_freq a,rsbt_freq_t b,rsbt_station d,rsbt_code_dic e
where a.guid=b.guid(+)  and a.station_guid=d.guid and (a.freq_mod=e.cn(+) and e.code_data_type(+)='01012006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_R_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_R_RPT_R" AS 
select a.GUID,a.STATION_GUID,FREQ_TYPE,
  b.FT_FREQ_UNIT_TYPE,
  FREQ_LC ,
  FREQ_UC ,
    decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) FREQ_EFB ,
    decode(freq_type,'1', FREQ_EFE,null) FREQ_EFE,
    decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) FREQ_RFB,
    decode(freq_type,'1', FREQ_RFE,null) FREQ_RFE,
    FREQ_MOD,FREQ_MB,FREQ_CODE,
    FT_FREQ_NO,FT_FREQ_TIMEB,FT_FREQ_TIMEE,FT_FREQ_INFO_TYPE,FT_FREQ_HCL,FT_FREQ_TYPE,FT_FREQ_MC,
    FT_FREQ_MC1,FT_FREQ_MC2,FT_FREQ_MC3,FT_FREQ_CCODE,FT_FREQ_CSGN,FT_FREQ_DUPDN
    ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
    ,FREQ_E_BAND
    ,FREQ_R_BAND
    --必要带宽单位
    ,'' FT_FREQ_Band_Unit_Type
   --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit  ,
    d.app_code,d.stat_app_type||d.stat_tdi tech_id,d.net_guid,e.code_chi_name freq_mod_name
from rsbt_freq_r a,rsbt_freq_t_r b,rsbt_station_r d,rsbt_code_dic e
where a.guid=b.guid(+)  and a.station_guid=d.guid and (a.freq_mod=e.cn(+) and e.code_data_type(+)='01012006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_TECHC_AA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_TECHC_AA" AS 
select
  ----蜂窝无线电通信基站技术资料申请表
  ----扇区数据的---中心频率"0"
  A.GUID,A.STATION_GUID,A.FREQ_TYPE,A.FT_FREQ_UNIT_TYPE,A.FREQ_LC,A.FREQ_UC,A.FT_FREQ_CCODE
  from v_rim_rsm_Rsbt_Freq A
  where A.FREQ_TYPE='0';

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_TECHC_AA_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_TECHC_AA_R" AS 
select
  ----蜂窝无线电通信基站技术资料申请表
  ----扇区数据的---中心频率"0"
  A.GUID,A.STATION_GUID,A.FREQ_TYPE,A.FT_FREQ_UNIT_TYPE,A.FREQ_LC,A.FREQ_UC,A.FT_FREQ_CCODE
  from v_rim_rsm_Rsbt_Freq_r A
  where A.FREQ_TYPE='0';

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_TECHC_BB
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_TECHC_BB" AS 
select
  ----蜂窝无线电通信基站技术资料申请表
  ----扇区数据的-----发射、接收频率（范围）"1"
  A.GUID,A.STATION_GUID,A.FREQ_TYPE,A.FT_FREQ_UNIT_TYPE,A.FT_FREQ_CCODE,
  A.FREQ_EFB,A.FREQ_EFE,A.FREQ_RFB,A.FREQ_RFE
  from v_rim_rsm_Rsbt_Freq A
  where A.FREQ_TYPE='1';

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_FREQ_TECHC_BB_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_FREQ_TECHC_BB_R" AS 
select
  ----蜂窝无线电通信基站技术资料申请表
  ----扇区数据的-----发射、接收频率（范围）"1"
  A.GUID,A.STATION_GUID,A.FREQ_TYPE,A.FT_FREQ_UNIT_TYPE,A.FT_FREQ_CCODE,
  A.FREQ_EFB,A.FREQ_EFE,A.FREQ_RFB,A.FREQ_RFE
  from v_rim_rsm_Rsbt_Freq_r A
  where A.FREQ_TYPE='1';

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_NET
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_NET" AS 
SELECT
t1."GUID",t1."ORG_GUID",t1."FEE_GUID",t1."ORG_CODE",t1."NET_NAME",t1."NET_SVN",t1."NET_SP",t1."NET_TS",t1."NET_BAND",t1."NET_AREA",t1."NET_USE",t1."NET_SAT_NAME",t1."NET_LG",t1."NET_START_DATE",t1."NET_CONFIRM_DATE",t1."NET_EXPIRED_DATE",
t2.ORG_NAME apply_org_name,
t2.org_code apply_org_code,
t2.ORG_SYS_Code apply_ORG_SYS_Code,
t2.ORG_LINK_PERSON apply_ORG_LINK_PERSON,
t2.ORG_PHONE apply_ORG_PHONE,
t2.ORG_Bank apply_ORG_Bank,
t2.ORG_Account_Name apply_ORG_Account_Name,
t2.ORG_Account apply_ORG_Account,

t3.ORG_NAME fee_name,
t3.org_code fee_org_code,
t3.ORG_SYS_Code fee_ORG_sys_code,
t3.ORG_LINK_PERSON fee_ORG_LINK_PERSON,
t3.ORG_PHONE fee_ORG_PHONE,
t3.ORG_Bank fee_ORG_Bank,
t3.ORG_Account_Name fee_ORG_Account_Name,
t3.ORG_Account fee_ORG_Account,

t4.code_chi_name netsvn,
t5.code_chi_name netsp,
t6.code_chi_name netts,
t7.code_chi_name netarea
FROM
RSBT_NET t1,
RSBT_ORG t2,
RSBT_ORG t3,
rsbt_code_dic t4,
rsbt_code_dic t5,
rsbt_code_dic t6,
rsbt_code_dic t7
where

t1.org_guid = t2.guid(+)and t1.fee_guid = t3.guid(+)
and (t1.net_svn = t4.cn(+) and t4.code_data_type (+)= '00452006')
and (t1.net_sp = t5.cn(+) and t5.code_data_type (+)= '00002006')
and (t1.net_ts = t6.cn(+) and t6.code_data_type(+) = '00012006')
and (t1.net_area = t7.cn(+) and t7.code_data_type(+)= '00022006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_NET_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_NET_R" AS 
select b.ORG_sys_code as fee_ORG_sys_code, c.ORG_sys_code as ORG_sys_code, A.net_band,A.net_start_date,A.org_code,A.net_area,A.net_sat_name,A.guid,A.net_name,c.org_type,
A.net_svn,A.net_ts,A.net_expired_date,A.net_use,A.net_sp,A.net_lg,A.org_guid,
c.org_addr AS set_org_addr,
c.org_link_person AS set_org_link_person,
c.org_phone AS set_org_phone,
c.org_mob_phone AS set_org_mob_phone,
c.org_post AS set_org_post,
A.net_confirm_date,A.fee_guid ,b.org_name fee_org_name,c.org_name as set_org_name,d.code_chi_name net_svn_name,
e.code_chi_name as net_sp_name,f.code_chi_name as net_ts_name,g.code_chi_name as net_area_name,A.org_code org_area_code
from rsbt_net_r A,RSBT_ORG b ,RSBT_ORG c ,RSBT_CODE_DIC d,RSBT_CODE_DIC e ,RSBT_CODE_DIC f,RSBT_CODE_DIC g
where a.fee_guid = b.guid(+)  and a.org_guid = c.guid(+)
and (a.net_svn = d.cn(+) and d.code_data_type(+) = '00452006')
and (a.net_sp = e.cn(+) and e.code_data_type(+) = '00002006')
and (a.net_ts=f.cn(+) and f.code_data_type(+) = '00012006')
and (a.net_area = g.cn(+) and g.code_data_type(+) = '00022006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STAT_LM_N_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STAT_LM_N_RPT" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,decode(ST_LMMTR,'1','1','0') ST_LMMTR ,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name stat_type_name,d.code_chi_name stat_work_name,e.code_chi_name st_status,f.code_chi_name st_lmmtr_name
from rsbt_station a,rsbt_station_t b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e,rsbt_code_dic f
where a.guid=b.guid(+) and (a.stat_type=c.cn(+) and c.code_data_type(+)='00052006') and (a.stat_work=d.cn(+) and d.code_data_type(+)='00062006')
and (a.stat_status=e.cn(+) and e.code_data_type(+)='00072006')
and (b.st_lmmtr=f.cn(+) and f.code_data_type(+)='00392006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STAT_LM_N_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STAT_LM_N_RPT_R" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,decode(ST_LMMTR,'1','1','0') ST_LMMTR ,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name stat_type_name,d.code_chi_name stat_work_name,e.code_chi_name st_status,f.code_chi_name st_lmmtr_name
from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e,rsbt_code_dic f
where a.guid=b.guid(+) and (a.stat_type=c.cn(+) and c.code_data_type(+)='00052006') and (a.stat_work=d.cn(+) and d.code_data_type(+)='00062006')
and (a.stat_status=e.cn(+) and e.code_data_type(+)='00072006')
and (b.st_lmmtr=f.cn(+) and f.code_data_type(+)='00392006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STAT_LM_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STAT_LM_RPT" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,decode(ST_LMMTR,'1','1','0') ST_LMMTR ,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name stat_type_name,d.code_chi_name stat_work_name,e.code_chi_name st_status
from rsbt_station a,rsbt_station_t b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e
where a.guid=b.guid(+) and (a.stat_type=c.cn(+) and c.code_data_type(+)='00052006') and (a.stat_work=d.cn(+) and d.code_data_type(+)='00062006')
and (a.stat_status=e.cn(+) and e.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STAT_LM_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STAT_LM_RPT_R" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,decode(ST_LMMTR,'1','1','0') ST_LMMTR ,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name stat_type_name,d.code_chi_name stat_work_name,e.code_chi_name st_status
from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e
where a.guid=b.guid(+) and (a.stat_type=c.cn(+) and c.code_data_type(+)='00052006') and (a.stat_work=d.cn(+) and d.code_data_type(+)='00062006')
and (a.stat_status=e.cn(+) and e.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STAT_REPORT_ME
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STAT_REPORT_ME" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,
    c.code_chi_name st_pos_type_name,
    f.code_chi_name multi_addr_name,
    g.code_chi_name st_me_stype_name,
    h.code_chi_name st_work,
    i.code_chi_name ant_type_name,
    j.code_chi_name rpole_name,
    k.code_chi_name epole_name,
    d.EQU_Model,d.EQU_AUTH,d.EQU_MENU,dd.ET_EQU_Type,     --设备
    e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_EGain,e.ANT_RGain,e.ANT_RPOLE,e.ANT_EPOLE,AT_QUA --天线
from rsbt_station a,rsbt_station_t b,rsbt_code_dic c,rsbt_code_dic f,rsbt_code_dic g,rsbt_code_dic h,rsbt_code_dic i,rsbt_code_dic j,rsbt_code_dic k,
     RSBT_EQU d,RSBT_EQU_T dd,
     RSBT_ANTFEED e,RSBT_ANTFEED_T ee
--(select Station_GUID as Station_GUID_d,EQU_Model,EQU_AUTH,EQU_MENU,ET_EQU_Type from  RSBT_EQU a,RSBT_EQU_T b where a.guid=b.guid(+)) d, --设备
--(select Station_GUID as Station_GUID_e,ANT_Type,ANT_Model,ANT_MENU,ANT_EGain,ANT_RGain,ANT_RPOLE,ANT_EPOLE,AT_QUA from  RSBT_ANTFEED a,RSBT_ANTFEED_T b where a.guid=b.guid(+)) e --天线
where a.stat_app_type='ME' and a.guid=b.guid(+) and (b.st_pos_type=c.cn(+) and c.code_data_type(+)='00352006')
and (b.st_e_multi_addr=f.cn(+) and f.code_data_type(+)='00122006')
and a.guid=d.station_guid(+) and d.guid=dd.guid(+)
and a.guid=e.station_guid(+) and e.guid=ee.guid(+)
and (b.st_me_stype=g.cn(+) and g.code_data_type(+)='00432006')
and (a.stat_work=h.cn(+) and h.code_data_type(+)='00382006')
and (e.ant_type=i.cn(+) and i.code_data_type(+)='00172006')
and (e.ant_rpole=j.cn(+) and j.code_data_type(+)='00202006')
and (e.ant_epole=k.cn(+) and k.code_data_type(+)='00202006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STAT_REPORT_MER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STAT_REPORT_MER" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,
    c.code_chi_name st_pos_type_name,
    f.code_chi_name multi_addr_name,
    g.code_chi_name st_me_stype_name,
    h.code_chi_name st_work,
    i.code_chi_name ant_type_name,
    j.code_chi_name rpole_name,
    k.code_chi_name epole_name,
    d.EQU_Model,d.EQU_AUTH,d.EQU_MENU,dd.ET_EQU_Type,     --设备
    e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_EGain,e.ANT_RGain,e.ANT_RPOLE,e.ANT_EPOLE,AT_QUA --天线
from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c,rsbt_code_dic f,rsbt_code_dic g,rsbt_code_dic h,rsbt_code_dic i,rsbt_code_dic j,rsbt_code_dic k,
     RSBT_EQU_r d,RSBT_EQU_T_r dd,
     RSBT_ANTFEED_r e,RSBT_ANTFEED_T_r ee
--(select Station_GUID as Station_GUID_d,EQU_Model,EQU_AUTH,EQU_MENU,ET_EQU_Type from  RSBT_EQU a,RSBT_EQU_T b where a.guid=b.guid(+)) d, --设备
--(select Station_GUID as Station_GUID_e,ANT_Type,ANT_Model,ANT_MENU,ANT_EGain,ANT_RGain,ANT_RPOLE,ANT_EPOLE,AT_QUA from  RSBT_ANTFEED a,RSBT_ANTFEED_T b where a.guid=b.guid(+)) e --天线
where a.stat_app_type='ME' and a.guid=b.guid(+) and (b.st_pos_type=c.cn(+) and c.code_data_type(+)='00352006')
and (b.st_e_multi_addr=f.cn(+) and f.code_data_type(+)='00122006')
and a.guid=d.station_guid(+) and d.guid=dd.guid(+)
and a.guid=e.station_guid(+) and e.guid=ee.guid(+)
and (b.st_me_stype=g.cn(+) and g.code_data_type(+)='00432006')
and (a.stat_work=h.cn(+) and h.code_data_type(+)='00382006')
and (e.ant_type=i.cn(+) and i.code_data_type(+)='00172006')
and (e.ant_rpole=j.cn(+) and j.code_data_type(+)='00202006')
and (e.ant_epole=k.cn(+) and k.code_data_type(+)='00202006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STAT_REPORT_S
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STAT_REPORT_S" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name,d.code_chi_name st_status
from rsbt_station a,rsbt_station_t b,rsbt_code_dic c,rsbt_code_dic d
where a.guid=b.guid(+) and (b.st_ship_type=c.cn(+) and c.code_data_type(+)='00152006') and (a.stat_status=d.cn(+) and d.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STAT_REPORT_S_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STAT_REPORT_S_R" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name,d.code_chi_name st_status
from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c,rsbt_code_dic d
where a.guid=b.guid(+) and (b.st_ship_type=c.cn(+) and c.code_data_type(+)='00152006') and (a.stat_status=d.cn(+) and d.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STAT_S_ROTHER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STAT_S_ROTHER" AS 
select a.APP_CODE,a.STAT_APP_Type,a.stat_tdi,
T0.equ_model,f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) equ_pow,T0.equ_pf,T0.equ_mb,T0.equ_type,T0.equ_auth,T0.station_guid,
  T0.equ_menu,T0.guid,t2.guid freq_guid,T0.equ_code,T1.et_equ_pwid2,T1.et_equ_pup,
  T1.et_equ_senerr,T1.et_pow_u,T1.et_equ_pr,T1.et_equ_type_id,T1.et_equ_upu,
  T1.et_equ_cl,T1.et_equ_fntval,T1.et_equ_pf,T1.et_equ_no,T1.et_equ_code,T1.et_equ_tl,
  T1.et_equ_epos,T1.et_equ_apos,T1.et_equ_chrip,T1.et_equ_rnq,T1.et_equ_name,T1.et_equ_use,
  T1.et_equ_ccode,T1.et_eirp,T1.et_equ_rwid,T1.et_equ_esgn,T1.et_equ_atype,T1.et_equ_pow_avg,
  T1.et_equ_pow_max,T1.et_equ_dnu,T1.et_af_type,T1.et_equ_type,T1.et_equ_senu,T1.et_equ_sen,
  T1.et_equ_mt,T1.et_equ_sum,T1.et_equ_pdn,T1.et_equ_euse,T1.et_equ_pwid1,T1.ET_EQU_RF,
  T1.ET_EQU_RF_BAND,T2.freq_mod,
  T2.freq_type, T2.freq_mb,T2.freq_code,  --频率数据处理
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) ft_freq_unit_type,
  f_rim_rsm_GETFREQ_R(freq_uc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_uc,
  f_rim_rsm_GETFREQ_R(freq_lc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_lc,
  decode(t2.FREQ_TYPE,'0',f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_efe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_efe,
  decode(t2.FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ,'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_rfe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_rfe,
  T3.ft_freq_type,T3.ft_freq_csgn,T3.ft_freq_mc1,
  T3.ft_freq_timee,T3.ft_freq_dupdn,T3.ft_freq_no,T3.ft_freq_hcl,T3.ft_freq_mc,T3.ft_freq_timeb,
  T3.ft_freq_mc2,T3.ft_freq_mc3,T3.ft_freq_info_type,T3.ft_freq_ccode
  ,t1.ET_EQU_UPOW,t1.ET_EQU_DPOW
  ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
  ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
  ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
  ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
      --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit
from v_rim_rsm_rsbt_stat_report_s a ,RSBT_EQU T0,RSBT_EQU_T T1,RSBT_freq T2,RSBT_freq_T T3
where a.GUID = T0.station_guid(+) and et_equ_type_id = '1' and
      t0.guid =t2.guid(+) and T0.guid  = T1.Guid(+)
      and t2.guid  = t3.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STAT_S_ROTHER_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STAT_S_ROTHER_R" AS 
select a.APP_CODE,a.STAT_APP_Type,a.stat_tdi,
T0.equ_model,f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) equ_pow,T0.equ_pf,T0.equ_mb,T0.equ_type,T0.equ_auth,T0.station_guid,
  T0.equ_menu,T0.guid,t2.guid freq_guid,T0.equ_code,T1.et_equ_pwid2,T1.et_equ_pup,
  T1.et_equ_senerr,T1.et_pow_u,T1.et_equ_pr,T1.et_equ_type_id,T1.et_equ_upu,
  T1.et_equ_cl,T1.et_equ_fntval,T1.et_equ_pf,T1.et_equ_no,T1.et_equ_code,T1.et_equ_tl,
  T1.et_equ_epos,T1.et_equ_apos,T1.et_equ_chrip,T1.et_equ_rnq,T1.et_equ_name,T1.et_equ_use,
  T1.et_equ_ccode,T1.et_eirp,T1.et_equ_rwid,T1.et_equ_esgn,T1.et_equ_atype,T1.et_equ_pow_avg,
  T1.et_equ_pow_max,T1.et_equ_dnu,T1.et_af_type,T1.et_equ_type,T1.et_equ_senu,T1.et_equ_sen,
  T1.et_equ_mt,T1.et_equ_sum,T1.et_equ_pdn,T1.et_equ_euse,T1.et_equ_pwid1,T1.ET_EQU_RF,
  T1.ET_EQU_RF_BAND,T2.freq_mod,
  T2.freq_type, T2.freq_mb,T2.freq_code,  --频率数据处理
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) ft_freq_unit_type,
  f_rim_rsm_GETFREQ_R(freq_uc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_uc,
  f_rim_rsm_GETFREQ_R(freq_lc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_lc,
  decode(t2.FREQ_TYPE,'0',f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_efe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_efe,
  decode(t2.FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ,'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_rfe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_rfe,
  T3.ft_freq_type,T3.ft_freq_csgn,T3.ft_freq_mc1,
  T3.ft_freq_timee,T3.ft_freq_dupdn,T3.ft_freq_no,T3.ft_freq_hcl,T3.ft_freq_mc,T3.ft_freq_timeb,
  T3.ft_freq_mc2,T3.ft_freq_mc3,T3.ft_freq_info_type,T3.ft_freq_ccode
  ,t1.ET_EQU_UPOW,t1.ET_EQU_DPOW
  ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
  ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
  ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
  ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
      --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit
from v_rim_rsm_rsbt_stat_report_s_r a ,RSBT_EQU_r T0,RSBT_EQU_T_r T1,RSBT_freq_r T2,RSBT_freq_T_r T3
where a.GUID = T0.station_guid(+) and et_equ_type_id = '1' and
      t0.guid =t2.guid(+) and T0.guid  = T1.Guid(+)
      and t2.guid  = t3.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION" AS 
select a."GUID",a."NET_GUID",a."ORG_CODE",a."APP_CODE",a."STAT_APP_TYPE",a."STAT_TDI",a."STAT_NAME",a."STAT_ADDR",a."STAT_AREA_CODE",a."STAT_TYPE",a."STAT_WORK",a."STAT_STATUS",a."STAT_EQU_SUM",a."STAT_LG",a."STAT_LA",a."STAT_AT",a."STAT_DATE_START",a."MEMO",
   f.st_r_emin,f.st_e_pos,f.st_me_sta2,f.st_lmmtr,f.st_a_st,f.st_me_name1,f.st_tf_trans_ca_p,f.st_b_ic,
   f.st_e_com_area,f.st_me_lg2,f.st_me_lg1,f.st_s_cs,f.st_d_type,f.st_s_mmsi,f.st_b_type2,f.st_pos_type,f.st_b_type1,
   f.st_me_fband,f.st_time_e,f.st_c_sum,f.st_a_nrm,f.st_e_sat,f.st_s_t,f.st_a_call_oi,f.st_r_wamin,
   f.st_s_p,f.st_a_call,f.st_me_file_no,f.st_a_piloting,f.st_call_sign,f.st_a_model,f.st_r_emax,
   f.st_b_edu,f.st_s_pn,f.st_me_sta3,f.st_me_sta1,f.st_a_type,f.st_e_net_code,f.st_time_b,f.st_e_multi_addr,
   f.st_e_lg,f.st_ship_name,f.st_tf_code,f.st_b_sgn,f.ST_B_Level,f.st_b_bm,f.st_ship_type,
   f.st_me_sat_name,f.st_c_code,f.st_serv_r,f.st_d_tec_type,f.st_b_cover_area,
   f.st_s_aaic,f.st_user_area,f.st_me_stype,f.st_tf_trans_ca_pu,
   f.st_r_wamax,f.st_a_sgn,f.st_me_name2,
   --h
   to_char(st_time_b,'hh24:mi') st_time_bDes ,to_char(st_time_e,'hh24:mi') st_time_eDes,
   to_char(st_time_b,'hh24') st_time_bDes1 , to_char(st_time_b,'mi') st_time_bDes2 ,
   to_char(st_time_e,'hh24') st_time_eDes1,   to_char(st_time_e,'mi') st_time_eDes2,
   '' obj_type , '' OBJ_NAME,'' OBJ_TDI1,'' OBJ_TDI2,'' OBJ_TDI3,'' OBJ_TDI4,'' OBJ_TDI5,'' OBJ_TDI6,'' OBJ_TDI7,'' OBJ_TDI8,
   --
  decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE0,
  decode(length(app_code) ,14,substr(app_code,3),  substr(app_code,2)) tapp_code,
  '1' opttype,
  --lm
  '1' FREQ_TYPE,
  to_char(stat_date_start,'yyyy-MM-dd') as stat_date_startDes,
  --
  e.code_chi_name stat_work_Name,e.import_code stat_work_code0,
  stat_work_e.code_chi_name stat_work_e_Name,stat_work_e.import_code stat_work_e_code0,
  g.code_chi_name stat_statusDes ,g.import_code stat_status_code0,
  d.code_chi_name stat_typeDes, d.import_code stat_type_code0,
  LMMTR.CODE_CHI_NAME ST_LMMTR_Name,LMMTR.Import_Code ST_LMMTR_code0,
  MULTI_Addr.CODE_CHI_NAME  ST_E_MULTI_Addr_Name,MULTI_Addr.Import_Code ST_E_MULTI_Addr_code0,
  E_COM_Area.CODE_CHI_NAME ST_E_COM_Area_Name,E_COM_Area.Import_Code ST_E_COM_Area_code0,
  POS_Type.CODE_CHI_NAME ST_POS_Type_Name,POS_Type.Import_Code ST_POS_Type_code0,
  B_level.CODE_CHI_NAME ST_B_Level_Name,B_level.Import_Code ST_B_Level_code0,
  ST_B_BM.CODE_CHI_NAME ST_B_BM_Name,ST_B_BM.Import_Code ST_B_BM_code0,
  ST_B_EDU.CODE_CHI_NAME ST_B_EDU_Name,ST_B_EDU.Import_Code ST_B_EDU_code0,
  B_IC.CODE_CHI_NAME ST_B_IC_Name,B_IC.Import_Code ST_B_IC_code0,
  Ship_Type.CODE_CHI_NAME ST_Ship_Type_Name,Ship_Type.Import_Code ST_Ship_Type_code0,
  ST_A_Type.CODE_CHI_NAME ST_A_Type_Name,ST_A_Type.Import_Code ST_A_Type_code0,
  ST_A_Call.CODE_CHI_NAME ST_A_Call_Name,ST_A_Call.Import_Code ST_A_Call_code0,
  ST_A_Piloting.CODE_CHI_NAME ST_A_Piloting_Name,ST_A_Piloting.Import_Code ST_A_Piloting_code0,
  ST_D_TEC_Type.CODE_CHI_NAME  ST_D_TEC_Type_Name,ST_D_TEC_Type.Import_Code ST_D_TEC_Type_code0,
  ST_D_Type.CODE_CHI_NAME   ST_D_Type_Name,ST_D_Type.Import_Code ST_D_Type_code0,
  ST_ME_Stype.CODE_CHI_NAME   ST_ME_Stype_Name,ST_ME_Stype.Import_Code ST_ME_Stype_code0,
  ST_B_TYPE2.CODE_CHI_NAME ST_B_TYPE2_Name,ST_B_TYPE2.Import_Code ST_B_TYPE2_code0,
  ST_B_TYPE1.CODE_CHI_NAME ST_B_TYPE1_Name,ST_B_TYPE1.Import_Code ST_B_TYPE1_code0
from rsbt_station a ,rsbt_station_t f ,RSBT_CODE_DIC d ,RSBT_CODE_DIC e , RSBT_CODE_DIC g,
   RSBT_CODE_DIC LMMTR, RSBT_CODE_DIC MULTI_Addr,RSBT_CODE_DIC E_COM_Area,
   RSBT_CODE_DIC POS_Type, RSBT_CODE_DIC B_level, RSBT_CODE_DIC ST_B_BM,
   RSBT_CODE_DIC ST_B_EDU, RSBT_CODE_DIC B_IC, RSBT_CODE_DIC Ship_Type,
   RSBT_CODE_DIC ST_A_Type , RSBT_CODE_DIC ST_A_Call, RSBT_CODE_DIC ST_A_Piloting,
   RSBT_CODE_DIC ST_D_TEC_Type , RSBT_CODE_DIC ST_D_Type , RSBT_CODE_DIC ST_ME_Stype,
   RSBT_CODE_DIC ST_B_TYPE2 , RSBT_CODE_DIC ST_B_TYPE1 ,RSBT_CODE_DIC stat_work_e
 where   a.guid = f.guid(+)
 and (a.stat_type = d.cn(+) and d.code_data_type(+) = '00052006')
 and (a.stat_work = e.cn(+) and e.code_data_type(+) = '00062006')
 and (a.stat_work = stat_work_e.cn(+) and stat_work_e.code_data_type(+) = '00382006')
 and (a.stat_status = g.cn(+) and g.code_data_type(+) = '00072006')
 and (f.ST_LMMTR = LMMTR.cn(+) and LMMTR.code_data_type(+) = '00392006')
 and (f.ST_E_MULTI_Addr = MULTI_Addr.cn(+) and MULTI_Addr.code_data_type(+) = '00122006')
 and (f.ST_E_COM_Area = E_COM_Area.cn(+) and E_COM_Area.code_data_type(+) = '00362006')
 and (f.ST_POS_Type = POS_Type.cn(+) and POS_Type.code_data_type(+) = '00352006')
 and (f.ST_B_Level = B_level.cn(+) and B_level.code_data_type(+) = '00132006')
 and (f.ST_B_BM = ST_B_BM.cn(+) and ST_B_BM.code_data_type(+) = '00142006')
 and (f.ST_B_EDU = ST_B_EDU.cn(+) and ST_B_EDU.code_data_type(+) = '00392006')
 and (f.ST_B_IC = B_IC.cn(+) and B_IC.code_data_type(+) = '00392006')
 and (f.ST_Ship_Type = Ship_Type.cn(+) and Ship_Type.code_data_type(+) = '00152006')
 and (f.ST_A_Type = ST_A_Type.cn(+) and ST_A_Type.code_data_type(+) = '00162006')
 and (f.ST_A_Call = ST_A_Call.cn(+) and ST_A_Call.code_data_type(+) = '00372006')
 and (f.ST_A_Piloting = ST_A_Piloting.cn(+) and ST_A_Piloting.code_data_type(+) = '00392006')
 and (f.ST_D_TEC_Type = ST_D_TEC_Type.cn(+) and ST_D_TEC_Type.code_data_type(+) = '00012006')
 and (f.ST_D_Type = ST_D_Type.cn(+) and ST_D_Type.code_data_type(+) = '00422006')
 and (f.ST_ME_Stype = ST_ME_Stype.cn(+) and ST_ME_Stype.code_data_type(+) = '00432006')
 and (f.ST_B_TYPE2 = ST_B_TYPE2.cn(+) and ST_B_TYPE2.code_data_type(+) = '00132006')
 and (f.ST_B_TYPE1 = ST_B_TYPE1.cn(+) and ST_B_TYPE1.code_data_type(+) = '00462006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_A_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_A_RPT" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,substr(c.code_chi_name,0,3) st_a_type_name,d.code_chi_name st_status,e.code_chi_name st_pilot
from rsbt_station a,rsbt_station_t b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e
where a.guid=b.guid(+) and (b.st_a_type=c.cn(+) and c.code_data_type(+)='00162006') and (a.stat_status=d.cn(+) and d.code_data_type(+)='00072006') and (b.st_a_piloting=e.cn(+) and e.code_data_type(+)='00392006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_A_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_A_RPT_R" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name st_a_type_name,d.code_chi_name st_status,e.code_chi_name st_pilot
from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e
where a.guid=b.guid(+) and (b.st_a_type=c.cn(+) and c.code_data_type(+)='00162006') and (a.stat_status=d.cn(+) and d.code_data_type(+)='00072006') and (b.st_a_piloting=e.cn(+) and e.code_data_type(+)='00392006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_B_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_B_RPT" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name st_b_type1_name,d.code_chi_name st_b_type2_name,e.code_chi_name st_b_level_name,f.code_chi_name st_b_bm_name,g.code_chi_name st_status,h.code_chi_name st_edu,i.code_chi_name st_ic
from rsbt_station a,rsbt_station_t b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e,rsbt_code_dic f,rsbt_code_dic g,rsbt_code_dic h,rsbt_code_dic i
where a.guid=b.guid(+) and (b.st_b_type1=c.cn(+) and c.code_data_type(+)='00462006') and (b.st_b_type2=d.cn(+) and d.code_data_type(+)='00472006') and (b.st_b_level=e.cn(+) and e.code_data_type(+)='00132006') and (b.st_b_bm=f.cn(+) and f.code_data_type(+)='00142006')
and (a.stat_status=g.cn(+) and g.code_data_type(+)='00072006')
and (b.st_b_edu=h.cn(+) and h.code_data_type(+)='00392006')
and (b.st_b_ic=i.cn(+) and i.code_data_type(+)='00392006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_B_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_B_RPT_R" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name st_b_type1_name,d.code_chi_name st_b_type2_name,e.code_chi_name st_b_level_name,f.code_chi_name st_b_bm_name,g.code_chi_name st_status,h.code_chi_name st_edu,i.code_chi_name st_ic
from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e,rsbt_code_dic f,rsbt_code_dic g,rsbt_code_dic h,rsbt_code_dic i
where a.guid=b.guid(+) and (b.st_b_type1=c.cn(+) and c.code_data_type(+)='00462006') and (b.st_b_type2=d.cn(+) and d.code_data_type(+)='00472006') and (b.st_b_level=e.cn(+) and e.code_data_type(+)='00132006') and (b.st_b_bm=f.cn(+) and f.code_data_type(+)='00142006')
and (a.stat_status=g.cn(+) and g.code_data_type(+)='00072006')
and (b.st_b_edu=h.cn(+) and h.code_data_type(+)='00392006')
and (b.st_b_ic=i.cn(+) and i.code_data_type(+)='00392006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_C_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_C_RPT" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,st_b_type1,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name st_status
from rsbt_station a,rsbt_station_t b,rsbt_code_dic c
where a.guid=b.guid(+) and (a.stat_status=c.cn(+) and c.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_C_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_C_RPT_R" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,st_b_type1,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name st_status
from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c
where a.guid=b.guid(+) and (a.stat_status=c.cn(+) and c.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_D_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_D_RPT" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM, ST_SERV_R,nvl(e.code_chi_name,st_d_tec_type) ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,st_b_type1,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name st_status,d.code_chi_name st_d_type_name,nvl(e.code_chi_name,st_d_tec_type) st_d_tec_type_name
from rsbt_station a,rsbt_station_t b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e
where a.guid=b.guid(+) and (a.stat_status=c.cn(+) and c.code_data_type(+)='00072006') and  (b.st_d_type=d.cn(+) and d.code_data_type(+)='00422006') and  (b.st_d_tec_type=e.cn(+) and e.code_data_type(+)='00012006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_D_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_D_RPT_R" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM, ST_SERV_R,nvl(e.code_chi_name,st_d_tec_type) ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,st_b_type1,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name st_status,d.code_chi_name st_d_type_name,nvl(e.code_chi_name,st_d_tec_type) st_d_tec_type_name
from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e
where a.guid=b.guid(+) and (a.stat_status=c.cn(+) and c.code_data_type(+)='00072006') and  (b.st_d_type=d.cn(+) and d.code_data_type(+)='00422006') and  (b.st_d_tec_type=e.cn(+) and e.code_data_type(+)='00012006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_E_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_E_RPT" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name stat_type_name,d.code_chi_name multi_addr_name,e.code_chi_name stat_work_name,f.code_chi_name st_e_com_area_name,g.code_chi_name st_status
from rsbt_station a,rsbt_station_t b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e,rsbt_code_dic f,rsbt_code_dic g
where a.guid=b.guid(+) and (a.stat_type=c.cn(+) and c.code_data_type(+)='00052006') and (b.st_e_multi_addr=d.cn(+) and d.code_data_type(+)='00122006') and (a.stat_work=e.cn(+) and e.code_data_type(+)='00382006') and (b.st_e_com_area=f.cn(+) and f.code_data_type(+)='00362006')
and (a.stat_status=g.cn(+) and g.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_E_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_E_RPT_R" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name stat_type_name,d.code_chi_name multi_addr_name,e.code_chi_name stat_work_name,f.code_chi_name st_e_com_area_name,g.code_chi_name st_status
from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e,rsbt_code_dic f,rsbt_code_dic g
where a.guid=b.guid(+) and (a.stat_type=c.cn(+) and c.code_data_type(+)='00052006') and (b.st_e_multi_addr=d.cn(+) and d.code_data_type(+)='00122006') and (a.stat_work=e.cn(+) and e.code_data_type(+)='00382006') and (b.st_e_com_area=f.cn(+) and f.code_data_type(+)='00362006')
and (a.stat_status=g.cn(+) and g.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_H_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_H_RPT" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name stat_type_name,d.code_chi_name stat_work_name,e.code_chi_name st_status
from rsbt_station a,rsbt_station_t b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e
where a.guid=b.guid(+) and (a.stat_type=c.cn(+) and c.code_data_type(+)='00052006') and (a.stat_work=d.cn(+) and d.code_data_type(+)='00062006')
and (a.stat_status=e.cn(+) and e.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_H_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_H_RPT_R" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name stat_type_name,d.code_chi_name stat_work_name,e.code_chi_name st_status
from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c,rsbt_code_dic d,rsbt_code_dic e
where a.guid=b.guid(+) and (a.stat_type=c.cn(+) and c.code_data_type(+)='00052006') and (a.stat_work=d.cn(+) and d.code_data_type(+)='00062006')
and (a.stat_status=e.cn(+) and e.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_R_RPT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_R_RPT" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name,d.code_chi_name st_status
from rsbt_station a,rsbt_station_t b,rsbt_code_dic c,rsbt_code_dic d
where a.guid=b.guid(+) and (a.stat_type=c.cn(+) and c.code_data_type(+)='00052006') and (a.stat_status=d.cn(+) and d.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_R_RPT_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_R_RPT_R" AS 
select a.GUID,NET_GUID,ORG_CODE,APP_CODE,STAT_APP_Type,STAT_TDI,STAT_NAME,STAT_ADDR,decode(a.STAT_AREA_CODE,null,decode(substr(app_code,2,1),'9','000000',substr(app_code,2,4)||'00'),a.STAT_AREA_CODE) STAT_AREA_CODE,
    STAT_TYPE,STAT_WORK,STAT_STATUS,STAT_EQU_SUM,STAT_LG,STAT_LA,STAT_AT,STAT_DATE_START,MEMO,
    ST_TIME_B,ST_TIME_E,ST_LMMTR,ST_USER_AREA,ST_TF_TRANS_CA_PU,ST_TF_TRANS_CA_P,ST_E_NET_CODE,
    ST_E_MULTI_ADDR,ST_E_COM_AREA,ST_POS_TYPE,ST_E_POS,ST_E_SAT,ST_E_LG,ST_B_SGN,ST_B_Level,ST_B_BM,
    ST_B_EDU,ST_B_IC,ST_B_COVER_AREA,ST_SHIP_TYPE,ST_CALL_SIGN,ST_S_MMSI,ST_S_CS,ST_SHIP_NAME,ST_S_PN,
    ST_S_AAIC,ST_S_T,ST_S_P,ST_A_MODEL,ST_A_TYPE,ST_A_CALL,ST_A_CALL_OI,ST_A_SGN,ST_A_ST,ST_A_PILOTING,
    ST_A_NRM,ST_R_WAMIN,ST_R_WAMAX,ST_R_EMIN,ST_R_EMAX,ST_C_CODE,ST_C_SUM,ST_SERV_R,ST_D_TEC_TYPE,
    ST_D_TYPE,ST_ME_SAT_NAME,ST_ME_STA1,ST_ME_STA2,ST_ME_STA3,ST_ME_STYPE,ST_ME_NAME1,
    ST_ME_NAME2,ST_ME_LG1,ST_ME_LG2,ST_ME_FBAND ,ST_B_TYPE2,ST_ME_FILE_NO,ST_TF_CODE,c.code_chi_name,d.code_chi_name st_status
from rsbt_station_r a,rsbt_station_t_r b,rsbt_code_dic c,rsbt_code_dic d
where a.guid=b.guid(+) and (a.stat_type=c.cn(+) and c.code_data_type(+)='00052006') and (a.stat_status=d.cn(+) and d.code_data_type(+)='00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_S_RO
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_S_RO" AS 
select a.APP_CODE,a.STAT_APP_Type,a.stat_tdi,
T0.equ_model,f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) equ_pow,T0.equ_pf,T0.equ_mb,T0.equ_type,T0.equ_auth,T0.station_guid,
  T0.equ_menu,T0.guid,t2.guid freq_guid,T0.equ_code,T1.et_equ_pwid2,T1.et_equ_pup,
  T1.et_equ_senerr,T1.et_pow_u,T1.et_equ_pr,T1.et_equ_type_id,T1.et_equ_upu,
  T1.et_equ_cl,T1.et_equ_fntval,T1.et_equ_pf,T1.et_equ_no,T1.et_equ_code,T1.et_equ_tl,
  T1.et_equ_epos,T1.et_equ_apos,T1.et_equ_chrip,T1.et_equ_rnq,T1.et_equ_name,T1.et_equ_use,
  T1.et_equ_ccode,T1.et_eirp,T1.et_equ_rwid,T1.et_equ_esgn,T1.et_equ_atype,T1.et_equ_pow_avg,
  T1.et_equ_pow_max,T1.et_equ_dnu,T1.et_af_type,T1.et_equ_type,T1.et_equ_senu,T1.et_equ_sen,
  T1.et_equ_mt,T1.et_equ_sum,T1.et_equ_pdn,T1.et_equ_euse,T1.et_equ_pwid1,T1.ET_EQU_RF,
  T1.ET_EQU_RF_BAND,T2.freq_mod,
  T2.freq_type, T2.freq_mb,T2.freq_code,  --频率数据处理
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) ft_freq_unit_type,
  f_rim_rsm_GETFREQ_R(freq_uc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_uc,
  f_rim_rsm_GETFREQ_R(freq_lc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_lc,
  decode(t2.FREQ_TYPE,'0',f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_efe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_efe,
  decode(t2.FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ,'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_rfe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_rfe,
  T3.ft_freq_type,T3.ft_freq_csgn,T3.ft_freq_mc1,
  T3.ft_freq_timee,T3.ft_freq_dupdn,T3.ft_freq_no,T3.ft_freq_hcl,T3.ft_freq_mc,T3.ft_freq_timeb,
  T3.ft_freq_mc2,T3.ft_freq_mc3,T3.ft_freq_info_type,T3.ft_freq_ccode
  ,t1.ET_EQU_UPOW,t1.ET_EQU_DPOW
  ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
  ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
  ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
  ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
      --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit
from v_rim_rsm_rsbt_stat_report_s a ,RSBT_EQU T0,RSBT_EQU_T T1,RSBT_freq T2,RSBT_freq_T T3
where a.GUID = T0.station_guid(+) and et_equ_type_id = '0' and
      t0.guid =t2.guid(+) and T0.guid  = T1.Guid(+)
      and t2.guid  = t3.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_S_RO_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_S_RO_R" AS 
select a.APP_CODE,a.STAT_APP_Type,a.stat_tdi,
T0.equ_model,f_rim_rsm_GETPOWER_W(EQU_POW,ET_pow_u) equ_pow,T0.equ_pf,T0.equ_mb,T0.equ_type,T0.equ_auth,T0.station_guid,
  T0.equ_menu,T0.guid,t2.guid freq_guid,T0.equ_code,T1.et_equ_pwid2,T1.et_equ_pup,
  T1.et_equ_senerr,T1.et_pow_u,T1.et_equ_pr,T1.et_equ_type_id,T1.et_equ_upu,
  T1.et_equ_cl,T1.et_equ_fntval,T1.et_equ_pf,T1.et_equ_no,T1.et_equ_code,T1.et_equ_tl,
  T1.et_equ_epos,T1.et_equ_apos,T1.et_equ_chrip,T1.et_equ_rnq,T1.et_equ_name,T1.et_equ_use,
  T1.et_equ_ccode,T1.et_eirp,T1.et_equ_rwid,T1.et_equ_esgn,T1.et_equ_atype,T1.et_equ_pow_avg,
  T1.et_equ_pow_max,T1.et_equ_dnu,T1.et_af_type,T1.et_equ_type,T1.et_equ_senu,T1.et_equ_sen,
  T1.et_equ_mt,T1.et_equ_sum,T1.et_equ_pdn,T1.et_equ_euse,T1.et_equ_pwid1,T1.ET_EQU_RF,
  T1.ET_EQU_RF_BAND,T2.freq_mod,
  T2.freq_type, T2.freq_mb,T2.freq_code,  --频率数据处理
  f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB) ft_freq_unit_type,
  f_rim_rsm_GETFREQ_R(freq_uc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_uc,
  f_rim_rsm_GETFREQ_R(freq_lc,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) freq_lc,
  decode(t2.FREQ_TYPE,'0',f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),'1', f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))) FREQ_EFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_efe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_efe,
  decode(t2.FREQ_TYPE,'0', f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ,'1', f_rim_rsm_GETFREQ_R(FREQ_RFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)) ) FREQ_RFB,
  decode(freq_type,'1',f_rim_rsm_GETFREQ_R(freq_rfe,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)),null) freq_rfe,
  T3.ft_freq_type,T3.ft_freq_csgn,T3.ft_freq_mc1,
  T3.ft_freq_timee,T3.ft_freq_dupdn,T3.ft_freq_no,T3.ft_freq_hcl,T3.ft_freq_mc,T3.ft_freq_timeb,
  T3.ft_freq_mc2,T3.ft_freq_mc3,T3.ft_freq_info_type,T3.ft_freq_ccode
  ,t1.ET_EQU_UPOW,t1.ET_EQU_DPOW
  ,FT_FREQ_FEP,FT_FREQ_FRP,FT_FREQ_POWFLAG,FT_FREQ_EIRP,FT_FREQ_POW_MAX,FT_FREQ_POW_AVG
  ,f_rim_rsm_GETFREQ_R(FREQ_E_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_E_BAND
  ,f_rim_rsm_GETFREQ_R(FREQ_R_BAND,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND)) FREQ_R_BAND
    --必要带宽单位
  ,f_rim_rsm_GETFREQ_Band_Unit(FREQ_E_BAND) FT_FREQ_Band_Unit_Type
      --发射功率
    ,f_rim_rsm_GETPOWER_W(FT_FREQ_EPOW, f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW)) FT_FREQ_EPOW
    ,f_rim_rsm_GETFREQ_fre_Pow_Uni(FT_FREQ_EPOW) FT_FREQ_EPOW_Unit
from v_rim_rsm_rsbt_stat_report_s_r a ,RSBT_EQU_r T0,RSBT_EQU_T_r T1,RSBT_freq_r T2,RSBT_freq_T_r T3
where a.GUID = T0.station_guid(+) and et_equ_type_id = '0' and
      t0.guid =t2.guid(+) and T0.guid  = T1.Guid(+)
      and t2.guid  = t3.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_SELECT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_SELECT" AS 
select a."GUID",a."NET_GUID",a."ORG_CODE",a."APP_CODE",a."STAT_APP_TYPE",a."STAT_TDI",a."STAT_NAME",a."STAT_ADDR",a."STAT_AREA_CODE",a."STAT_TYPE",a."STAT_WORK",a."STAT_STATUS",a."STAT_EQU_SUM",a."STAT_LG",a."STAT_LA",a."STAT_AT",a."STAT_DATE_START",a."MEMO",a.stat_app_type||a.stat_tdi stat_all from rsbt_station a;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_STATION_WF
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_STATION_WF" AS 
select fileguid,stat_tdi,app_code,'0' IsDB,formcode from  v_rim_rsm_apply_filelist_wf where formcode not in
(select app_code  from rsbt_apply)
union all
select guid,stat_app_type||stat_tdi as stat_tdi ,app_code,'1' IsDB,app_code||stat_app_type||stat_tdi as formcode from rsbt_station
union all
select guid,null as stat_tdi ,app_code,'1' IsDB,app_code as formcode from rsbt_apply;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_TECHTF
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_TECHTF" AS 
select
  ----地面固定业务台（站）技术资料申报表
  ----台(站)数据信息
  A.GUID,A.STAT_TDI,A.APP_CODE,
  SubStr(A.App_Code,1,1)||
  Substr(A.APP_CODE,2,4) ||'-'||
  Substr(A.APP_CODE,6,4) ||'-'||
  Substr(A.APP_CODE,10,4) as Area_Code,
  C.Code_CHI_Name,
  D.Code_CHI_Name AS Code_CHI_Name_A,
  A.STAT_NAME,B.ST_TF_CODE,A.STAT_ADDR,A.STAT_EQU_SUM,
  f_rim_rsm_changedegree(A.STAT_LG) as STAT_LG,
  f_rim_rsm_changedegree(A.STAT_LA) as STAT_LA,A.STAT_AT,
  B.ST_TF_TRANS_CA_P,B.ST_TF_TRANS_CA_PU,
  E.Code_CHI_Name as Code_CHI_Name_B,
  A.STAT_DATE_START,A.MEMO,A.STAT_TYPE
from RSBT_STATION A,RSBT_STATION_T B,RSBT_CODE_DIC C,
RSBT_CODE_DIC D,RSBT_CODE_DIC E
where A.GUID=B.GUID(+) and A.STAT_APP_TYPE='TF'
and (A.STAT_TYPE=C.CN(+) and C.code_data_type(+) = '00052006')
AND (A.stat_status = D.CN(+) and D.code_data_type(+) = '00072006')
and (B.ST_TF_TRANS_CA_PU=E.CN(+) and E.code_data_type(+) = '00312006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_TECHTF_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_TECHTF_R" AS 
select
  ----地面固定业务台（站）技术资料申报表
  ----台(站)数据信息
  A.GUID,A.STAT_TDI,A.APP_CODE,
  SubStr(A.App_Code,1,1)||
  Substr(A.APP_CODE,2,4) ||'-'||
  Substr(A.APP_CODE,6,4) ||'-'||
  Substr(A.APP_CODE,10,4) as Area_Code,
  C.Code_CHI_Name,
  D.Code_CHI_Name AS Code_CHI_Name_A,
  A.STAT_NAME,B.ST_TF_CODE,A.STAT_ADDR,A.STAT_EQU_SUM,
  f_rim_rsm_changedegree(A.STAT_LG) as STAT_LG,
  f_rim_rsm_changedegree(A.STAT_LA) as STAT_LA,A.STAT_AT,
  B.ST_TF_TRANS_CA_P,B.ST_TF_TRANS_CA_PU,
  E.Code_CHI_Name as Code_CHI_Name_B,
  A.STAT_DATE_START,A.MEMO,A.STAT_TYPE
from RSBT_STATION_r A,RSBT_STATION_T_r B,RSBT_CODE_DIC C,
RSBT_CODE_DIC D,RSBT_CODE_DIC E
where A.GUID=B.GUID(+) and A.STAT_APP_TYPE='TF'
and (A.STAT_TYPE=C.CN(+) and C.code_data_type(+) = '00052006')
AND (A.stat_status = D.CN(+) and D.code_data_type(+) = '00072006')
and (B.ST_TF_TRANS_CA_PU=E.CN(+) and E.code_data_type(+) = '00312006');

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_TFCODE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_TFCODE" AS 
select distinct stat.guid,stat.net_guid, stat_t.st_tf_code,app.app_code,stat.stat_tdi,app.app_type from rsbt_station stat,rsbt_station_t stat_t,rsbt_apply app
where stat_t.guid=stat.guid and app.app_code=stat.app_code and stat.stat_app_type='TF' and stat_t.st_tf_code is not null;

-- ----------------------------
-- View structure for V_RIM_RSM_RSBT_TFCODE_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_RSBT_TFCODE_R" AS 
select distinct stat.guid,stat.net_guid, stat_t.st_tf_code,app.app_code,stat.stat_tdi,app.app_type from rsbt_station_r stat,rsbt_station_t_r stat_t,rsbt_apply_r app
where stat_t.guid=stat.guid and app.app_code=stat.app_code and stat.stat_app_type='TF' and stat_t.st_tf_code is not null;

-- ----------------------------
-- View structure for V_RIM_RSM_SEAL_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SEAL_APPLY" AS 
select f.guid apply_guid, f.app_code app_codedes,f.app_code,a.guid net_guid,a.net_name,a.org_guid,b.org_name,decode(substr(f.app_code,1,1),'P',substr(f.app_code,3,4)||'00',nvl(b.org_area_code,substr(f.app_code,2,4)||'00')) area_code,
      c.code_chi_name NET_SVN_V,c.cn NET_SVN,d.code_chi_name NET_SP_V,e.code_chi_name net_area_v,a.org_code,
      (select  count(s.app_code) from rsbt_station s where s.stat_status='1' and f.app_code=s.app_code)sum_use,
      (select  count(s.app_code) from rsbt_station_h s where s.stat_status='0' and f.app_code=s.app_code)sum_seal,
      (select  count(s.app_code) from rsbt_station_h s where s.stat_status='2' and f.app_code=s.app_code)sum_discard
 from rsbt_apply f,rsbt_net a ,rsbt_org b,RSBT_CODE_DIC c ,RSBT_CODE_DIC d ,RSBT_CODE_DIC e
 where  f.net_guid=a.guid and a.org_guid = b.guid(+) and a.NET_Expired_Date is null
         and f.app_type<>'F'
         and a.NET_SVN = c.cn(+) and c.code_data_type(+) = '00452006'
         and a.NET_SP = d.cn(+) and d.code_data_type(+) = '00002006'
         and a.NET_Area = e.cn(+) and e.code_data_type(+) = '00022006';

-- ----------------------------
-- View structure for V_RIM_RSM_SEAL_EQUIP
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SEAL_EQUIP" AS 
select a.app_code app_code,substr(a.app_code,-12,12) app_codedes,nvl(a.STAT_AREA_CODE,a.org_code) stat_area_code,stat_area_code area_code,g.guid apply_guid,
       a.NET_GUID, a.guid station_guid,b.net_name,decode(substr(a.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(a.app_code),c.org_name) org_name,a.STAT_APP_Type|| a.stat_tdi decl_code,
	 decode(substr(a.app_code,1,1),'P','PA','T') as app_type,decode(substr(a.app_code,1,1),'P','业余电台申请','无线电台申请') as app_type_Name
	 ,b.org_guid,e.guid equ_guid,f.et_equ_no,e.equ_menu,e.equ_model,e.equ_code, '1' equ_status,'在用' equ_status_v
 from rsbt_equ e,rsbt_equ_t f,rsbt_station a ,rsbt_net b ,rsbt_org c,rsbt_apply g
 where e.station_guid=a.guid and e.guid=f.guid(+) and a.net_guid = b.guid(+) and a.app_code=g.app_code(+)
 and b.org_guid = c.guid(+) and a.stat_app_type='LM'
 union all
 select a.app_code app_code,substr(a.app_code,-12,12) app_codedes,nvl(a.STAT_AREA_CODE,a.org_code) stat_area_code,stat_area_code area_code,g.guid apply_guid,
       a.NET_GUID, a.guid station_guid,b.net_name,decode(substr(a.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(a.app_code),c.org_name) org_name,a.STAT_APP_Type|| a.stat_tdi decl_code,
	 decode(substr(a.app_code,1,1),'P','PA','T') as app_type,decode(substr(a.app_code,1,1),'P','业余电台申请','无线电台申请') as app_type_Name
	 ,b.org_guid,e.guid equ_guid,f.et_equ_no,e.equ_menu,e.equ_model,e.equ_code, nvl(d.equ_status,1) equ_status,decode(d.equ_status,'0','封存','2','报废','在用') equ_status_v
 from rsbt_equ_h e,rsbt_equ_t_h f,rsbt_station a ,rsbt_net b ,rsbt_org c,T_RIM_RSM_EQU_EXPAND d ,rsbt_apply g
 where e.station_guid=a.guid and e.guid=f.guid(+)  and a.net_guid = b.guid(+) and e.guid=d.guid(+) and a.app_code=g.app_code(+)
 and b.org_guid = c.guid(+) and a.stat_app_type='LM';

-- ----------------------------
-- View structure for V_RIM_RSM_SEAL_NET
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SEAL_NET" AS 
select a.GUID,a.ORG_GUID,a.FEE_GUID,a.ORG_CODE,a.NET_NAME,a.NET_SVN,a.NET_SP,a.NET_TS,a.NET_BAND,
a.NET_AREA,a.NET_USE,a.NET_SAT_NAME,a.NET_LG,a.NET_START_DATE,a.NET_CONFIRM_DATE,a.NET_EXPIRED_DATE,
b.org_name, org_area_code area_code,c.code_chi_name NET_SVN_V,d.code_chi_name NET_SP_V,e.code_chi_name net_area_v,
      (select  count(s.app_code) from rsbt_station s where s.stat_status='1' and s.NET_GUID=a.guid)sum_use,
      (select  count(s.app_code) from rsbt_station_h s where s.stat_status='0' and s.NET_GUID=a.guid)sum_seal,
      (select  count(s.app_code) from rsbt_station_h s where s.stat_status='2' and s.NET_GUID=a.guid)sum_discard
 from rsbt_net a ,rsbt_org b,RSBT_CODE_DIC c ,RSBT_CODE_DIC d ,RSBT_CODE_DIC e
 where  a.org_guid = b.guid(+)
       and a.guid<>'null'
 				and a.NET_SVN = c.cn(+) and c.code_data_type(+) = '00452006'
 				and a.NET_SP = d.cn(+) and d.code_data_type(+) = '00002006'
 				and a.NET_Area = e.cn(+) and e.code_data_type(+) = '00022006';

-- ----------------------------
-- View structure for V_RIM_RSM_SEAL_STAT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SEAL_STAT" AS 
select a.app_code app_code,substr(a.app_code,-12,12) app_codedes,nvl(a.STAT_AREA_CODE,substr(substr(a.app_code,-12,12),1,4)||'00') stat_area_code,stat_area_code area_code,a.org_code, a.NET_GUID, a.guid station_guid,
b.net_name,decode(substr(a.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(a.app_code),c.org_name) org_name,d.code_chi_name stat_type_v,a.STAT_APP_Type|| a.stat_tdi decl_code,
	 decode(nvl(a.net_guid,''),'','PA','T') as app_type,decode(nvl(a.net_guid,''),'','业余电台申请','无线电台申请') as app_type_Name
	 ,b.org_guid,g.code_chi_name stat_status_v,a.stat_status,a.stat_addr,stat_type,f.guid apply_guid
 from rsbt_station a ,rsbt_net b ,rsbt_org c,RSBT_CODE_DIC d ,RSBT_CODE_DIC g ,rsbt_apply f
 where  a.net_guid = b.guid(+) and b.org_guid = c.guid(+) and a.app_code=f.app_code
		 and (a.stat_type = d.cn(+) and d.code_data_type(+) = '00052006')
		  and (a.stat_status = g.cn(+) and g.code_data_type(+) = '00072006')
union all
select a.app_code app_code,substr(a.app_code,-12,12) app_codedes,nvl(a.STAT_AREA_CODE,substr(substr(a.app_code,-12,12),1,4)||'00') stat_area_code,stat_area_code area_code,a.org_code, a.NET_GUID, a.guid station_guid,
b.net_name,decode(substr(a.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(a.app_code),c.org_name) org_name,d.code_chi_name stat_type_v,a.STAT_APP_Type|| a.stat_tdi decl_code,
	 decode(nvl(a.net_guid,''),'','PA','T') as app_type,decode(nvl(a.net_guid,''),'','业余电台申请','无线电台申请') as app_type_Name
	 ,b.org_guid,g.code_chi_name stat_status_v,a.stat_status,a.stat_addr,stat_type,f.guid apply_guid
 from rsbt_station_h a ,rsbt_net b ,rsbt_org c,RSBT_CODE_DIC d ,RSBT_CODE_DIC g ,rsbt_apply f
 where  a.net_guid = b.guid(+) and b.org_guid = c.guid(+) and a.app_code=f.app_code
		 and (a.stat_type = d.cn(+) and d.code_data_type(+) = '00052006')
		  and (a.stat_status = g.cn(+) and g.code_data_type(+) = '00072006');

-- ----------------------------
-- View structure for V_RIM_RSM_SEALDISCARD_APPLY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SEALDISCARD_APPLY" AS 
select f.guid apply_guid, f.app_code app_codedes,f.app_code,a.guid net_guid,a.net_name,a.org_guid,b.org_name,decode(substr(f.app_code,1,1),'P',substr(f.app_code,3,4)||'00',nvl(b.org_area_code,substr(f.app_code,2,4)||'00')) area_code,
      c.code_chi_name NET_SVN_V,c.cn NET_SVN,d.code_chi_name NET_SP_V,e.code_chi_name net_area_v,a.org_code,
      (select  count(s.app_code) from rsbt_station s where s.stat_status='1' and f.app_code=s.app_code)sum_use,
      (select  count(s.app_code) from rsbt_station_h s where s.stat_status='0' and f.app_code=s.app_code)sum_seal,
       (select  count(s.app_code) from rsbt_station_h s where s.stat_status='2' and f.app_code=s.app_code)sum_discard,
      nvl(n.apply_status,'1') apply_status ,decode(n.apply_status,'0','封存','2','报废','在用') apply_status_v,to_date(null)  TIMESTAMP
 from rsbt_apply f,rsbt_net a ,t_rim_rsm_apply_status n, rsbt_org b,RSBT_CODE_DIC c ,RSBT_CODE_DIC d ,RSBT_CODE_DIC e
 where  f.net_guid=a.guid and f.guid=n.guid(+) and a.org_guid = b.guid(+) and a.NET_Expired_Date is null
         and f.app_type<>'F'
         and a.NET_SVN = c.cn(+) and c.code_data_type(+) = '00452006'
         and a.NET_SP = d.cn(+) and d.code_data_type(+) = '00002006'
         and a.NET_Area = e.cn(+) and e.code_data_type(+) = '00022006'
union all
select f.guid apply_guid, f.app_code app_codedes,f.app_code,a.guid net_guid,a.net_name,a.org_guid,b.org_name,decode(substr(f.app_code,1,1),'P',substr(f.app_code,3,4)||'00',nvl(b.org_area_code,substr(f.app_code,2,4)||'00')) area_code,
      c.code_chi_name NET_SVN_V,c.cn NET_SVN,d.code_chi_name NET_SP_V,e.code_chi_name net_area_v,a.org_code,
      (select  count(s.app_code) from rsbt_station s where s.stat_status='1' and f.app_code=s.app_code)sum_use,
      (select  count(s.app_code) from rsbt_station_h s where s.stat_status='0' and f.app_code=s.app_code)sum_seal,
       (select  count(s.app_code) from rsbt_station_h s where s.stat_status='2' and f.app_code=s.app_code)sum_discard,
      nvl(n.apply_status,'1') apply_status ,decode(n.apply_status,'0','封存','2','报废','在用') apply_status_v,f.TIMESTAMP
 from rsbt_apply_h f,rsbt_net a ,t_rim_rsm_apply_status n, rsbt_org b,RSBT_CODE_DIC c ,RSBT_CODE_DIC d ,RSBT_CODE_DIC e
 where  f.net_guid=a.guid and f.guid=n.guid(+) and a.org_guid = b.guid(+) and a.NET_Expired_Date is null
         and f.app_type<>'F'
         and a.NET_SVN = c.cn(+) and c.code_data_type(+) = '00452006'
         and a.NET_SP = d.cn(+) and d.code_data_type(+) = '00002006'
         and a.NET_Area = e.cn(+) and e.code_data_type(+) = '00022006';

-- ----------------------------
-- View structure for V_RIM_RSM_SEARCH_STAT_ANTFEED
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SEARCH_STAT_ANTFEED" AS 
select apply.guid app_guid,a.app_code app_code,substr(a.app_code,-12,12) app_codedes,decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.STAT_AREA_CODE) stat_area_code,a.NET_GUID, a.guid station_guid,
b.net_name,decode(substr(a.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(a.app_code),c.org_name) org_name,d.code_chi_name stat_type_v,a.STAT_APP_Type|| a.stat_tdi decl_code,
   decode(nvl(a.net_guid,''),'','PA','T') as app_type,decode(nvl(a.net_guid,''),'','业余电台申请','无线电台申请') as app_type_Name
   ,b.org_guid,g.code_chi_name stat_status_v,a.stat_status,a.stat_addr,stat_type,f.guid antfeed_guid,f.ANT_Work_Type,f.ANT_POLE,f.ANT_RPOLE,f.ANT_EPOLE,f.ANT_Type,f.ANT_Model,f.ANT_MENU,f.ANT_Hight,
f.ANT_Gain,f.ANT_EGain,f.ANT_RGain,f.ANT_Angle,f.ANT_Size,f.FEED_MENU,f.FEED_Model,f.FEED_Length,f.FEED_Lose,f.ANT_Code,f.FEED_Code,t.AT_ANT_NO,t.AT_SE_B,t.AT_SE_E,t.AT_ANG_B,t.AT_ANG_E,t.AT_RNT,t.AT_BWID,t.AT_LEL,t.AT_SSPEED,t.AT_CCODE,t.AT_3DBE,t.AT_3DBR,
t.AT_RANG,t.AT_EANG,t.AT_CSGN,t.AT_UPDN,t.AT_SUM,t.AT_QUA,t.AT_UNIT_TYPE,t.AT_H_HPIC,t.AT_H_VPIC,t.AT_ANT_UPANG,
t.AT_ANT_TFCODE,modle.code_chi_name ant_type_cn,pole.code_chi_name ant_pole_cn,rpole.code_chi_name ant_rpole_cn,
epole.code_chi_name ant_epole_cn,work_type.code_chi_name ant_work_type_cn
 from rsbt_station a ,rsbt_net b ,rsbt_org c,RSBT_CODE_DIC d ,RSBT_CODE_DIC g,rsbt_antfeed f,rsbt_antfeed_t t,rsbt_apply apply,
 RSBT_CODE_DIC pole,RSBT_CODE_DIC rpole,RSBT_CODE_DIC epole,RSBT_CODE_DIC modle,RSBT_CODE_DIC work_type
 where  a.net_guid = b.guid(+) and b.org_guid = c.guid(+) and (a.stat_status='0' or a.stat_status='1')
     and (a.stat_type = d.cn(+) and d.code_data_type(+) = '00052006') and a.guid = f.station_guid(+) and f.guid = t.guid
      and (a.stat_status = g.cn(+) and g.code_data_type(+) = '00072006') and a.stat_app_type <> 'LM'
      and (f.Ant_Type = modle.cn(+) and modle.code_data_type(+) = '00172006')
      and (f.ant_pole = pole.cn(+) and pole.code_data_type(+) = '00202006')
      and (f.ant_rpole = rpole.cn(+) and rpole.code_data_type(+) = '00202006')
      and (f.ant_epole = epole.cn(+) and epole.code_data_type(+) = '00202006')
      and (f.ANT_Work_Type = work_type.cn(+) and work_type.code_data_type(+) = '00382006')
      and a.app_code=apply.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_SEARCH_STAT_EQU
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SEARCH_STAT_EQU" AS 
select apply.guid app_guid,a.app_code app_code,substr(a.app_code,-12,12) app_codedes,decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.STAT_AREA_CODE) stat_area_code,a.NET_GUID, a.guid station_guid,
b.net_name,decode(substr(a.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(a.app_code),c.org_name) org_name,d.code_chi_name stat_type_v,a.STAT_APP_Type|| a.stat_tdi decl_code,
	 decode(nvl(a.net_guid,''),'','PA','T') as app_type,decode(nvl(a.net_guid,''),'','业余电台申请','无线电台申请') as app_type_Name
	 ,b.org_guid,g.code_chi_name stat_status_v,a.stat_status,a.stat_addr,stat_type,q.guid equ_guid,q.equ_type,q.equ_model,q.equ_auth,q.equ_menu,q.equ_code,q.equ_pf,
   decode( q.equ_pf,'X','峰包功率','Y','平均功率','Z','载波功率','B','标称功率','无标识') equ_pf_name,q.equ_pow,q.equ_mb,decode(q.equ_mb,0,'主','1','备','无标识')  equ_mb_name,
   t.ET_EQU_NO,t.ET_AF_TYPE,t.ET_POW_U,t.ET_EQU_CL,t.ET_EQU_TL,t.ET_EQU_RNQ,t.ET_EQU_TYPE_ID,t.ET_EQU_NAME,t.ET_EQU_CODE,t.ET_EQU_ESGN,t.ET_EQU_EPOS,t.ET_EQU_ATYPE,
t.ET_EQU_APOS,t.ET_EQU_SUM,t.ET_EQU_EUSE,t.ET_EQU_FNTVAL,t.ET_EQU_PUP,t.ET_EQU_PDN,t.ET_EQU_CHRIP,t.ET_EQU_PWID1,t.ET_EQU_PWID2,t.ET_EQU_PR,t.ET_EQU_PF,
t.ET_EQU_RF,t.ET_EQU_RF_BAND,t.ET_EIRP,t.ET_EQU_SEN,t.ET_EQU_SENU,t.ET_EQU_SENERR,t.ET_EQU_RWID,t.ET_EQU_MT,t.ET_EQU_CCODE,t.ET_EQU_UPU,t.ET_EQU_DNU,
t.ET_EQU_TYPE,t.ET_EQU_USE,t.ET_EQU_POW_MAX,t.ET_EQU_POW_AVG,t.ET_EQU_UPOW,t.ET_EQU_DPOW,t.ET_EQU_TFCODE
 from rsbt_station a ,rsbt_net b ,rsbt_org c,RSBT_CODE_DIC d ,RSBT_CODE_DIC g,rsbt_equ q,rsbt_equ_t t,rsbt_apply apply
 where  a.net_guid = b.guid(+) and b.org_guid = c.guid(+) and (a.stat_status='0' or a.stat_status='1')
   and (a.stat_type = d.cn(+) and d.code_data_type(+) = '00052006') and a.guid = q.station_guid(+) and q.guid = t.guid
      and (a.stat_status = g.cn(+) and g.code_data_type(+) = '00072006')
      and a.app_code=apply.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_SEARCH_STAT_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SEARCH_STAT_FREQ" AS 
select apply.guid app_guid,a.app_code app_code,substr(a.app_code,-12,12) app_codedes,decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.STAT_AREA_CODE) stat_area_code,a.NET_GUID, a.guid station_guid,
    b.net_name,decode(substr(a.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(a.app_code),c.org_name) org_name,d.code_chi_name stat_type_v,a.STAT_APP_Type|| a.stat_tdi decl_code,
	 decode(nvl(a.net_guid,''),'','PA','T') as app_type,decode(nvl(a.net_guid,''),'','业余电台申请','无线电台申请') as app_type_Name
	 ,b.org_guid,g.code_chi_name stat_status_v,a.stat_status,a.stat_addr,stat_type,
   f.guid freq_guid,decode( f.freq_type,'0','频点','频段') freq_type_name,f.freq_type,
   nvl(f.freq_lc,0) freq_lc, nvl(f.freq_uc,0) freq_uc,
   decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) EFB1,
   decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) RFB1,
   to_char(decode(f.freq_type,'0',decode(f.freq_uc,0,'',f.freq_uc),decode(f.FREQ_EFB,0,'',f.FREQ_EFB)),'999990.9999') FREQ_EFB,
   to_char(decode(f.freq_type,'0',decode(f.freq_lc,0,'',f.freq_lc),decode(f.FREQ_RFB,0,'',f.FREQ_RFB)),'999990.9999') FREQ_RFB,
   to_char(decode(f.FREQ_EFE,0,'',f.FREQ_EFE),'999990.9999') FREQ_EFE, to_char(decode(f.FREQ_RFE,0,'',f.FREQ_RFE),'999990.9999') FREQ_RFE,
   to_char(decode(f.FREQ_E_Band,0,'',f.FREQ_E_Band),'999990.9999') FREQ_E_Band,
   to_char(decode(f.FREQ_R_Band,0,'',f.FREQ_R_Band),'999990.9999') FREQ_R_Band,f.FREQ_MOD,f.FREQ_MB,f.FREQ_Code,
   t.FT_FREQ_NO,t.FT_FREQ_TIMEB,t.FT_FREQ_TIMEE,t.FT_FREQ_INFO_TYPE,t.FT_FREQ_HCL,t.FT_FREQ_TYPE,t.FT_FREQ_MC,t.FT_FREQ_MC1,
t.FT_FREQ_MC2,t.FT_FREQ_MC3,t.FT_FREQ_CCODE,t.FT_FREQ_CSGN,t.FT_FREQ_DUPDN,t.FT_FREQ_UNIT_TYPE,t.FT_FREQ_FEP,t.FT_FREQ_FRP,
t.FT_FREQ_EPOW,t.FT_FREQ_POWFLAG,t.FT_FREQ_EIRP,t.FT_FREQ_POW_MAX,t.FT_FREQ_POW_AVG,t.FT_FREQ_TFCODE
 from rsbt_station a ,rsbt_net b ,rsbt_org c,RSBT_CODE_DIC d ,RSBT_CODE_DIC g,rsbt_freq f,rsbt_freq_t t,rsbt_apply apply
 where  a.net_guid = b.guid(+) and b.org_guid = c.guid(+) and (a.stat_status='0' or a.stat_status='1') and a.guid = f.station_guid
     and a.stat_type = d.cn(+) and d.code_data_type(+) = '00052006' and t.guid = f.guid
      and a.stat_status = g.cn(+) and g.code_data_type(+) = '00072006'
      and a.app_code=apply.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_SEARCH_STAT_FREQ_OLD
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SEARCH_STAT_FREQ_OLD" AS 
select apply.guid app_guid,a.app_code app_code,substr(a.app_code,-12,12) app_codedes,decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.STAT_AREA_CODE) stat_area_code,a.NET_GUID, a.guid station_guid,
b.net_name,decode(substr(a.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(a.app_code),c.org_name) org_name,d.code_chi_name stat_type_v,a.STAT_APP_Type|| a.stat_tdi decl_code,
   decode(nvl(a.net_guid,''),'','PA','T') as app_type,decode(nvl(a.net_guid,''),'','业余电台申请','无线电台申请') as app_type_Name
   ,b.org_guid,g.code_chi_name stat_status_v,a.stat_status,a.stat_addr,stat_type,
   f.guid freq_guid,decode( f.freq_type,'0','频点','频段') freq_type_name,f.freq_type,f.freq_lc,f.freq_uc,f.FREQ_EFB,f.FREQ_EFE,f.FREQ_E_Band,f.FREQ_RFB,f.FREQ_RFE,f.FREQ_R_Band,f.FREQ_MOD,f.FREQ_MB,f.FREQ_Code,
   t.FT_FREQ_NO,t.FT_FREQ_TIMEB,t.FT_FREQ_TIMEE,t.FT_FREQ_INFO_TYPE,t.FT_FREQ_HCL,t.FT_FREQ_TYPE,t.FT_FREQ_MC,t.FT_FREQ_MC1,
t.FT_FREQ_MC2,t.FT_FREQ_MC3,t.FT_FREQ_CCODE,t.FT_FREQ_CSGN,t.FT_FREQ_DUPDN,t.FT_FREQ_UNIT_TYPE,t.FT_FREQ_FEP,t.FT_FREQ_FRP,
t.FT_FREQ_EPOW,t.FT_FREQ_POWFLAG,t.FT_FREQ_EIRP,t.FT_FREQ_POW_MAX,t.FT_FREQ_POW_AVG,t.FT_FREQ_TFCODE
 from rsbt_station a ,rsbt_net b ,rsbt_org c,RSBT_CODE_DIC d ,RSBT_CODE_DIC g,rsbt_freq f,rsbt_freq_t t,rsbt_apply apply
 where  a.net_guid = b.guid(+) and b.org_guid = c.guid(+) and (a.stat_status='0' or a.stat_status='1') and a.guid = f.station_guid
     and (a.stat_type = d.cn(+) and d.code_data_type(+) = '00052006') and t.guid = f.guid
      and (a.stat_status = g.cn(+) and g.code_data_type(+) = '00072006')
      and a.app_code=apply.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_SEARCH_STAT_NET
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SEARCH_STAT_NET" AS 
select apply.guid app_guid,a.app_code app_code,substr(a.app_code,-12,12) app_codedes,decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.STAT_AREA_CODE) stat_area_code,a.NET_GUID, a.guid station_guid,
b.net_name,decode(substr(a.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(a.app_code),c.org_name) org_name,d.code_chi_name stat_type_v,a.STAT_APP_Type|| a.stat_tdi decl_code,
	 decode(nvl(a.net_guid,''),'','PA','T') as app_type,decode(nvl(a.net_guid,''),'','业余电台申请','无线电台申请') as app_type_Name,
	 b.org_guid,g.code_chi_name stat_status_v,a.stat_status,a.stat_addr,stat_type,b.FEE_GUID,b.ORG_Code,
   b.NET_SVN,b1.code_chi_name NET_SVN_view,
   b.NET_SP ,b2.code_chi_name NET_SP_view,
   b.NET_TS ,b3.code_chi_name NET_TS_view,
   b.NET_Band,b.NET_Area,decode(b.NET_Area,'1','国际/跨边境(界)','2','全国','3','跨省','4','省内','5','地市','6','县级','其他') NET_Area_name,b.NET_Use,b.NET_SAT_Name,
b.NET_LG,b.NET_Start_Date,b.NET_Confirm_Date,b.NET_Expired_Date
 from rsbt_station a ,rsbt_net b ,rsbt_org c,RSBT_CODE_DIC d ,RSBT_CODE_DIC g,RSBT_CODE_DIC b1,
 RSBT_CODE_DIC b2,RSBT_CODE_DIC b3,rsbt_apply apply
  where  a.net_guid = b.guid(+) and b.org_guid = c.guid(+) and (a.stat_status='0' or a.stat_status='1')
		 and (a.stat_type = d.cn(+) and d.code_data_type(+) = '00052006')
     and (b.NET_SVN = b1.cn(+) and b1.code_data_type(+) = '00452006')
     and (b.NET_SP = b2.cn(+) and b2.code_data_type(+) = '00002006')
     and (b.NET_TS = b3.cn(+) and b3.code_data_type(+) = '00012006')
		  and (a.stat_status = g.cn(+) and g.code_data_type(+) = '00072006')
       and a.app_code=apply.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_SELECT_LINK
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SELECT_LINK" AS 
select a.guid stat_guid,a.net_guid,b.org_guid,a.app_code,a.STAT_APP_Type||a.stat_tdi stat_tdi,d.org_name,a.stat_name,
 				nvl(a.stat_area_code,substr(a.app_code,2,4)||'00') area_code,c.code_chi_name stat_type_v,stat_type,STAT_LG,STAT_LA,a.STAT_APP_Type,e.st_tf_code stat_code,a.stat_addr
 from rsbt_station a,rsbt_net b,RSBT_CODE_DIC c,rsbt_org d,rsbt_station_t e
 where a.net_guid=b.guid(+) and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006'
 				and b.org_guid=d.guid(+) and a.guid=e.guid(+) and a.stat_app_type='TF';

-- ----------------------------
-- View structure for V_RIM_RSM_SELECT_LINK_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_SELECT_LINK_R" AS 
select a.guid stat_guid,a.net_guid,b.org_guid,a.app_code,a.STAT_APP_Type||a.stat_tdi stat_tdi,d.org_name,a.stat_name,
         nvl(a.stat_area_code,substr(a.app_code,2,4)||'00') area_code,c.code_chi_name stat_type_v,stat_type,STAT_LG,STAT_LA,a.STAT_APP_Type,e.st_tf_code stat_code,a.stat_addr
 from rsbt_station_r a,rsbt_net_r b,RSBT_CODE_DIC c,rsbt_org d,rsbt_station_t_r e
 where a.net_guid=b.guid(+) and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006'
         and b.org_guid=d.guid(+) and a.guid=e.guid(+) and a.stat_app_type='TF';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_ANT_SEARCH
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_ANT_SEARCH" AS 
select
e.guid ant_guid ,b.guid,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--antfeed
e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_Size,e.FEED_MENU,e.FEED_Model,ANT_Hight,ANT_Gain,et.AT_ANT_TFCODE,
e.FEED_Length,e.FEED_Lose,e.ant_rpole,e.ant_epole,e.ant_code,e.feed_code,e.ant_egain,e.guid antfeed_guid,
e.ant_angle,e.ANT_WORK_TYPE,e.ant_rgain,e.ant_pole,e.ant_type ANT_Type_Name,
et.at_ant_no,et.at_ant_upang,et.at_lel,et.at_bwid,et.AT_ANG_E,et.at_ang_b,et.at_ccode,et.at_unit_type,
et.at_3dbe,et.at_sspeed,et.at_rnt,et.at_qua,et.at_se_e,et.at_eang,et.at_updn,et.at_h_hpic,
et.at_se_b,et.at_csgn,et.at_3dbr,et.at_rang,et.at_sum,et.at_h_vpic,
e.ANT_WORK_TYPE ANT_WORK_TYPE_Name,
e.ANT_POLE ANT_POLE_Name,
e.ANT_RPOLE ANT_RPOLE_Name,
e.ANT_EPOLE ANT_EPOLE_Name,
et.AT_UPDN AT_UPDN_Name
from rsbt_station b ,rsbt_antfeed e,rsbt_station_t bt ,rsbt_antfeed_t et,
rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c
where  b.guid=bt.guid(+) and b.net_guid=n.guid(+)
and e.station_guid=b.guid(+) and e.guid=et.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+)
and exists (select guid from rsbt_eaf eaf where b.guid=eaf.station_guid and e.guid=eaf.ant_guid);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_CALL_SIGN_S
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_CALL_SIGN_S" AS 
select a."GUID",a."STATION_GUID",a."EQUIP_NO",a."LICE_OK",a."NOTE",a."LICENSE_CODE",a."RQCODE",a."PRINTSTATUS",st.st_call_sign from t_rim_rsm_lic_statues a,rsbt_station s,rsbt_station_t st
where a.station_guid=s.guid and s.guid=st.guid(+) and s.stat_app_type='S';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_COUNT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_COUNT" AS 
select f_rim_rsm_year(substr(a.stat_year,1,4))||decode(substr(a.stat_year,6,1),'F','上半年','下半年') stat_year,
    substr(a.stat_year,1,4)||decode(substr(a.stat_year,6,1),'F','年上半年','年下半年') stat_year_value,b.code_chi_name stat_place,
    a.stat_year stat_date,a.stat_dept dept_code,'' stat_dept,a.stat_dept stat_code,'' lead_sign,'' fill_sign,f_rim_rsm_date(sysdate) fill_date,
    stat_sum,bc_sum,bt_sum,bw_sum,sf_sum,sm_sum,hf_sum,hm_sum,ss_sum,as_sum,pb_sum,jq_sum,lj_sum,fwgsm_sum,lfgsm_sum,
    fwcdma_sum,lfcdma_sum,wx_sum,gx_sum,gd_sum,ws_sum,wy_sum,la_sum,ha_sum,spm_sum,ms_sum,yy_sum,ot_sum
from t_rim_rsm_stat_info a,RSBT_CODE_DIC b
where a.stat_dept<>'999999'  and a.stat_dept=b.cn(+) and b.code_data_type(+)='00032006'
union all
select f_rim_rsm_year(substr(a.stat_year,1,4))||decode(substr(a.stat_year,6,1),'F','上半年','下半年') stat_year,
    substr(a.stat_year,1,4)||decode(substr(a.stat_year,6,1),'F','年上半年','年下半年') stat_year_value,'合计' stat_place,
    a.stat_year stat_date,a.stat_dept dept_code,'' stat_dept,a.stat_dept stat_code,'' lead_sign,'' fill_sign,f_rim_rsm_date(sysdate) fill_date,
    stat_sum,bc_sum,bt_sum,bw_sum,sf_sum,sm_sum,hf_sum,hm_sum,ss_sum,as_sum,pb_sum,jq_sum,lj_sum,fwgsm_sum,lfgsm_sum,
    fwcdma_sum,lfcdma_sum,wx_sum,gx_sum,gd_sum,ws_sum,wy_sum,la_sum,ha_sum,spm_sum,ms_sum,yy_sum,ot_sum
from t_rim_rsm_stat_info a
where stat_dept='999999';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_COUNT_B2A
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_COUNT_B2A" AS 
select a.areacode area_code,d.code_chi_name area_name,decode(logtype,'1','转A库','2','转A库临时区','3','B库删除') logtype, decode(logtype,'2',b.typename) stat_type,decode(logtype,'1',1,'2',0,'3',2) orderid
from t_rim_rsm_stat_impbtoa_log a,t_rim_rsm_station_type b,rsbt_code_dic d
where  a.formtype<>'T' and a.formtype<>'PA' and a.formtype<>'LM'
and a.stat_type_guid=b.guid(+) and a.logdate=(select max(logdate) from t_rim_rsm_stat_impbtoa_log l where a.appcode=l.appcode and a.stattdi=l.stattdi)
and a.areacode=d.cn and  d.code_data_type(+)='00032006'
union all
select a.areacode area_code,d.code_chi_name area_name,decode(logtype,'1','转A库','2','转A库临时区','3','B库删除') logtype, decode(logtype,'2',b.typename) stat_type,decode(logtype,'1',1,'2',0,'3',2) orderid
from t_rim_rsm_stat_impbtoa_log a,t_rim_rsm_station_type b,rsbt_station c, rsbt_equ e, rsbt_code_dic d
where a.formtype='LM' and a.appcode=c.app_code(+) and a.stattdi=c.stat_app_type||c.stat_tdi and c.guid=e.station_guid
and a.stat_type_guid=b.guid(+) and a.logdate=(select max(logdate) from t_rim_rsm_stat_impbtoa_log l where a.appcode=l.appcode and a.stattdi=l.stattdi)
and a.areacode=d.cn and  d.code_data_type(+)='00032006'
union all
select s.org_code area_code,d.code_chi_name area_name, 'B库剩余' stat_type ,'' stat_type,3 orderid from rsbt_station_r s,rsbt_code_dic d
where s.stat_app_type<>'LM' and s.org_code=d.cn and  d.code_data_type(+)='00032006'
union all
select s.org_code area_code,d.code_chi_name area_name, 'B库剩余' stat_type ,'' stat_type,3 orderid from rsbt_station_r s,rsbt_equ_r e, rsbt_code_dic d
where s.stat_app_type='LM' and s.guid=e.station_guid and s.org_code=d.cn and  d.code_data_type(+)='00032006';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_DERATE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_DERATE" AS 
select apply.guid app_guid,c.guid,a.net_guid,a.guid station_guid,decode(nvl(b.fee_guid,''),'',c.org_guid,b.fee_guid) org_guid,net_name,
  a.app_code app_codedes,a.app_code,a.STAT_APP_Type||a.stat_tdi stat_tdi,a.stat_date_start,d.org_name,a.stat_addr,
  decode(a.STAT_AREA_CODE,null,decode(substr(a.app_code,2,1),'9','000000',substr(a.app_code,2,4)||'00'),a.STAT_AREA_CODE) stat_area_code,
  nvl(c.Fee_Derate_Proportion,0) Fee_Derate_Proportion, decode(c.Fee_Derate_Proportion,'','',to_char(nvl(c.Fee_Derate_Proportion,0)*100,'990.9')||'%') derate,c.memo,d.org_sys_code,e.code_chi_name
from rsbt_station a,rsbt_net b,rsbt_feeeveryyear c,rsbt_org d,RSBT_CODE_DIC e,rsbt_apply apply
where a.net_guid=b.guid(+) and a.guid=c.station_guid(+) and a.stat_status='1'
      and decode(nvl(b.fee_guid,''),'',c.org_guid,b.fee_guid)=d.guid and a.Net_guid<>'null'
      and (d.org_sys_code = e.cn(+) and e.code_data_type(+) = '00092006')
      and a.app_code=apply.app_code(+);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EAF
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EAF" AS 
select a.guid,a.station_guid,a.freq_guid,decode(b.freq_type,'1',decode(FREQ_EFB,null,'',f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||'-'||f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||h.code_chi_name),
       decode(FREQ_UC,null,decode(FREQ_LC,null,'',f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||h.code_chi_name),f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_UC,FREQ_LC,FREQ_EFB,FREQ_RFB))||h.code_chi_name)) freq_title,
       decode(b.freq_type,'1',b.FREQ_EFB,b.freq_uc) freq_efb,decode(b.freq_type,'1',b.freq_efe,b.freq_lc) freq_efe,
       a.equ_guid,c.EQU_Model,c.EQU_CODE,a.ant_guid,d.ANT_Model ant_title,e.ft_freq_no,f.et_equ_no,g.at_ant_no,d.ant_angle,e.ft_freq_tfcode tf_code
from rsbt_eaf a,rsbt_freq b,rsbt_equ c,rsbt_antfeed d,rsbt_freq_t e,rsbt_equ_t f,rsbt_antfeed_t g,RSBT_CODE_DIC h
where a.freq_guid=b.guid(+) and a.equ_guid=c.guid(+) and a.ant_guid=d.guid(+) and b.guid=e.guid(+)
			and c.guid=f.guid(+) and d.guid=g.guid(+) and e.ft_freq_tfcode=f.et_equ_tfcode and f.et_equ_tfcode=g.at_ant_tfcode
			and f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)=h.cn(+) and h.code_data_type(+)='00292006';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EAF_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EAF_R" AS 
select a.guid,a.station_guid,a.freq_guid,decode(b.freq_type,'1',decode(FREQ_EFB,null,'',f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||'-'||f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||h.code_chi_name),
decode(FREQ_LC,null,decode(FREQ_UC,null,'',f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||h.code_chi_name),f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||h.code_chi_name)) freq_title,
      a.equ_guid,c.EQU_Model,c.EQU_CODE,a.ant_guid,d.ANT_Model ant_title,e.ft_freq_no,f.et_equ_no,g.at_ant_no,d.ant_angle,e.ft_freq_tfcode tf_code
from rsbt_eaf_r a,rsbt_freq_r b,rsbt_equ_r c,rsbt_antfeed_r d,rsbt_freq_t_r e,rsbt_equ_t_r f,rsbt_antfeed_t_r g,RSBT_CODE_DIC h
where a.freq_guid=b.guid(+) and a.equ_guid=c.guid(+) and a.ant_guid=d.guid(+) and b.guid=e.guid(+)
      and c.guid=f.guid(+) and d.guid=g.guid(+) and e.ft_freq_tfcode=f.et_equ_tfcode and f.et_equ_tfcode=g.at_ant_tfcode
      and f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)=h.cn(+) and h.code_data_type(+)='00292006';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EAF_TF
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EAF_TF" AS 
select st.GUID Station_GUID_B,st.ST_TF_CODE stat_code_b, st.guid station_guid,b.guid freq_guid,decode(b.freq_type,'1',decode(FREQ_EFB,null,'',f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||'-'||f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||h.code_chi_name),
decode(FREQ_LC,null,decode(FREQ_UC,null,'',f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||h.code_chi_name),f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||h.code_chi_name)) freq_title,
      c.guid equ_guid,c.EQU_Model,c.EQU_CODE,d.guid ant_guid,d.ANT_Model ant_title,e.ft_freq_no,f.et_equ_no,g.at_ant_no,d.ant_angle,e.ft_freq_tfcode tf_code
from v_rim_rsm_getstation st, rsbt_freq b,rsbt_equ c,rsbt_antfeed d,rsbt_freq_t e,rsbt_equ_t f,rsbt_antfeed_t g,RSBT_CODE_DIC h
where  b.guid=e.guid(+)
and st.GUID = b.station_guid(+)
and st.GUID = c.station_guid(+)
and st.GUID = d.station_guid(+)
      and c.guid=f.guid(+) and d.guid=g.guid(+) and nvl(e.ft_freq_tfcode,' ')=nvl(f.et_equ_tfcode,' ') and nvl(f.et_equ_tfcode,' ')=nvl(g.at_ant_tfcode,' ')
      and f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)=h.cn(+) and h.code_data_type(+)='00292006';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EAF_TF_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EAF_TF_R" AS 
select st.GUID Station_GUID_B,st.ST_TF_CODE stat_code_b, st.guid station_guid,b.guid freq_guid,decode(b.freq_type,'1',decode(FREQ_EFB,null,'',f_rim_rsm_GETFREQ_R(FREQ_EFB,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||'-'||f_rim_rsm_GETFREQ_R(FREQ_EFE,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||h.code_chi_name),
decode(FREQ_LC,null,decode(FREQ_UC,null,'',f_rim_rsm_GETFREQ_R(FREQ_UC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||h.code_chi_name),f_rim_rsm_GETFREQ_R(FREQ_LC,f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB))||h.code_chi_name)) freq_title,
      c.guid equ_guid,c.EQU_Model,c.EQU_CODE,d.guid ant_guid,d.ANT_Model ant_title,e.ft_freq_no,f.et_equ_no,g.at_ant_no,d.ant_angle,e.ft_freq_tfcode tf_code
from v_rim_rsm_getstation_r st, rsbt_freq_r b,rsbt_equ_r c,rsbt_antfeed_r d,rsbt_freq_t_r e,rsbt_equ_t_r f,rsbt_antfeed_t_r g,RSBT_CODE_DIC h
where  b.guid=e.guid(+)
and st.GUID = b.station_guid(+)
and st.GUID = c.station_guid(+)
and st.GUID = d.station_guid(+)
      and c.guid=f.guid(+) and d.guid=g.guid(+) and nvl(e.ft_freq_tfcode,' ')=nvl(f.et_equ_tfcode,' ') and nvl(f.et_equ_tfcode,' ')=nvl(g.at_ant_tfcode,' ')
      and f_rim_rsm_GETFREQ_freq_Unit(FREQ_LC,FREQ_UC,FREQ_EFB,FREQ_RFB)=h.cn(+) and h.code_data_type(+)='00292006';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EFA_VIEW_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EFA_VIEW_R" AS 
select
a.equ_guid,a.freq_guid,a.ant_guid,a.station_guid guid,a.guid eaf_guid,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,'r'), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--equ
c.EQU_Model,c.EQU_AUTH,c.EQU_MENU,c.EQU_Code,c.Equ_Pow,ct.ET_EQU_TFCODE,
--f_sdb_GETPOWER_W(EQU_POW,ET_pow_u) || NVL(et_pow_unit.code_chi_name,'W') et_pow_Name,
F_RIM_RSM_GETPOWER_W(EQU_POW,ET_pow_u) et_pow_Name,
c.EQU_PF,c.equ_pf Equ_PF_Name,c.equ_mb,c.equ_type,
ct.et_equ_pwid2,ct.et_equ_pup,ct.et_equ_senerr,ct.et_pow_u,ct.ET_pow_u et_pow_u_name,ct.et_equ_pr,decode(ct.et_equ_type_id,'0','收发信机','1','其它') et_equ_type_id,
ct.et_equ_upu,ct.et_equ_cl,ct.et_equ_fntval,ct.et_equ_pf,ct.et_equ_no,ct.et_equ_upow,
ct.et_equ_code,ct.et_equ_tl,ct.et_equ_epos,ct.et_equ_apos,ct.et_equ_chrip,ct.et_equ_rnq,ct.et_equ_name,
ct.et_equ_use,ct.et_equ_ccode,ct.et_eirp,ct.et_equ_rwid,ct.et_equ_esgn,ct.et_equ_atype,
ct.et_equ_pow_avg,ct.et_equ_pow_max,ct.et_equ_dnu,ct.et_af_type,ct.et_equ_dpow,ct.et_equ_type,
ct.et_equ_senu,ct.et_equ_sen,ct.et_equ_mt,ct.et_equ_sum,ct.et_equ_pdn,ct.et_equ_euse,ct.et_equ_pwid1,
ct.ET_EQU_RF,ct.ET_EQU_RF_BAND,
c.EQU_MB EQU_MB_Name,
ct.ET_AF_Type ET_AF_Type_Name,
ct.ET_EQU_Atype ET_EQU_Atype_Name,
ct.ET_EQU_SENU ET_EQU_SENU_Name,
ct.ET_EQU_SENERR ET_EQU_SENERR_Name,
ct.ET_EQU_MT ET_EQU_MT_Name,
--freq
decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) EFB1,
decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) RFB1,
decode(FREQ_TYPE,'0', to_char(FREQ_UC),'1', to_char(FREQ_EFB) || '－' || to_char(FREQ_EFE)) EFB ,FREQ_EFE,
decode(FREQ_TYPE,'0', to_char(FREQ_LC),'1', to_char(FREQ_RFB)  || '－' || to_char(FREQ_RFE)) RFB,FREQ_RFE,
d.FREQ_RFB,d.FREQ_EFB,
FREQ_E_Band,FREQ_R_Band,FREQ_MOD,
d.freq_mod FREQ_MOD_Name,d.freq_type,d.freq_mb,d.freq_code,d.freq_uc,d.freq_lc,
dt.ft_freq_timee,dt.ft_freq_mc2,dt.ft_freq_mc,dt.ft_freq_type,dt.ft_freq_frp,
dt.ft_freq_dupdn,dt.ft_freq_pow_avg,dt.ft_freq_epow,dt.ft_freq_hcl,dt.ft_freq_pow_max,dt.ft_freq_eirp,
dt.ft_freq_ccode,dt.ft_freq_mc3,dt.ft_freq_csgn,dt.ft_freq_mc1,dt.ft_freq_unit_type,dt.ft_freq_powflag,
dt.ft_freq_fep,dt.ft_freq_info_type,dt.ft_freq_no,dt.ft_freq_timeb,dt.FT_FREQ_TFCODE,
--接收频率  发射频率
'-' freq_v,'-' freq_v_r,
--发射带宽
'-' band_v,'-' band_v_R,
d.FREQ_MB FREQ_MB_Name,
dt.FT_FREQ_INFO_Type FT_FREQ_INFO_Type_Name,
dt.FT_FREQ_Type FT_FREQ_Type_Name,
dt.FT_FREQ_DUPDN FT_FREQ_DUPDN_Name,
dt.FT_FREQ_FEP FT_FREQ_FEP_Name,
dt.FT_FREQ_FRP FT_FREQ_FRP_Name,
dt.ft_freq_powflag FT_FREQ_POWFLAG_Name,' ' station_code_b ,
--antfeed
e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_Size,e.FEED_MENU,e.FEED_Model,ANT_Hight,ANT_Gain,et.AT_ANT_TFCODE,
e.FEED_Length,e.FEED_Lose,e.ant_rpole,e.ant_epole,e.ant_code,e.feed_code,e.ant_egain,e.guid antfeed_guid,
e.ant_angle,e.ANT_WORK_TYPE,e.ant_rgain,e.ant_pole,e.ant_type ANT_Type_Name,
et.at_ant_no,et.at_ant_upang,et.at_lel,et.at_bwid,et.AT_ANG_E,et.at_ang_b,et.at_ccode,et.at_unit_type,
et.at_3dbe,et.at_sspeed,et.at_rnt,et.at_qua,et.at_se_e,et.at_eang,et.at_updn,et.at_h_hpic,
et.at_se_b,et.at_csgn,et.at_3dbr,et.at_rang,et.at_sum,et.at_h_vpic,
e.ANT_WORK_TYPE ANT_WORK_TYPE_Name,
e.ANT_POLE ANT_POLE_Name,
e.ANT_RPOLE ANT_RPOLE_Name,
e.ANT_EPOLE ANT_EPOLE_Name,
et.AT_UPDN AT_UPDN_Name,'1' equ_status,'1' is_bak
from RSBT_EAF_r a,rsbt_station_r b ,rsbt_Equ_r c,rsbt_Freq_r d,rsbt_antfeed_r e,
rsbt_station_t_r bt ,Rsbt_Equ_t_r ct,rsbt_Freq_t_r dt,rsbt_antfeed_t_r et, rsbt_net_r n,RSBT_ORG n_b ,RSBT_ORG n_c
where a.station_guid = b.guid  and b.guid=bt.guid(+) and b.net_guid=n.guid(+) and
a.equ_guid=c.guid(+)  and a.equ_guid=ct.guid(+) and
a.freq_guid = d.guid(+) and a.freq_guid=dt.guid(+) and
a.ant_guid = e.guid(+) and a.ant_guid=et.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EFA_VIEW_R_T
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EFA_VIEW_R_T" AS 
select
a.equ_guid,a.freq_guid,a.ant_guid,a.station_guid guid,a.guid eaf_guid,
--station_type or memo
decode(app.app_type,'T',app.memo,'PA',app_pa.memo) app_memo,stype.typename,to_char(app.app_ftlb,'yyyy-MM-dd') app_ftlb,to_char(app.app_ftle,'yyyy-MM-dd') app_ftle,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,'r'), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--equ
c.EQU_Model,c.EQU_AUTH,c.EQU_MENU,c.EQU_Code,c.Equ_Pow,ct.ET_EQU_TFCODE,
--f_sdb_GETPOWER_W(EQU_POW,ET_pow_u) || NVL(et_pow_unit.code_chi_name,'W') et_pow_Name,
F_RIM_RSM_GETPOWER_W(EQU_POW,ET_pow_u) et_pow_Name,
c.EQU_PF,c.equ_pf Equ_PF_Name,c.equ_mb,c.equ_type,
ct.et_equ_pwid2,ct.et_equ_pup,ct.et_equ_senerr,ct.et_pow_u,ct.ET_pow_u et_pow_u_name,ct.et_equ_pr,decode(ct.et_equ_type_id,'0','收发信机','1','其它') et_equ_type_id,
ct.et_equ_upu,ct.et_equ_cl,ct.et_equ_fntval,ct.et_equ_pf,ct.et_equ_no,ct.et_equ_upow,
ct.et_equ_code,ct.et_equ_tl,ct.et_equ_epos,ct.et_equ_apos,ct.et_equ_chrip,ct.et_equ_rnq,ct.et_equ_name,
ct.et_equ_use,ct.et_equ_ccode,ct.et_eirp,ct.et_equ_rwid,ct.et_equ_esgn,ct.et_equ_atype,
ct.et_equ_pow_avg,ct.et_equ_pow_max,ct.et_equ_dnu,ct.et_af_type,ct.et_equ_dpow,ct.et_equ_type,
ct.et_equ_senu,ct.et_equ_sen,ct.et_equ_mt,ct.et_equ_sum,ct.et_equ_pdn,ct.et_equ_euse,ct.et_equ_pwid1,
ct.ET_EQU_RF,ct.ET_EQU_RF_BAND,
c.EQU_MB EQU_MB_Name,
ct.ET_AF_Type ET_AF_Type_Name,
ct.ET_EQU_Atype ET_EQU_Atype_Name,
ct.ET_EQU_SENU ET_EQU_SENU_Name,
ct.ET_EQU_SENERR ET_EQU_SENERR_Name,
ct.ET_EQU_MT ET_EQU_MT_Name,
--freq
decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) EFB1,
decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) RFB1,
decode(FREQ_TYPE,'0', to_char(FREQ_UC),'1', to_char(FREQ_EFB) || '－' || to_char(FREQ_EFE)) EFB ,FREQ_EFE,
decode(FREQ_TYPE,'0', to_char(FREQ_LC),'1', to_char(FREQ_RFB)  || '－' || to_char(FREQ_RFE)) RFB,FREQ_RFE,
d.FREQ_RFB,d.FREQ_EFB,
FREQ_E_Band,FREQ_R_Band,FREQ_MOD,
d.freq_mod FREQ_MOD_Name,d.freq_type,d.freq_mb,d.freq_code,d.freq_uc,d.freq_lc,
dt.ft_freq_timee,dt.ft_freq_mc2,dt.ft_freq_mc,dt.ft_freq_type,dt.ft_freq_frp,
dt.ft_freq_dupdn,dt.ft_freq_pow_avg,dt.ft_freq_epow,dt.ft_freq_hcl,dt.ft_freq_pow_max,dt.ft_freq_eirp,
dt.ft_freq_ccode,dt.ft_freq_mc3,dt.ft_freq_csgn,dt.ft_freq_mc1,dt.ft_freq_unit_type,dt.ft_freq_powflag,
dt.ft_freq_fep,dt.ft_freq_info_type,dt.ft_freq_no,dt.ft_freq_timeb,dt.FT_FREQ_TFCODE,
--接收频率  发射频率
'-' freq_v,'-' freq_v_r,
--发射带宽
'-' band_v,'-' band_v_R,
d.FREQ_MB FREQ_MB_Name,
dt.FT_FREQ_INFO_Type FT_FREQ_INFO_Type_Name,
dt.FT_FREQ_Type FT_FREQ_Type_Name,
dt.FT_FREQ_DUPDN FT_FREQ_DUPDN_Name,
dt.FT_FREQ_FEP FT_FREQ_FEP_Name,
dt.FT_FREQ_FRP FT_FREQ_FRP_Name,
dt.ft_freq_powflag FT_FREQ_POWFLAG_Name,' ' station_code_b ,
--antfeed
e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_Size,e.FEED_MENU,e.FEED_Model,ANT_Hight,ANT_Gain,et.AT_ANT_TFCODE,
e.FEED_Length,e.FEED_Lose,e.ant_rpole,e.ant_epole,e.ant_code,e.feed_code,e.ant_egain,e.guid antfeed_guid,
e.ant_angle,e.ANT_WORK_TYPE,e.ant_rgain,e.ant_pole,e.ant_type ANT_Type_Name,
et.at_ant_no,et.at_ant_upang,et.at_lel,et.at_bwid,et.AT_ANG_E,et.at_ang_b,et.at_ccode,et.at_unit_type,
et.at_3dbe,et.at_sspeed,et.at_rnt,et.at_qua,et.at_se_e,et.at_eang,et.at_updn,et.at_h_hpic,
et.at_se_b,et.at_csgn,et.at_3dbr,et.at_rang,et.at_sum,et.at_h_vpic,
e.ANT_WORK_TYPE ANT_WORK_TYPE_Name,
e.ANT_POLE ANT_POLE_Name,
e.ANT_RPOLE ANT_RPOLE_Name,
e.ANT_EPOLE ANT_EPOLE_Name,
et.AT_UPDN AT_UPDN_Name,'1' equ_status,'1' is_bak
from RSBT_EAF_r a,rsbt_station_r b ,rsbt_Equ_r c,rsbt_Freq_r d,rsbt_antfeed_r e,rsbt_apply_r app,rsbt_apply_pa_r app_pa,t_rim_rsm_stat_type_relev_r srelev,t_rim_rsm_station_type stype,
rsbt_station_t_r bt ,Rsbt_Equ_t_r ct,rsbt_Freq_t_r dt,rsbt_antfeed_t_r et, rsbt_net_r n,RSBT_ORG n_b ,RSBT_ORG n_c
where a.station_guid = b.guid  and b.guid=bt.guid(+) and b.net_guid=n.guid(+)
and b.app_code=app.app_code(+) and app.guid=app_pa.app_guid(+) and b.guid=srelev.stat_guid(+) and srelev.stat_type_guid=stype.guid(+) and
a.equ_guid=c.guid(+)  and a.equ_guid=ct.guid(+) and
a.freq_guid = d.guid(+) and a.freq_guid=dt.guid(+) and
a.ant_guid = e.guid(+) and a.ant_guid=et.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EFA_VIEW_SEAL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EFA_VIEW_SEAL" AS 
select
a.equ_guid,a.freq_guid,a.ant_guid,a.station_guid guid,a.guid eaf_guid,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--equ
c.EQU_Model,c.EQU_AUTH,c.EQU_MENU,c.EQU_Code,c.Equ_Pow,ct.ET_EQU_TFCODE,
--f_sdb_GETPOWER_W(EQU_POW,ET_pow_u) || NVL(et_pow_unit.code_chi_name,'W') et_pow_Name,
F_RIM_RSM_GETPOWER_W(EQU_POW,ET_pow_u) et_pow_Name,
c.EQU_PF,c.equ_pf Equ_PF_Name,c.equ_mb,c.equ_type,
ct.et_equ_pwid2,ct.et_equ_pup,ct.et_equ_senerr,ct.et_pow_u,ct.ET_pow_u et_pow_u_name,ct.et_equ_pr,decode(ct.et_equ_type_id,'0','收发信机','1','其它') et_equ_type_id,
ct.et_equ_upu,ct.et_equ_cl,ct.et_equ_fntval,ct.et_equ_pf,ct.et_equ_no,ct.et_equ_upow,
ct.et_equ_code,ct.et_equ_tl,ct.et_equ_epos,ct.et_equ_apos,ct.et_equ_chrip,ct.et_equ_rnq,ct.et_equ_name,
ct.et_equ_use,ct.et_equ_ccode,ct.et_eirp,ct.et_equ_rwid,ct.et_equ_esgn,ct.et_equ_atype,
ct.et_equ_pow_avg,ct.et_equ_pow_max,ct.et_equ_dnu,ct.et_af_type,ct.et_equ_dpow,ct.et_equ_type,
ct.et_equ_senu,ct.et_equ_sen,ct.et_equ_mt,ct.et_equ_sum,ct.et_equ_pdn,ct.et_equ_euse,ct.et_equ_pwid1,
ct.ET_EQU_RF,ct.ET_EQU_RF_BAND,
c.EQU_MB EQU_MB_Name,
ct.ET_AF_Type ET_AF_Type_Name,
ct.ET_EQU_Atype ET_EQU_Atype_Name,
ct.ET_EQU_SENU ET_EQU_SENU_Name,
ct.ET_EQU_SENERR ET_EQU_SENERR_Name,
ct.ET_EQU_MT ET_EQU_MT_Name,
--freq
decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) EFB1,
decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) RFB1,
decode(FREQ_TYPE,'0', to_char(FREQ_UC),'1', to_char(FREQ_EFB) || '－' || to_char(FREQ_EFE)) EFB ,FREQ_EFE,
decode(FREQ_TYPE,'0', to_char(FREQ_LC),'1', to_char(FREQ_RFB)  || '－' || to_char(FREQ_RFE)) RFB,FREQ_RFE,
d.FREQ_RFB,d.FREQ_EFB,
FREQ_E_Band,FREQ_R_Band,FREQ_MOD,
d.freq_mod FREQ_MOD_Name,d.freq_type,d.freq_mb,d.freq_code,d.freq_uc,d.freq_lc,
dt.ft_freq_timee,dt.ft_freq_mc2,dt.ft_freq_mc,dt.ft_freq_type,dt.ft_freq_frp,
dt.ft_freq_dupdn,dt.ft_freq_pow_avg,dt.ft_freq_epow,dt.ft_freq_hcl,dt.ft_freq_pow_max,dt.ft_freq_eirp,
dt.ft_freq_ccode,dt.ft_freq_mc3,dt.ft_freq_csgn,dt.ft_freq_mc1,dt.ft_freq_unit_type,dt.ft_freq_powflag,
dt.ft_freq_fep,dt.ft_freq_info_type,dt.ft_freq_no,dt.ft_freq_timeb,dt.FT_FREQ_TFCODE,
--接收频率  发射频率
'-' freq_v,'-' freq_v_r,
--发射带宽
'-' band_v,'-' band_v_R,
d.FREQ_MB FREQ_MB_Name,
dt.FT_FREQ_INFO_Type FT_FREQ_INFO_Type_Name,
dt.FT_FREQ_Type FT_FREQ_Type_Name,
dt.FT_FREQ_DUPDN FT_FREQ_DUPDN_Name,
dt.FT_FREQ_FEP FT_FREQ_FEP_Name,
dt.FT_FREQ_FRP FT_FREQ_FRP_Name,
dt.ft_freq_powflag FT_FREQ_POWFLAG_Name,' ' station_code_b ,
--antfeed
e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_Size,e.FEED_MENU,e.FEED_Model,ANT_Hight,ANT_Gain,et.AT_ANT_TFCODE,
e.FEED_Length,e.FEED_Lose,e.ant_rpole,e.ant_epole,e.ant_code,e.feed_code,e.ant_egain,e.guid antfeed_guid,
e.ant_angle,e.ANT_WORK_TYPE,e.ant_rgain,e.ant_pole,e.ant_type ANT_Type_Name,
et.at_ant_no,et.at_ant_upang,et.at_lel,et.at_bwid,et.AT_ANG_E,et.at_ang_b,et.at_ccode,et.at_unit_type,
et.at_3dbe,et.at_sspeed,et.at_rnt,et.at_qua,et.at_se_e,et.at_eang,et.at_updn,et.at_h_hpic,
et.at_se_b,et.at_csgn,et.at_3dbr,et.at_rang,et.at_sum,et.at_h_vpic,
e.ANT_WORK_TYPE ANT_WORK_TYPE_Name,
e.ANT_POLE ANT_POLE_Name,
e.ANT_RPOLE ANT_RPOLE_Name,
e.ANT_EPOLE ANT_EPOLE_Name,
et.AT_UPDN AT_UPDN_Name ,nvl(e_exp.equ_status,'1') equ_status,'0' is_bak
from RSBT_EAF_h a,rsbt_station_h b ,rsbt_Equ_h c,rsbt_Freq_h d,rsbt_antfeed_h e,
rsbt_station_t_h bt ,Rsbt_Equ_t_h ct,rsbt_Freq_t_h dt,rsbt_antfeed_t_h et, rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c ,t_rim_rsm_equ_expand e_exp
where b.stat_status='0' and a.station_guid = b.guid  and b.guid=bt.guid(+) and b.net_guid=n.guid(+) and c.guid=e_exp.guid(+) and nvl(e_exp.equ_status,'1')='1' and
a.equ_guid=c.guid(+)  and a.equ_guid=ct.guid(+) and
a.freq_guid = d.guid(+) and a.freq_guid=dt.guid(+) and
a.ant_guid = e.guid(+) and a.ant_guid=et.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EFA_VIEW_SEAL_T
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EFA_VIEW_SEAL_T" AS 
select
a.equ_guid,a.freq_guid,a.ant_guid,a.station_guid guid,a.guid eaf_guid,
--station_type or memo
decode(app.app_type,'T',app.memo,'PA',app_pa.memo) app_memo,'' typename,to_char(app.app_ftlb,'yyyy-MM-dd') app_ftlb,to_char(app.app_ftle,'yyyy-MM-dd') app_ftle,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--equ
c.EQU_Model,c.EQU_AUTH,c.EQU_MENU,c.EQU_Code,c.Equ_Pow,ct.ET_EQU_TFCODE,
--f_sdb_GETPOWER_W(EQU_POW,ET_pow_u) || NVL(et_pow_unit.code_chi_name,'W') et_pow_Name,
F_RIM_RSM_GETPOWER_W(EQU_POW,ET_pow_u) et_pow_Name,
c.EQU_PF,c.equ_pf Equ_PF_Name,c.equ_mb,c.equ_type,
ct.et_equ_pwid2,ct.et_equ_pup,ct.et_equ_senerr,ct.et_pow_u,ct.ET_pow_u et_pow_u_name,ct.et_equ_pr,decode(ct.et_equ_type_id,'0','收发信机','1','其它') et_equ_type_id,
ct.et_equ_upu,ct.et_equ_cl,ct.et_equ_fntval,ct.et_equ_pf,ct.et_equ_no,ct.et_equ_upow,
ct.et_equ_code,ct.et_equ_tl,ct.et_equ_epos,ct.et_equ_apos,ct.et_equ_chrip,ct.et_equ_rnq,ct.et_equ_name,
ct.et_equ_use,ct.et_equ_ccode,ct.et_eirp,ct.et_equ_rwid,ct.et_equ_esgn,ct.et_equ_atype,
ct.et_equ_pow_avg,ct.et_equ_pow_max,ct.et_equ_dnu,ct.et_af_type,ct.et_equ_dpow,ct.et_equ_type,
ct.et_equ_senu,ct.et_equ_sen,ct.et_equ_mt,ct.et_equ_sum,ct.et_equ_pdn,ct.et_equ_euse,ct.et_equ_pwid1,
ct.ET_EQU_RF,ct.ET_EQU_RF_BAND,
c.EQU_MB EQU_MB_Name,
ct.ET_AF_Type ET_AF_Type_Name,
ct.ET_EQU_Atype ET_EQU_Atype_Name,
ct.ET_EQU_SENU ET_EQU_SENU_Name,
ct.ET_EQU_SENERR ET_EQU_SENERR_Name,
ct.ET_EQU_MT ET_EQU_MT_Name,
--freq
decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) EFB1,
decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) RFB1,
decode(FREQ_TYPE,'0', to_char(FREQ_UC),'1', to_char(FREQ_EFB) || '－' || to_char(FREQ_EFE)) EFB ,FREQ_EFE,
decode(FREQ_TYPE,'0', to_char(FREQ_LC),'1', to_char(FREQ_RFB)  || '－' || to_char(FREQ_RFE)) RFB,FREQ_RFE,
d.FREQ_RFB,d.FREQ_EFB,
FREQ_E_Band,FREQ_R_Band,FREQ_MOD,
d.freq_mod FREQ_MOD_Name,d.freq_type,d.freq_mb,d.freq_code,d.freq_uc,d.freq_lc,
dt.ft_freq_timee,dt.ft_freq_mc2,dt.ft_freq_mc,dt.ft_freq_type,dt.ft_freq_frp,
dt.ft_freq_dupdn,dt.ft_freq_pow_avg,dt.ft_freq_epow,dt.ft_freq_hcl,dt.ft_freq_pow_max,dt.ft_freq_eirp,
dt.ft_freq_ccode,dt.ft_freq_mc3,dt.ft_freq_csgn,dt.ft_freq_mc1,dt.ft_freq_unit_type,dt.ft_freq_powflag,
dt.ft_freq_fep,dt.ft_freq_info_type,dt.ft_freq_no,dt.ft_freq_timeb,dt.FT_FREQ_TFCODE,
--接收频率  发射频率
'-' freq_v,'-' freq_v_r,
--发射带宽
'-' band_v,'-' band_v_R,
d.FREQ_MB FREQ_MB_Name,
dt.FT_FREQ_INFO_Type FT_FREQ_INFO_Type_Name,
dt.FT_FREQ_Type FT_FREQ_Type_Name,
dt.FT_FREQ_DUPDN FT_FREQ_DUPDN_Name,
dt.FT_FREQ_FEP FT_FREQ_FEP_Name,
dt.FT_FREQ_FRP FT_FREQ_FRP_Name,
dt.ft_freq_powflag FT_FREQ_POWFLAG_Name,' ' station_code_b ,
--antfeed
e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_Size,e.FEED_MENU,e.FEED_Model,ANT_Hight,ANT_Gain,et.AT_ANT_TFCODE,
e.FEED_Length,e.FEED_Lose,e.ant_rpole,e.ant_epole,e.ant_code,e.feed_code,e.ant_egain,e.guid antfeed_guid,
e.ant_angle,e.ANT_WORK_TYPE,e.ant_rgain,e.ant_pole,e.ant_type ANT_Type_Name,
et.at_ant_no,et.at_ant_upang,et.at_lel,et.at_bwid,et.AT_ANG_E,et.at_ang_b,et.at_ccode,et.at_unit_type,
et.at_3dbe,et.at_sspeed,et.at_rnt,et.at_qua,et.at_se_e,et.at_eang,et.at_updn,et.at_h_hpic,
et.at_se_b,et.at_csgn,et.at_3dbr,et.at_rang,et.at_sum,et.at_h_vpic,
e.ANT_WORK_TYPE ANT_WORK_TYPE_Name,
e.ANT_POLE ANT_POLE_Name,
e.ANT_RPOLE ANT_RPOLE_Name,
e.ANT_EPOLE ANT_EPOLE_Name,
et.AT_UPDN AT_UPDN_Name ,nvl(e_exp.equ_status,'1') equ_status,'0' is_bak
from RSBT_EAF_h a,rsbt_station_h b ,rsbt_Equ_h c,rsbt_Freq_h d,rsbt_antfeed_h e,rsbt_apply app,rsbt_apply_pa app_pa,
rsbt_station_t_h bt ,Rsbt_Equ_t_h ct,rsbt_Freq_t_h dt,rsbt_antfeed_t_h et, rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c ,t_rim_rsm_equ_expand e_exp
where b.stat_status='0' and a.station_guid = b.guid  and b.guid=bt.guid(+) and b.net_guid=n.guid(+) and c.guid=e_exp.guid(+) and nvl(e_exp.equ_status,'1')='1' and
 b.app_code=app.app_code and app.guid=app_pa.app_guid(+) and
a.equ_guid=c.guid(+)  and a.equ_guid=ct.guid(+) and
a.freq_guid = d.guid(+) and a.freq_guid=dt.guid(+) and
a.ant_guid = e.guid(+) and a.ant_guid=et.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+)
--申请表在历史库中
union all
select
a.equ_guid,a.freq_guid,a.ant_guid,a.station_guid guid,a.guid eaf_guid,
--station_type or memo
decode(app.app_type,'T',app.memo,'PA',app_pa.memo) app_memo,'' typename,to_char(app.app_ftlb,'yyyy-MM-dd') app_ftlb,to_char(app.app_ftle,'yyyy-MM-dd') app_ftle,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--equ
c.EQU_Model,c.EQU_AUTH,c.EQU_MENU,c.EQU_Code,c.Equ_Pow,ct.ET_EQU_TFCODE,
--f_sdb_GETPOWER_W(EQU_POW,ET_pow_u) || NVL(et_pow_unit.code_chi_name,'W') et_pow_Name,
F_RIM_RSM_GETPOWER_W(EQU_POW,ET_pow_u) et_pow_Name,
c.EQU_PF,c.equ_pf Equ_PF_Name,c.equ_mb,c.equ_type,
ct.et_equ_pwid2,ct.et_equ_pup,ct.et_equ_senerr,ct.et_pow_u,ct.ET_pow_u et_pow_u_name,ct.et_equ_pr,decode(ct.et_equ_type_id,'0','收发信机','1','其它') et_equ_type_id,
ct.et_equ_upu,ct.et_equ_cl,ct.et_equ_fntval,ct.et_equ_pf,ct.et_equ_no,ct.et_equ_upow,
ct.et_equ_code,ct.et_equ_tl,ct.et_equ_epos,ct.et_equ_apos,ct.et_equ_chrip,ct.et_equ_rnq,ct.et_equ_name,
ct.et_equ_use,ct.et_equ_ccode,ct.et_eirp,ct.et_equ_rwid,ct.et_equ_esgn,ct.et_equ_atype,
ct.et_equ_pow_avg,ct.et_equ_pow_max,ct.et_equ_dnu,ct.et_af_type,ct.et_equ_dpow,ct.et_equ_type,
ct.et_equ_senu,ct.et_equ_sen,ct.et_equ_mt,ct.et_equ_sum,ct.et_equ_pdn,ct.et_equ_euse,ct.et_equ_pwid1,
ct.ET_EQU_RF,ct.ET_EQU_RF_BAND,
c.EQU_MB EQU_MB_Name,
ct.ET_AF_Type ET_AF_Type_Name,
ct.ET_EQU_Atype ET_EQU_Atype_Name,
ct.ET_EQU_SENU ET_EQU_SENU_Name,
ct.ET_EQU_SENERR ET_EQU_SENERR_Name,
ct.ET_EQU_MT ET_EQU_MT_Name,
--freq
decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) EFB1,
decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) RFB1,
decode(FREQ_TYPE,'0', to_char(FREQ_UC),'1', to_char(FREQ_EFB) || '－' || to_char(FREQ_EFE)) EFB ,FREQ_EFE,
decode(FREQ_TYPE,'0', to_char(FREQ_LC),'1', to_char(FREQ_RFB)  || '－' || to_char(FREQ_RFE)) RFB,FREQ_RFE,
d.FREQ_RFB,d.FREQ_EFB,
FREQ_E_Band,FREQ_R_Band,FREQ_MOD,
d.freq_mod FREQ_MOD_Name,d.freq_type,d.freq_mb,d.freq_code,d.freq_uc,d.freq_lc,
dt.ft_freq_timee,dt.ft_freq_mc2,dt.ft_freq_mc,dt.ft_freq_type,dt.ft_freq_frp,
dt.ft_freq_dupdn,dt.ft_freq_pow_avg,dt.ft_freq_epow,dt.ft_freq_hcl,dt.ft_freq_pow_max,dt.ft_freq_eirp,
dt.ft_freq_ccode,dt.ft_freq_mc3,dt.ft_freq_csgn,dt.ft_freq_mc1,dt.ft_freq_unit_type,dt.ft_freq_powflag,
dt.ft_freq_fep,dt.ft_freq_info_type,dt.ft_freq_no,dt.ft_freq_timeb,dt.FT_FREQ_TFCODE,
--接收频率  发射频率
'-' freq_v,'-' freq_v_r,
--发射带宽
'-' band_v,'-' band_v_R,
d.FREQ_MB FREQ_MB_Name,
dt.FT_FREQ_INFO_Type FT_FREQ_INFO_Type_Name,
dt.FT_FREQ_Type FT_FREQ_Type_Name,
dt.FT_FREQ_DUPDN FT_FREQ_DUPDN_Name,
dt.FT_FREQ_FEP FT_FREQ_FEP_Name,
dt.FT_FREQ_FRP FT_FREQ_FRP_Name,
dt.ft_freq_powflag FT_FREQ_POWFLAG_Name,' ' station_code_b ,
--antfeed
e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_Size,e.FEED_MENU,e.FEED_Model,ANT_Hight,ANT_Gain,et.AT_ANT_TFCODE,
e.FEED_Length,e.FEED_Lose,e.ant_rpole,e.ant_epole,e.ant_code,e.feed_code,e.ant_egain,e.guid antfeed_guid,
e.ant_angle,e.ANT_WORK_TYPE,e.ant_rgain,e.ant_pole,e.ant_type ANT_Type_Name,
et.at_ant_no,et.at_ant_upang,et.at_lel,et.at_bwid,et.AT_ANG_E,et.at_ang_b,et.at_ccode,et.at_unit_type,
et.at_3dbe,et.at_sspeed,et.at_rnt,et.at_qua,et.at_se_e,et.at_eang,et.at_updn,et.at_h_hpic,
et.at_se_b,et.at_csgn,et.at_3dbr,et.at_rang,et.at_sum,et.at_h_vpic,
e.ANT_WORK_TYPE ANT_WORK_TYPE_Name,
e.ANT_POLE ANT_POLE_Name,
e.ANT_RPOLE ANT_RPOLE_Name,
e.ANT_EPOLE ANT_EPOLE_Name,
et.AT_UPDN AT_UPDN_Name ,nvl(e_exp.equ_status,'1') equ_status,'0' is_bak
from RSBT_EAF_h a,rsbt_station_h b ,rsbt_Equ_h c,rsbt_Freq_h d,rsbt_antfeed_h e,rsbt_apply_h app,rsbt_apply_pa_h app_pa,
rsbt_station_t_h bt ,Rsbt_Equ_t_h ct,rsbt_Freq_t_h dt,rsbt_antfeed_t_h et, rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c ,t_rim_rsm_equ_expand e_exp
where b.stat_status='0' and a.station_guid = b.guid  and b.guid=bt.guid(+) and b.net_guid=n.guid(+) and c.guid=e_exp.guid(+) and nvl(e_exp.equ_status,'1')='1' and
 b.app_code=app.app_code and app.guid=app_pa.app_guid(+) and
a.equ_guid=c.guid(+)  and a.equ_guid=ct.guid(+) and
a.freq_guid = d.guid(+) and a.freq_guid=dt.guid(+) and
a.ant_guid = e.guid(+) and a.ant_guid=et.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EFA_VIEW_SIMPLE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EFA_VIEW_SIMPLE" AS 
select
a.equ_guid,a.freq_guid,a.ant_guid,a.station_guid guid,a.guid eaf_guid,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
F_RIM_RSM_GetDCByDCode('00012006',n.net_ts) net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,F_RIM_RSM_GetDCByDCode('00452006',n.net_svn) net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--equ
c.EQU_Model,c.EQU_AUTH,c.EQU_MENU,c.EQU_Code,c.Equ_Pow,ct.ET_EQU_TFCODE,
--f_sdb_GETPOWER_W(EQU_POW,ET_pow_u) || NVL(et_pow_unit.code_chi_name,'W') et_pow_Name,
F_RIM_RSM_GETPOWER_W(EQU_POW,ET_pow_u) et_pow_Name,
c.EQU_PF,c.equ_pf Equ_PF_Name,c.equ_mb,c.equ_type,
ct.et_equ_pwid2,ct.et_equ_pup,ct.et_equ_senerr,ct.et_pow_u,ct.ET_pow_u et_pow_u_name,ct.et_equ_pr,decode(ct.et_equ_type_id,'0','收发信机','1','其它') et_equ_type_id,
ct.et_equ_upu,ct.et_equ_cl,ct.et_equ_fntval,ct.et_equ_pf,ct.et_equ_no,ct.et_equ_upow,
ct.et_equ_code,ct.et_equ_tl,ct.et_equ_epos,ct.et_equ_apos,ct.et_equ_chrip,ct.et_equ_rnq,ct.et_equ_name,
ct.et_equ_use,ct.et_equ_ccode,ct.et_eirp,ct.et_equ_rwid,ct.et_equ_esgn,ct.et_equ_atype,
ct.et_equ_pow_avg,ct.et_equ_pow_max,ct.et_equ_dnu,ct.et_af_type,ct.et_equ_dpow,ct.et_equ_type,
ct.et_equ_senu,ct.et_equ_sen,ct.et_equ_mt,ct.et_equ_sum,ct.et_equ_pdn,ct.et_equ_euse,ct.et_equ_pwid1,
ct.ET_EQU_RF,ct.ET_EQU_RF_BAND,
c.EQU_MB EQU_MB_Name,
ct.ET_AF_Type ET_AF_Type_Name,
ct.ET_EQU_Atype ET_EQU_Atype_Name,
ct.ET_EQU_SENU ET_EQU_SENU_Name,
ct.ET_EQU_SENERR ET_EQU_SENERR_Name,
ct.ET_EQU_MT ET_EQU_MT_Name,
--freq
decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) EFB1,
decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) RFB1,
decode(FREQ_TYPE,'0', to_char(FREQ_UC),'1', to_char(FREQ_EFB) || '－' || to_char(FREQ_EFE)) EFB ,FREQ_EFE,
decode(FREQ_TYPE,'0', to_char(FREQ_LC),'1', to_char(FREQ_RFB)  || '－' || to_char(FREQ_RFE)) RFB,FREQ_RFE,
d.FREQ_RFB,d.FREQ_EFB,
FREQ_E_Band,FREQ_R_Band,FREQ_MOD,
F_RIM_RSM_GetDCByDCode('00272006',d.freq_mod) FREQ_MOD_Name,d.freq_type,d.freq_mb,d.freq_code,d.freq_uc,d.freq_lc,
dt.ft_freq_timee,dt.ft_freq_mc2,dt.ft_freq_mc,dt.ft_freq_type,dt.ft_freq_frp,
dt.ft_freq_dupdn,dt.ft_freq_pow_avg,dt.ft_freq_epow,dt.ft_freq_hcl,dt.ft_freq_pow_max,dt.ft_freq_eirp,
dt.ft_freq_ccode,dt.ft_freq_mc3,dt.ft_freq_csgn,dt.ft_freq_mc1,dt.ft_freq_unit_type,dt.ft_freq_powflag,
dt.ft_freq_fep,dt.ft_freq_info_type,dt.ft_freq_no,dt.ft_freq_timeb,dt.FT_FREQ_TFCODE,
--接收频率  发射频率
'-' freq_v,'-' freq_v_r,
--发射带宽
'-' band_v,'-' band_v_R,
d.FREQ_MB FREQ_MB_Name,
dt.FT_FREQ_INFO_Type FT_FREQ_INFO_Type_Name,
dt.FT_FREQ_Type FT_FREQ_Type_Name,
dt.FT_FREQ_DUPDN FT_FREQ_DUPDN_Name,
dt.FT_FREQ_FEP FT_FREQ_FEP_Name,
dt.FT_FREQ_FRP FT_FREQ_FRP_Name,
dt.ft_freq_powflag FT_FREQ_POWFLAG_Name,' ' station_code_b ,
--antfeed
e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_Size,e.FEED_MENU,e.FEED_Model,ANT_Hight,ANT_Gain,et.AT_ANT_TFCODE,
e.FEED_Length,e.FEED_Lose,e.ant_rpole,e.ant_epole,e.ant_code,e.feed_code,e.ant_egain,e.guid antfeed_guid,
e.ant_angle,e.ANT_WORK_TYPE,e.ant_rgain,e.ant_pole,e.ant_type ANT_Type_Name,
et.at_ant_no,et.at_ant_upang,et.at_lel,et.at_bwid,et.AT_ANG_E,et.at_ang_b,et.at_ccode,et.at_unit_type,
et.at_3dbe,et.at_sspeed,et.at_rnt,et.at_qua,et.at_se_e,et.at_eang,et.at_updn,et.at_h_hpic,
et.at_se_b,et.at_csgn,et.at_3dbr,et.at_rang,et.at_sum,et.at_h_vpic,
e.ANT_WORK_TYPE ANT_WORK_TYPE_Name,
e.ANT_POLE ANT_POLE_Name,
e.ANT_RPOLE ANT_RPOLE_Name,
e.ANT_EPOLE ANT_EPOLE_Name,
et.AT_UPDN AT_UPDN_Name ,nvl(e_exp.equ_status,'1') equ_status,'0' is_bak
from RSBT_EAF a,rsbt_station b ,rsbt_Equ c,rsbt_Freq d,rsbt_antfeed e,
rsbt_station_t bt ,Rsbt_Equ_t ct,rsbt_Freq_t dt,rsbt_antfeed_t et, rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c ,t_rim_rsm_equ_expand e_exp

where a.station_guid = b.guid  and b.guid=bt.guid(+) and b.net_guid=n.guid(+) and c.guid=e_exp.guid(+) and nvl(e_exp.equ_status,'1')='1' and
a.equ_guid=c.guid(+)  and a.equ_guid=ct.guid(+) and
a.freq_guid = d.guid(+) and a.freq_guid=dt.guid(+) and
a.ant_guid = e.guid(+) and a.ant_guid=et.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EFA_VIEW_TYPE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EFA_VIEW_TYPE" AS 
select
a.equ_guid,a.freq_guid,a.ant_guid,a.station_guid guid,a.guid eaf_guid,
--station_type or memo
decode(app.app_type,'T',app.memo,'PA',app_pa.memo) app_memo,stype.typename,to_char(app.app_ftlb,'yyyy-MM-dd') app_ftlb,to_char(app.app_ftle,'yyyy-MM-dd') app_ftle,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--equ
c.EQU_Model,c.EQU_AUTH,c.EQU_MENU,c.EQU_Code,c.Equ_Pow,ct.ET_EQU_TFCODE,
--f_sdb_GETPOWER_W(EQU_POW,ET_pow_u) || NVL(et_pow_unit.code_chi_name,'W') et_pow_Name,
F_RIM_RSM_GETPOWER_W(EQU_POW,ET_pow_u) et_pow_Name,
c.EQU_PF,c.equ_pf Equ_PF_Name,c.equ_mb,c.equ_type,
ct.et_equ_pwid2,ct.et_equ_pup,ct.et_equ_senerr,ct.et_pow_u,ct.ET_pow_u et_pow_u_name,ct.et_equ_pr,decode(ct.et_equ_type_id,'0','收发信机','1','其它') et_equ_type_id,
ct.et_equ_upu,ct.et_equ_cl,ct.et_equ_fntval,ct.et_equ_pf,ct.et_equ_no,ct.et_equ_upow,
ct.et_equ_code,ct.et_equ_tl,ct.et_equ_epos,ct.et_equ_apos,ct.et_equ_chrip,ct.et_equ_rnq,ct.et_equ_name,
ct.et_equ_use,ct.et_equ_ccode,ct.et_eirp,ct.et_equ_rwid,ct.et_equ_esgn,ct.et_equ_atype,
ct.et_equ_pow_avg,ct.et_equ_pow_max,ct.et_equ_dnu,ct.et_af_type,ct.et_equ_dpow,ct.et_equ_type,
ct.et_equ_senu,ct.et_equ_sen,ct.et_equ_mt,ct.et_equ_sum,ct.et_equ_pdn,ct.et_equ_euse,ct.et_equ_pwid1,
ct.ET_EQU_RF,ct.ET_EQU_RF_BAND,
c.EQU_MB EQU_MB_Name,
ct.ET_AF_Type ET_AF_Type_Name,
ct.ET_EQU_Atype ET_EQU_Atype_Name,
ct.ET_EQU_SENU ET_EQU_SENU_Name,
ct.ET_EQU_SENERR ET_EQU_SENERR_Name,
ct.ET_EQU_MT ET_EQU_MT_Name,
--freq
decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) EFB1,
decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) RFB1,
decode(FREQ_TYPE,'0', to_char(FREQ_UC),'1', to_char(FREQ_EFB) || '－' || to_char(FREQ_EFE)) EFB ,FREQ_EFE,
decode(FREQ_TYPE,'0', to_char(FREQ_LC),'1', to_char(FREQ_RFB)  || '－' || to_char(FREQ_RFE)) RFB,FREQ_RFE,
d.FREQ_RFB,d.FREQ_EFB,
FREQ_E_Band,FREQ_R_Band,FREQ_MOD,
d.freq_mod FREQ_MOD_Name,d.freq_type,d.freq_mb,d.freq_code,d.freq_uc,d.freq_lc,
dt.ft_freq_timee,dt.ft_freq_mc2,dt.ft_freq_mc,dt.ft_freq_type,dt.ft_freq_frp,
dt.ft_freq_dupdn,dt.ft_freq_pow_avg,dt.ft_freq_epow,dt.ft_freq_hcl,dt.ft_freq_pow_max,dt.ft_freq_eirp,
dt.ft_freq_ccode,dt.ft_freq_mc3,dt.ft_freq_csgn,dt.ft_freq_mc1,dt.ft_freq_unit_type,dt.ft_freq_powflag,
dt.ft_freq_fep,dt.ft_freq_info_type,dt.ft_freq_no,dt.ft_freq_timeb,dt.FT_FREQ_TFCODE,
--接收频率  发射频率
'-' freq_v,'-' freq_v_r,
--发射带宽
'-' band_v,'-' band_v_R,
d.FREQ_MB FREQ_MB_Name,
dt.FT_FREQ_INFO_Type FT_FREQ_INFO_Type_Name,
dt.FT_FREQ_Type FT_FREQ_Type_Name,
dt.FT_FREQ_DUPDN FT_FREQ_DUPDN_Name,
dt.FT_FREQ_FEP FT_FREQ_FEP_Name,
dt.FT_FREQ_FRP FT_FREQ_FRP_Name,
dt.ft_freq_powflag FT_FREQ_POWFLAG_Name,' ' station_code_b ,
--antfeed
e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_Size,e.FEED_MENU,e.FEED_Model,ANT_Hight,ANT_Gain,et.AT_ANT_TFCODE,
e.FEED_Length,e.FEED_Lose,e.ant_rpole,e.ant_epole,e.ant_code,e.feed_code,e.ant_egain,e.guid antfeed_guid,
e.ant_angle,e.ANT_WORK_TYPE,e.ant_rgain,e.ant_pole,e.ant_type ANT_Type_Name,
et.at_ant_no,et.at_ant_upang,et.at_lel,et.at_bwid,et.AT_ANG_E,et.at_ang_b,et.at_ccode,et.at_unit_type,
et.at_3dbe,et.at_sspeed,et.at_rnt,et.at_qua,et.at_se_e,et.at_eang,et.at_updn,et.at_h_hpic,
et.at_se_b,et.at_csgn,et.at_3dbr,et.at_rang,et.at_sum,et.at_h_vpic,
e.ANT_WORK_TYPE ANT_WORK_TYPE_Name,
e.ANT_POLE ANT_POLE_Name,
e.ANT_RPOLE ANT_RPOLE_Name,
e.ANT_EPOLE ANT_EPOLE_Name,
et.AT_UPDN AT_UPDN_Name ,nvl(e_exp.equ_status,'1') equ_status,'0' is_bak
from RSBT_EAF a,rsbt_station b ,rsbt_Equ c,rsbt_Freq d,rsbt_antfeed e,rsbt_apply app,rsbt_apply_pa app_pa,t_rim_rsm_stat_type_relev srelev,t_rim_rsm_station_type stype,
rsbt_station_t bt ,Rsbt_Equ_t ct,rsbt_Freq_t dt,rsbt_antfeed_t et, rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c ,t_rim_rsm_equ_expand e_exp
where a.station_guid = b.guid  and b.guid=bt.guid(+) and b.net_guid=n.guid(+) and c.guid=e_exp.guid(+) and nvl(e_exp.equ_status,'1')='1'
and b.app_code=app.app_code(+) and app.guid=app_pa.app_guid(+) and b.guid=srelev.stat_guid(+) and srelev.stat_type_guid=stype.guid(+) and
a.equ_guid=c.guid(+)  and a.equ_guid=ct.guid(+) and
a.freq_guid = d.guid(+) and a.freq_guid=dt.guid(+) and
a.ant_guid = e.guid(+) and a.ant_guid=et.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EQU
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EQU" AS 
SELECT A.GUID,STATION_GUID,EQU_TYPE,EQU_MODEL,EQU_AUTH,EQU_MENU,EQU_CODE,EQU_PF,f_RIM_RSM_GETPOWER_W(EQU_POW,ET_pow_u) EQU_POW,EQU_MB,
    ET_EQU_NO,ET_AF_TYPE,ET_EIRP,ET_POW_U,ET_EQU_CL,ET_EQU_TL,ET_EQU_RNQ,ET_EQU_TYPE_ID,
    ET_EQU_NAME,ET_EQU_CODE,ET_EQU_ESGN,ET_EQU_EPOS,ET_EQU_ATYPE,ET_EQU_APOS,ET_EQU_SUM,ET_EQU_EUSE,
    ET_EQU_FNTVAL,ET_EQU_PUP,ET_EQU_PDN,ET_EQU_CHRIP,ET_EQU_PWID1,ET_EQU_PWID2,ET_EQU_PR,ET_EQU_PF,
    ET_EQU_SEN,ET_EQU_SENU,ET_EQU_SENERR,ET_EQU_RWID,ET_EQU_MT,ET_EQU_CCODE,ET_EQU_UPU,ET_EQU_DNU,
    ET_EQU_TYPE,ET_EQU_USE,ET_EQU_POW_MAX,ET_EQU_POW_AVG ,b.ET_EQU_UPOW,b.ET_EQU_DPOW,b.ET_EQU_RF,
    b.ET_EQU_RF_BAND,
    C.net_guid,C.ORG_Code,C.APP_Code,C.STAT_APP_Type,C.STAT_TDI,C.STAT_Name,C.STAT_ADDR,
    C.STAT_Area_Code,C.STAT_Type,C.STAT_Work,C.STAT_Status,C.STAT_EQU_SUM,C.STAT_LG,C.STAT_LA,C.STAT_AT,
    C.STAT_Date_Start,C.MEMO,nvl(d.equ_status,'1') equ_status
from rsbt_EQU a,rsbt_EQU_t b,RSBT_STATION C,t_rim_rsm_equ_expand d
where a.guid=b.guid(+) AND A.STATION_GUID=C.GUID and a.guid=d.guid(+) and nvl(d.equ_status,'1')='1';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EQU_ANT_SEARCH
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EQU_ANT_SEARCH" AS 
select
c.guid equ_guid,e.guid ant_guid,b.guid,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--equ
c.EQU_Model,c.EQU_AUTH,c.EQU_MENU,c.EQU_Code,c.Equ_Pow,ct.ET_EQU_TFCODE,
--f_sdb_GETPOWER_W(EQU_POW,ET_pow_u) || NVL(et_pow_unit.code_chi_name,'W') et_pow_Name,
F_RIM_RSM_GETPOWER_W(EQU_POW,ET_pow_u) et_pow_Name,
c.EQU_PF,c.equ_pf Equ_PF_Name,c.equ_mb,c.equ_type,
ct.et_equ_pwid2,ct.et_equ_pup,ct.et_equ_senerr,ct.et_pow_u,ct.ET_pow_u et_pow_u_name,ct.et_equ_pr,decode(ct.et_equ_type_id,'0','收发信机','1','其它') et_equ_type_id,
ct.et_equ_upu,ct.et_equ_cl,ct.et_equ_fntval,ct.et_equ_pf,ct.et_equ_no,ct.et_equ_upow,
ct.et_equ_code,ct.et_equ_tl,ct.et_equ_epos,ct.et_equ_apos,ct.et_equ_chrip,ct.et_equ_rnq,ct.et_equ_name,
ct.et_equ_use,ct.et_equ_ccode,ct.et_eirp,ct.et_equ_rwid,ct.et_equ_esgn,ct.et_equ_atype,
ct.et_equ_pow_avg,ct.et_equ_pow_max,ct.et_equ_dnu,ct.et_af_type,ct.et_equ_dpow,ct.et_equ_type,
ct.et_equ_senu,ct.et_equ_sen,ct.et_equ_mt,ct.et_equ_sum,ct.et_equ_pdn,ct.et_equ_euse,ct.et_equ_pwid1,
ct.ET_EQU_RF,ct.ET_EQU_RF_BAND,
c.EQU_MB EQU_MB_Name,
ct.ET_AF_Type ET_AF_Type_Name,
ct.ET_EQU_Atype ET_EQU_Atype_Name,
ct.ET_EQU_SENU ET_EQU_SENU_Name,
ct.ET_EQU_SENERR ET_EQU_SENERR_Name,
ct.ET_EQU_MT ET_EQU_MT_Name,
--antfeed
e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_Size,e.FEED_MENU,e.FEED_Model,ANT_Hight,ANT_Gain,et.AT_ANT_TFCODE,
e.FEED_Length,e.FEED_Lose,e.ant_rpole,e.ant_epole,e.ant_code,e.feed_code,e.ant_egain,e.guid antfeed_guid,
e.ant_angle,e.ANT_WORK_TYPE,e.ant_rgain,e.ant_pole,e.ant_type ANT_Type_Name,
et.at_ant_no,et.at_ant_upang,et.at_lel,et.at_bwid,et.AT_ANG_E,et.at_ang_b,et.at_ccode,et.at_unit_type,
et.at_3dbe,et.at_sspeed,et.at_rnt,et.at_qua,et.at_se_e,et.at_eang,et.at_updn,et.at_h_hpic,
et.at_se_b,et.at_csgn,et.at_3dbr,et.at_rang,et.at_sum,et.at_h_vpic,
e.ANT_WORK_TYPE ANT_WORK_TYPE_Name,
e.ANT_POLE ANT_POLE_Name,
e.ANT_RPOLE ANT_RPOLE_Name,
e.ANT_EPOLE ANT_EPOLE_Name,
et.AT_UPDN AT_UPDN_Name ,nvl(e_exp.equ_status,'1') equ_status
from rsbt_station b ,rsbt_Equ c,rsbt_antfeed e,
rsbt_station_t bt ,Rsbt_Equ_t ct,rsbt_antfeed_t et, rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c ,t_rim_rsm_equ_expand e_exp
where b.guid=bt.guid(+) and b.net_guid=n.guid(+) and c.guid=e_exp.guid(+) and nvl(e_exp.equ_status,'1')='1'
and c.station_guid=b.guid and c.guid=ct.guid(+)
and e.station_guid=b.guid and e.guid=et.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+)
and exists (select guid from rsbt_eaf eaf where b.guid=eaf.station_guid and c.guid=eaf.equ_guid and e.guid=eaf.ant_guid);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_EQU_SEARCH
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_EQU_SEARCH" AS 
select
c.guid equ_guid,b.guid,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--equ
c.EQU_Model,c.EQU_AUTH,c.EQU_MENU,c.EQU_Code,c.Equ_Pow,ct.ET_EQU_TFCODE,
--f_sdb_GETPOWER_W(EQU_POW,ET_pow_u) || NVL(et_pow_unit.code_chi_name,'W') et_pow_Name,
F_RIM_RSM_GETPOWER_W(EQU_POW,ET_pow_u) et_pow_Name,
c.EQU_PF,c.equ_pf Equ_PF_Name,c.equ_mb,c.equ_type,
ct.et_equ_pwid2,ct.et_equ_pup,ct.et_equ_senerr,ct.et_pow_u,ct.ET_pow_u et_pow_u_name,ct.et_equ_pr,decode(ct.et_equ_type_id,'0','收发信机','1','其它') et_equ_type_id,
ct.et_equ_upu,ct.et_equ_cl,ct.et_equ_fntval,ct.et_equ_pf,ct.et_equ_no,ct.et_equ_upow,
ct.et_equ_code,ct.et_equ_tl,ct.et_equ_epos,ct.et_equ_apos,ct.et_equ_chrip,ct.et_equ_rnq,ct.et_equ_name,
ct.et_equ_use,ct.et_equ_ccode,ct.et_eirp,ct.et_equ_rwid,ct.et_equ_esgn,ct.et_equ_atype,
ct.et_equ_pow_avg,ct.et_equ_pow_max,ct.et_equ_dnu,ct.et_af_type,ct.et_equ_dpow,ct.et_equ_type,
ct.et_equ_senu,ct.et_equ_sen,ct.et_equ_mt,ct.et_equ_sum,ct.et_equ_pdn,ct.et_equ_euse,ct.et_equ_pwid1,
ct.ET_EQU_RF,ct.ET_EQU_RF_BAND,
c.EQU_MB EQU_MB_Name,
ct.ET_AF_Type ET_AF_Type_Name,
ct.ET_EQU_Atype ET_EQU_Atype_Name,
ct.ET_EQU_SENU ET_EQU_SENU_Name,
ct.ET_EQU_SENERR ET_EQU_SENERR_Name,
ct.ET_EQU_MT ET_EQU_MT_Name,
nvl(e_exp.equ_status,'1') equ_status
from rsbt_station b ,rsbt_Equ c,rsbt_station_t bt ,Rsbt_Equ_t ct,
rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c ,t_rim_rsm_equ_expand e_exp
where  b.guid=bt.guid(+) and b.net_guid=n.guid(+) and c.guid=e_exp.guid(+) and nvl(e_exp.equ_status,'1')='1'
and c.station_guid=b.guid(+) and c.guid=ct.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+)
and exists (select guid from rsbt_eaf eaf where b.guid=eaf.station_guid and c.guid=eaf.equ_guid);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_FREQ_ANT_SEARCH
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_FREQ_ANT_SEARCH" AS 
select
d.guid freq_guid,e.guid ant_guid,b.guid,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--freq
decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) EFB1,
decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) RFB1,
decode(FREQ_TYPE,'0', to_char(FREQ_UC),'1', to_char(FREQ_EFB) || '－' || to_char(FREQ_EFE)) EFB ,FREQ_EFE,
decode(FREQ_TYPE,'0', to_char(FREQ_LC),'1', to_char(FREQ_RFB)  || '－' || to_char(FREQ_RFE)) RFB,FREQ_RFE,
d.FREQ_RFB,d.FREQ_EFB,
FREQ_E_Band,FREQ_R_Band,FREQ_MOD,
d.freq_mod FREQ_MOD_Name,d.freq_type,d.freq_mb,d.freq_code,d.freq_uc,d.freq_lc,
dt.ft_freq_timee,dt.ft_freq_mc2,dt.ft_freq_mc,dt.ft_freq_type,dt.ft_freq_frp,
dt.ft_freq_dupdn,dt.ft_freq_pow_avg,dt.ft_freq_epow,dt.ft_freq_hcl,dt.ft_freq_pow_max,dt.ft_freq_eirp,
dt.ft_freq_ccode,dt.ft_freq_mc3,dt.ft_freq_csgn,dt.ft_freq_mc1,dt.ft_freq_unit_type,dt.ft_freq_powflag,
dt.ft_freq_fep,dt.ft_freq_info_type,dt.ft_freq_no,dt.ft_freq_timeb,dt.FT_FREQ_TFCODE,
--接收频率  发射频率
'-' freq_v,'-' freq_v_r,
--发射带宽
'-' band_v,'-' band_v_R,
d.FREQ_MB FREQ_MB_Name,
dt.FT_FREQ_INFO_Type FT_FREQ_INFO_Type_Name,
dt.FT_FREQ_Type FT_FREQ_Type_Name,
dt.FT_FREQ_DUPDN FT_FREQ_DUPDN_Name,
dt.FT_FREQ_FEP FT_FREQ_FEP_Name,
dt.FT_FREQ_FRP FT_FREQ_FRP_Name,
dt.ft_freq_powflag FT_FREQ_POWFLAG_Name,' ' station_code_b ,
--antfeed
e.ANT_Type,e.ANT_Model,e.ANT_MENU,e.ANT_Size,e.FEED_MENU,e.FEED_Model,ANT_Hight,ANT_Gain,et.AT_ANT_TFCODE,
e.FEED_Length,e.FEED_Lose,e.ant_rpole,e.ant_epole,e.ant_code,e.feed_code,e.ant_egain,e.guid antfeed_guid,
e.ant_angle,e.ANT_WORK_TYPE,e.ant_rgain,e.ant_pole,e.ant_type ANT_Type_Name,
et.at_ant_no,et.at_ant_upang,et.at_lel,et.at_bwid,et.AT_ANG_E,et.at_ang_b,et.at_ccode,et.at_unit_type,
et.at_3dbe,et.at_sspeed,et.at_rnt,et.at_qua,et.at_se_e,et.at_eang,et.at_updn,et.at_h_hpic,
et.at_se_b,et.at_csgn,et.at_3dbr,et.at_rang,et.at_sum,et.at_h_vpic,
e.ANT_WORK_TYPE ANT_WORK_TYPE_Name,
e.ANT_POLE ANT_POLE_Name,
e.ANT_RPOLE ANT_RPOLE_Name,
e.ANT_EPOLE ANT_EPOLE_Name,
et.AT_UPDN AT_UPDN_Name
from rsbt_station b ,rsbt_Freq d,rsbt_antfeed e,rsbt_station_t bt ,rsbt_Freq_t dt,rsbt_antfeed_t et,
rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c
where b.guid=bt.guid(+) and b.net_guid=n.guid(+)
and d.station_guid=b.guid and d.guid=dt.guid(+)
and e.station_guid=b.guid and e.guid=et.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+)
and exists (select guid from rsbt_eaf eaf where b.guid=eaf.station_guid and d.guid=eaf.freq_guid and e.guid=eaf.ant_guid);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_FREQ_EQU_SEARCH
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_FREQ_EQU_SEARCH" AS 
select
c.guid equ_guid,d.guid freq_guid,b.guid,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--equ
c.EQU_Model,c.EQU_AUTH,c.EQU_MENU,c.EQU_Code,c.Equ_Pow,ct.ET_EQU_TFCODE,
--f_sdb_GETPOWER_W(EQU_POW,ET_pow_u) || NVL(et_pow_unit.code_chi_name,'W') et_pow_Name,
F_RIM_RSM_GETPOWER_W(EQU_POW,ET_pow_u) et_pow_Name,
c.EQU_PF,c.equ_pf Equ_PF_Name,c.equ_mb,c.equ_type,
ct.et_equ_pwid2,ct.et_equ_pup,ct.et_equ_senerr,ct.et_pow_u,ct.ET_pow_u et_pow_u_name,ct.et_equ_pr,decode(ct.et_equ_type_id,'0','收发信机','1','其它') et_equ_type_id,
ct.et_equ_upu,ct.et_equ_cl,ct.et_equ_fntval,ct.et_equ_pf,ct.et_equ_no,ct.et_equ_upow,
ct.et_equ_code,ct.et_equ_tl,ct.et_equ_epos,ct.et_equ_apos,ct.et_equ_chrip,ct.et_equ_rnq,ct.et_equ_name,
ct.et_equ_use,ct.et_equ_ccode,ct.et_eirp,ct.et_equ_rwid,ct.et_equ_esgn,ct.et_equ_atype,
ct.et_equ_pow_avg,ct.et_equ_pow_max,ct.et_equ_dnu,ct.et_af_type,ct.et_equ_dpow,ct.et_equ_type,
ct.et_equ_senu,ct.et_equ_sen,ct.et_equ_mt,ct.et_equ_sum,ct.et_equ_pdn,ct.et_equ_euse,ct.et_equ_pwid1,
ct.ET_EQU_RF,ct.ET_EQU_RF_BAND,
c.EQU_MB EQU_MB_Name,
ct.ET_AF_Type ET_AF_Type_Name,
ct.ET_EQU_Atype ET_EQU_Atype_Name,
ct.ET_EQU_SENU ET_EQU_SENU_Name,
ct.ET_EQU_SENERR ET_EQU_SENERR_Name,
ct.ET_EQU_MT ET_EQU_MT_Name,
--freq
decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) EFB1,
decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) RFB1,
decode(FREQ_TYPE,'0', to_char(FREQ_UC),'1', to_char(FREQ_EFB) || '－' || to_char(FREQ_EFE)) EFB ,FREQ_EFE,
decode(FREQ_TYPE,'0', to_char(FREQ_LC),'1', to_char(FREQ_RFB)  || '－' || to_char(FREQ_RFE)) RFB,FREQ_RFE,
d.FREQ_RFB,d.FREQ_EFB,
FREQ_E_Band,FREQ_R_Band,FREQ_MOD,
d.freq_mod FREQ_MOD_Name,d.freq_type,d.freq_mb,d.freq_code,d.freq_uc,d.freq_lc,
dt.ft_freq_timee,dt.ft_freq_mc2,dt.ft_freq_mc,dt.ft_freq_type,dt.ft_freq_frp,
dt.ft_freq_dupdn,dt.ft_freq_pow_avg,dt.ft_freq_epow,dt.ft_freq_hcl,dt.ft_freq_pow_max,dt.ft_freq_eirp,
dt.ft_freq_ccode,dt.ft_freq_mc3,dt.ft_freq_csgn,dt.ft_freq_mc1,dt.ft_freq_unit_type,dt.ft_freq_powflag,
dt.ft_freq_fep,dt.ft_freq_info_type,dt.ft_freq_no,dt.ft_freq_timeb,dt.FT_FREQ_TFCODE,
--接收频率  发射频率
'-' freq_v,'-' freq_v_r,
--发射带宽
'-' band_v,'-' band_v_R,
d.FREQ_MB FREQ_MB_Name,
dt.FT_FREQ_INFO_Type FT_FREQ_INFO_Type_Name,
dt.FT_FREQ_Type FT_FREQ_Type_Name,
dt.FT_FREQ_DUPDN FT_FREQ_DUPDN_Name,
dt.FT_FREQ_FEP FT_FREQ_FEP_Name,
dt.FT_FREQ_FRP FT_FREQ_FRP_Name,
dt.ft_freq_powflag FT_FREQ_POWFLAG_Name,' ' station_code_b ,nvl(e_exp.equ_status,'1') equ_status
from rsbt_station b ,rsbt_Equ c,rsbt_Freq d,
rsbt_station_t bt ,Rsbt_Equ_t ct,rsbt_Freq_t dt, rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c ,t_rim_rsm_equ_expand e_exp
where  b.guid=bt.guid(+) and b.net_guid=n.guid(+) and c.guid=e_exp.guid(+) and nvl(e_exp.equ_status,'1')='1'
and c.station_guid=b.guid and c.guid=ct.guid(+)
and d.station_guid=b.guid and d.guid=dt.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+)
and exists (select guid from rsbt_eaf eaf where b.guid=eaf.station_guid and c.guid=eaf.equ_guid and d.guid=eaf.freq_guid);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_FREQ_SEARCH
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_FREQ_SEARCH" AS 
select
b.guid, d.guid freq_guid,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name,
--freq
decode(FREQ_TYPE,'0', FREQ_UC,'1', FREQ_EFB) EFB1,
decode(FREQ_TYPE,'0', FREQ_LC,'1', FREQ_RFB) RFB1,
decode(FREQ_TYPE,'0', to_char(FREQ_UC),'1', to_char(FREQ_EFB) || '－' || to_char(FREQ_EFE)) EFB ,FREQ_EFE,
decode(FREQ_TYPE,'0', to_char(FREQ_LC),'1', to_char(FREQ_RFB)  || '－' || to_char(FREQ_RFE)) RFB,FREQ_RFE,
d.FREQ_RFB,d.FREQ_EFB,
FREQ_E_Band,FREQ_R_Band,FREQ_MOD,
d.freq_mod FREQ_MOD_Name,d.freq_type,d.freq_mb,d.freq_code,d.freq_uc,d.freq_lc,
dt.ft_freq_timee,dt.ft_freq_mc2,dt.ft_freq_mc,dt.ft_freq_type,dt.ft_freq_frp,
dt.ft_freq_dupdn,dt.ft_freq_pow_avg,dt.ft_freq_epow,dt.ft_freq_hcl,dt.ft_freq_pow_max,dt.ft_freq_eirp,
dt.ft_freq_ccode,dt.ft_freq_mc3,dt.ft_freq_csgn,dt.ft_freq_mc1,dt.ft_freq_unit_type,dt.ft_freq_powflag,
dt.ft_freq_fep,dt.ft_freq_info_type,dt.ft_freq_no,dt.ft_freq_timeb,dt.FT_FREQ_TFCODE,
--接收频率  发射频率
'-' freq_v,'-' freq_v_r,
--发射带宽
'-' band_v,'-' band_v_R,
d.FREQ_MB FREQ_MB_Name,
dt.FT_FREQ_INFO_Type FT_FREQ_INFO_Type_Name,
dt.FT_FREQ_Type FT_FREQ_Type_Name,
dt.FT_FREQ_DUPDN FT_FREQ_DUPDN_Name,
dt.FT_FREQ_FEP FT_FREQ_FEP_Name,
dt.FT_FREQ_FRP FT_FREQ_FRP_Name,
dt.ft_freq_powflag FT_FREQ_POWFLAG_Name,' ' station_code_b
from rsbt_station b ,rsbt_Freq d,rsbt_station_t bt ,rsbt_Freq_t dt , rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c
where b.guid=bt.guid(+) and b.net_guid=n.guid(+)
and d.station_guid=b.guid(+) and d.guid=dt.guid(+)
and n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+)
and exists (select guid from rsbt_eaf eaf where d.guid=eaf.freq_guid and b.guid=eaf.station_guid);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_INFO
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_INFO" AS 
select c.CODE_CHI_NAME,s.STAT_YEAR,s.STAT_MONTH,s.STAT_DEPT,s.STAT_SUM,s.BC_SUM,s.BT_SUM,s.BW_SUM,s.SF_SUM,s.SM_SUM,s.HF_SUM,s.HM_SUM,s.SS_SUM,s.AS_SUM,s.PB_SUM,s.JQ_SUM,s.LJ_SUM,s.FWGSM_SUM,s.LFGSM_SUM,s.FWCDMA_SUM,s.LFCDMA_SUM,s.FWWCDMA_SUM,s.LFWCDMA_SUM,s.FWTDSCDMA_SUM,s.LFTDSCDMA_SUM,s.WX_SUM,s.GX_SUM,s.GD_SUM,s.WS_SUM,s.WY_SUM,s.LA_SUM,s.HA_SUM,s.SPM_SUM,s.MS_SUM,s.YY_SUM,s.OT_SUM,nvl(s.stat_include,'A') stat_include,nvl(s.stat_include,'A')||'库' stat_include_v
 from t_rim_rsm_stat_info s,rsbt_code_dic c where s.stat_dept =c.cn and c.code_type_chi_name = '地区编码'
union
select '全省' CODE_CHI_NAME,s.STAT_YEAR,s.STAT_MONTH,s.STAT_DEPT,s.STAT_SUM,s.BC_SUM,s.BT_SUM,s.BW_SUM,s.SF_SUM,s.SM_SUM,s.HF_SUM,s.HM_SUM,s.SS_SUM,s.AS_SUM,s.PB_SUM,s.JQ_SUM,s.LJ_SUM,s.FWGSM_SUM,s.LFGSM_SUM,s.FWCDMA_SUM,s.LFCDMA_SUM,s.FWWCDMA_SUM,s.LFWCDMA_SUM,s.FWTDSCDMA_SUM,s.LFTDSCDMA_SUM,s.WX_SUM,s.GX_SUM,s.GD_SUM,s.WS_SUM,s.WY_SUM,s.LA_SUM,s.HA_SUM,s.SPM_SUM,s.MS_SUM,s.YY_SUM,s.OT_SUM,nvl(s.stat_include,'A') stat_include,nvl(s.stat_include,'A')||'库' stat_include_v
 from t_rim_rsm_stat_info s,rsbt_code_dic c where s.stat_dept='999999';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_INFO_COUNT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_INFO_COUNT" AS 
select
 -----台站设施统计视图
 "CODE_CHI_NAME","STAT_YEAR","STAT_MONTH","STAT_DEPT","STAT_SUM","BC_SUM","BT_SUM","BW_SUM","SF_SUM","SM_SUM","HF_SUM","HM_SUM","SS_SUM","AS_SUM","PB_SUM","JQ_SUM","LJ_SUM","FWGSM_SUM","LFGSM_SUM","FWCDMA_SUM","LFCDMA_SUM","FWWCDMA_SUM","LFWCDMA_SUM","FWTDSCDMA_SUM","LFTDSCDMA_SUM","WX_SUM","GX_SUM","GD_SUM","WS_SUM","WY_SUM","LA_SUM","HA_SUM","SPM_SUM","MS_SUM","YY_SUM","OT_SUM","STAT_INCLUDE","STAT_INCLUDE_V" from v_rim_rsm_stat_info A where a.STAT_DEPT like '50%';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_INFO_TREND
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_INFO_TREND" AS 
select NVL(stat_include,'A') stat_include,stat_year,a.stat_year||'-'||a.stat_month stat_date,a.stat_year||'年'||a.stat_month||'月份' 统计时间,stat_dept,b.code_chi_name 统计单位,stat_sum 台站合计,bc_sum 广播电台声音,bt_sum 广播电台电视,bw_sum 广播电台差转台,
	sf_sum 高频陆地固定电台,sm_sum 高频移动电台,hf_sum "甚、特高频陆地固定台",hm_sum "甚、特高频移动台",ss_sum 船舶电台,
	as_sum 航空器电台,pb_sum 寻呼基站,jq_sum 集群基站,lj_sum 集群移动台,fwgsm_sum 蜂窝GSM基站,lfgsm_sum 蜂窝GSM移动台,
	fwcdma_sum 蜂窝CDMA基站,lfcdma_sum 蜂窝CDMA移动台,fwwcdma_sum 蜂窝WCDMA基站,lfwcdma_sum 蜂窝WCDMA移动台,fwtdscdma_sum "蜂窝TD-SCDMA基站",lftdscdma_sum "蜂窝TD-SCDMA移动台",wx_sum 无线数据电台,gx_sum 固定无线接入中心站,gd_sum 固定无线接入终端站,
	ws_sum 无线市话基站,wy_sum 无线市话移动台,la_sum "卫星地球站天线<=4.5米台站",
	ha_sum "卫星地球站天线>4.5米台站",spm_sum 卫星地球站移动台,ms_sum 微波接力站,yy_sum 业余电台,ot_sum 其它台站
from t_rim_rsm_stat_info a,RSBT_CODE_DIC b where a.stat_dept=b.cn(+) and b.code_data_type(+)='00032006' and stat_dept<>'999999'
union all
select NVL(stat_include,'A') stat_include,stat_year,stat_year||'-'||stat_month  stat_date,stat_year||'年'||stat_month||'月份' 统计时间 ,stat_dept,'全省' 统计单位,stat_sum 台站合计,bc_sum 广播电台声音,bt_sum 广播电台电视,bw_sum 广播电台差转台,
	sf_sum 高频陆地固定电台,sm_sum 高频移动电台,hf_sum "甚、特高频陆地固定台",hm_sum "甚、特高频移动台",ss_sum 船舶电台,
	as_sum 航空器电台,pb_sum 寻呼基站,jq_sum 集群基站,lj_sum 集群移动台,fwgsm_sum 蜂窝GSM基站,lfgsm_sum 蜂窝GSM移动台,
	fwcdma_sum 蜂窝CDMA基站,lfcdma_sum 蜂窝CDMA移动台,fwwcdma_sum 蜂窝WCDMA基站,lfwcdma_sum 蜂窝WCDMA移动台,fwtdscdma_sum "蜂窝TD-SCDMA基站",lftdscdma_sum "蜂窝TD-SCDMA移动台",wx_sum 无线数据电台,gx_sum 固定无线接入中心站,gd_sum 固定无线接入终端站,
	ws_sum 无线市话基站,wy_sum 无线市话移动台,la_sum "卫星地球站天线<=4.5米台站",
	ha_sum "卫星地球站天线>4.5米台站",spm_sum 卫星地球站移动台,ms_sum 微波接力站,yy_sum 业余电台,ot_sum 其它台站
from t_rim_rsm_stat_info where  stat_dept='999999';

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_ORG_SELECT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_ORG_SELECT" AS 
select s.guid guid,app.guid app_guid,s.stat_name,s.net_guid,s.app_code,s.stat_addr,s.stat_app_type,s.stat_type,s.stat_work,s.stat_tdi,s.memo,
s.STAT_APP_Type|| s.stat_tdi tdi_code,s.stat_area_code ,s.stat_date_start,s.STAT_LG,s.STAT_LA,o.org_name,o.org_addr,decode(app.app_type,'T',APP.MEMO,'PA',app_pa.memo) APP_MEMO
 from rsbt_station s,rsbt_apply app,rsbt_apply_pa app_pa,rsbt_org o
where s.app_code=app.app_code(+) and app.guid=app_pa.app_guid(+) and app.org_guid=o.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_SEARCH
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_SEARCH" AS 
select
b.guid,
--station
b.guid as STATION_GUID,b.stat_lg,(b.stat_app_type || b.stat_tdi) as stat_tdi,b.stat_at,b.memo,b.stat_addr,n_b.org_code,
b.stat_name,b.net_guid,b.stat_type,b.stat_equ_sum,b.stat_la,
b.stat_status,b.STAT_APP_Type,b.app_code,substr(b.app_code,-12,12)  app_codeDes,
decode(b.STAT_AREA_CODE,null,b.org_code,b.STAT_AREA_CODE) STAT_AREA_CODE,to_char(b.stat_date_start,'yyyy-MM-dd') stat_date_start ,b.stat_work,
decode(substr(b.APP_CODE,1,1) ,'P','PA','T') as app_type,decode(decode(substr(b.APP_CODE,1,1) ,'P','PA','T') ,'T','无线电台申请','P','业余电台申请') as app_type_Name,
b.STAT_APP_Type|| b.stat_tdi tech_ID,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lg) stat_lgDes,F_RIM_RSM_STAT_CHANGEDEGREE(b.stat_lA) stat_lADes,
b.stat_area_code AREA_VIEW,DECODE(substr(b.app_code,1,1),'P',f_rim_rsm_getpaname(b.app_code,''), n_c.org_name) org_name,n_c.org_addr,n_c.org_link_person,n_c.org_mob_phone,n_c.org_phone,
--station_t
 bt.st_r_emin,bt.st_e_pos,bt.st_me_sta2,bt.st_lmmtr,bt.st_a_st,bt.st_me_name1,bt.st_tf_trans_ca_p,bt.st_b_ic,
 bt.st_e_com_area,bt.st_me_lg2,bt.st_me_lg1,bt.st_s_cs,bt.st_d_type,bt.st_s_mmsi,bt.st_b_type2,bt.st_pos_type,bt.st_b_type1,
 bt.st_me_fband,bt.st_time_e,bt.st_c_sum,bt.st_a_nrm,bt.st_e_sat,bt.st_s_t,bt.st_a_call_oi,bt.st_r_wamin,
 bt.st_s_p,bt.st_a_call,bt.st_me_file_no,bt.st_a_piloting,bt.st_call_sign,bt.st_a_model,bt.st_r_emax,
 bt.st_b_edu,bt.st_s_pn,bt.st_me_sta3,bt.st_me_sta1,bt.st_a_type,bt.st_e_net_code,bt.st_time_b,bt.st_e_multi_addr,
 bt.st_e_lg,bt.st_ship_name,bt.st_tf_code,bt.st_b_sgn,bt.ST_B_Level,bt.st_b_bm,bt.st_ship_type,
 bt.st_me_sat_name,bt.st_c_code,bt.st_serv_r,bt.st_d_tec_type ST_D_TEC_Type_Name,bt.st_b_cover_area,
 bt.st_s_aaic,bt.st_user_area,bt.st_me_stype,bt.st_tf_trans_ca_pu,
 bt.st_r_wamax,bt.st_a_sgn,bt.st_me_name2,
--net
n_b.ORG_sys_code fee_ORG_sys_code, n_c.ORG_sys_code,n_c.org_code set_org_code,
n.net_ts net_ts_name,n_c.org_area_code,n.net_band,n.net_start_date,n.net_area,n.net_sat_name,n.net_sp net_sp_name,
n.net_name,n.net_svn net_svn_name,n.net_ts,n.net_area net_area_name,n.net_expired_date,
n.net_use,n.net_sp,n.net_lg,n.org_guid,n.net_confirm_date,
decode(substr(b.APP_CODE,1,1) ,'P',F_RIM_RSM_GetPaNameByAppCode(b.app_code),n_c.org_name) set_org_name,n_b.org_name fee_org_name,
n.fee_guid,n.net_svn,
decode(substr(b.APP_CODE,1,1),'P',F_RIM_RSM_GetPaAddrByAppCode(b.app_code),n_c.org_addr) set_org_addr,n_c.org_link_person set_org_link_person,
n_c.org_phone set_org_phone,n_c.org_mob_phone set_org_mob_phone,n_c.org_post set_org_post,
--other
b.stat_type stat_typeDes,
b.STAT_WORK stat_work_Name ,
b.stat_status stat_statusDes ,
bt.ST_LMMTR ST_LMMTR_Name,
bt.ST_E_MULTI_Addr ST_E_MULTI_Addr_Name,
bt.ST_E_COM_Area ST_E_COM_Area_Name,
bt.ST_POS_Type ST_POS_Type_Name,
bt.st_b_level ST_B_Level_Name,
bt.ST_B_BM ST_B_BM_Name,
bt.ST_B_EDU ST_B_EDU_Name,
bt.ST_B_IC ST_B_IC_Name,
bt.ST_Ship_Type ST_Ship_Type_Name,
bt.ST_A_Type ST_A_Type_Name,
bt.ST_A_Call_OI ST_A_Call_OI_Name,
bt.ST_A_Piloting ST_A_Piloting_Name,
bt.ST_D_TEC_Type,
bt.ST_D_Type   ST_D_Type_Name,
bt.ST_ME_Stype   ST_ME_Stype_Name,
bt.ST_B_TYPE2 ST_B_TYPE2_Name,bt.ST_B_TYPE1 ST_B_TYPE1_Name
from rsbt_station b ,rsbt_station_t bt , rsbt_net n,RSBT_ORG n_b ,RSBT_ORG n_c
where   b.guid=bt.guid(+) and b.net_guid=n.guid(+)  and
 n.fee_guid = n_b.guid(+) and n.org_guid = n_c.guid(+)
and exists (select guid from rsbt_eaf eaf where b.guid=eaf.station_guid);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_TYPE_REVEL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_TYPE_REVEL" AS 
select s.guid guid,app.guid app_guid,s.stat_name,s.net_guid,s.app_code,s.stat_addr,s.stat_app_type,s.stat_type,s.stat_work,s.stat_tdi,s.memo,decode(app.app_type,'T',app.memo,'PA',app_pa.memo) app_memo,
s.STAT_APP_Type|| s.stat_tdi tdi_code,s.stat_area_code ,s.stat_date_start,s.STAT_LG,s.STAT_LA,decode(app.app_type,'T',o.org_name,'PA',app_pa.app_pa_name ) org_name,o.org_addr,
t.typename typename,r.stat_type_guid ,t.orderid,t.remark
from rsbt_station s,t_rim_rsm_stat_type_relev r,t_rim_rsm_station_type t,rsbt_apply app,rsbt_apply_pa app_pa, rsbt_org o
where s.guid(+)=r.stat_guid and r.stat_type_guid=t.guid(+) AND app.app_code(+)=s.app_code and app.guid=app_pa.app_guid(+) and app.org_guid=o.guid(+);

-- ----------------------------
-- View structure for V_RIM_RSM_STAT_TYPE_REVEL2
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STAT_TYPE_REVEL2" AS 
select s.guid station_guid,r.guid,app.guid app_guid,s.stat_name,s.net_guid,s.app_code,s.stat_addr,s.stat_app_type,s.stat_type,s.stat_work,s.stat_tdi,s.memo,
s.STAT_APP_Type|| s.stat_tdi tdi_code,s.stat_area_code ,s.stat_date_start,s.STAT_LG,s.STAT_LA,r.set_result,r.set_status,decode(r.set_status,'1','已处理','未处理') set_status_v,
t.typename typename,r.stat_type_guid ,t.orderid,r.remark from rsbt_station s,t_rim_rsm_stat_type_relev2 r,t_rim_rsm_station_type2 t,rsbt_apply app
where s.guid(+)=r.stat_guid and r.stat_type_guid=t.guid(+) AND app.app_code(+)=s.app_code;

-- ----------------------------
-- View structure for V_RIM_RSM_STATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STATION" AS 
select s.guid,s.app_code apply_code,
       to_char(s.stat_date_start, 'yyyy-MM-dd HH24:MM:SS') APPR_DATE,
       s.STAT_APP_Type||s.stat_tdi decl_code,
       s.STAT_AREA_CODE area_code,
       s.stat_addr Stat_addr,
       s.stat_name stat_name,
       statType.Code_Chi_Name stat_type,
       s.STAT_LG Longi,
       s.STAT_LA Lati,
       s.STAT_AT ALTITUDE,
       org.org_name dept_name,
       ft.ft_freq_no freq_no,
       decode(f.freq_type,'1',(nvl(f.FREQ_EFB,0)+nvl(f.FREQ_EFE,nvl(f.FREQ_EFB,0)))/2,nvl(f.FREQ_UC,0))  freq_emit,
       decode(f.freq_type,'1',nvl(f.FREQ_EFB,0),nvl(f.FREQ_UC,0)) freq_emit_low,
       decode(f.freq_type,'1',nvl(f.FREQ_EFE,0),nvl(f.FREQ_UC,0)) freq_emit_up,
       decode(f.freq_type,'1',(nvl(f.FREQ_EFB,0)+nvl(f.FREQ_EFE,nvl(f.FREQ_EFB,0)))/2,nvl(f.FREQ_UC,0))  freq_rece,
       decode(f.freq_type,'1',nvl(f.FREQ_EFB,0),nvl(f.FREQ_UC,0)) freq_rece_low,
       decode(f.freq_type,'1',nvl(f.FREQ_EFE,0),nvl(f.FREQ_UC,0)) freq_rece_up,
       f.FREQ_MOD modulation,
       f.freq_e_band,
       decode(f.freq_type,'1',nvl(f.FREQ_EFB,0),nvl(f.FREQ_UC,0)) - nvl(f.freq_e_band,0.025)/2 freq1,  --考虑带宽后的频率起始值
       decode(f.freq_type,'1',nvl(f.FREQ_EFB,0),nvl(f.FREQ_UC,0)) + nvl(f.freq_e_band,0.025)/2 freq2,   --考虑带宽后的频率结束值
       0 "ANTHEIGHT", 0 "POWER"
    from rsbt_station s,rsbt_freq f,rsbt_freq_t ft, rsbt_net net, rsbt_org org,rsbt_code_dic statType
    where s.app_code is not null and s.guid=f.Station_GUID and f.guid=ft.guid
    and s.net_guid = net.guid(+) and net.org_guid = org.guid(+)
    and s.stat_type = statType.cn(+) and statType.code_data_type(+) = '00052006'
    union all
    select s.guid,s.app_code apply_code,
       to_char(s.stat_date_start, 'yyyy-MM-dd HH24:MM:SS') APPR_DATE,
       s.STAT_APP_Type||s.stat_tdi decl_code,
       s.STAT_AREA_CODE area_code,
       s.stat_addr Stat_addr,
       s.stat_name stat_name,
       statType.Code_Chi_Name stat_type,
       s.STAT_LG Longi,
       s.STAT_LA Lati,
       s.STAT_AT ALTITUDE,
       org.org_name dept_name,
       ft.ft_freq_no freq_no,
       decode(f.freq_type,'1',(nvl(f.FREQ_EFB,0)+nvl(f.FREQ_EFE,nvl(f.FREQ_EFB,0)))/2,nvl(f.FREQ_UC,0))  freq_emit,
       decode(f.freq_type,'1',nvl(f.FREQ_EFB,0),nvl(f.FREQ_UC,0)) freq_emit_low,
       decode(f.freq_type,'1',nvl(f.FREQ_EFE,0),nvl(f.FREQ_UC,0)) freq_emit_up,
       decode(f.freq_type,'1',(nvl(f.FREQ_EFB,0)+nvl(f.FREQ_EFE,nvl(f.FREQ_EFB,0)))/2,nvl(f.FREQ_UC,0))  freq_rece,
       decode(f.freq_type,'1',nvl(f.FREQ_EFB,0),nvl(f.FREQ_UC,0)) freq_rece_low,
       decode(f.freq_type,'1',nvl(f.FREQ_EFE,0),nvl(f.FREQ_UC,0)) freq_rece_up,
       f.FREQ_MOD modulation,
       f.freq_e_band,
       decode(f.freq_type,'1',nvl(f.FREQ_EFB,0),nvl(f.FREQ_UC,0)) - nvl(f.freq_e_band,0.025)/2 freq1,  --考虑带宽后的频率起始值
       decode(f.freq_type,'1',nvl(f.FREQ_EFB,0),nvl(f.FREQ_UC,0)) + nvl(f.freq_e_band,0.025)/2 freq2,   --考虑带宽后的频率结束值
       0 "ANTHEIGHT", 0 "POWER"
    from rsbt_station_r s,rsbt_freq_r f,rsbt_freq_t_r ft, rsbt_net_r net, rsbt_org org,rsbt_code_dic statType
    where s.app_code is not null and s.guid=f.Station_GUID and f.guid=ft.guid
    and s.net_guid = net.guid(+) and net.org_guid = org.guid(+)
    and s.stat_type = statType.cn(+) and statType.code_data_type(+) = '00052006';

-- ----------------------------
-- View structure for V_RIM_RSM_STATION_SELECT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STATION_SELECT" AS 
select a.guid,a.guid stat_guid,e.guid org_guid,decode(f.app_type,'PA',f.app_pa_name,e.org_name) org_name,
      a.app_code,substr(a.app_code,-12,12) app_codeDes,
      a.stat_app_type,
      a.stat_tdi,a.stat_app_type || a.stat_tdi decl_code,a.net_guid,c.net_confirm_date,a.stat_addr,a.stat_name,a.stat_type,
      d.code_chi_name stat_type_name,a.stat_lg,a.stat_la,a.org_code,f.app_type,
      F_RIM_RSM_STAT_CHANGEDEGREE(a.stat_lg) LG_View,F_RIM_RSM_STAT_CHANGEDEGREE(a.stat_la) LA_View
from rsbt_station a,rsbt_net c,rsbt_code_dic d,rsbt_org e,
     (select g.app_code,g.app_type,min(h.app_pa_name) app_pa_name from rsbt_apply g,rsbt_apply_pa h where g.guid=h.app_guid(+) group by g.app_code,g.app_type) f
where a.net_guid=c.guid(+) and c.org_guid=e.guid(+) and a.stat_type=d.cn(+) and d.code_data_type(+)='00052006'
      and a.app_code=f.app_code;

-- ----------------------------
-- View structure for V_RIM_RSM_STATION_TYPE2
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STATION_TYPE2" AS 
select GUID,ORDERID,TYPENAME,decode(ALLOWPRINTLICENSE,'1','是','否') ALLOWPRINTLICENSE,REMARK
 from T_RIM_RSM_STATION_TYPE2;

-- ----------------------------
-- View structure for V_RIM_RSM_STATIONILLEGALRECORD
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STATIONILLEGALRECORD" AS 
select
  s1.guid,s1.station_guid,s2.org_code,
  to_char(s1.station_illegal_time,'yyyy-MM-dd') station_illegal_time,
  s1.station_illegal_mode,
  j.code_chi_name Station_illegal_mode_view ,
  s1.station_illegal_date,
  s1.station_illegal_date_u,k.code_chi_name station_illegal_date_u_v,s1.station_illegal_lg,
  s1.station_illegal_la,s1.station_illegal_equmode,
  to_char(s1.station_punish_time,'yyyy-MM-dd') station_punish_time,
  s1.station_punish_result,s1.memo,
  s2.app_code,s2.stat_app_type||s2.stat_tdi stat_tdi,s2.stat_name,s2.stat_addr,
  f_rim_rsm_changedegree(s1.station_illegal_lg) LG_View,f_rim_rsm_changedegree(s1.station_illegal_la) LA_View,
  s2.stat_lg,s2.stat_la
  from
  rsbt_stationillegalrecord s1,rsbt_station s2,rsbt_code_dic j,rsbt_code_dic k
  where
  s1.station_guid = s2.guid(+)
  and s1.Station_illegal_mode=j.cn(+) and j.code_data_type='00562006' and s1.station_illegal_date_u=k.cn(+) and k.code_data_type='00572006';

-- ----------------------------
-- View structure for V_RIM_RSM_STATNETORG_COUNT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STATNETORG_COUNT" AS 
select d.code_chi_name area_name ,a.guid station_guid,a.org_code area_code,a.stat_date_start,b.net_svn,b.net_ts,c.guid org_guid,c.org_name,c.org_addr,'A' Stat_Include
from rsbt_station a,rsbt_net b,rsbt_org c ,rsbt_code_dic d
where a.stat_app_type<>'LM' and a.net_guid=b.guid(+) and b.org_guid=c.guid(+) and a.org_code(+)=d.cn and  d.code_data_type(+)='00032006'
union all
select d.code_chi_name area_name ,a.guid station_guid,a.org_code area_code,a.stat_date_start,b.net_svn,b.net_ts,c.guid org_guid,c.org_name,c.org_addr,'A' Stat_Include
from rsbt_station a,rsbt_net b,rsbt_org c ,rsbt_code_dic d,rsbt_equ e
where a.stat_app_type='LM' and e.station_guid=a.guid  and a.net_guid=b.guid(+) and b.org_guid=c.guid(+) and a.org_code(+)=d.cn and  d.code_data_type(+)='00032006'
union all
select  d.code_chi_name area_name ,a.guid station_guid,a.org_code area_code,a.stat_date_start,b.net_svn,b.net_ts,c.guid org_guid,c.org_name,c.org_addr ,'B' Stat_Include
from  rsbt_station_r a,rsbt_net_r b,rsbt_org c ,rsbt_code_dic d
where a.stat_app_type<>'LM' and a.net_guid=b.guid(+) and b.org_guid=c.guid(+) and a.org_code(+)=d.cn and  d.code_data_type(+)='00032006'
union all
select  d.code_chi_name area_name ,a.guid station_guid,a.org_code area_code,a.stat_date_start,b.net_svn,b.net_ts,c.guid org_guid,c.org_name,c.org_addr ,'B' Stat_Include
from rsbt_station_r a,rsbt_net_r b,rsbt_org c ,rsbt_code_dic d ,rsbt_equ_r e
where a.stat_app_type='LM' and e.station_guid=a.guid and a.net_guid=b.guid(+) and b.org_guid=c.guid(+) and a.org_code(+)=d.cn and  d.code_data_type(+)='00032006';

-- ----------------------------
-- View structure for V_RIM_RSM_STATNETORGFREQ_COUNT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_STATNETORGFREQ_COUNT" AS 
select f.freq_type,f.freq_uc,f.freq_efb,f.freq_efe, d.code_chi_name area_name ,a.guid station_guid,a.app_code,a.stat_app_type,a.stat_tdi,a.stat_name,a.stat_addr, a.org_code area_code,a.stat_date_start,b.net_svn,b.net_ts,c.guid org_guid,c.org_name,c.org_addr,'A' Stat_Include
from rsbt_station a,rsbt_net b,rsbt_org c ,rsbt_code_dic d,rsbt_freq f
where  f.station_guid=a.guid  and a.net_guid=b.guid(+) and b.org_guid=c.guid(+) and a.org_code(+)=d.cn and  d.code_data_type(+)='00032006'
union all
select  f.freq_type,f.freq_uc,f.freq_efb,f.freq_efe,d.code_chi_name area_name ,a.guid station_guid,a.app_code,a.stat_app_type,a.stat_tdi,a.stat_name,a.stat_addr,a.org_code area_code,a.stat_date_start,b.net_svn,b.net_ts,c.guid org_guid,c.org_name,c.org_addr ,'B' Stat_Include
from rsbt_station_r a,rsbt_net_r b,rsbt_org c ,rsbt_code_dic d ,rsbt_freq_r f
where  f.station_guid=a.guid and a.net_guid=b.guid(+) and b.org_guid=c.guid(+) and a.org_code(+)=d.cn and  d.code_data_type(+)='00032006';

-- ----------------------------
-- View structure for V_RIM_RSM_TECHMGR
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_TECHMGR" AS 
select s.guid,apply.app_code,s.stat_app_type,NVL(s.org_code,SUBSTR(apply.app_code,-12,4)||'00') org_code,s.stat_tdi,s.stat_name,s.stat_addr,s.stat_area_code,s.stat_type,to_char(s.stat_date_start,'yyyy-mm-dd') stat_date_start,
       apply.guid app_guid,apply.app_type, s.stat_app_type || s.stat_tdi as TechID,decode(s.stat_status,'1','在用','0','封存') statusDesc,n.org_guid,o.org_name
       --增加经纬度
     ,to_char(s.stat_lg) stat_lg,to_char(s.stat_la) stat_la
  from rsbt_station s ,rsbt_net n ,rsbt_org o,rsbt_apply apply
where apply.net_guid  = n.guid(+)
  and apply.org_guid  = o.guid(+) and s.app_code(+)=apply.app_code  and nvl(s.stat_status,'1')='1' and apply.app_type<>'F';

-- ----------------------------
-- View structure for V_RIM_RSM_TECHMGR_R
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_RSM_TECHMGR_R" AS 
select s.guid,s.app_code,s.stat_app_type,s.org_code,s.stat_tdi,s.stat_name,s.stat_addr,s.stat_area_code,s.stat_type,to_char(s.stat_date_start,'yyyy-mm-dd') stat_date_start,
       apply.guid app_guid,apply.app_type, s.stat_app_type || s.stat_tdi as TechID,decode(s.stat_status,'1','在用','0','封存') statusDesc,n.org_guid,o.org_name,
       decode(impback.imp_back_type,2,'二类',DECODE(impback.imp_back_type,3,'三类','')) AS imp_back_type
from rsbt_station_r s ,rsbt_net_r n ,rsbt_org o,rsbt_apply_r apply,T_RIM_RSM_RSBT_IMBACKTYPE_LOG impback
where s.net_guid  = n.guid
  and n.org_guid  = o.guid and s.app_code(+)=apply.app_code  and s.stat_status='1'
  AND s.guid=impback.form_guid(+)
  union
  select '' guid,apply.app_code,'' stat_app_type,n.org_code org_code,'' stat_tdi,'' stat_name,'' stat_addr,'' stat_area_code,'' stat_type,'' stat_date_start,
  apply.guid app_guid,apply.app_type, '' TechID,'' statusDesc,n.org_guid,o.org_name,
  decode(impback.imp_back_type,2,'二类',DECODE(impback.imp_back_type,3,'三类','')) AS imp_back_type
  from rsbt_apply_r apply,rsbt_station_r stat ,rsbt_net_r n ,rsbt_org o,T_RIM_RSM_RSBT_IMBACKTYPE_LOG impback
  where
  apply.net_guid  = n.guid and n.org_guid  = o.guid and
  apply.app_code = stat.app_code(+) and stat.guid is null AND stat.guid=impback.form_guid(+) and apply.app_type<>'F';

-- ----------------------------
-- View structure for V_RIM_WF_APPLYLIST
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_APPLYLIST" AS 
select  r.guid,
          r.missiveid,
          r.userid,
          DECODE(r.appstatus,'0','申请',1,'通过',2,'不通过',3,'领导审批',4,'初步同意',5,'不同意') appstatus,
          r.appdate,
          r.orgid,
          r.phonenum,
          (select d.deptname from t_rim_comm_department d where d.deptid=r.orgid and d.delflag='0') deptname,/*申请人单位*/
          r.operid,
          (select b.username from t_rim_comm_user b where r.operid=b.userid) opername, /*拟稿人*/
          m.missivetitle,
          (select de.deptname from t_rim_comm_department de where
          de.deptid=(select dem.deptid from t_rim_comm_dept_emp dem where dem.empno=(select u.empno from t_rim_comm_user u where u.userid=r.operid ) and dem.direct='Y') and de.delflag='0') dname, /*审批处室*/
         (select de.deptid from t_rim_comm_department de where
          de.deptid=(select dem.deptid from t_rim_comm_dept_emp dem where dem.empno=(select u.empno from t_rim_comm_user u where u.userid=r.operid ) and dem.direct='Y') and de.delflag='0') deptid, /*拟稿人部门id*/
          a.username,/*申请人*/
          r.appcause,
          r.autheropinion,
          r.leaderopinion
    from t_rim_wf_readapp r,t_rim_wf_missive m,t_rim_comm_user a
    where r.missiveid=m.missiveid and r.userid=a.userid;

-- ----------------------------
-- View structure for V_RIM_WF_APPROVE_MAIN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_APPROVE_MAIN" AS 
select ----核准无线电发射设备型号审批（工作流视图）
a."ACCEPT_ID",a."ACCEPT_DATE",a."DEPT_NAME",a."PRESIDENT",a."LINKMAN",a."PHONE",a."ADDRESS",a."ZIP_CODE",a."EQUIP_MODEL",a."EQUIP_NAME",a."FUNCTION",a."MODU_MODEL",a."FREQ_RANGE",a."POWER_EMIT",a."BAND_WIDTH",a."QUAL_AUDIT",a."QUAL_PASS",a."QUAL_SIGN",a."QUAL_DATE",a."LEAD_AUDIT",a."LEAD_PASS",a."LEAD_SIGN",a."LEAD_DATE",a."ORG_AREA_CODE",a."RESID_GUID",a."USERID",d.code_chi_name modu ,F_IFNULL(E.DATAKEY) AS DATAKEY
from T_RIM_WF_APPROVE_MAIN a ,rsbt_code_dic d  ,WF_RT_CASE E
where a.modu_model=d.cn(+) and d.code_data_type(+)='00272006' and A.Resid_Guid=E.Datakey(+)
 order by A.ACCEPT_ID;

-- ----------------------------
-- View structure for V_RIM_WF_AUDITINGLIST
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_AUDITINGLIST" AS 
select  r.guid,
          r.missiveid,
          DECODE(r.appstatus,'0','申请',1,'通过',2,'不通过',3,'领导审批',4,'初步同意',5,'不同意') appstatus,
          r.appdate,
          r.userid,
          r.operid,
          r.orgid,
          m.missivetitle,
          u.username,
          r.leaderid
    from t_rim_wf_readapp r,t_rim_wf_missive m,t_rim_comm_user u
    where r.missiveid=m.missiveid and r.userid=u.userid;

-- ----------------------------
-- View structure for V_RIM_WF_CANBACKDETEGATE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_CANBACKDETEGATE" AS 
select a.missiveid,
       a.missivetitle,
       a.missivetype,
       c.itemname citemname,
       a.exigence ,
       F_RIM_OA_ARCHIVEName(a.exigence,'03') as URGENCYName,
       a.keepsecret,
       f.itemname,
       a.operid,
       a.proposaltele,
       a.addresserdept,
       a.maindept,
       a.ccdept,
       a.thematic,
       a.falg,
       a.comeondept,
       a.comeonnumer,
       a.comeoncode,
       a.comeondate,
       to_char(a.dodate,'yyyy-mm-dd') dodate,
       a.contexttype ,
       a.createdate,
       a.cretaer,
       a.partcode,
       b.operatid,
       K."CASEID",K."WORKID",K."ACTIVITYINSTID",K."PERFORMER",K."ARRIVEDATE",K."ACCEPTDATE",K."FINISHDATE",K."CANRETURN",K."CANRETAKE",K."SEQNO",K."ISCOMMITED",K."LIMITDATE",K."PACKAGEID",K."PROCESSID",K."PROCESSNAME",K."DATAKEY",K."SUBJECT",K."CREATOR",K."CREATED",K."CASESTATUS",K."ACTIVITYID",K."ACTIVITYNAME",K."NOTE",K."ASSIGNEE",K."USERNAME",
       e.guid,
       e.workid dworkid,
       e.delegateuserid,
       g.UserName dUserName,
       e.userid duserid,
       e.delegatedate,
       e.transactorid,
       e.remark,
       e.delflag
 from t_rim_wf_missive a,
      T_RIM_WF_MissiveState b,
      (select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='02') c,
      (select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='03') d,
      (select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='04') f,
      V_WF_WORK K,
      t_Rim_Wf_Delegatemissivelist e,
      t_Rim_Comm_User g
 where  a.missiveid(+)=b.missiveid
        and  a.missivetype=c.itemid(+)
        and a.exigence=d.itemid(+)
        and a.keepsecret=f.itemid(+)
        and a.MISSIVEID=K.datakey
        and k.workid(+)=e.workid
        and e.delegateuserid=g.userid
        and e.delflag='0'
        and e.userid = b.operatid
         order by inserttime desc;

-- ----------------------------
-- View structure for V_RIM_WF_COLLECTORS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_COLLECTORS" AS 
select
  t.guid,
  t.userid,
  t.createtime,
  c.itemname citemname,
  d.itemname ditemname,
  f.itemname fitemname,
  m."MISSIVEID",m."MISSIVETITLE",m."MISSIVETYPE",m."EXIGENCE",m."KEEPSECRET",m."OPERID",m."PROPOSALTELE",m."ADDRESSERDEPT",m."MAINDEPT",m."CCDEPT",m."THEMATIC",m."FALG",m."COMEONDEPT",m."COMEONNUMER",m."COMEONCODE",m."COMEONDATE",m."DODATE",m."CONTEXTTYPE",m."CREATEDATE",m."CRETAER",m."PARTCODE"
from
  t_rim_wf_collectors t,
  t_rim_wf_missive m,
  (select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='02') c,
  (select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='03') d,
  (select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='04') f
where
  t.missiveid =m.missiveid and
  m.missivetype=c.itemid(+) and
  m.exigence=d.itemid(+) and
  m.keepsecret=f.itemid(+);

-- ----------------------------
-- View structure for V_RIM_WF_DEVELOP_DRAFT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_DEVELOP_DRAFT" AS 
select ----研制无线电发射设备申请视图（已提交或未提交）
A."ACCEPT_ID",A."ACCEPT_DATE",A."DEPT_NAME",A."PRESIDENT",A."LINKMAN",A."PHONE",A."ADDRESS",A."ZIP_CODE",A."PRINCIPAL",A."TITLE",A."RANK",A."DEPT_LEAD",A."DEPT_RELA",A."EQUIP_NAME",A."FUNCTION",A."MODU_MODEL",A."FREQ_RANGE",A."BAND_WIDTH",A."POWER_EMIT",A."QUAL_AUDIT",A."QUAL_PASS",A."QUAL_SIGN",A."QUAL_DATE",A."LEAD_AUDIT",A."LEAD_PASS",A."LEAD_SIGN",A."LEAD_DATE",A."ORG_AREA_CODE",A."RESID_GUID",A."USERID",A."MODU",A."DATAKEY",B."ID",B."ACTIVITY",B."ACTOR",B."PROCESSDATE",B."NOTE",B."REFDATA" from V_RIM_WF_Develop_main a, T_RIM_oa_doc_wfnote b
where a.DATAKEY=' ' and a.ResID_GUID=b.refdata(+) and b.refdata is null;

-- ----------------------------
-- View structure for V_RIM_WF_DEVELOP_MAIN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_DEVELOP_MAIN" AS 
select ----研制无线电发射设备申请视图（已提交或未提交）
a."ACCEPT_ID",a."ACCEPT_DATE",a."DEPT_NAME",a."PRESIDENT",a."LINKMAN",a."PHONE",a."ADDRESS",a."ZIP_CODE",a."PRINCIPAL",a."TITLE",a."RANK",a."DEPT_LEAD",a."DEPT_RELA",a."EQUIP_NAME",a."FUNCTION",a."MODU_MODEL",a."FREQ_RANGE",a."BAND_WIDTH",a."POWER_EMIT",a."QUAL_AUDIT",a."QUAL_PASS",a."QUAL_SIGN",a."QUAL_DATE",a."LEAD_AUDIT",a."LEAD_PASS",a."LEAD_SIGN",a."LEAD_DATE",a."ORG_AREA_CODE",a."RESID_GUID",a."USERID",d.code_chi_name modu ,F_IFNULL(E.DATAKEY) AS DATAKEY
from T_RIM_WF_develop_main a ,rsbt_code_dic d  ,WF_RT_CASE E
where a.modu_model=d.cn(+) and d.code_data_type(+)='00272006'
AND  A.ResID_GUID=E.DATAKEY(+) order by A.ACCEPT_ID;

-- ----------------------------
-- View structure for V_RIM_WF_IMPORT_MAIN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_IMPORT_MAIN" AS 
select "ACCEPT_ID","ACCEPT_DATE","DEPT_IMP","DEPT_LEAD","ADDRESS","ZIP_CODE","LINKMAN","PHONE","ARRIVE_DATE","CONT_NO","ARRIVE_BATCH","SIGN_CHINA","CUSTOM_ARRIVE","SIGN_FOREIGN","CONS_COUNTRY","TECH_STATUS","PURPOSE","QUAL_AUDIT","QUAL_PASS","QUAL_SIGN","QUAL_DATE","SUPER_AUDIT","SUPER_KEY","SUPER_NOTE","SUPER_PASS","LEAD_AUDIT","LEAD_PASS","LEAD_SIGN","LEAD_DATE","VALID_DATE","PASS_CODE","COPY_DEPT","AFFIX_NOTE","GUID","AREA_CODE","USERID","DATAKEY" from (select A.*,F_IFNULL(B.DATAKEY) AS DATAKEY
 from t_rim_wf_import_main A,WF_RT_CASE B
 where a.guid=b.datakey(+)) d where d.guid<>d.DATAKEY;

-- ----------------------------
-- View structure for V_RIM_WF_MISSIVE_QUERY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_MISSIVE_QUERY" AS 
SELECT a.missiveid, a.missivetitle, a.missivetype, b.itemname citemname,
          a.exigence, c.itemname ditemname, a.keepsecret, a.operid,
          a.proposaltele, a.addresserdept, a.maindept, a.ccdept, a.thematic,
          a.falg, a.comeondept, a.comeonnumer, a.comeoncode, a.comeondate,
          TO_CHAR (a.dodate, 'yyyy-mm-dd') dodate, a.contexttype,
          a.createdate, a.cretaer, a.partcode,e.workid,e.activityname,e.arrivedate,e.datakey
     FROM t_rim_wf_missive a,
          (SELECT itemid, itemname
             FROM t_rim_oa_type
            WHERE typeid = '02') b,
          (SELECT itemid, itemname
             FROM t_rim_oa_type
            WHERE typeid = '03') c,
          (SELECT a.*,
                  ROW_NUMBER () OVER (PARTITION BY datakey ORDER BY arrivedate DESC)
                                                                          num
             FROM v_wf_work a) e
    WHERE a.falg <> '1'
      AND a.missivetype = b.itemid
      AND a.exigence = c.itemid(+)
      AND a.missiveid = e.datakey
      AND e.num = 1;

-- ----------------------------
-- View structure for V_RIM_WF_MISSIVE_READER
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_MISSIVE_READER" AS 
SELECT a.missivetitle, b.NAME opername, a.createdate, b.mobile, a.operid,
          a.missiveid
     FROM t_rim_wf_missive a, v_rim_comm_userinfo b
    WHERE a.operid = b.userid
      AND a.missivetype = 1;

-- ----------------------------
-- View structure for V_RIM_WF_MISSIVE_RELATIVE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_MISSIVE_RELATIVE" AS 
SELECT DISTINCT A.COMEONNUMER COMEONNUMER, a.missivetitle, a.missiveid, a.partcode,
                   a.falg
              FROM t_rim_wf_missive a, wf_rt_case b
             WHERE a.missiveid = b.datakey AND a.falg = '0' AND b.status = '3' and a.comeonnumer is not null;

-- ----------------------------
-- View structure for V_RIM_WF_MISSIVE_VIEW
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_MISSIVE_VIEW" AS 
select a.missiveid, a.missivetitle,  a.missivetype,c.itemname citemname,
             a.exigence ,d.itemname ditemname,
              a.keepsecret,f.itemname, a.operid, a.proposaltele, a.addresserdept, a.maindept, a.ccdept, a.thematic, a.falg, a.comeondept, a.comeonnumer, a.comeoncode, a.comeondate, a.dodate,
               a.contexttype , a.createdate, a.cretaer, a.partcode,b.stateflag,b.insertTime
    ,b.operatid,b.insertpeop,b.updattime,b.updatpeop,K."CASEID",K."WORKID",K."ACTIVITYINSTID",K."PERFORMER",K."ARRIVEDATE",K."ACCEPTDATE",K."FINISHDATE",K."CANRETURN",K."CANRETAKE",K."SEQNO",K."ISCOMMITED",K."LIMITDATE",K."PACKAGEID",K."PROCESSID",K."PROCESSNAME",K."DATAKEY",K."SUBJECT",K."CREATOR",K."CREATED",K."CASESTATUS",K."ACTIVITYID",K."ACTIVITYNAME",K."NOTE",K."ASSIGNEE",K."EUNAME",K."REMAK",K."USERNAME"
 from t_rim_wf_missive a,T_RIM_WF_MissiveState b,(select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='02') c,(select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='03') d,
 (select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='04') f,V_WF_WORK K
 where  a.missiveid(+)=b.missiveid and  a.missivetype=c.itemid(+) and a.exigence=d.itemid(+) and a.keepsecret=f.itemid(+) and a.MISSIVEID=K.datakey;

-- ----------------------------
-- View structure for V_RIM_WF_MISSIVE_VIEWS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_MISSIVE_VIEWS" AS 
select a.missiveid, a.missivetitle,  a.missivetype,c.itemname citemname,
             a.exigence ,d.itemname ditemname,
              a.keepsecret,f.itemname, a.operid, a.proposaltele, a.addresserdept, a.maindept, a.ccdept, a.thematic, a.falg, a.comeondept, a.comeonnumer, a.comeoncode, a.comeondate, a.dodate,
               a.contexttype , a.createdate, a.cretaer, a.partcode,b.stateflag,b.operatid
 from t_rim_wf_missive a,T_RIM_WF_MissiveState b,(select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='02') c,(select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='03') d,
 (select itemID,ITEMNAME from T_RIM_OA_TYPE where TYpeID='04') f
 where  a.missiveid(+)=b.missiveid and  a.missivetype=c.itemid(+) and a.exigence=d.itemid(+) and a.keepsecret=f.itemid(+);

-- ----------------------------
-- View structure for V_RIM_WF_MISSIVEFORMSINFO
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_MISSIVEFORMSINFO" AS 
select a."MISSIVEID",a."MISSIVETITLE",a."MISSIVETYPE",a."EXIGENCE",a."KEEPSECRET",a."OPERID",a."PROPOSALTELE",a."ADDRESSERDEPT",a."MAINDEPT",a."CCDEPT",a."THEMATIC",a."FALG",a."COMEONDEPT",a."COMEONNUMER",a."COMEONCODE",a."COMEONDATE",a."DODATE",a."CONTEXTTYPE",a."CREATEDATE",a."CRETAER",a."PARTCODE",b.formname,b.formurl,b.formshowurl,b.guid as formsguid,c.wfguid,c.guid as formsinfoguid from t_rim_wf_missive a ,t_rim_wf_forms b,
T_RIM_WF_FORMSINFO c
where  a.missiveid=c.wfguid(+) and b.guid=c.formsguid;

-- ----------------------------
-- View structure for V_RIM_WF_MISSIVEREADER_FLAG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_MISSIVEREADER_FLAG" AS 
SELECT a.missivetitle, b.NAME creatorname, a.createdate, b.mobile,
          a.operid creator, c.operatid,nvl(d.name,C.OPERATID) operatname, a.missiveid, c.flag, c.inserttime
     FROM t_rim_wf_missive a, v_rim_comm_userinfo b, t_rim_wf_missivereader c,v_rim_comm_userinfo d
    WHERE a.operid = b.userid
      AND a.missivetype = 1
      AND a.missiveid = c.missiveid
      and C.OPERATID=D.USERID;

-- ----------------------------
-- View structure for V_RIM_WF_PRODUCE_DRAFT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_PRODUCE_DRAFT" AS 
select  ----无线电通讯设备生产许可证审批（工作流视图）----未提交、已提交
A."ACCEPT_ID",A."ACCEPT_DATE",A."LICE_NO",A."RECORD_NO",A."DEPT_ID",A."PROD_ADREE",A."PROD_ITEM",A."VALID_BEGIN",A."VALID_END",A."OEM_DEPT",A."OEM_CERT",A."WORK_AREA",A."EMPL_SUM",A."DEVE_SUM",A."PROD_SUM",A."LINE_SUM",A."PROD_FLOW",A."QA_MODE",A."SCREEN_WAY",A."MANA_SIGN",A."FILL_DATE",A."QUAL_AUDIT",A."QUAL_PASS",A."QUAL_SIGN",A."QUAL_DATE",A."REVIEW_PROD",A."REVIEW_INST",A."REVIEW_TECH",A."REVIEW_QA",A."REVIEW_AUDIT",A."REVIEW_PASS",A."REVIEW_SIGN",A."REVIEW_DATE",A."SUPER_AUDIT",A."SUPER_KEY",A."SUPER_NOTE",A."SUPER_PASS",A."LEAD_AUDIT",A."LEAD_PASS",A."LEAD_SIGN",A."LEAD_DATE",A."ORG_AREA_CODE",A."RESID_GUID",A."USERID",A."ORG_NAME",A."ORG_TYPE",A."DEPT_NAME",A."COM_TYPE",A."ORG_LINK_PERSON",A."ORG_PHONE",A."ORG_ADDR",A."DATAKEY",B.ID,B.ACTIVITY,b.ACTOR,B.PROCESSDATE,B.NOTE,B.REFDATA
from V_RIM_WF_Produce_main a, T_RIM_OA_doc_wfnote b
where a.DATAKEY=' ' and a.Resid_Guid=b.refdata(+) and b.refdata is null;

-- ----------------------------
-- View structure for V_RIM_WF_PRODUCE_MAIN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_PRODUCE_MAIN" AS 
select ----无线电通讯设备生产许可证申请数据(工作流视图)
a."ACCEPT_ID",a."ACCEPT_DATE",a."LICE_NO",a."RECORD_NO",a."DEPT_ID",a."PROD_ADREE",a."PROD_ITEM",a."VALID_BEGIN",a."VALID_END",a."OEM_DEPT",a."OEM_CERT",a."WORK_AREA",a."EMPL_SUM",a."DEVE_SUM",a."PROD_SUM",a."LINE_SUM",a."PROD_FLOW",a."QA_MODE",a."SCREEN_WAY",a."MANA_SIGN",a."FILL_DATE",a."QUAL_AUDIT",a."QUAL_PASS",a."QUAL_SIGN",a."QUAL_DATE",a."REVIEW_PROD",a."REVIEW_INST",a."REVIEW_TECH",a."REVIEW_QA",a."REVIEW_AUDIT",a."REVIEW_PASS",a."REVIEW_SIGN",a."REVIEW_DATE",a."SUPER_AUDIT",a."SUPER_KEY",a."SUPER_NOTE",a."SUPER_PASS",a."LEAD_AUDIT",a."LEAD_PASS",a."LEAD_SIGN",a."LEAD_DATE",a."ORG_AREA_CODE",a."RESID_GUID",a."USERID",b.org_name,b.ORG_Type,b.org_name as dept_name,b.org_type as com_type,
b.org_link_person,b.org_phone,b.org_addr,F_IFNULL(E.DATAKEY) AS DATAKEY
from T_RIM_wf_produce_main a,rsbt_org b,WF_RT_CASE E
where a.Dept_id=b.GUID(+)  AND  A.Resid_Guid=E.DATAKEY(+)  order by A.ACCEPT_ID;

-- ----------------------------
-- View structure for V_RIM_WF_SELL_MAIN
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_SELL_MAIN" AS 
select "ACCEPT_ID","ACCEPT_DATE","LICE_NO","DEPT_ID","SELL_ADREE","SELL_ITEM","VALID_BEGIN","VALID_END","MANA_SIGN","FILL_DATE","QUAL_AUDIT","QUAL_PASS","QUAL_SIGN","QUAL_DATE","REVIEW_AUDIT","REVIEW_PASS","REVIEW_SIGN","REVIEW_DATE","SUPER_AUDIT","SUPER_KEY","SUPER_NOTE","SUPER_PASS","LEAD_AUDIT","LEAD_PASS","LEAD_SIGN","LEAD_DATE","GUID","AREA_CODE","USERID","DATAKEY","ORG_NAME" from
(select A.*,F_IFNULL(B.DATAKEY) AS DATAKEY,c.ORG_NAME
 from t_rim_wf_sell_main A,WF_RT_CASE B,v_rim_frm_rsbt_org c
 where a.guid=b.datakey(+) and a.dept_id=c.GUID) d where d.DATAKEY<>d.guid;

-- ----------------------------
-- View structure for V_RIM_WF_USERS_USERNA_DEP
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RIM_WF_USERS_USERNA_DEP" AS 
select u.userid,u.username,
  (select d.deptname from t_rim_comm_department d where d.deptid=(select de.deptid from t_rim_comm_dept_emp de where de.empno=u.empno and de.direct='Y')) depart,
  (select d1.deptid from t_rim_comm_department d1 where d1.deptid=(select de1.deptid from t_rim_comm_dept_emp de1 where de1.empno=u.empno and de1.direct='Y')) depid
  from t_rim_comm_user u;

-- ----------------------------
-- View structure for V_RSBT_LICENSE_COUNT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBT_LICENSE_COUNT" AS 
SELECT
	VA.LICENSE_DATE,
	VA.LICE_STATUS
FROM
	V_RSBT_LICENSE_LIST_A VA
UNION ALL
	SELECT
		VB.LICENSE_DATE,
		VB.LICE_STATUS
	FROM
		V_RSBT_LICENSE_LIST_B VB;

-- ----------------------------
-- View structure for V_RSBT_LICENSE_LIST_A
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBT_LICENSE_LIST_A" AS 
SELECT
	D.GUID ORG_GUID,
	A.NET_GUID,
	A.GUID STATION_GUID,
	A.APP_CODE,
	A.STAT_NAME,
	SUBSTR (A.APP_CODE ,- 12, 12) APP_CODEDES,
	A.STAT_APP_TYPE || A.STAT_TDI STAT_TDI,
	'' EQU_CODE,
	'' EQU_MENU,
	A.STAT_TDI STAT_TDINO,
	B.GUID LIC_GUID,
	DECODE (
		A.ORG_CODE,
		NULL,
		DECODE (
			SUBSTR (A.APP_CODE, 2, 1),
			'9',
			'000000',
			SUBSTR (A.APP_CODE, 2, 4) || '00'
		),
		A.ORG_CODE
	) AREA_CODE,
	DECODE (
		SUBSTR (A.APP_CODE, 1, 1),
		'P',
		F_RIM_RSM_GETPANAMEBYAPPCODE (A.APP_CODE),
		D.ORG_NAME
	) ORG_NAME,
	A.STAT_ADDR,
	E.CODE_CHI_NAME STAT_TYPE,
	A.STAT_TYPE STAT_TYPE_CODE,
	A.STAT_DATE_START,
	B.LICE_OK,
	B.LICENSE_DATE_E,
	F_RIM_RSM_LICEVALIDCHECK (B.LICENSE_DATE_E, B.LICE_OK) LICE_STATUS,
	B.LICENSE_CODE,
	NVL (B.EQUIP_NO, '1') EQUIP_NO,
	B.LICENSE_DATE_B,
	B.LICENSE_DATE,
	B.MEMO,
	A.STAT_APP_TYPE DECL_KEY,
	D.ORG_SYS_CODE,
	G.CODE_CHI_NAME AREA_VIEW,
	B.RQCODE
FROM
	RSBT_STATION A,
	V_RSBT_LICENSE_STATUS B,
	RSBT_NET C,
	RSBT_ORG D,
	RSBT_CODE_DIC E,
	RSBT_CODE_DIC G
WHERE
	A.STAT_APP_TYPE <> 'LM'
AND INSTR (NVL(B.STAT_TDI, 'WW'), 'LM') = 0
AND A.STAT_STATUS = '1'
AND A.APP_CODE = B.APP_CODE (+)
AND A.STAT_APP_TYPE || A.STAT_TDI = B.STAT_TDI_LIC (+)
AND A.NET_GUID = C.GUID (+)
AND C.ORG_GUID = D.GUID (+)
AND A.STAT_TYPE = E.CN (+)
AND E.CODE_DATA_TYPE (+) = '00052006'
AND A.ORG_CODE = G.CN (+)
AND G.CODE_DATA_TYPE (+) = '00032006';

-- ----------------------------
-- View structure for V_RSBT_LICENSE_LIST_B
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBT_LICENSE_LIST_B" AS 
SELECT
	D.GUID ORG_GUID,
	A.NET_GUID,
	A.STATION_GUID STATION_GUID,
	A.APP_CODE,
	A.STAT_NAME,
	SUBSTR (A.APP_CODE ,- 12, 12) APP_CODEDES,
	A.STAT_APP_TYPE || A.STAT_TDI STAT_TDI,
	A.EQU_CODE,
	A.EQU_MENU,
	A.STAT_TDI STAT_TDINO,
	B.GUID LIC_GUID,
	DECODE (
		A.ORG_CODE,
		NULL,
		DECODE (
			SUBSTR (A.APP_CODE, 2, 1),
			'9',
			'000000',
			SUBSTR (A.APP_CODE, 2, 4) || '00'
		),
		A.ORG_CODE
	) AREA_CODE,
	DECODE (
		SUBSTR (A.APP_CODE, 1, 1),
		'P',
		F_RIM_RSM_GETPANAMEBYAPPCODE (A.APP_CODE),
		D.ORG_NAME
	) ORG_NAME,
	A.STAT_ADDR,
	E.CODE_CHI_NAME STAT_TYPE,
	A.STAT_TYPE STAT_TYPE_CODE,
	A.STAT_DATE_START,
	B.LICE_OK,
	B.LICENSE_DATE_E,
    B.LICENSE_MANAGER,
	F_RIM_RSM_LICEVALIDCHECK (B.LICENSE_DATE_E, B.LICE_OK) LICE_STATUS,
	B.LICENSE_CODE,
	DECODE (
		NVL (B.EQUIP_NO, ''),
		'',
		A.ET_EQU_NO,
		B.EQUIP_NO
	) EQUIP_NO,
	B.LICENSE_DATE_B,
	B.LICENSE_DATE,
	B.MEMO,
	A.STAT_APP_TYPE DECL_KEY,
	D.ORG_SYS_CODE,
	G.CODE_CHI_NAME AREA_VIEW,
	B.RQCODE
FROM
	V_RSBT_STATION_EQU A,
	V_RSBT_LICENSE_STATUS B,
	RSBT_STATION S,
	RSBT_NET C,
	RSBT_ORG D,
	RSBT_CODE_DIC E,
	RSBT_CODE_DIC G
WHERE
	A.STAT_APP_TYPE = 'LM'
AND A.STAT_STATUS = '1'
AND A.STATION_GUID = S.GUID
AND A.STATION_GUID = B.STATION_GUID (+)
AND A.ET_EQU_NO = B.EQUIP_NO (+)
AND S.NET_GUID = C.GUID (+)
AND C.ORG_GUID = D.GUID (+)
AND S.STAT_TYPE = E.CN (+)
AND E.CODE_DATA_TYPE (+) = '00052006'
AND S.ORG_CODE = G.CN (+)
AND G.CODE_DATA_TYPE (+) = '00032006';

-- ----------------------------
-- View structure for V_RSBT_LICENSE_STATUS
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBT_LICENSE_STATUS" AS 
SELECT
	A.GUID,
	A.STATION_GUID,
	A.APP_CODE,
	A.STAT_TDI,
	A.STAT_APP_TYPE,
	A.LICENSE_TYPE,
	B.LICENSE_CODE,
	A.LICENSE_ORG_NAME,
	A.LICENSE_MANAGER,
	SUBSTR (A.APP_CODE ,- 12, 12) APPLY_CODE,
	A.LICENSE_DATE_B,
	A.LICENSE_DATE_E,
	A.LICENSE_DATE,
	A.MEMO,
	B.GUID LICSTATUES_GUID,
	B.EQUIP_NO,
	B.LICE_OK,
	B.NOTE,
	A.STAT_APP_TYPE || A.STAT_TDI STAT_TDI_LIC,
	SUBSTR (A.LICENSE_CODE, 0, 4) || '00' ORG_CODE,
	F_RIM_RSM_LICEVALIDCHECK (A.LICENSE_DATE_E, B.LICE_OK) LICE_STATUS,
	B.PRINTSTATUS,
	B.RQCODE
FROM
	RSBT_LICENSE A,
	T_RIM_RSM_LIC_STATUES B
WHERE
	A.GUID = B.GUID (+);

-- ----------------------------
-- View structure for V_RSBT_LINK
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBT_LINK" AS 
SELECT
	A."GUID",A."NET_GUID_A",A."STATION_GUID_A",A."GUID_EAF_A",A."NET_GUID_B",A."STATION_GUID_B",A."GUID_EAF_B",
	B.ST_TF_CODE AS ST_TF_CODE_A,
	B.APP_CODE AS APP_CODE_A,
	B.STAT_TDI AS STAT_TDI_A,
    B.STAT_APP_TYPE AS STAT_APP_TYPE_A,
	D.FREQ_LC AS FREQ_LC_A,
	D.FREQ_UC AS FREQ_UC_A,
    E.ST_TF_CODE AS ST_TF_CODE_B,
	E.APP_CODE AS APP_CODE_B,
	E.STAT_TDI AS STAT_TDI_B,
    E.STAT_APP_TYPE AS STAT_APP_TYPE_B,
	G.FREQ_LC AS FREQ_LC_B,
	G.FREQ_UC AS FREQ_UC_B
FROM
	RSBT_LINK A,
	V_RSBTSTATION_T B,
	RSBT_EAF C,
	V_RSBTFREQ_T D,
    V_RSBTSTATION_T E,
	RSBT_EAF F,
	V_RSBTFREQ_T G
WHERE
	A.STATION_GUID_A = B.GUID
AND A.GUID_EAF_A = C.GUID
AND C.FREQ_GUID = D.GUID
AND A.STATION_GUID_B = E.GUID
AND A.GUID_EAF_B= F.GUID
AND F.FREQ_GUID = G.GUID;

-- ----------------------------
-- View structure for V_RSBT_STATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBT_STATION" AS 
SELECT
A.GUID,
A.NET_GUID,
A.ORG_CODE,
A.APP_CODE,
A.STAT_APP_TYPE,
A.STAT_TDI,
A.STAT_NAME,
A.STAT_ADDR,
A.STAT_AREA_CODE,
A.STAT_TYPE,
A.STAT_WORK,
A.STAT_STATUS,
A.STAT_EQU_SUM,
A.STAT_LG,
A.STAT_LA,
A.STAT_AT,
A.STAT_DATE_START,
A.MEMO,
A.STAT_COODINATION,
A.STAT_INTCOORDSTATUS,
A.STAT_INTCOODINATION,
A.STAT_COORDADM,
A.STAT_REGISTERCODE,
B.ST_TIME_B,
B.ST_TIME_E,
B.ST_LMMTR,
B.ST_USER_AREA,
B.ST_TF_CODE,
B.ST_TF_TRANS_CA_PU,
B.ST_TF_TRANS_CA_P,
B.ST_E_NET_CODE,
B.ST_E_MULTI_ADDR,
B.ST_E_COM_AREA,
B.ST_POS_TYPE,
B.ST_E_POS,
B.ST_E_SAT,
B.ST_E_LG,
B.ST_B_SGN,
B.ST_B_LEVEL,
B.ST_B_BM,
B.ST_B_EDU,
B.ST_B_IC,
B.ST_B_COVER_AREA,
B.ST_SHIP_TYPE,
B.ST_CALL_SIGN,
B.ST_S_MMSI,
B.ST_S_CS,
B.ST_SHIP_NAME,
B.ST_S_PN,
B.ST_S_AAIC,
B.ST_S_T,
B.ST_S_P,
B.ST_A_MODEL,
B.ST_A_TYPE,
B.ST_A_CALL,
B.ST_A_CALL_OI,
B.ST_A_SGN,
B.ST_A_ST,
B.ST_A_PILOTING,
B.ST_A_NRM,
B.ST_R_WAMIN,
B.ST_R_WAMAX,
B.ST_R_EMIN,
B.ST_R_EMAX,
B.ST_C_CODE,
B.ST_C_SUM,
B.ST_SERV_R,
B.ST_D_TEC_TYPE,
B.ST_D_TYPE,
B.ST_ME_SAT_NAME,
B.ST_ME_STA1,
B.ST_ME_STA2,
B.ST_ME_STA3,
B.ST_ME_STYPE,
B.ST_ME_NAME1,
B.ST_ME_NAME2,
B.ST_ME_LG1,
B.ST_ME_LG2,
B.ST_ME_FBAND,
B.ST_B_TYPE1,
B.ST_B_TYPE2,
B.ST_ME_FILE_NO
from RSBT_STATION a, RSBT_STATION_T b
where a.GUID = b.GUID;

-- ----------------------------
-- View structure for V_RSBT_STATION_EQU
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBT_STATION_EQU" AS 
SELECT
	A.GUID,
	A.STATION_GUID,
	A.EQU_TYPE,
	A.EQU_MODEL,
	A.EQU_AUTH,
	A.EQU_MENU,
	A.EQU_CODE,
	A.EQU_PF,
	F_RIM_RSM_GETPOWER_W (A.EQU_POW, A.ET_POW_U) EQU_POW,
	A.EQU_MB,
	A.ET_EQU_NO,
	A.ET_AF_TYPE,
	A.ET_POW_U,
	A.ET_EQU_CL,
	A.ET_EQU_TL,
	A.ET_EQU_RNQ,
	A.ET_EQU_TYPE_ID,
	A.ET_EQU_NAME,
	A.ET_EQU_CODE,
	A.ET_EQU_ESGN,
	A.ET_EQU_EPOS,
	A.ET_EQU_ATYPE,
	A.ET_EQU_APOS,
	A.ET_EQU_SUM,
	A.ET_EQU_EUSE,
	A.ET_EQU_FNTVAL,
	A.ET_EQU_PUP,
	A.ET_EQU_PDN,
	A.ET_EQU_CHRIP,
	A.ET_EQU_PWID1,
	A.ET_EQU_PWID2,
	A.ET_EQU_PR,
	A.ET_EQU_PF,
	A.ET_EQU_SEN,
	A.ET_EQU_SENU,
	A.ET_EQU_SENERR,
	A.ET_EQU_RWID,
	A.ET_EQU_MT,
	A.ET_EQU_CCODE,
	A.ET_EQU_UPU,
	A.ET_EQU_DNU,
	A.ET_EQU_TYPE,
	A.ET_EQU_USE,
	A.ET_EQU_POW_MAX,
	A.ET_EQU_POW_AVG,
	A.ET_EQU_UPOW,
	A.ET_EQU_DPOW,
	A.ET_EQU_RF,
	A.ET_EQU_RF_BAND,
	B.NET_GUID,
	B.ORG_CODE,
	B.APP_CODE,
	B.STAT_APP_TYPE,
	B.STAT_TDI,
	B.STAT_NAME,
	B.STAT_ADDR,
	B.STAT_AREA_CODE,
	B.STAT_TYPE,
	B.STAT_WORK,
	B.STAT_STATUS,
	B.STAT_EQU_SUM,
	B.STAT_LG,
	B.STAT_LA,
	B.STAT_AT,
	B.STAT_DATE_START,
	B.MEMO
FROM
	V_RSBTEQU_T A,
	RSBT_STATION B
WHERE A.STATION_GUID = B.GUID;

-- ----------------------------
-- View structure for V_RSBTANTFEED_T
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBTANTFEED_T" AS 
SELECT
A.GUID,
A.STATION_GUID,
A.ANT_WORK_TYPE,
A.ANT_POLE,
A.ANT_RPOLE,
A.ANT_EPOLE,
A.ANT_TYPE,
A.ANT_MODEL,
A.ANT_MENU,
A.ANT_HIGHT,
A.ANT_GAIN,
A.ANT_EGAIN,
A.ANT_RGAIN,
A.ANT_ANGLE,
A.ANT_SIZE,
A.FEED_MENU,
A.FEED_MODEL,
A.FEED_LENGTH,
A.FEED_LOSE,
A.ANT_CODE,
A.FEED_CODE,
B.AT_ANT_NO,
B.AT_SE_B,
B.AT_SE_E,
B.AT_ANG_B,
B.AT_ANG_E,
B.AT_RNT,
B.AT_BWID,
B.AT_LEL,
B.AT_SSPEED,
B.AT_CCODE,
B.AT_3DBE,
B.AT_3DBR,
B.AT_RANG,
B.AT_EANG,
B.AT_CSGN,
B.AT_UPDN,
B.AT_SUM,
B.AT_QUA,
B.AT_UNIT_TYPE,
B.AT_H_HPIC,
B.AT_H_VPIC,
B.AT_ANT_UPANG
FROM 
RSBT_ANTFEED A, 
RSBT_ANTFEED_T B
WHERE 
A.GUID = B.GUID;

-- ----------------------------
-- View structure for V_RSBTAPPLY_RSBTORG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBTAPPLY_RSBTORG" AS 
SELECT 
a."GUID",a."ORG_GUID",a."NET_GUID",a."ORG_MANAGER_GUID",a."APP_CODE",a."APP_TYPE",a."APP_SUB_TYPE",a."APP_OBJECT_TYPE",a."APP_DATE",a."APP_FTLB",a."APP_FTLE",a."MEMO",
b.ORG_NAME,
b.ORG_ADDR,
b.ORG_PHONE,
b.ORG_LINK_PERSON,
b.ORG_SYS_CODE,
c.NET_AREA,
c.NET_BAND
FROM
RSBT_APPLY a , 
RSBT_ORG b,
RSBT_NET c
WHERE a.ORG_GUID = b.GUID
AND a.NET_GUID = c.GUID;

-- ----------------------------
-- View structure for V_RSBTEAF_DATA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBTEAF_DATA" AS 
SELECT
a."GUID",a."STATION_GUID",a."EQU_GUID",a."ANT_GUID",a."FREQ_GUID",
b.APP_CODE,
b.STAT_TDI,
b.STAT_APP_TYPE,
b.ST_TF_CODE,
c.ET_EQU_NO,
c.EQU_MODEL,
c.EQU_CODE,
c.ET_EQU_TFCODE,
d.FT_FREQ_NO,
d.FREQ_TYPE,
d.FREQ_LC,
d.FREQ_UC,
d.FREQ_EFB,
d.FREQ_EFE,
e.ANT_MODEL
FROM
RSBT_EAF a,
V_RSBTSTATION_T b,
V_RSBTEQU_T c,
V_RSBTFREQ_T d,
V_RSBTANTFEED_T e
WHERE
a.STATION_GUID = b.GUID
AND
a.EQU_GUID = c.GUID
AND
a.FREQ_GUID = d.GUID
AND
a.ANT_GUID = e.GUID;

-- ----------------------------
-- View structure for V_RSBTEAF_FREQ_EQU_STATION_ANT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBTEAF_FREQ_EQU_STATION_ANT" AS 
SELECT
	A."GUID",A."STATION_GUID",A."EQU_GUID",A."ANT_GUID",A."FREQ_GUID",
    B.FREQ_TYPE,
    B.FREQ_LC,
    B.FREQ_EFB,
    B.FREQ_EFE,
    B.FREQ_UC,
    B.FREQ_RFB,
    B.FREQ_RFE,
    B.FT_FREQ_HCL,
    B.FT_FREQ_FEP,
    B.FREQ_MOD,
    B.FT_FREQ_POW_MAX,
    B.FT_FREQ_POW_AVG,
    C.EQU_POW,
    C.EQU_MODEL,
    C.EQU_CODE,
    C.EQU_AUTH,
    C.ET_EQU_NO,
    C.ET_EQU_TFCODE,
    C.ET_EQU_CL,
    C.ET_EQU_ESGN,
    C.ET_EQU_TYPE_ID,
    C.ET_EQU_NAME,
    D.ST_USER_AREA,
    D.ST_TF_CODE,
    D.ST_TF_TRANS_CA_P,
    D.ST_E_NET_CODE,
    D.ST_E_SAT,
    D.ST_E_LG,
    D.ST_E_MULTI_ADDR,
    D.STAT_DATE_START,
    D.ST_B_BM,
    D.ST_SHIP_NAME,
    D.ST_CALL_SIGN,
    D.ST_S_MMSI,
    D.ST_A_NRM,
    D.ST_A_CALL_OI,
    D.ST_A_TYPE,
    E.ANT_TYPE,
    E.ANT_GAIN,
    E.ANT_HIGHT,
    E.ANT_MODEL,
    E.ANT_SIZE
FROM
	RSBT_EAF A,
	V_RSBTFREQ_T B,
	V_RSBTEQU_T C,
	V_RSBTSTATION_T D,
	V_RSBTANTFEED_T E
WHERE
	A .FREQ_GUID = B.GUID
AND A .EQU_GUID = C.GUID
AND A .STATION_GUID = D .GUID
AND A .ANT_GUID = E.GUID;

-- ----------------------------
-- View structure for V_RSBTEQU_T
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBTEQU_T" AS 
SELECT
A.GUID,
A.STATION_GUID,
A.EQU_TYPE,
A.EQU_MODEL,
A.EQU_AUTH,
A.EQU_MENU,
A.EQU_CODE,
A.EQU_PF,
A.EQU_POW,
A.EQU_MB,
B.ET_EQU_NO,
B.ET_AF_TYPE,
B.ET_POW_U,
B.ET_EQU_CL,
B.ET_EQU_TL,
B.ET_EQU_RNQ,
B.ET_EQU_TYPE_ID,
B.ET_EQU_NAME,
B.ET_EQU_CODE,
B.ET_EQU_ESGN,
B.ET_EQU_EPOS,
B.ET_EQU_ATYPE,
B.ET_EQU_APOS,
B.ET_EQU_SUM,
B.ET_EQU_EUSE,
B.ET_EQU_FNTVAL,
B.ET_EQU_PUP,
B.ET_EQU_PDN,
B.ET_EQU_CHRIP,
B.ET_EQU_PWID1,
B.ET_EQU_PWID2,
B.ET_EQU_PR,
B.ET_EQU_PF,
B.ET_EQU_RF,
B.ET_EQU_RF_BAND,
B.ET_EQU_SEN,
B.ET_EQU_SENU,
B.ET_EQU_SENERR,
B.ET_EQU_RWID,
B.ET_EQU_MT,
B.ET_EQU_CCODE,
B.ET_EQU_UPU,
B.ET_EQU_DNU,
B.ET_EQU_TYPE,
B.ET_EQU_USE,
B.ET_EQU_POW_MAX,
B.ET_EQU_POW_AVG,
B.ET_EQU_UPOW,
B.ET_EQU_DPOW,
B.ET_EQU_TFCODE
FROM 
RSBT_EQU A, 
RSBT_EQU_T B
WHERE 
A.GUID = B.GUID (+);

-- ----------------------------
-- View structure for V_RSBTFREQ_T
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBTFREQ_T" AS 
SELECT
A.GUID,
A.STATION_GUID,
A.FREQ_TYPE,
A.FREQ_LC,
A.FREQ_UC,
A.FREQ_EFB,
A.FREQ_EFE,
A.FREQ_E_BAND,
A.FREQ_RFB,
A.FREQ_RFE,
A.FREQ_R_BAND,
A.FREQ_MOD,
A.FREQ_MB,
A.FREQ_CODE,
B.FT_FREQ_NO,
B.FT_FREQ_TIMEB,
B.FT_FREQ_TIMEE,
B.FT_FREQ_INFO_TYPE,
B.FT_FREQ_HCL,
B.FT_FREQ_TYPE,
B.FT_FREQ_MC,
B.FT_FREQ_MC1,
B.FT_FREQ_MC2,
B.FT_FREQ_MC3,
B.FT_FREQ_CCODE,
B.FT_FREQ_CSGN,
B.FT_FREQ_DUPDN,
B.FT_FREQ_UNIT_TYPE,
B.FT_FREQ_FEP,
B.FT_FREQ_FRP,
B.FT_FREQ_EPOW,
B.FT_FREQ_POWFLAG,
B.FT_FREQ_EIRP,
B.FT_FREQ_POW_MAX,
B.FT_FREQ_POW_AVG
FROM 
RSBT_FREQ A, 
RSBT_FREQ_T B
WHERE 
A.GUID = B.GUID;

-- ----------------------------
-- View structure for V_RSBTILLEGAL_STATION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBTILLEGAL_STATION" AS 
SELECT
	A."GUID",A."STATION_GUID",A."STATION_ILLEGAL_TIME",A."STATION_ILLEGAL_MODE",A."STATION_SUPERVISION_STATUS",A."STATION_ILLEGAL_DATE",A."STATION_ILLEGAL_DATE_U",A."STATION_ILLEGAL_LG",A."STATION_ILLEGAL_LA",A."STATION_ILLEGAL_EQUMODE",A."STATION_PUNISH_TIME",A."STATION_PUNISH_RESULT",A."MEMO",
    B.APP_CODE,
    B.STAT_TDI,
    B.STAT_NAME,
    B.STAT_ADDR,
    B.STAT_APP_TYPE
FROM
	RSBT_STATIONSUPERVISIONRECORD A,
	RSBT_STATION B
WHERE
	A.STATION_GUID = B.GUID;

-- ----------------------------
-- View structure for V_RSBTSTATION_APPLY_ORG
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBTSTATION_APPLY_ORG" AS 
SELECT
	A."GUID",A."NET_GUID",A."ORG_CODE",A."APP_CODE",A."STAT_APP_TYPE",A."STAT_TDI",A."STAT_NAME",A."STAT_ADDR",A."STAT_AREA_CODE",A."STAT_TYPE",A."STAT_WORK",A."STAT_STATUS",A."STAT_EQU_SUM",A."STAT_LG",A."STAT_LA",A."STAT_AT",A."STAT_DATE_START",A."MEMO",A."ST_TIME_B",A."ST_TIME_E",A."ST_LMMTR",A."ST_USER_AREA",A."ST_TF_CODE",A."ST_TF_TRANS_CA_PU",A."ST_TF_TRANS_CA_P",A."ST_E_NET_CODE",A."ST_E_MULTI_ADDR",A."ST_E_COM_AREA",A."ST_POS_TYPE",A."ST_E_POS",A."ST_E_SAT",A."ST_E_LG",A."ST_B_SGN",A."ST_B_LEVEL",A."ST_B_BM",A."ST_B_EDU",A."ST_B_IC",A."ST_B_COVER_AREA",A."ST_SHIP_TYPE",A."ST_CALL_SIGN",A."ST_S_MMSI",A."ST_S_CS",A."ST_SHIP_NAME",A."ST_S_PN",A."ST_S_AAIC",A."ST_S_T",A."ST_S_P",A."ST_A_MODEL",A."ST_A_TYPE",A."ST_A_CALL",A."ST_A_CALL_OI",A."ST_A_SGN",A."ST_A_ST",A."ST_A_PILOTING",A."ST_A_NRM",A."ST_R_WAMIN",A."ST_R_WAMAX",A."ST_R_EMIN",A."ST_R_EMAX",A."ST_C_CODE",A."ST_C_SUM",A."ST_SERV_R",A."ST_D_TEC_TYPE",A."ST_D_TYPE",A."ST_ME_SAT_NAME",A."ST_ME_STA1",A."ST_ME_STA2",A."ST_ME_STA3",A."ST_ME_STYPE",A."ST_ME_NAME1",A."ST_ME_NAME2",A."ST_ME_LG1",A."ST_ME_LG2",A."ST_ME_FBAND",A."ST_B_TYPE1",A."ST_B_TYPE2",A."ST_ME_FILE_NO", 
    B.ORG_SYS_CODE,
    B.ORG_NAME,
    C.GUID AS SPLSTATION_GUID
FROM
	V_RSBTSTATION_T A
INNER JOIN V_RSBTAPPLY_RSBTORG B ON A .APP_CODE = B.APP_CODE
LEFT JOIN SPLSTATION_MANGER C ON A .GUID = C.STATION_GUID;

-- ----------------------------
-- View structure for V_RSBTSTATION_T
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSBTSTATION_T" AS 
SELECT
A.GUID,
A.NET_GUID,
A.ORG_CODE,
A.APP_CODE,
A.STAT_APP_TYPE,
A.STAT_TDI,
A.STAT_NAME,
A.STAT_ADDR,
A.STAT_AREA_CODE,
A.STAT_TYPE,
A.STAT_WORK,
A.STAT_STATUS,
A.STAT_EQU_SUM,
A.STAT_LG,
A.STAT_LA,
A.STAT_AT,
A.STAT_DATE_START,
A.MEMO,
B.ST_TIME_B,
B.ST_TIME_E,
B.ST_LMMTR,
B.ST_USER_AREA,
B.ST_TF_CODE,
B.ST_TF_TRANS_CA_PU,
B.ST_TF_TRANS_CA_P,
B.ST_E_NET_CODE,
B.ST_E_MULTI_ADDR,
B.ST_E_COM_AREA,
B.ST_POS_TYPE,
B.ST_E_POS,
B.ST_E_SAT,
B.ST_E_LG,
B.ST_B_SGN,
B.ST_B_LEVEL,
B.ST_B_BM,
B.ST_B_EDU,
B.ST_B_IC,
B.ST_B_COVER_AREA,
B.ST_SHIP_TYPE,
B.ST_CALL_SIGN,
B.ST_S_MMSI,
B.ST_S_CS,
B.ST_SHIP_NAME,
B.ST_S_PN,
B.ST_S_AAIC,
B.ST_S_T,
B.ST_S_P,
B.ST_A_MODEL,
B.ST_A_TYPE,
B.ST_A_CALL,
B.ST_A_CALL_OI,
B.ST_A_SGN,
B.ST_A_ST,
B.ST_A_PILOTING,
B.ST_A_NRM,
B.ST_R_WAMIN,
B.ST_R_WAMAX,
B.ST_R_EMIN,
B.ST_R_EMAX,
B.ST_C_CODE,
B.ST_C_SUM,
B.ST_SERV_R,
B.ST_D_TEC_TYPE,
B.ST_D_TYPE,
B.ST_ME_SAT_NAME,
B.ST_ME_STA1,
B.ST_ME_STA2,
B.ST_ME_STA3,
B.ST_ME_STYPE,
B.ST_ME_NAME1,
B.ST_ME_NAME2,
B.ST_ME_LG1,
B.ST_ME_LG2,
B.ST_ME_FBAND,
B.ST_B_TYPE1,
B.ST_B_TYPE2,
B.ST_ME_FILE_NO
FROM 
RSBT_STATION A, 
RSBT_STATION_T B
WHERE 
A.GUID = B.GUID;

-- ----------------------------
-- View structure for V_RSM_PAY_DEPTITEM_DETAIL_AA
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSM_PAY_DEPTITEM_DETAIL_AA" AS 
select
----查看年度计费明细视图
"ORG_TYPE","ITEM_NO","APPLY_CODE","DECL_CODE","DEPT_PAY","AREA_CODE","COUNT_YEAR","TYPE_NAME","ITEM_CODE","ITEM_NAME","FEE_PAY","COUNT_MODE","FREQ_NOTE","AMOUNT","SUM_COUNT","DERATE","SUM_PAY" from v_rim_rsm_pay_deptitem_detail
order by  to_Number(Substr(decl_code,Length(decl_code)-3,4));

-- ----------------------------
-- View structure for V_RSM_SDB_LICE_EQUIP
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_RSM_SDB_LICE_EQUIP" AS 
select
  ----用于迁移所有老版本2014年及以前的执照数据
  F_rim_rsm_AppCode(A.APPLY_CODE,A.DECL_CODE) as APPLY_CODE_Temp,F_rim_rsm_Station_GuidCode(A.APPLY_CODE,A.DECL_CODE) AS Station_Guid,
  A.APPLY_CODE,A.DECL_CODE,A.EQUIP_NO,A.LICE_CODE,A.VALID_BEGIN,A.VALID_END,A.ISSUE_DATE,A.LICE_OK,A.UPDATEFLAG
 from SDB_LICE_EQUIP A where A.UPDATEFLAG='0';

-- ----------------------------
-- View structure for V_SDB_PAY_APPLYCOUNT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_SDB_PAY_APPLYCOUNT" AS 
select
  ----老版本【频率台站Ver2.0】缴费数据查询（缴费单位明细）--申请表
   item_no,a.apply_code,a.area_code,dept_pay,org_name,count_year,sum_count,handler,
to_char(handle_date,'YYYY-MM-DD') handle_date,checker,
to_char(check_date,'YYYY-MM-DD') check_date,confirm,
decode(confirm,'N','否','是') is_check,paid,sum_paid
  from sdb_pay_Applycount a,rsbt_org b
   where a.dept_pay=b.guid(+);

-- ----------------------------
-- View structure for V_SDB_PAY_DEPTCOUNT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_SDB_PAY_DEPTCOUNT" AS 
select
  ----老版本【频率台站Ver2.0】缴费数据查询（缴费单位明细）---单位
  item_no,a.area_code,a.dept_pay,org_name,count_year,
sum_count,handler,to_char(handle_date,'YYYY-MM-DD') handle_date,
checker,to_char(check_date,'YYYY-MM-DD') check_date,confirm,decode(confirm,'N','否','是') is_check,paid,sum_paid
  from sdb_pay_deptcount a,rsbt_org b
   where a.dept_pay=b.guid(+);

-- ----------------------------
-- View structure for V_SDB_PAY_RESULT_BB
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_SDB_PAY_RESULT_BB" AS 
select
   ----老版本频率台站V2.0综合查询缴费数据
   B."ITEM_NO",B."NET_GUID",B."APPLY_CODE",B."TYPE_ID",B."PAY_TYPE",B."AREA_CODE",B."DEPT_PAY",B."ORG_NAME",B."COUNT_YEAR",B."SUM_COUNT",B."CONFIRM",B."PAY_STAT",B."SUM_PAID",B."HANDLER",B."HANDLE_DATE",B."CHECKER",B."CHECK_DATE",B."NOTE",B."PAID",B."ORG_SYS_CODE",B."CODE_CHI_NAME",B."ORG_TYPE",B."ORG_LINK_PERSON",B."ORG_PERSON_ID",B."ORG_SUP_CODE",B."ORG_ADDR",B."ORG_POST",B."ORG_PHONE",B."ORG_MOB_PHONE",B."ORG_FAX",B."ORG_BANK",B."ORG_ACCOUNT_NAME",B."ORG_ACCOUNT",B."ORG_HOSTILITY",B."ORG_WEB_SITE",B."ORG_MAIL",B."STAT_COUNT",B."APPLY_CODE_TEMP",
   F_rim_rsm_App_GUID_ByDept_Pay(B.dept_pay) as  APP_GUID_TEMP
    from v_sdb_pay_result_AAA B;

-- ----------------------------
-- View structure for V_SDB_PAY_RESULT_BBB
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_SDB_PAY_RESULT_BBB" AS 
select
   ----老版本频率台站V2.0综合查询缴费数据
  "ITEM_NO","NET_GUID","APPLY_CODE","TYPE_ID","PAY_TYPE","AREA_CODE","DEPT_PAY","ORG_NAME","COUNT_YEAR","SUM_COUNT","CONFIRM","PAY_STAT","SUM_PAID","HANDLER","HANDLE_DATE","CHECKER","CHECK_DATE","NOTE","PAID","ORG_SYS_CODE","CODE_CHI_NAME","ORG_TYPE","ORG_LINK_PERSON","ORG_PERSON_ID","ORG_SUP_CODE","ORG_ADDR","ORG_POST","ORG_PHONE","ORG_MOB_PHONE","ORG_FAX","ORG_BANK","ORG_ACCOUNT_NAME","ORG_ACCOUNT","ORG_HOSTILITY","ORG_WEB_SITE","ORG_MAIL","STAT_COUNT","APPLY_CODE_TEMP","APP_GUID_TEMP"
  from V_SDB_PAY_RESULT_BB B where b.APPLY_CODE_Temp is not null and B.APP_GUID_TEMP is not null;

-- ----------------------------
-- View structure for V_SHIP_CALLSIGN_DETAIL
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_SHIP_CALLSIGN_DETAIL" AS 
select a.guid,b.st_call_sign,a.app_code, a.STAT_APP_Type || a.STAT_TDI as STAT_CODE,b.ST_Ship_Name,b.ST_S_T from RSBT_STATION a left join RSBT_STATION_T b on a.guid = b.guid where a.STAT_APP_Type = 'S' and b.st_call_sign is not null;

-- ----------------------------
-- View structure for V_SPLSTATION_CONSULT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_SPLSTATION_CONSULT" AS 
SELECT
	A.GUID,
	A.SPLSTATION_GUID,
	A.CONSULT_OBJECT,
	A.CONSULT_ADDRESS,
	A.CONSULT_CONTENT,
	A.CONSULT_FILENAME,
	A.CONSULT_TIME,
	A.REPLY_TIME,
	A.CONSULT_RESULT,
	A.REPLAY_FILENAME,
	A.CONSULT_STATUS,
	A.CREATETIME,
    B.APP_CODE,
    B.STAT_APP_TYPE,
    B.STAT_TDI,
    B.STAT_NAME
FROM
	SPLSTATION_CONSULT A,
	V_RSBTSTATION_APPLY_ORG B
WHERE
	A .SPLSTATION_GUID = B.SPLSTATION_GUID;

-- ----------------------------
-- View structure for V_SPLSTATION_ELECTENV
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_SPLSTATION_ELECTENV" AS 
SELECT
	A ."GUID",A."SPECIAL_STATION_GUID",A."FILE_NAME",A."FILE_ENCLOSEURE",A."CREATETIME", 
	B.GUID AS SPLSTATION_GUID,
    C.APP_CODE,
	C.STAT_NAME,
	C.STAT_APP_TYPE,
	C.STAT_TDI
FROM
	SPLSTATION_ELECTENV A,
	SPLSTATION_MANGER B,
	RSBT_STATION C
WHERE
	A .SPECIAL_STATION_GUID = B.GUID
AND B.STATION_GUID = C.GUID;

-- ----------------------------
-- View structure for V_STAT_BUILD_ALERT
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_STAT_BUILD_ALERT" AS 
select a."GUID",a."ORG_GUID",a."NET_GUID",a."ORG_MANAGER_GUID",a."APP_CODE",a."APP_TYPE",a."APP_SUB_TYPE",a."APP_OBJECT_TYPE",a."APP_DATE",a."APP_FTLB",a."APP_FTLE",a."MEMO",c.org_name,c.org_link_person from RSBT_APPLY a left join RSBT_STATION b on a.App_Code = b.app_code
left join RSBT_ORG c on a.org_guid = c.guid where a.app_type in ('T','PA') and b.Stat_App_Type is null and ROUND(TO_NUMBER(sysdate - app_FTLB)) > 180 order by a.APP_FTLB desc, a.APP_CODE;

-- ----------------------------
-- View structure for V_STORAGE_FREQ
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_STORAGE_FREQ" AS 
SELECT T1."GUID",T1."ORG_GUID",T1."SYS_CODE",T1."PF_TYPE",T1."ADMIN_ORG_CODE",T1."EDIT_ORG_CODE",T1."FILE_NO",T1."START_DATE",T1."STOP_DATE",T1."DATA_STATUS",T1."MEMO",T1."FREQ_PROTECT_TYPE",
  t2.org_name,
  t3.sys_name,
  t4.code_chi_name pf_name,
  t5.org_name admin_org_name,
  t6.org_name edit_org_name,
  t7.code_chi_name data_status_name,
  t8.code_chi_name FREQ_PROTECT_TYPE_NAME
FROM
 frbt_protect t1,
 rsbt_org t2,
 frbt_system t3,
 frbt_code_dic t4, 
rsbt_org t5, 
rsbt_org t6, 
frbt_code_dic t7,
frbt_code_dic t8
WHERE t1.org_guid = t2.guid(+)
AND   t1.sys_code = t3.sys_code(+)
AND   t1.pf_type = t4.cn(+) and t4.code_data_type(+)='00092006'
AND   t1.admin_org_code = t5.org_code(+)
AND   t1.edit_org_code = t6.org_code(+)
AND   t1.data_status = t7.cn(+) and t7.code_data_type(+)='00012006'
AND 	(t1.FREQ_PROTECT_TYPE = t8.cn(+) and t8.code_data_type='00172006')
AND t1.FREQ_PROTECT_TYPE = '2';

-- ----------------------------
-- View structure for V_WF_ACTIVITY
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_WF_ACTIVITY" AS 
select b."ID",b."CASEID",b."ACTIVITYID",b."ISACTIVATE",
       a.processName,
       c.activityname
    from v_wf_case a, wf_rt_activity b, wf_def_cacheactname c
    where a.id = b.caseid
    and  a.packageid=c.packageid
    and a.processid=c.processid
    and b.activityid=c.activityid;

-- ----------------------------
-- View structure for V_WF_CASE
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_WF_CASE" AS 
select a."ID",a."PACKAGEID",a."PROCESSID",a."SUBJECT",a."CREATOR",a."CREATED",a."STATUS",a."FINISHDATE",a."DATAKEY",a."PROJECTREF",a."ENDACTIVITY",a."LIMITDATE", decode( a.status,'0','正在处理','1','挂起','2','中止','3','完成') statusname, b.name as processName
    from wf_rt_case a, wf_def_main b
    where a.packageid=b.id(+);

-- ----------------------------
-- View structure for V_WF_CURRENT_WORKITEM
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_WF_CURRENT_WORKITEM" AS 
select "CASEID","WORKID","ACTIVITYINSTID","PERFORMER","ARRIVEDATE","ACCEPTDATE","FINISHDATE","CANRETURN","CANRETAKE","SEQNO","ISCOMMITED","LIMITDATE","PACKAGEID","PROCESSID","PROCESSNAME","DATAKEY","SUBJECT","CREATOR","CREATED","CASESTATUS","ACTIVITYID","ACTIVITYNAME","NOTE","ASSIGNEE"
from v_wf_Work
where iscommited is null or iscommited <> 'Y';

-- ----------------------------
-- View structure for V_WF_FLOWPERMISSION
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_WF_FLOWPERMISSION" AS 
select distinct wf_rt_case.packageid as packageid_p, p.userid, p.permissionValue
    from wf_rt_case, V_rim_COMM_PERMISSION p
    where PACKAGEID=p.resid(+);

-- ----------------------------
-- View structure for V_WF_ROLLBACKLIST
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_WF_ROLLBACKLIST" AS 
select wf_rt_work.caseid,
         wf_rt_rollbackstack.opno,
         wf_rt_activity.activityid,
         wf_rt_work.performer,
         wf_rt_case.packageid,
         wf_rt_case.processid
  from wf_rt_work,
       wf_rt_rollbackstack,
       wf_rt_activity,
       wf_rt_case
  where not wf_rt_work.performer is null
        and wf_rt_rollbackstack.optype = 4
        and wf_rt_work.caseid = wf_rt_rollbackstack.caseid
        and wf_rt_work.workid = wf_rt_rollbackstack.optarget
        and wf_rt_work.caseid = wf_rt_activity.caseid
        and wf_rt_work.activityinstid = wf_rt_activity.id
        and wf_rt_work.caseid = wf_rt_case.id
  order by caseid,
        opno desc;

-- ----------------------------
-- View structure for V_WF_WORK
-- ----------------------------
CREATE OR REPLACE FORCE VIEW "RXDEV"."V_WF_WORK" AS 
select a."CASEID",a."WORKID",a."ACTIVITYINSTID",a."PERFORMER",a."ARRIVEDATE",a."ACCEPTDATE",a."FINISHDATE",a."CANRETURN",a."CANRETAKE",a."SEQNO",a."ISCOMMITED",a."LIMITDATE",
       b.packageid,
       b.processid,
       b.processName,
       b.datakey,
       b.subject,
       b.creator,
       b.created,
       b.status as caseStatus,
       c.activityid,
       c.activityname,
       d.note,
       e.userid assignee,
       e.username euname,
       e.note remak,
       u.username
from wf_rt_work a,
     v_wf_case b,
     v_wf_activity c,
     wf_rt_note d,
     t_rim_oa_archive_delegateuser e,
     t_rim_comm_user u
where a.caseid = b.id
      and a.activityinstid = c.id
      and a.workid = d.workid(+)
      and a.performer = e.delegateuserid(+)
      and a.performer=u.userid;

-- ----------------------------
-- Procedure structure for FEE_450M_APPLY_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_450M_APPLY_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
  --测试
  --无线接入450MHZ频段计费'120100'
  --无线接入450MHZ频段
  CURSOR C_COUNT450M IS SELECT * FROM V_RIM_RSM_FEE_450m_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                and (freq_emit>0 or freq_rece>0)
              ORDER BY decl_code,FREQ_EMIT,FREQ_RECE;
  V_COUNT450M C_COUNT450M%ROWTYPE;
  --
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --无线接入450MHZ频段记录合计数量
  V_Count_FEE_450m NUMBER;
  X_Count_FEE_450m NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  --
begin
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  --
  --无线接入450MHZ频段计费'120100'
  V_FLAG := 'N';
  OPEN C_COUNT450M;
  LOOP
    FETCH C_COUNT450M INTO V_COUNT450M;
    EXIT WHEN C_COUNT450M%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT450M.begin_date,'YYYY'),substr(V_COUNT450M.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT450M.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120100';
      ----数据记录合计数量
      SELECT count(*) INTO V_Count_FEE_450m FROM V_RIM_RSM_FEE_450m_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                and (freq_emit>0 or freq_rece>0);
      --第一条记录
      V_AMOUNT := 0;
      X_Count_FEE_450m :=0;
      X_Count_FEE_450m := X_Count_FEE_450m+1;
      --计算发射频点
      if V_COUNT450M.freq_emit>0 then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --计算接收频点
      if V_COUNT450M.freq_rece>0 and V_COUNT450M.freq_rece<>V_COUNT450M.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
      end if;
       --计算技术资料表编号是否相同
      ----台站相同，继续累加
      --计算发射频点
      IF  V_DECLCODE=V_COUNT450M.decl_code AND V_APPLYCODE=V_COUNT450M.APPLY_CODE THEN
        if V_COUNT450M.freq_emit>0 then
           V_AMOUNT := V_AMOUNT+1;
        end if;
        --计算接收频点
        if V_COUNT450M.freq_rece>0 and V_COUNT450M.freq_rece<>V_COUNT450M.freq_emit then
          V_AMOUNT := V_AMOUNT+1;
        end if;
      END IF;
      --记录累加
      V_APPLYCODE := V_COUNT450M.APPLY_CODE;
      V_DERATE := V_COUNT450M.DERATE;
      V_DECLCODE := V_COUNT450M.decl_code;
      --取出减免比例
      v_deptpay:= V_COUNT450M.dept_pay;
      v_areacode:= V_COUNT450M.area_code;
      V_FREQEMIT:= V_COUNT450M.FREQ_EMIT;
      V_FREQRECE:= V_COUNT450M.FREQ_RECE;
      V_PARTMID:=V_PART;
       --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNT450M.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNT450M.APPLY_CODE,0,length(V_COUNT450M.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNT450M.DECL_CODE;---技术资料表编号
      V_FLAG := 'Y';

    ELSIF V_APPLYCODE=V_COUNT450M.apply_code and V_DECLCODE=V_COUNT450M.decl_code THEN
      X_Count_FEE_450m := X_Count_FEE_450m+1;
     --台站相同，继续累加
      --计算发射频点
      if V_COUNT450M.freq_emit>0 and V_FREQEMIT <> V_COUNT450M.FREQ_EMIT then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQEMIT:= V_COUNT450M.FREQ_EMIT;
      end if;
      --计算接收频点
      if V_COUNT450M.freq_rece>0 and V_FREQRECE <> V_COUNT450M.FREQ_RECE and V_COUNT450M.freq_rece<>V_COUNT450M.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQRECE:= V_COUNT450M.FREQ_RECE;
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT450M.DERATE;
    ELSE
      INSERT INTO T_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120100',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ----第二次初始数据
      --记录累加
      --记录累加
      V_APPLYCODE := V_COUNT450M.APPLY_CODE;
      V_DERATE := V_COUNT450M.DERATE;
      V_DECLCODE := V_COUNT450M.decl_code;
      --取出减免比例
      v_deptpay:= V_COUNT450M.dept_pay;
      v_areacode:= V_COUNT450M.area_code;
      V_FREQEMIT:= V_COUNT450M.FREQ_EMIT;
      V_FREQRECE:= V_COUNT450M.FREQ_RECE;
      V_PARTMID:=V_PART;
       --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNT450M.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNT450M.APPLY_CODE,0,length(V_COUNT450M.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNT450M.DECL_CODE;---技术资料表编号
       V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_FEE_450m := X_Count_FEE_450m+1;
      --如果执行最后条记录
      IF V_Count_FEE_450m=X_Count_FEE_450m THEN
           --计算发射频点
          if V_COUNT450M.freq_emit>0 then
            V_AMOUNT := V_AMOUNT+1;
          end if;
          --计算接收频点
          if V_COUNT450M.freq_rece>0 and V_COUNT450M.freq_rece<>V_COUNT450M.freq_emit then
            V_AMOUNT := V_AMOUNT+1;
          end if;
          --
          INSERT INTO T_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120100',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
          --
      END IF;
      --
    END IF;
  END LOOP;
  CLOSE C_COUNT450M;
  --
  IF V_FLAG = 'Y' THEN
   --存在需要添加的记录结果
    INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      DECL_CODE_Temp,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '120100',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;


end fee_450m_Apply_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_DATA_APPLY_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_DATA_APPLY_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
  --测试
  --无线数据频段
  CURSOR C_COUNTDATA IS SELECT * FROM V_RIM_RSM_FEE_data_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                and (freq_emit>0 or freq_rece>0)
              ORDER BY decl_code,FREQ_EMIT,FREQ_RECE;
  V_COUNTDATA C_COUNTDATA%ROWTYPE;


  ----
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --无线数据频段记录合计数量
  V_Count_Data NUMBER;
  X_Count_Data NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  ----
begin
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  ----
  --无线数据频段计费'140100'
  V_FLAG := 'N';
  OPEN C_COUNTDATA;
  LOOP
    FETCH C_COUNTDATA INTO V_COUNTDATA;
    EXIT WHEN C_COUNTDATA%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTDATA.begin_date,'YYYY'),substr(V_COUNTDATA.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTDATA.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    ---
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='140100';
      ----数据记录合计数量
      SELECT count(*) INTO V_Count_Data FROM V_RIM_RSM_FEE_data_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND (freq_emit>0 or freq_rece>0) ;
      --第一条记录
      V_AMOUNT := 0;
      X_Count_Data :=0;
      X_Count_Data := X_Count_Data+1;
      --计算发射频点
      if V_COUNTDATA.freq_emit>0 then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --计算接收频点
      if V_COUNTDATA.freq_rece>0 and V_COUNTDATA.freq_rece<>V_COUNTDATA.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --计算技术资料表编号是否相同
      ----台站相同，继续累加
      --计算发射频点
      IF  V_DECLCODE=V_COUNTDATA.decl_code AND V_APPLYCODE=V_COUNTDATA.APPLY_CODE THEN
        if V_COUNTDATA.freq_emit>0 then
           V_AMOUNT := V_AMOUNT+1;
        end if;
        --计算接收频点
        if V_COUNTDATA.freq_rece>0 and V_COUNTDATA.freq_rece<>V_COUNTDATA.freq_emit then
          V_AMOUNT := V_AMOUNT+1;
        end if;
      END IF;
      --
      --记录累加
      V_APPLYCODE := V_COUNTDATA.APPLY_CODE;
      V_DERATE := V_COUNTDATA.DERATE;
      V_DECLCODE := V_COUNTDATA.decl_code;
       --取出减免比例
      v_deptpay:= V_COUNTDATA.dept_pay;
      v_areacode:= V_COUNTDATA.area_code;
      V_FREQEMIT:= V_COUNTDATA.FREQ_EMIT;
      V_FREQRECE:= V_COUNTDATA.FREQ_RECE;
      V_PARTMID:=V_PART;
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTDATA.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTDATA.APPLY_CODE,0,length(V_COUNTDATA.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTDATA.DECL_CODE;---技术资料表编号
      V_FLAG := 'Y';
    ELSIF v_applycode=V_COUNTDATA.apply_code and v_declcode=V_COUNTDATA.decl_code THEN
      X_Count_Data := X_Count_Data+1;
      --台站相同，继续累加
      --计算发射频点
      if V_COUNTDATA.freq_emit>0 and V_FREQEMIT <> V_COUNTDATA.FREQ_EMIT then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQEMIT:= V_COUNTDATA.FREQ_EMIT;
      end if;
      --计算接收频点
      if V_COUNTDATA.freq_rece>0 and V_FREQRECE <> V_COUNTDATA.FREQ_RECE and V_COUNTDATA.freq_rece<>V_COUNTDATA.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQRECE:= V_COUNTDATA.FREQ_RECE;
      end if;
    ELSE
      ----新增明细记录表
      INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '140100',
                        V_DERATE,
                        V_PARTMID,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ----第二次初始数据
      --记录累加
      V_APPLYCODE := V_COUNTDATA.APPLY_CODE;
      V_DERATE := V_COUNTDATA.DERATE;
      V_DECLCODE := V_COUNTDATA.decl_code;
       --取出减免比例
      v_deptpay:= V_COUNTDATA.dept_pay;
      v_areacode:= V_COUNTDATA.area_code;
      V_FREQEMIT:= V_COUNTDATA.FREQ_EMIT;
      V_FREQRECE:= V_COUNTDATA.FREQ_RECE;
      V_PARTMID:=V_PART;
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTDATA.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTDATA.APPLY_CODE,0,length(V_COUNTDATA.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTDATA.DECL_CODE;---技术资料表编号
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_Data := X_Count_Data+1;
      --如果执行最后条记录
      IF V_Count_Data=X_Count_Data THEN
         --
         --计算发射频点
          if V_COUNTDATA.freq_emit>0 then
            V_AMOUNT := V_AMOUNT+1;
          end if;
          --计算接收频点
          if V_COUNTDATA.freq_rece>0 and V_COUNTDATA.freq_rece<>V_COUNTDATA.freq_emit then
            V_AMOUNT := V_AMOUNT+1;
          end if;
         ----新增明细记录表
         INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '140100',
                        V_DERATE,
                        V_PARTMID,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
         --新增明细记录表
      END IF;
      --
    END IF;
    --
  END LOOP;
  CLOSE C_COUNTDATA;
  ---
  IF V_FLAG = 'Y' THEN
      ----新增明细记录表
      INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '140100',
                        V_DERATE,
                        V_PARTMID,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
  END IF;
  ----
  COMMIT;
end fee_data_Apply_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_E_APPLY_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_E_APPLY_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
 ----测试
 ----地球站
  --地球站
  CURSOR C_COUNTEARTH IS SELECT * FROM V_RIM_RSM_FEE_E_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY decl_code;
  V_COUNTEARTH C_COUNTEARTH%ROWTYPE;
  --
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --地球站记录合计数量
  V_Count_EARTH NUMBER;----记录合计数量
  X_Count_EARTH NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  --
begin
  ----
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  ----
  --地球站计费'100100'
  V_FLAG := 'N';
  OPEN  C_COUNTEARTH;
  LOOP
      FETCH  C_COUNTEARTH INTO V_COUNTEARTH;
      EXIT WHEN  C_COUNTEARTH%NOTFOUND;
      --在计费年度之前的年份
      V_YEAR := to_number(nvl(to_char(V_COUNTEARTH.begin_date,'YYYY'),substr(V_COUNTEARTH.APPLY_code,5,4)));
      V_MONTH := to_number(nvl(to_char(V_COUNTEARTH.begin_date,'MM'),'1'));
      if V_YEAR < COUNTYEAR then
        V_PART :=100;
      elsif V_YEAR = COUNTYEAR then
        IF V_MONTH<7 THEN
        --第一、二季度计收全年
          V_PART :=100;
        ELSIF V_MONTH>9 THEN
          --第四季度计收25％
          V_PART :=25;
        ELSE
          --第三季度计收50％
          V_PART :=50;
        END IF;
      ELSE
        V_PART :=0;
      END IF;
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='100100';
      --
      V_AMOUNT := CEIL(NVL(V_COUNTEARTH.ASSI_BAND,0));
      --记录累加
      v_applycode1 :=V_COUNTEARTH.apply_code;
      v_declcode1 :=V_COUNTEARTH.decl_code;
      V_DERATE := V_COUNTEARTH.DERATE;
      V_FLAG := 'N';
      --
      IF V_AMOUNT<=0 THEN
         V_AMOUNT:=0;
      END IF;
      --
      ApplyCode_Temp := Substr(v_applycode1,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(v_applycode1,0,length(v_applycode1)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTEARTH.DECL_CODE;---技术资料表编号
      --
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                      v_declcode1,
                      V_COUNTEARTH.dept_pay,
                      V_COUNTEARTH.area_code,
                        COUNTYEAR,
                        '100100',
                        V_DERATE,
                        V_PART,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PART/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
        ----
        V_AMOUNT :=0;
        v_applycode1 :=V_COUNTEARTH.apply_code;
        v_declcode1 :=V_COUNTEARTH.decl_code;
        V_DERATE := V_COUNTEARTH.DERATE;
        ----
  END LOOP;
  CLOSE  C_COUNTEARTH;
  ---
  commit;

end FEE_E_Apply_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_ENTER1G8_APPLY_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_ENTER1G8_APPLY_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
   ----测试
   ----无线接入1.8G
   --无线接入1.8G
  CURSOR C_COUNT1G8 IS SELECT * FROM V_RIM_RSM_FEE_ENTER1G8_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY decl_code;
  V_COUNT1G8 C_COUNT1G8%ROWTYPE;
  ---
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
  V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --无线接入1.8G记录合计数量
  V_Count_ENTER1G8 NUMBER;
  X_Count_ENTER1G8 NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  --

begin
  ----
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  ----
  --无线接入1.8G '120200'
  V_FLAG := 'N';
  OPEN C_COUNT1G8;
  LOOP
    FETCH C_COUNT1G8 INTO V_COUNT1G8;
    EXIT WHEN C_COUNT1G8%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT1G8.begin_date,'YYYY'),substr(V_COUNT1G8.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT1G8.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;

    --取出收费标准
    SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120200';
    --第一条记录
    V_AMOUNT := 1;
     --记录累加
    V_DERATE := V_COUNT1G8.DERATE;
     --取出减免比例
    V_DECLCODE := V_COUNT1G8.DECL_CODE;
    v_deptpay:= V_COUNT1G8.dept_pay;
    v_areacode:= V_COUNT1G8.area_code;
    V_PARTMID:=V_PART;

    --获取申请表编号和技术资料表编号
    ApplyCode_Temp := Substr(V_COUNT1G8.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
    ApplyType_Temp := substr(V_COUNT1G8.APPLY_CODE,0,length(V_COUNT1G8.APPLY_CODE)-12);----申请表类型T或PA
    DECL_CODE_Temp := V_COUNT1G8.DECL_CODE;---技术资料表编号
    ---
    INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      DECL_CODE_Temp,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '120200',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
    V_AMOUNT := 1;
    V_DECLCODE := V_COUNT1G8.DECL_CODE;
    v_deptpay:= V_COUNT1G8.dept_pay;
    v_areacode:= V_COUNT1G8.area_code;
    V_DERATE := V_COUNT1G8.DERATE;
    --取出减免比例
  END LOOP;
  CLOSE C_COUNT1G8;

  ----
  COMMIT;

end FEE_ENTER1G8_Apply_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_ENTER3G5_APPLY_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_ENTER3G5_APPLY_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS

  ----测试
  ----【无线接入3.5G】
  --无线接入3.5G
  CURSOR C_COUNT3G5 IS SELECT * FROM V_RIM_RSM_FEE_ENTER3G5_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>0
              ORDER BY decl_code,FREQ_EMIT;
  V_COUNT3G5 C_COUNT3G5%ROWTYPE;
  ---
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --无线接入3.5G记录合计数量
  V_Count_ENTER3G5 NUMBER;----记录合计数量
  X_Count_ENTER3G5 NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
begin
  ---
  ---
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  ---
  --无线接入系统(3.5GHZ)计费'120300'
  V_FLAG := 'N';
  V_BANDWIDTH :=0;
  OPEN  C_COUNT3G5;
  LOOP
    FETCH  C_COUNT3G5 INTO V_COUNT3G5;
    EXIT WHEN  C_COUNT3G5%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT3G5.begin_date,'YYYY'),substr(V_COUNT3G5.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT3G5.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120300';
      ------数据记录合计数量
      SELECT count(*) INTO V_Count_ENTER3G5 FROM V_RIM_RSM_FEE_ENTER3G5_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>0;
      --第一条记录
       --第一条记录
      X_Count_ENTER3G5 :=0;
      X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
       ---记录累加
      v_deptpay:= V_COUNT3G5.dept_pay;
      v_areacode:= V_COUNT3G5.area_code;
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      if V_BANDWIDTH =0 then
         V_BANDWIDTH :=0;
      end if;
       V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
       --空值则默认为一个单位
      V_DERATE := V_COUNT3G5.DERATE;
      V_PARTMID := V_PART;
      --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_DECLCODE=V_COUNT3G5.DECL_CODE AND V_APPLYCODE = V_COUNT3G5.APPLY_CODE THEN
      --同一个台站则带宽数据累计
      X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
      --计算发射频点
      if V_FREQEMIT <> V_COUNT3G5.FREQ_EMIT then
         V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
        V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT3G5.DERATE;
       --取出减免比例
       ---记录累加
      V_APPLYCODE := V_COUNT3G5.APPLY_CODE;
      V_DECLCODE := V_COUNT3G5.DECL_CODE;
      v_deptpay:= V_COUNT3G5.dept_pay;
      v_areacode:= V_COUNT3G5.area_code;
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH/3.5);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120300',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_BANDWIDTH :=0;
      --计算发射频点
     -- V_BANDWIDTH :=  V_BANDWIDTH+nvl(V_COUNT3G5.CHAN_DIST,3.5)*2;
      V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
       --空值则默认为一个单位
      V_DERATE := V_COUNT3G5.DERATE;
      --取出减免比例
      V_DECLCODE := V_COUNT3G5.DECL_CODE;
      v_deptpay:= V_COUNT3G5.dept_pay;
      v_areacode:= V_COUNT3G5.area_code;
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
      --如果执行最后条记录
      if X_Count_ENTER3G5=V_Count_ENTER3G5 then
          ---记录累加
          v_deptpay:= V_COUNT3G5.dept_pay;
          v_areacode:= V_COUNT3G5.area_code;
          V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
          V_BANDWIDTH := CEIL(nvl(V_COUNT3G5.CHAN_DIST,1));
          V_PARTMID := V_PART;
          --空值则默认为一个单位
          V_DERATE := V_COUNT3G5.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          --
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT3G5.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNT3G5.APPLY_CODE,0,length(V_COUNT3G5.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT3G5.DECL_CODE;---技术资料表编号
          --
          INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120300',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
          --
      end if;
    END IF;
    ---记录累加
    V_APPLYCODE := V_COUNT3G5.APPLY_CODE;
    V_DECLCODE := V_COUNT3G5.DECL_CODE;
    v_deptpay:= V_COUNT3G5.dept_pay;
    v_areacode:= V_COUNT3G5.area_code;
    V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
    ----
  END LOOP;
  CLOSE  C_COUNT3G5;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH/3.5);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '120300',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;

----
commit;

end FEE_ENTER3G5_Apply_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_ENTER3G5_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_ENTER3G5_TEST"(COUNTYEAR NUMBER,DEPTCODE varchar2,areacode varchar2)
IS
  --- ----测试
  ----年度【无线接入3.5G】
  ----年度无线接入3.5G
  --无线接入3.5G
  CURSOR C_COUNT3G5 IS SELECT * FROM V_rim_rsm_FEE_ENTER3G5
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND FREQ_EMIT>0
              ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT;
  V_COUNT3G5 C_COUNT3G5%ROWTYPE;
  ----
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;


  --无线接入3.5G记录合计数量
  V_Count_ENTER3G5 NUMBER;----记录合计数量
  X_Count_ENTER3G5 NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  ----
begin
  --
  DELETE FROM T_RIM_RSM_PAY_DEPTITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_deptnetitem WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECKITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  --无线接入系统(3.5GHZ)计费'120300'
  V_FLAG := 'N';
  X_Count_ENTER3G5 :=0;
  V_BANDWIDTH :=0;
  OPEN  C_COUNT3G5;
  LOOP
    FETCH  C_COUNT3G5 INTO V_COUNT3G5;
    EXIT WHEN  C_COUNT3G5%NOTFOUND;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120300';
        ----数据记录合计数量
      SELECT count(*) INTO V_Count_ENTER3G5 FROM V_rim_rsm_FEE_ENTER3G5
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND FREQ_EMIT>0;
      --第一条记录
      if X_Count_ENTER3G5 = 0 then
         X_Count_ENTER3G5 :=0;
      end if;
      X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
      --第一条记录
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      if V_BANDWIDTH  =0 then
         V_BANDWIDTH :=0;
      end if;
      --计算发射频点
       V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
      V_DERATE := V_COUNT3G5.DERATE;
       --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_APPLYCODE = V_COUNT3G5.APPLY_CODE AND V_DECLCODE = V_COUNT3G5.DECL_CODE THEN
      --同一个台站则带宽数据累计
       X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
      --计算发射频点
      if V_FREQEMIT <> V_COUNT3G5.FREQ_EMIT then
         V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
        V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
       ---记录累加
      V_APPLYCODE := V_COUNT3G5.APPLY_CODE;
      V_DECLCODE := V_COUNT3G5.DECL_CODE;
      v_deptpay:= V_COUNT3G5.dept_pay;
      v_areacode:= V_COUNT3G5.area_code;
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      --空值则默认为一个单位
      V_DERATE := V_COUNT3G5.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH/4);
      IF V_AMOUNT<=0 THEN
        V_AMOUNT:=1;
      END IF;
        --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNT3G5.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := 'T';----申请表类型T或PA
      --
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '120300',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_BANDWIDTH :=0;
      --计算发射频点
      V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
      --空值则默认为一个单位
      V_DERATE := V_COUNT3G5.DERATE;
      --取出减免比例
      V_APPLYCODE:= V_COUNT3G5.APPLY_CODE;
      V_DECLCODE := V_COUNT3G5.DECL_CODE;
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
      if  X_Count_ENTER3G5 =V_Count_ENTER3G5 then
          ---记录累加
          v_deptpay:= V_COUNT3G5.dept_pay;
          v_areacode:= V_COUNT3G5.area_code;
          V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
          V_BANDWIDTH := CEIL(nvl(V_COUNT3G5.CHAN_DIST,1));

          --空值则默认为一个单位
          V_DERATE := V_COUNT3G5.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          --
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT3G5.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := 'T';--substr(V_COUNT3G5.APPLY_CODE,0,length(V_COUNT3G5.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT3G5.DECL_CODE;---技术资料表编号
          --
          INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        ApplyCode_Temp,
                        DECL_CODE_Temp,
                        COUNTYEAR,
                        '120300',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        ApplyType_Temp);
          --
      end if;
      --
    END IF;
     ---记录累加
    V_APPLYCODE := V_COUNT3G5.APPLY_CODE;
    V_DECLCODE := V_COUNT3G5.DECL_CODE;
    v_deptpay:= V_COUNT3G5.dept_pay;
    v_areacode:= V_COUNT3G5.area_code;
    V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
    --
  END LOOP;
  CLOSE  C_COUNT3G5;
  IF V_FLAG = 'Y' THEN
   --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH/3.5);
    IF V_AMOUNT<=0 THEN
      V_AMOUNT:=1;
    END IF;
    ApplyType_Temp := 'T';--substr(V_COUNT3G5.APPLY_CODE,0,length(V_COUNT3G5.APPLY_CODE)-12);----申请表类型T或PA
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '120300',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
   ----
  commit;

end FEE_ENTER3G5_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_ENTER5G8_APPLY_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_ENTER5G8_APPLY_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
   ---测试
  ----【无线接入5.8G】
  --无线接入5.8G
  --无线接入5.8G
  CURSOR C_COUNT5G82 IS SELECT * FROM V_RIM_RSM_FEE_ENTER5G8_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND (FREQ_EMIT>= 5725 and  FREQ_EMIT<= 5850 )
              ORDER BY decl_code,FREQ_EMIT;
  V_COUNT5G82 C_COUNT5G82%ROWTYPE;
  --
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --无线接入5.8G记录合计数量
  V_Count_ENTER5G8 NUMBER;----记录合计数量
  X_Count_ENTER5G8 NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  ---
begin
  ---
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  ----
  --无线接入系统(5.8GHZ)计费'120400'
  V_FLAG := 'N';
  V_BANDWIDTH :=0;
  OPEN  C_COUNT5G82;
  LOOP
    FETCH  C_COUNT5G82 INTO V_COUNT5G82;
    EXIT WHEN  C_COUNT5G82%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT5G82.begin_date,'YYYY'),substr(V_COUNT5G82.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT5G82.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120400';
      ------数据记录合计数量
      SELECT count(*) INTO V_Count_ENTER5G8 FROM v_rim_rsm_fee_enter5g8_Apply
               WHERE APPLY_CODE='T500020150020'
                AND begin_YEAR=2015
                AND (FREQ_EMIT>= 5725 and  FREQ_EMIT<= 5850 ) ;
      --第一条记录
      X_Count_ENTER5G8 :=0;
      X_Count_ENTER5G8 :=X_Count_ENTER5G8+1;
      -----记录累加
      -- V_DECLCODE := V_COUNT5G82.DECL_CODE;
      v_deptpay:= V_COUNT5G82.dept_pay;
      v_areacode:= V_COUNT5G82.area_code;
      V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
      V_PARTMID := V_PART;
      ---
      if V_BANDWIDTH =0 then
         V_BANDWIDTH :=0;
      end if;
      V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT5G82.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNT5G82.DERATE;
      --取出减免比例
      V_FLAG := 'Y';

    ELSIF V_DECLCODE=V_COUNT5G82.DECL_CODE AND V_APPLYCODE= V_COUNT5G82.APPLY_CODE THEN
      --同一个台站则带宽数据累计
      X_Count_ENTER5G8 :=X_Count_ENTER5G8+1;
      --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT5G82.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT5G82.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
       --取出减免比例
       ---记录累加
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT5G82.DERATE;
      v_deptpay:= V_COUNT5G82.dept_pay;
      v_areacode:= V_COUNT5G82.area_code;
      V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
      V_PARTMID := V_PART;
      --
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120400',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ---
      V_BANDWIDTH :=0;
      V_BANDWIDTH := nvl(V_COUNT5G82.CHAN_DIST,1);
       --空值则默认为一个单位
      V_DERATE := V_COUNT5G82.DERATE;
      --取出减免比例
      V_APPLYCODE := V_COUNT5G82.APPLY_CODE;
      V_DECLCODE := V_COUNT5G82.DECL_CODE;
      v_deptpay:= V_COUNT5G82.dept_pay;
      v_areacode:= V_COUNT5G82.area_code;
      V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_ENTER5G8 :=X_Count_ENTER5G8+1;
      --如果执行最后条记录
      if X_Count_ENTER5G8 = V_Count_ENTER5G8 then
          V_DECLCODE := V_COUNT5G82.DECL_CODE;
          v_deptpay:= V_COUNT5G82.dept_pay;
          v_areacode:= V_COUNT5G82.area_code;
          V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
          --空值则默认为一个单位
          V_DERATE := V_COUNT5G82.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          ----
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT5G82.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNT5G82.APPLY_CODE,0,length(V_COUNT5G82.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT5G82.DECL_CODE;---技术资料表编号
          ----
          INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120400',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      end if;
    END IF;
    ---记录累加
    V_APPLYCODE := V_COUNT5G82.APPLY_CODE;
    V_DECLCODE := V_COUNT5G82.DECL_CODE;
    v_deptpay:= V_COUNT5G82.dept_pay;
    v_areacode:= V_COUNT5G82.area_code;
    V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
  END LOOP;
  CLOSE  C_COUNT5G82;
  IF V_FLAG = 'Y' THEN
   --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '120400',
                      V_DERATE,
                      V_PARTMID,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
---
commit;

end FEE_ENTER5G8_Apply_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_KP2G4_APPLY_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_KP2G4_APPLY_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
  ---测试
  ---扩频系统2.4G
  CURSOR C_COUNT2G4 IS SELECT * FROM V_RIM_RSM_FEE_KP2G4_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>0
              ORDER BY decl_code,FREQ_EMIT;
  V_COUNT2G4 C_COUNT2G4%ROWTYPE;
  --
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --移动台记录合计数量
  V_Count_kp2g4 NUMBER;
  X_Count_kp2g4 NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
begin
   ---
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  --
   --扩频系统2.4G计费'130100'
  V_FLAG := 'N';
  OPEN C_COUNT2G4;
  LOOP
    FETCH C_COUNT2G4 INTO V_COUNT2G4;
    EXIT WHEN C_COUNT2G4%NOTFOUND;

    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT2G4.begin_date,'YYYY'),substr(V_COUNT2G4.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT2G4.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    ----
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='130100';
      ----数据记录合计数量
      SELECT count(*) INTO V_Count_kp2g4 FROM V_RIM_RSM_FEE_KP2G4_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>0 ;
      --第一条记录
      X_Count_kp2g4 :=0;
      X_Count_kp2g4 :=X_Count_kp2g4+1;
      ---记录累加
      v_deptpay:= V_COUNT2G4.dept_pay;
      v_areacode:= V_COUNT2G4.area_code;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      V_BANDWIDTH := CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));
      V_PARTMID := V_PART;
      --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;
       --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_DECLCODE=V_COUNT2G4.DECL_CODE AND V_APPLYCODE= V_COUNT2G4.APPLY_CODE THEN
      ---
      X_Count_kp2g4 :=X_Count_kp2g4+1;
      --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT2G4.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
       ---记录累加
      V_APPLYCODE := V_COUNT2G4.APPLY_CODE;
      V_DECLCODE := V_COUNT2G4.DECL_CODE;
      v_deptpay:= V_COUNT2G4.dept_pay;
      v_areacode:= V_COUNT2G4.area_code;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      V_PARTMID := V_PART;
      --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT2G4.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      --
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNT2G4.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNT2G4.APPLY_CODE,0,length(V_COUNT2G4.APPLY_CODE)-12);----申请表类型T或PA
     -- DECL_CODE_Temp := V_COUNT2G4.DECL_CODE;---技术资料表编号
      --
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '130100',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);

      V_BANDWIDTH := nvl(V_COUNT2G4.CHAN_DIST,1);
      --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;
      --取出减免比例
      V_DECLCODE := V_COUNT2G4.DECL_CODE;
      v_deptpay:= V_COUNT2G4.dept_pay;
      v_areacode:= V_COUNT2G4.area_code;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      --
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_kp2g4 :=X_Count_kp2g4+1;
       --如果执行最后条记录
      IF X_Count_kp2g4=V_Count_kp2g4 THEN
         ---记录累加
          v_deptpay:= V_COUNT2G4.dept_pay;
          v_areacode:= V_COUNT2G4.area_code;
          V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
          V_BANDWIDTH := CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));
          V_PARTMID := V_PART;
          --空值则默认为一个单位
          V_DERATE := V_COUNT2G4.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          --
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT2G4.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNT2G4.APPLY_CODE,0,length(V_COUNT2G4.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT2G4.DECL_CODE;---技术资料表编号
          --
          INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                          decl_code,
                          dept_pay,
                          area_code,
                          COUNT_YEAR,
                          ITEM_CODE,
                          DERATE,
                          pay_rate,
                          AMOUNT,
                          SUM_COUNT,
                          SUM_PAY,
                          Applytype)
                      VALUES (ApplyCode_Temp,
                            DECL_CODE_Temp,
                          v_deptpay,
                          v_areacode,
                          COUNTYEAR,
                            '130100',
                            V_DERATE,
                            V_PARTMID,
                          V_AMOUNT,
                            V_AMOUNT*V_FEE,
                            V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                            ApplyType_Temp);
      END IF;

    END IF;
    --
    ---记录累加
    V_APPLYCODE := V_COUNT2G4.APPLY_CODE;
    V_DECLCODE := V_COUNT2G4.DECL_CODE;
    v_deptpay:= V_COUNT2G4.dept_pay;
    v_areacode:= V_COUNT2G4.area_code;
    V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
    --
  END LOOP;
  CLOSE C_COUNT2G4;

  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '130100',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  ---
  COMMIT;
end fee_kp2g4_apply_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_KP2G4_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_KP2G4_TEST"(COUNTYEAR NUMBER,DEPTCODE varchar2,areacode varchar2)
IS
  ----测试
  ----扩频系统2.4G
  --扩频系统2.4G
  CURSOR C_COUNT2G4 IS SELECT * FROM V_rim_rsm_FEE_KP2G4
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND FREQ_EMIT>0
              ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT;
  V_COUNT2G4 C_COUNT2G4%ROWTYPE;
--
 V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  --申请表编号

  V_DECLCODE VARCHAR2(6);
  V_DECLCODE1 VARCHAR2(6);
   --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
  --数量
  V_BANDWIDTH NUMBER;
  --带宽
  V_DERATE NUMBER;
  --减免
  V_FEE NUMBER;
  --

  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);

  --无绳电话的收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --无线数据频段记录合计数量
  V_Count_Data NUMBER;
  X_Count_Data NUMBER;----记录次数
  --无线接入450MHZ频段记录合计数量
  V_Count_FEE_450m NUMBER;
  X_Count_FEE_450m NUMBER;----记录次数
  --移动台记录合计数量
  V_Count_mobile NUMBER;
  X_Count_mobile NUMBER;----记录次数
  --扩频系统2.4G记录合计数量
  V_Count_kp2g4 NUMBER;
  X_Count_kp2g4 NUMBER;----记录次数
  --扩频系统5.8G记录合计数量
  V_Count_KP5G8 NUMBER;
  X_Count_KP5G8 NUMBER;----记录次数
  --无线接入3.5G记录合计数量
  V_Count_ENTER3G5 NUMBER;----记录合计数量
  X_Count_ENTER3G5 NUMBER;----记录次数
  --无线接入5.8G记录合计数量
  V_Count_ENTER5G8 NUMBER;----记录合计数量
  X_Count_ENTER5G8 NUMBER;----记录次数
  --雷达站10G以下--记录合计数量
  V_CountR_10GDOWN NUMBER;----记录合计数量
  X_CountR_10GDOWN NUMBER;----记录次数
  --雷达站10G以上--记录合计数量
  V_CountR_10GUP NUMBER;----记录合计数量
  X_CountR_10GUP NUMBER;----记录次数
   --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
--
begin
  ---
  DELETE FROM T_RIM_RSM_PAY_DEPTITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_deptnetitem WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECKITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  --
  --扩频系统2.4G计费'130100'
  V_FLAG := 'N';
  OPEN C_COUNT2G4;
  LOOP
    FETCH C_COUNT2G4 INTO V_COUNT2G4;
    EXIT WHEN C_COUNT2G4%NOTFOUND;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='130100';
       ----数据记录合计数量
      SELECT count(*) INTO V_Count_kp2g4 FROM V_rim_rsm_FEE_KP2G4
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND FREQ_EMIT>0;
      --第一条记录
      X_Count_kp2g4 :=0;
      X_Count_kp2g4 :=X_Count_kp2g4+1;
      --
      v_deptpay:= V_COUNT2G4.dept_pay;
      v_areacode:= V_COUNT2G4.area_code;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      V_BANDWIDTH := CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));
        --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_APPLYCODE = V_COUNT2G4.APPLY_CODE AND V_DECLCODE = V_COUNT2G4.DECL_CODE THEN
       X_Count_kp2g4 :=X_Count_kp2g4+1;
      --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT2G4.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
        --带宽累加，空值则默认为一个单位
      end if;
       ---记录累加
      V_APPLYCODE := V_COUNT2G4.APPLY_CODE;
      V_DECLCODE := V_COUNT2G4.DECL_CODE;
      v_deptpay:= V_COUNT2G4.dept_pay;
      v_areacode:= V_COUNT2G4.area_code;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;

      --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;

      V_DERATE := V_COUNT2G4.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF V_AMOUNT<=0 THEN
        V_AMOUNT:=1;
      END IF;
       --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNT2G4.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNT2G4.APPLY_CODE,0,length(V_COUNT2G4.APPLY_CODE)-12);----申请表类型T或PA
     -- DECL_CODE_Temp := V_COUNT2G4.DECL_CODE;---技术资料表编号
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '130100',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ---

      V_BANDWIDTH := nvl(V_COUNT2G4.CHAN_DIST,1);
       --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;
       --取出减免比例
      V_APPLYCODE:= V_COUNT2G4.APPLY_CODE;
      V_DECLCODE := V_COUNT2G4.DECL_CODE;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_kp2g4 :=X_Count_kp2g4+1;
       --如果执行最后条记录
      IF X_Count_kp2g4=V_Count_kp2g4 THEN
         ---记录累加
          v_deptpay:= V_COUNT2G4.dept_pay;
          v_areacode:= V_COUNT2G4.area_code;
          V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
          V_BANDWIDTH := CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));

          --空值则默认为一个单位
          V_DERATE := V_COUNT2G4.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          --
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT2G4.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNT2G4.APPLY_CODE,0,length(V_COUNT2G4.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT2G4.DECL_CODE;---技术资料表编号
          --
          INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        ApplyCode_Temp,
                        DECL_CODE_Temp,
                        COUNTYEAR,
                        '130100',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        ApplyType_Temp);
      END IF;
    END IF;
    ---记录累加
    V_APPLYCODE := V_COUNT2G4.APPLY_CODE;
    V_DECLCODE := V_COUNT2G4.DECL_CODE;
    v_deptpay:= V_COUNT2G4.dept_pay;
    v_areacode:= V_COUNT2G4.area_code;
    V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
    --
  END LOOP;
  CLOSE C_COUNT2G4;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF V_AMOUNT<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '130100',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100);
  END IF;
--
  COMMIT;

end FEE_KP2G4_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_KP5G8_APPLY_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_KP5G8_APPLY_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
   ---测试
   ---扩频系统5.8G
   --扩频系统5.8G
  CURSOR C_COUNT5G81 IS SELECT * FROM V_RIM_RSM_FEE_KP5G8_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>0
              ORDER BY decl_code,FREQ_EMIT;
  V_COUNT5G81 C_COUNT5G81%ROWTYPE;
  --
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --扩频系统5.8G记录合计数量
  V_Count_KP5G8 NUMBER;----记录合计数量
  X_Count_KP5G8 NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  --
begin
  ---
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  --
  --扩频系统5.8G计费'130200'
  V_FLAG := 'N';
  V_BANDWIDTH :=0;
  OPEN  C_COUNT5G81;
  LOOP
    FETCH  C_COUNT5G81 INTO V_COUNT5G81;
    EXIT WHEN  C_COUNT5G81%NOTFOUND;

    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT5G81.begin_date,'YYYY'),substr(V_COUNT5G81.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT5G81.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='130200';
      ----数据记录合计数量
      SELECT count(*) INTO V_Count_KP5G8 FROM V_RIM_RSM_FEE_KP5G8_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>0;
      --第一条记录
      X_Count_KP5G8 :=0;
      X_Count_KP5G8 :=X_Count_KP5G8+1;
       ---记录累加
      v_deptpay:= V_COUNT5G81.dept_pay;
      v_areacode:= V_COUNT5G81.area_code;
      V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
      V_PARTMID := V_PART;
      if (V_BANDWIDTH = 0 ) then
         V_BANDWIDTH :=0;
      end if;
      V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT5G81.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNT5G81.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_DECLCODE=V_COUNT5G81.DECL_CODE AND V_APPLYCODE=V_COUNT5G81.APPLY_CODE THEN
       X_Count_KP5G8 :=X_Count_KP5G8+1;
      --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT5G81.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT5G81.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT5G81.DERATE;
       --取出减免比例
       ---记录累加
      V_APPLYCODE := V_COUNT5G81.APPLY_CODE;
      V_DECLCODE := V_COUNT5G81.DECL_CODE;
      v_deptpay:= V_COUNT5G81.dept_pay;
      v_areacode:= V_COUNT5G81.area_code;
      V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '130200',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ---
      V_BANDWIDTH := CEIL(nvl(V_COUNT5G81.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNT5G81.DERATE;
       --取出减免比例
      V_DECLCODE := V_COUNT5G81.DECL_CODE;
      v_deptpay:= V_COUNT5G81.dept_pay;
      v_areacode:= V_COUNT5G81.area_code;
      V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_KP5G8 :=X_Count_KP5G8+1;
       --如果执行最后条记录
      IF X_Count_KP5G8=V_Count_KP5G8 THEN
         ---记录累加
          v_deptpay:= V_COUNT5G81.dept_pay;
          v_areacode:= V_COUNT5G81.area_code;
          V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
          V_BANDWIDTH := CEIL(nvl(V_COUNT5G81.CHAN_DIST,1));
          V_PARTMID := V_PART;
          --空值则默认为一个单位
          V_DERATE := V_COUNT5G81.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          --
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT5G81.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNT5G81.APPLY_CODE,0,length(V_COUNT5G81.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT5G81.DECL_CODE;---技术资料表编号
          --
         INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '130200',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      END IF;
      --
    END IF;
    ---记录累加
    V_APPLYCODE := V_COUNT5G81.APPLY_CODE;
    V_DECLCODE := V_COUNT5G81.DECL_CODE;
    v_deptpay:= V_COUNT5G81.dept_pay;
    v_areacode:= V_COUNT5G81.area_code;
    V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
  END LOOP;
  CLOSE  C_COUNT5G81;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '130200',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  --
  commit;

end FEE_KP5G8_Apply_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_MMDS_APPLY_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_MMDS_APPLY_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
  --测试
  --有线电视传输MMDS台
  CURSOR C_COUNTMMDS IS SELECT * FROM V_RIM_RSM_FEE_MMDS_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>0
              ORDER BY decl_code,FREQ_EMIT;
  V_COUNTMMDS C_COUNTMMDS%ROWTYPE;
  --
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --移动台记录合计数量
  V_Count_MMDS NUMBER;
  X_Count_MMDS NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  --
begin

  ---
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;

  --有线电视传输（MMDS）计费'930000'
  V_FLAG := 'N';
  OPEN C_COUNTMMDS;
  LOOP
    FETCH C_COUNTMMDS INTO V_COUNTMMDS;
    EXIT WHEN C_COUNTMMDS%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTMMDS.begin_date,'YYYY'),substr(V_COUNTMMDS.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTMMDS.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_DECLCODE := V_COUNTMMDS.DECL_CODE;
      V_BANDWIDTH := nvl(V_COUNTMMDS.CHAN_DIST,1);
      v_deptpay:= V_COUNTMMDS.dept_pay;
      v_areacode:= V_COUNTMMDS.area_code;
      V_FREQEMIT:= V_COUNTMMDS.FREQ_EMIT;
      V_PARTMID := V_PART;
      --空值则默认为一个单位
      V_DERATE := V_COUNTMMDS.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='930000';
      --取出收费标准
    ELSIF V_DECLCODE = V_COUNTMMDS.DECL_CODE THEN
     --台站相同，继续累加
      if V_FREQEMIT <> V_COUNTMMDS.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+nvl(V_COUNTMMDS.CHAN_DIST,1);
        V_FREQEMIT:= V_COUNTMMDS.FREQ_EMIT;
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNTMMDS.DERATE;
    ELSE
    --台站不同,保存计算结果
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '930000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_BANDWIDTH := nvl(V_COUNTMMDS.CHAN_DIST,1);
       --空值则默认为一个单位
      V_DERATE := V_COUNTMMDS.DERATE;
       --取出减免比例
      V_DECLCODE := V_COUNTMMDS.DECL_CODE;
      v_deptpay:= V_COUNTMMDS.dept_pay;
      v_areacode:= V_COUNTMMDS.area_code;
      V_FREQEMIT:= V_COUNTMMDS.FREQ_EMIT;
    END IF;
  END LOOP;
  CLOSE C_COUNTMMDS;
  IF V_FLAG = 'Y' THEN
   --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
    END IF;
    INSERT INTO t_rim_rsm_PAY_APPLYITEM  (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '930000',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;

  --
  COMMIT;


end fee_mmds_apply_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_MOBILE_APPLY_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_MOBILE_APPLY_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
  --
  --测试
  --移动台
  CURSOR C_COUNTMOBILE IS SELECT * FROM V_RIM_RSM_FEE_mobile_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY decl_code;
  V_COUNTMOBILE C_COUNTMOBILE%ROWTYPE;
  ---
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --移动台记录合计数量
  V_Count_mobile NUMBER;
  X_Count_mobile NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
begin
  ---
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  --
  --移动台计费'820000'
  V_FLAG := 'N';
  OPEN C_COUNTMOBILE;
  LOOP
    FETCH C_COUNTMOBILE INTO V_COUNTMOBILE;
    EXIT WHEN C_COUNTMOBILE%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTMOBILE.begin_date,'YYYY'),substr(V_COUNTMOBILE.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTMOBILE.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='820000';
       ----数据记录合计数量
      SELECT count(*) INTO V_Count_mobile FROM V_RIM_RSM_FEE_mobile_Apply
                WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY decl_code;
      --第一条记录
      V_AMOUNT := 1;
      X_Count_mobile :=0;
      X_Count_mobile :=X_Count_mobile+1;
       --记录累加
      V_DERATE := V_COUNTMOBILE.DERATE;
       --取出减免比例
      V_DECLCODE := V_COUNTMOBILE.decl_code;
      v_deptpay:= V_COUNTMOBILE.dept_pay;
      v_areacode:= V_COUNTMOBILE.area_code;
      V_PARTMID:=V_PART;
      V_FLAG := 'Y';
      -----获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTMOBILE.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTMOBILE.APPLY_CODE,0,length(V_COUNTMOBILE.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTMOBILE.DECL_CODE;---技术资料表编号
      ---
    ELSIF V_DECLCODE=V_COUNTMOBILE.decl_code THEN
      X_Count_mobile :=X_Count_mobile+1;
     --台站相同，继续累加
      V_AMOUNT := V_AMOUNT+1;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNTMOBILE.DERATE;
    ELSE
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTMOBILE.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTMOBILE.APPLY_CODE,0,length(V_COUNTMOBILE.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTMOBILE.DECL_CODE;---技术资料表编号
      --
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '820000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_AMOUNT := 1;
      V_DECLCODE := V_COUNTMOBILE.decl_code;
      v_deptpay:= V_COUNTMOBILE.dept_pay;
      v_areacode:= V_COUNTMOBILE.area_code;
      V_DERATE := V_COUNTMOBILE.DERATE;
      --
      X_Count_mobile :=X_Count_mobile+1;
       --取出减免比例
    END IF;
  END LOOP;
  CLOSE C_COUNTMOBILE;
  ---
  IF   V_FLAG = 'Y' AND V_Count_mobile= X_Count_mobile THEN
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '820000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
  END IF;
  ---

   COMMIT;
end FEE_mobile_Apply_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_MOBILE_DEPT_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_MOBILE_DEPT_TEST"(COUNTYEAR NUMBER,DEPTCODE varchar2,areacode varchar2)
is
  ----测试
  --移动台计费'820000'【1000MHz以下的无线电台(移动电台)】
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  --申请表编号

  V_DECLCODE VARCHAR2(6);
  V_DECLCODE1 VARCHAR2(6);
   --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
  --数量
  V_BANDWIDTH NUMBER;
  --带宽
  V_DERATE NUMBER;
  --减免
  V_FEE NUMBER;
  --

  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);

  --无绳电话的收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --无线数据频段记录合计数量
  V_Count_Data NUMBER;
  X_Count_Data NUMBER;----记录次数
  --无线接入450MHZ频段记录合计数量
  V_Count_FEE_450m NUMBER;
  X_Count_FEE_450m NUMBER;----记录次数
  --移动台记录合计数量
  V_Count_mobile NUMBER;
  X_Count_mobile NUMBER;----记录次数
  --扩频系统2.4G记录合计数量
  V_Count_kp2g4 NUMBER;
  X_Count_kp2g4 NUMBER;----记录次数
  --扩频系统5.8G记录合计数量
  V_Count_KP5G8 NUMBER;
  X_Count_KP5G8 NUMBER;----记录次数
  --无线接入3.5G记录合计数量
  V_Count_ENTER3G5 NUMBER;----记录合计数量
  X_Count_ENTER3G5 NUMBER;----记录次数
  --无线接入5.8G记录合计数量
  V_Count_ENTER5G8 NUMBER;----记录合计数量
  X_Count_ENTER5G8 NUMBER;----记录次数
  --雷达站10G以下--记录合计数量
  V_CountR_10GDOWN NUMBER;----记录合计数量
  X_CountR_10GDOWN NUMBER;----记录次数
  --雷达站10G以上--记录合计数量
  V_CountR_10GUP NUMBER;----记录合计数量
  X_CountR_10GUP NUMBER;----记录次数
   --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）

    --移动台(1000MHz以下的无线电台(移动电台)--'820000')
  CURSOR C_COUNTMOBILE IS SELECT * FROM V_rim_rsm_FEE_mobile
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTMOBILE C_COUNTMOBILE%ROWTYPE;

begin

  DELETE FROM T_RIM_RSM_PAY_DEPTITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_deptnetitem WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECKITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;

  --移动台计费'820000'【1000MHz以下的无线电台(移动电台)】
  V_FLAG := 'N';
  OPEN C_COUNTMOBILE;
  LOOP
    FETCH C_COUNTMOBILE INTO V_COUNTMOBILE;
    EXIT WHEN C_COUNTMOBILE%NOTFOUND;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode :=V_COUNTMOBILE.apply_code;
      v_declcode :=V_COUNTMOBILE.decl_code;
      V_DERATE := V_COUNTMOBILE.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='820000';
      --取出收费标准
    ELSIF v_applycode=V_COUNTMOBILE.apply_code and v_declcode=V_COUNTMOBILE.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
    ELSE
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '820000',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        'T');
      V_AMOUNT := 1;
      v_applycode :=V_COUNTMOBILE.apply_code;
      v_declcode :=V_COUNTMOBILE.decl_code;
      V_DERATE := V_COUNTMOBILE.DERATE;
      --取出减免比例
    END IF;
  END LOOP;
  CLOSE C_COUNTMOBILE;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '820000',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      'T');
  END IF;


end FEE_MOBILE_Dept_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_R_APPLY10GDOWN_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_R_APPLY10GDOWN_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
----测试
----雷达站10G以下(按照微波站收费)
--雷达站10G以下(按照微波站收费)
  CURSOR C_COUNTR10GDOWN IS SELECT * FROM V_RIM_RSM_FEE_R_Apply
        WHERE APPLY_CODE=APPLYCODE
        AND begin_YEAR=COUNTYEAR
        and FREQ_EMIT<=10000 and FREQ_EMIT>0
        ORDER BY decl_code,FREQ_EMIT;
  V_COUNTR10GDOWN C_COUNTR10GDOWN%ROWTYPE;
  ----
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --雷达站10G以下--记录合计数量
  V_Count_10GDOWN NUMBER;----记录合计数量
  X_Count_10GDOWN NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  ---
begin
  ----
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  --
  --10G以下雷达站计费'910000'(按照微波站收费，重庆需求)
  V_FLAG := 'N';
  V_BANDWIDTH :=0;
  OPEN  C_COUNTR10GDOWN;
  LOOP
    FETCH  C_COUNTR10GDOWN INTO V_COUNTR10GDOWN;
    EXIT WHEN  C_COUNTR10GDOWN%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTR10GDOWN.begin_date,'YYYY'),substr(V_COUNTR10GDOWN.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTR10GDOWN.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='910000';
      ------数据记录合计数量
      SELECT count(*) INTO V_Count_10GDOWN FROM V_RIM_RSM_FEE_R_Apply
        WHERE APPLY_CODE=APPLYCODE
        AND begin_YEAR=COUNTYEAR
        and FREQ_EMIT<=10000 and FREQ_EMIT>0 ;
      ----
      X_Count_10GDOWN :=0;
      X_Count_10GDOWN :=X_Count_10GDOWN+1;
      --第一条记录
      --V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
      v_deptpay:= V_COUNTR10GDOWN.dept_pay;
      v_areacode:= V_COUNTR10GDOWN.area_code;
      V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
      V_PARTMID:= V_PART;
       if V_BANDWIDTH =0 then
         V_BANDWIDTH :=0;
      end if;
      V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNTR10GDOWN.CHAN_DIST,1));
       --空值则默认为一个单位
      V_DERATE := V_COUNTR10GDOWN.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_DECLCODE=V_COUNTR10GDOWN.DECL_CODE  AND V_APPLYCODE = V_COUNTR10GDOWN.APPLY_CODE THEN
      --同一个台站则带宽数据累计
      X_Count_10GDOWN :=X_Count_10GDOWN+1;
      ----
      if V_FREQEMIT <> V_COUNTR10GDOWN.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNTR10GDOWN.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNTR10GDOWN.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '910000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ---
      V_BANDWIDTH :=0;
      V_BANDWIDTH := CEIL(nvl(V_COUNTR10GDOWN.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNTR10GDOWN.DERATE;
      --取出减免比例
      V_APPLYCODE := V_COUNTR10GDOWN.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
      v_deptpay:= V_COUNTR10GDOWN.dept_pay;
      v_areacode:= V_COUNTR10GDOWN.area_code;
      V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_10GDOWN :=X_Count_10GDOWN+1;
      IF X_Count_10GDOWN = V_Count_10GDOWN  THEN
          V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
          v_deptpay:= V_COUNTR10GDOWN.dept_pay;
          v_areacode:= V_COUNTR10GDOWN.area_code;
          V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
          --空值则默认为一个单位
          V_DERATE := V_COUNTR10GDOWN.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          ----
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNTR10GDOWN.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNTR10GDOWN.APPLY_CODE,0,length(V_COUNTR10GDOWN.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNTR10GDOWN.DECL_CODE;---技术资料表编号
          ---
           INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '910000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
          ---
      END IF;
      --如果执行最后条记录
    END IF;
    ---
      V_DERATE := V_COUNTR10GDOWN.DERATE;
      --取出减免比例
      ---记录累加
      V_APPLYCODE := V_COUNTR10GDOWN.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
      v_deptpay:= V_COUNTR10GDOWN.dept_pay;
      v_areacode:= V_COUNTR10GDOWN.area_code;
      V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
    ----
  END LOOP;
  CLOSE  C_COUNTR10GDOWN;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '910000',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  ----
commit;

end FEE_R_Apply10GDOWN_TEST;

/

-- ----------------------------
-- Procedure structure for FEE_R_APPLY10GUP_TEST
-- ----------------------------
CREATE OR REPLACE procedure "RXDEV"."FEE_R_APPLY10GUP_TEST"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
----测试
----雷达站10G以上(按照微波站收费)
--雷达站10G以上(按照微波站收费)
  --雷达站10G以上(按照微波站收费)
  CURSOR C_COUNTR10GUP IS SELECT * FROM V_RIM_RSM_FEE_R_Apply
        WHERE APPLY_CODE=APPLYCODE
        AND begin_YEAR=COUNTYEAR
        and FREQ_EMIT>10000
        ORDER BY decl_code,FREQ_EMIT;
  V_COUNTR10GUP C_COUNTR10GUP%ROWTYPE;
  ----
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
  V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;

  --雷达站10G以上--记录合计数量
  V_CountR_10GUP NUMBER;----记录合计数量
  X_CountR_10GUP NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  ---
begin
  ----
  ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ----
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  --
  --雷达站10G以上计费'920000'(按照微波站收费，重庆需求)
  V_FLAG := 'N';
  V_BANDWIDTH :=0;
  OPEN  C_COUNTR10GUP;
  LOOP
    FETCH  C_COUNTR10GUP INTO V_COUNTR10GUP;
    EXIT WHEN  C_COUNTR10GUP%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTR10GUP.begin_date,'YYYY'),substr(V_COUNTR10GUP.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTR10GUP.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='920000';
      ------数据记录合计数量
      SELECT count(*) INTO V_CountR_10GUP FROM V_RIM_RSM_FEE_R_Apply
          WHERE APPLY_CODE=APPLYCODE
          AND begin_YEAR=COUNTYEAR
          and FREQ_EMIT>10000;
      ----
      X_CountR_10GUP :=0;
      X_CountR_10GUP :=X_CountR_10GUP+1;
      --第一条记录
      --V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
      v_deptpay:= V_COUNTR10GUP.dept_pay;
      v_areacode:= V_COUNTR10GUP.area_code;
      V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
      V_PARTMID:= V_PART;
       if V_BANDWIDTH =0 then
         V_BANDWIDTH :=0;
      end if;
      V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNTR10GUP.CHAN_DIST,1));
       --空值则默认为一个单位
      V_DERATE := V_COUNTR10GUP.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_DECLCODE=V_COUNTR10GUP.DECL_CODE  AND V_APPLYCODE = V_COUNTR10GUP.APPLY_CODE THEN
      --同一个台站则带宽数据累计
      X_CountR_10GUP :=X_CountR_10GUP+1;
      ----
      if V_FREQEMIT <> V_COUNTR10GUP.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNTR10GUP.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNTR10GUP.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '920000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ---
      V_BANDWIDTH :=0;
      V_BANDWIDTH := CEIL(nvl(V_COUNTR10GUP.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNTR10GUP.DERATE;
      --取出减免比例
      V_APPLYCODE := V_COUNTR10GUP.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GUP.DECL_CODE;
      v_deptpay:= V_COUNTR10GUP.dept_pay;
      v_areacode:= V_COUNTR10GUP.area_code;
      V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
       X_CountR_10GUP :=X_CountR_10GUP+1;
      IF X_CountR_10GUP = V_CountR_10GUP  THEN
          V_DECLCODE := V_COUNTR10GUP.DECL_CODE;
          v_deptpay:= V_COUNTR10GUP.dept_pay;
          v_areacode:= V_COUNTR10GUP.area_code;
          V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
          --空值则默认为一个单位
          V_DERATE := V_COUNTR10GUP.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          ----
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNTR10GUP.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNTR10GUP.APPLY_CODE,0,length(V_COUNTR10GUP.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNTR10GUP.DECL_CODE;---技术资料表编号
          ---
           INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '920000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
          ---
      END IF;
      --如果执行最后条记录
    END IF;
    ---
      V_DERATE := V_COUNTR10GUP.DERATE;
      --取出减免比例
      ---记录累加
      V_APPLYCODE := V_COUNTR10GUP.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GUP.DECL_CODE;
      v_deptpay:= V_COUNTR10GUP.dept_pay;
      v_areacode:= V_COUNTR10GUP.area_code;
      V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
    ----
  END LOOP;
  CLOSE  C_COUNTR10GUP;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '920000',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  ----
commit;

end FEE_R_Apply10GUP_TEST;

/

-- ----------------------------
-- Procedure structure for P_RIM_RSM_FEECOMPUTE_APP_PA
-- ----------------------------
CREATE OR REPLACE PROCEDURE "RXDEV"."P_RIM_RSM_FEECOMPUTE_APP_PA"(applycode VARCHAR,COUNTYEAR NUMBER,COUNTHANDLER VARCHAR,COUNTDATE DATE,DATACONFIRM VARCHAR,CHECKHANDLER VARCHAR,CHECKDATE DATE)
IS
  V_SUM    NUMBER;
  V_SUM1   NUMBER;
  V_COUNT  NUMBER;
 CURSOR C_dept IS
  select APP_PA_ID_CARD,org_area_code from v_rim_rsm_pa_equcheckcount where app_code=applycode and APP_PA_ID_CARD<>'null' and APP_PA_ID_CARD is not null group by APP_PA_ID_CARD,org_area_code;
  v_dept C_dept%ROWTYPE;
BEGIN
 OPEN C_dept;
  LOOP
    FETCH  C_dept INTO v_dept;
    EXIT WHEN  C_dept%NOTFOUND;
  P_rim_rsm_FEEITEM_EQUAPP_PA(COUNTYEAR,applycode);
    V_SUM :=0;
  SELECT COUNT(*) INTO V_COUNT FROM T_RIM_RSM_PAY_EQUPA_APPLYITEM WHERE apply_code=applycode AND COUNT_YEAR=COUNTYEAR;
  IF V_COUNT>0 THEN
    SELECT SUM(SUM_PAY) INTO V_SUM1 FROM T_RIM_RSM_PAY_EQUPA_APPLYITEM WHERE apply_code=applycode AND COUNT_YEAR=COUNTYEAR;
    V_SUM := V_SUM1;
  END IF;
  IF DATACONFIRM='N' THEN
    UPDATE T_RIM_RSM_PAY_EQUPA_APPLYCOUNT  SET   SUM_COUNT  =V_SUM,
                    HANDLE_DATE  =COUNTDATE,
                    HANDLER    =COUNTHANDLER,
                    CONFIRM    =DATACONFIRM,
                    CHECKER     =NULL,
                    CHECK_DATE  =NULL
                WHERE  apply_code  =applycode
                  and  area_code  =v_dept.org_area_code
                  and  IDENTIFICATION_CARD  =v_dept.app_pa_id_card
                  and  COUNT_YEAR  =COUNTYEAR;

    IF SQL%NOTFOUND THEN
    --属于新加的计算结果,并且有计算细目记录
      INSERT INTO T_RIM_RSM_PAY_EQUPA_APPLYCOUNT (ITEM_NO,
                      APPLY_CODE,
                      IDENTIFICATION_CARD,
                      area_code,
                      COUNT_YEAR,
                      SUM_COUNT,
                      HANDLE_DATE,
                      HANDLER,
                      CONFIRM,
                      CHECKER,
                      CHECK_DATE)
                    VALUES(F_RIM_RSM_GETFEENO(COUNTYEAR),
                      APPLYCODE,
                      v_dept.app_pa_id_card,
                      v_dept.org_area_code,
                      COUNTYEAR,
                      V_SUM,
                      COUNTDATE,
                      COUNTHANDLER,
                      DATACONFIRM,
                      CHECKHANDLER,
                      CHECKDATE);

    END IF;
  ELSE
    UPDATE T_RIM_RSM_PAY_EQUPA_APPLYCOUNT   SET  SUM_COUNT  =V_SUM,
                    HANDLE_DATE  =COUNTDATE,
                    HANDLER    =COUNTHANDLER,
                    CONFIRM    =DATACONFIRM,
                    CHECKER     =CHECKHANDLER,
                    CHECK_DATE  =CHECKDATE
                WHERE  apply_code  =applycode
                  and COUNT_YEAR  =COUNTYEAR;
    IF SQL%NOTFOUND THEN
     --属于新加的计算结果,并且有计算细目记录
           INSERT INTO T_RIM_RSM_PAY_EQUPA_APPLYCOUNT (ITEM_NO,
                      APPLY_CODE,
                      IDENTIFICATION_CARD,
                      area_code,
                      COUNT_YEAR,
                      SUM_COUNT,
                      HANDLE_DATE,
                      HANDLER,
                      CONFIRM,
                      CHECKER,
                      CHECK_DATE)
                    VALUES(F_RIM_RSM_GETFEENO(COUNTYEAR),
                      APPLYCODE,
                      v_dept.app_pa_id_card,
                      v_dept.org_area_code,
                      COUNTYEAR,
                      V_SUM,
                      COUNTDATE,
                      COUNTHANDLER,
                      DATACONFIRM,
                      CHECKHANDLER,
                      CHECKDATE);
    END IF;
   END IF;
 END LOOP;
 IF V_dept.App_Pa_Id_Card IS NULL THEN
       UPDATE T_RIM_RSM_PAY_EQUPA_APPLYCOUNT  SET   SUM_COUNT  =0,
                    HANDLE_DATE  =COUNTDATE,
                    HANDLER    =COUNTHANDLER,
                    CONFIRM    =DATACONFIRM,
                    CHECKER     =NULL,
                    CHECK_DATE  =NULL
                WHERE  apply_code  =applycode
                  and COUNT_YEAR  =COUNTYEAR;
  END IF;
  close C_dept;
  commit;
END;

/

-- ----------------------------
-- Procedure structure for P_RIM_RSM_FEECOMPUTE_APPLY
-- ----------------------------
CREATE OR REPLACE PROCEDURE "RXDEV"."P_RIM_RSM_FEECOMPUTE_APPLY"(APPLYCODE varchar2,COUNTYEAR NUMBER,COUNTHANDLER VARCHAR,COUNTDATE DATE,DATACONFIRM VARCHAR,CHECKHANDLER VARCHAR,CHECKDATE DATE)
IS
----新台计费
  V_SUM    NUMBER;
  V_SUM1   NUMBER;
  V_COUNT  NUMBER;
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  CURSOR C_dept IS
    select dept_pay,area_code from v_RIM_RSM_PAY_dept where apply_code= 'T'||applycode and dept_pay<>'null' and dept_pay is not null group by dept_pay,area_code;
  v_dept C_dept%ROWTYPE;
BEGIN
  P_RIM_RSM_FEEITEM_APPLY(COUNTYEAR,APPLYCODE);
  --
  --ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  --ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA
  ApplyCode_Temp := APPLYCODE;
  ApplyType_Temp := 'T';
  --
  OPEN C_dept;
  LOOP
    FETCH  C_dept INTO v_dept;
    EXIT WHEN  C_dept%NOTFOUND;
    V_SUM :=0;
    SELECT COUNT(*) INTO V_COUNT FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND dept_pay=v_dept.dept_pay and area_code=v_dept.area_code AND COUNT_YEAR=COUNTYEAR;
    IF V_COUNT>0 THEN
       SELECT SUM(SUM_PAY) INTO V_SUM1 FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND dept_pay=v_dept.dept_pay and area_code=v_dept.area_code AND COUNT_YEAR=COUNTYEAR;
      V_SUM := V_SUM1;
    END IF;
    SELECT COUNT(*) INTO V_COUNT FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND  dept_pay=v_dept.dept_pay and area_code=v_dept.area_code AND COUNT_YEAR=COUNTYEAR;
    IF V_COUNT>0 THEN
       SELECT SUM(SUM_PAY) INTO V_SUM1 FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND  dept_pay=v_dept.dept_pay and area_code=v_dept.area_code AND COUNT_YEAR=COUNTYEAR;
      V_SUM := V_SUM+V_SUM1;
    END IF;
     SELECT COUNT(*) INTO V_COUNT FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND  dept_pay=v_dept.dept_pay and area_code=v_dept.area_code AND COUNT_YEAR=COUNTYEAR;
  IF V_COUNT>0 THEN
    SELECT SUM(SUM_PAY) INTO V_SUM1 FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND  dept_pay=v_dept.dept_pay and area_code=v_dept.area_code AND COUNT_YEAR=COUNTYEAR;
    V_SUM := V_SUM+V_SUM1;
  END IF;
    SELECT COUNT(*) INTO V_COUNT FROM T_RIM_RSM_PAY_APPLYOTHER WHERE APPLY_CODE=ApplyCode_Temp and dept_pay=v_dept.dept_pay and area_code=v_dept.area_code AND COUNT_YEAR=COUNTYEAR;
    IF V_COUNT>0 THEN
      SELECT SUM(FEE_PAY) INTO V_SUM1 FROM T_RIM_RSM_PAY_APPLYOTHER WHERE APPLY_CODE=ApplyCode_Temp and dept_pay=v_dept.dept_pay and area_code=v_dept.area_code AND COUNT_YEAR=COUNTYEAR;
      V_SUM := V_SUM+V_SUM1;
    END IF;
    IF DATACONFIRM='N' THEN
      UPDATE T_RIM_RSM_PAY_APPLYCOUNT  SET  SUM_COUNT  =V_SUM,
                      HANDLE_DATE  =COUNTDATE,
                      HANDLER    =COUNTHANDLER,
                      CONFIRM    =DATACONFIRM,
                      CHECKER     =NULL,
                      CHECK_DATE  =NULL,
                      APPLYTYPE = ApplyType_Temp
                  WHERE  APPLY_CODE  =ApplyCode_Temp AND
                      dept_pay  =v_dept.dept_pay and
                      area_code  =v_dept.area_code and
                      COUNT_YEAR  =COUNTYEAR;
      IF SQL%NOTFOUND THEN
      --属于新加的计算结果,并且有计算细目记录
        INSERT INTO T_RIM_RSM_PAY_APPLYCOUNT(ITEM_NO,
                      APPLY_CODE,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      SUM_COUNT,
                      HANDLE_DATE,
                      HANDLER,
                      CONFIRM,
                      APPLYTYPE)
                    VALUES(F_RIM_RSM_GETFEENO(COUNTYEAR),
                      ApplyCode_Temp,
                      v_dept.dept_pay,
                      v_dept.area_code,
                      COUNTYEAR,
                      V_SUM,
                      COUNTDATE,
                      COUNTHANDLER,
                      DATACONFIRM,
                      ApplyType_Temp);
      END IF;
    ELSE
      UPDATE T_RIM_RSM_PAY_APPLYCOUNT  SET  SUM_COUNT  =V_SUM,
                      HANDLE_DATE  =COUNTDATE,
                      HANDLER    =COUNTHANDLER,
                      CONFIRM    =DATACONFIRM,
                      CHECKER     =CHECKHANDLER,
                      CHECK_DATE  =CHECKDATE,
                      APPLYTYPE = ApplyType_Temp
                  WHERE  APPLY_CODE  =ApplyCode_Temp AND
                      dept_pay  =v_dept.dept_pay and
                      area_code  =v_dept.area_code and
                      COUNT_YEAR  =COUNTYEAR;
      IF SQL%NOTFOUND THEN
      --属于新加的计算结果,并且有计算细目记录
        INSERT INTO T_RIM_RSM_PAY_APPLYCOUNT(ITEM_NO,
                      APPLY_CODE,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      SUM_COUNT,
                      HANDLE_DATE,
                      HANDLER,
                      CONFIRM,
                      CHECKER,
                      CHECK_DATE,
                      APPLYTYPE)
                    VALUES(F_RIM_RSM_GETFEENO(COUNTYEAR),
                      ApplyCode_Temp,
                      v_dept.dept_pay,
                      v_dept.area_code,
                      COUNTYEAR,
                      V_SUM,
                      COUNTDATE,
                      COUNTHANDLER,
                      DATACONFIRM,
                      CHECKHANDLER,
                      CHECKDATE,
                      ApplyType_Temp);
      END IF;
    END IF;
     IF V_SUM=0 THEN
        SELECT COUNT(*) INTO V_COUNT FROM v_rim_rsm_pay_dept where to_char(STAT_Date_Start,'YYYY')=TO_CHAR(COUNTYEAR)
           and APPLY_code=TO_CHAR('T'||APPLYCODE) and dept_pay<>'null';
         IF V_COUNT=0 THEN
             DELETE FROM T_RIM_RSM_PAY_APPLYCOUNT
               WHERE  APPLY_CODE  =ApplyCode_Temp AND
                  dept_pay  =v_dept.dept_pay and
                  area_code  =v_dept.area_code and
                  COUNT_YEAR  =COUNTYEAR;
         END IF;
     END IF;
  END LOOP;
  IF V_dept.Dept_Pay IS NULL THEN
      UPDATE T_RIM_RSM_PAY_APPLYCOUNT  SET  SUM_COUNT =0,
                      HANDLE_DATE  =COUNTDATE,
                      HANDLER    =COUNTHANDLER,
                      CONFIRM    =DATACONFIRM,
                      CHECKER     =NULL,
                      CHECK_DATE  =NULL
                  WHERE  APPLY_CODE  =ApplyCode_Temp AND
                      COUNT_YEAR  =COUNTYEAR;
  END IF;
  CLOSE C_dept;
  commit;
END;

/

-- ----------------------------
-- Procedure structure for P_RIM_RSM_FEECOMPUTE_DEPT
-- ----------------------------
CREATE OR REPLACE PROCEDURE "RXDEV"."P_RIM_RSM_FEECOMPUTE_DEPT"(DEPTCODE VARCHAR,areacode varchar,COUNTYEAR NUMBER,COUNTHANDLER VARCHAR,COUNTDATE DATE,DATACONFIRM VARCHAR,CHECKHANDLER VARCHAR,CHECKDATE DATE)
IS
  V_SUM    NUMBER;
  V_SUM1   NUMBER;
  V_COUNT  NUMBER;
BEGIN
  ----年度计费
  P_RIM_RSM_FEEITEM_DEPT(COUNTYEAR,DEPTCODE,areacode);
    V_SUM :=0;
  SELECT COUNT(*) INTO V_COUNT FROM T_RIM_RSM_pay_deptnetitem WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  IF V_COUNT>0 THEN
    SELECT SUM(SUM_PAY) INTO V_SUM1 FROM T_RIM_RSM_pay_deptnetitem WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
    V_SUM := V_SUM1;
  END IF;
  SELECT COUNT(*) INTO V_COUNT FROM T_RIM_RSM_PAY_DEPTITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  IF V_COUNT>0 THEN
    SELECT SUM(SUM_PAY) INTO V_SUM1 FROM T_RIM_RSM_PAY_DEPTITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
    V_SUM := V_SUM+V_SUM1;
  END IF;
  SELECT COUNT(*) INTO V_COUNT FROM T_RIM_RSM_PAY_EQUCHECKITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode  AND COUNT_YEAR=COUNTYEAR;
  IF V_COUNT>0 THEN
    SELECT SUM(SUM_PAY) INTO V_SUM1 FROM T_RIM_RSM_PAY_EQUCHECKITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode  AND COUNT_YEAR=COUNTYEAR;
    V_SUM := V_SUM+V_SUM1;
  END IF;
  SELECT COUNT(*) INTO V_COUNT FROM T_RIM_RSM_PAY_DEPTOTHER WHERE DEPT_PAY=DEPTCODE and area_code=areacode  AND COUNT_YEAR=COUNTYEAR;
  IF V_COUNT>0 THEN
    SELECT SUM(FEE_PAY) INTO V_SUM1 FROM T_RIM_RSM_PAY_DEPTOTHER WHERE DEPT_PAY=DEPTCODE and area_code=areacode  AND COUNT_YEAR=COUNTYEAR;
    V_SUM := V_SUM+V_SUM1;
  END IF;
  IF DATACONFIRM='N' THEN
    UPDATE T_RIM_RSM_PAY_DEPTCOUNT  SET   SUM_COUNT  =V_SUM,
                    HANDLE_DATE  =COUNTDATE,
                    HANDLER    =COUNTHANDLER,
                    CONFIRM    =DATACONFIRM,
                    CHECKER     =NULL,
                    CHECK_DATE  =NULL
                WHERE  DEPT_PAY  =DEPTCODE
                  AND  area_code=areacode
                  and COUNT_YEAR  =COUNTYEAR;
    IF SQL%NOTFOUND THEN
    --属于新加的计算结果,并且有计算细目记录
      INSERT INTO T_RIM_RSM_PAY_DEPTCOUNT (ITEM_NO,
                       DEPT_PAY,
                       area_code,
                       COUNT_YEAR,
                       SUM_COUNT,
                       HANDLE_DATE,
                       HANDLER,
                       CONFIRM)
                  VALUES(F_RIM_RSM_GETFEENO(COUNTYEAR),
                       DEPTCODE,
                       areacode,
                       COUNTYEAR,
                       V_SUM,
                       COUNTDATE,
                       COUNTHANDLER,
                       DATACONFIRM);
    END IF;
  ELSE
    UPDATE T_RIM_RSM_PAY_DEPTCOUNT   SET  SUM_COUNT  =V_SUM,
                    HANDLE_DATE  =COUNTDATE,
                    HANDLER    =COUNTHANDLER,
                    CONFIRM    =DATACONFIRM,
                    CHECKER     =CHECKHANDLER,
                    CHECK_DATE  =CHECKDATE
                WHERE  DEPT_PAY  =DEPTCODE
                  AND  area_code=areacode
                  and COUNT_YEAR  =COUNTYEAR;
    IF SQL%NOTFOUND THEN
     --属于新加的计算结果,并且有计算细目记录
      INSERT INTO T_RIM_RSM_PAY_DEPTCOUNT (ITEM_NO,
                       DEPT_PAY,
                       area_code,
                       COUNT_YEAR,
                       SUM_COUNT,
                       HANDLE_DATE,
                       HANDLER,
                       CONFIRM,
                       CHECKER,
                       CHECK_DATE)
                  VALUES(F_RIM_RSM_GETFEENO(COUNTYEAR),
                       DEPTCODE,
                       areacode,
                       COUNTYEAR,
                       V_SUM,
                       COUNTDATE,
                       COUNTHANDLER,
                       DATACONFIRM,
                       CHECKHANDLER,
                       CHECKDATE);
    END IF;
  END IF;
  commit;
END;

/

-- ----------------------------
-- Procedure structure for P_RIM_RSM_FEECOMPUTE_DEPT_PA
-- ----------------------------
CREATE OR REPLACE PROCEDURE "RXDEV"."P_RIM_RSM_FEECOMPUTE_DEPT_PA"(DEPTCODE VARCHAR,areacode varchar,COUNTYEAR NUMBER,COUNTHANDLER VARCHAR,COUNTDATE DATE,DATACONFIRM VARCHAR,CHECKHANDLER VARCHAR,CHECKDATE DATE)
IS
  V_SUM    NUMBER;
  V_SUM1   NUMBER;
  V_COUNT  NUMBER;
BEGIN
  P_rim_rsm_FEEITEM_EQUDEPT_PA(COUNTYEAR,DEPTCODE,areacode);
    V_SUM :=0;
  SELECT COUNT(*) INTO V_COUNT FROM T_RIM_RSM_PAY_EQUPADEPTITEM WHERE IDENTIFICATION_CARD=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  IF V_COUNT>0 THEN
    SELECT SUM(SUM_PAY) INTO V_SUM1 FROM T_RIM_RSM_PAY_EQUPADEPTITEM WHERE IDENTIFICATION_CARD=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
    V_SUM := V_SUM1;
  END IF;
  IF DATACONFIRM='N' THEN
    UPDATE T_RIM_RSM_PAY_EQUPADEPTCOUNT  SET   SUM_COUNT  =V_SUM,
                    HANDLE_DATE  =COUNTDATE,
                    HANDLER    =COUNTHANDLER,
                    CONFIRM    =DATACONFIRM,
                    CHECKER     =NULL,
                    CHECK_DATE  =NULL
                WHERE  IDENTIFICATION_CARD  =DEPTCODE
                  AND  area_code=areacode
                  and COUNT_YEAR  =COUNTYEAR;
    IF SQL%NOTFOUND THEN
    --属于新加的计算结果,并且有计算细目记录
      INSERT INTO T_RIM_RSM_PAY_EQUPADEPTCOUNT (ITEM_NO,
                       IDENTIFICATION_CARD,
                       area_code,
                       COUNT_YEAR,
                       SUM_COUNT,
                       HANDLE_DATE,
                       HANDLER,
                       CONFIRM)
                  VALUES(F_RIM_RSM_GETFEENO(COUNTYEAR),
                       DEPTCODE,
                       areacode,
                       COUNTYEAR,
                       V_SUM,
                       COUNTDATE,
                       COUNTHANDLER,
                       DATACONFIRM);
    END IF;
  ELSE
    UPDATE T_RIM_RSM_PAY_EQUPADEPTCOUNT   SET  SUM_COUNT  =V_SUM,
                    HANDLE_DATE  =COUNTDATE,
                    HANDLER    =COUNTHANDLER,
                    CONFIRM    =DATACONFIRM,
                    CHECKER     =CHECKHANDLER,
                    CHECK_DATE  =CHECKDATE
                WHERE  IDENTIFICATION_CARD  =DEPTCODE
                  AND  area_code=areacode
                  and COUNT_YEAR  =COUNTYEAR;
    IF SQL%NOTFOUND THEN
     --属于新加的计算结果,并且有计算细目记录
      INSERT INTO T_RIM_RSM_PAY_EQUPADEPTCOUNT (ITEM_NO,
                       IDENTIFICATION_CARD,
                       area_code,
                       COUNT_YEAR,
                       SUM_COUNT,
                       HANDLE_DATE,
                       HANDLER,
                       CONFIRM,
                       CHECKER,
                       CHECK_DATE)
                  VALUES(F_RIM_RSM_GETFEENO(COUNTYEAR),
                       DEPTCODE,
                       areacode,
                       COUNTYEAR,
                       V_SUM,
                       COUNTDATE,
                       COUNTHANDLER,
                       DATACONFIRM,
                       CHECKHANDLER,
                       CHECKDATE);
    END IF;
  END IF;
  commit;
END;

/

-- ----------------------------
-- Procedure structure for P_RIM_RSM_FEEITEM_APPLY
-- ----------------------------
CREATE OR REPLACE PROCEDURE "RXDEV"."P_RIM_RSM_FEEITEM_APPLY"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
  ----新台计费

  --集群系统
  CURSOR C_COUNTJQ IS SELECT dept_pay,area_code,net_guid,
  min(begin_date) begin_date,freq,net_range,
  min(freq_note) freq_note,min(derate) derate ,
  ----【申请表编号、技术资料表编号】
  min(apply_code) APPLY_CODE,min(DECL_CODE) DECL_CODE
  FROM V_RIM_RSM_FEE_JQ_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                and freq>0
              group BY dept_pay,area_code,net_guid,freq,net_range;
  V_COUNTJQ C_COUNTJQ%ROWTYPE;
  --寻呼系统
  CURSOR C_COUNTPB IS SELECT dept_pay,area_code,net_guid,
  ---【申请表编号、技术资料表编号】
  min(apply_code) APPLY_CODE,min(DECL_CODE) DECL_CODE ,
  min(begin_date) begin_date,freq_emit,net_range,
  min(freq_note) freq_note,min(derate) derate
  FROM V_RIM_RSM_FEE_PB_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                and freq_emit>0
              group BY dept_pay,area_code,net_guid,freq_emit,net_range;
  V_COUNTPB C_COUNTPB%ROWTYPE;

  --广播电台
  CURSOR C_COUNTBC IS SELECT  dept_pay,area_code,net_guid,
  ----【申请表编号、技术资料表编号】
  min(apply_code) APPLY_CODE,min(DECL_CODE) DECL_CODE ,
  min(begin_date) begin_date,freq_emit,net_range,min(freq_note) freq_note,
  min(derate) derate  FROM V_RIM_RSM_FEE_BC_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                and freq_emit>0
              group BY dept_pay,area_code,net_guid,freq_emit,net_range;
  V_COUNTBC C_COUNTBC%ROWTYPE;

  --电视
  CURSOR C_COUNTBT IS SELECT  dept_pay,area_code,net_guid,
  ----【申请表编号、技术资料表编号】
  min(apply_code) APPLY_CODE,min(DECL_CODE) DECL_CODE ,
  min(begin_date) begin_date,freq_emit,net_range,min(freq_note) freq_note,
  min(derate) derate
  FROM V_RIM_RSM_FEE_BT_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                and freq_emit>0
              group BY dept_pay,area_code,net_guid,freq_emit,net_range;
  V_COUNTBT C_COUNTBT%ROWTYPE;

  ----无绳电话---410000
  ----暂时去掉
  /*
  CURSOR C_COUNTLINELESS IS SELECT * FROM V_RIM_RSM_FEE_LINELESS_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY decl_code;
  V_COUNTLINELESS C_COUNTLINELESS%ROWTYPE;

  */

  --船舶电台（吨位小于1600吨）
  CURSOR C_COUNTSHIP1 IS SELECT * FROM V_RIM_RSM_FEE_S_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND SHIP_TYPE<>'PH'
                AND TONNAGE<=1600
              ORDER BY decl_code;
  V_COUNTSHIP1 C_COUNTSHIP1%ROWTYPE;

  --船舶电台（吨位大于1600吨）
  CURSOR C_COUNTSHIP2 IS SELECT * FROM V_RIM_RSM_FEE_S_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND SHIP_TYPE<>'PH'
                AND TONNAGE>1600
              ORDER BY decl_code;
  V_COUNTSHIP2 C_COUNTSHIP2%ROWTYPE;

  --船舶电台（渔船，功率>=20马力）
  CURSOR C_COUNTSHIP3 IS SELECT * FROM V_RIM_RSM_FEE_S_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND SHIP_TYPE='PH'
                AND POWER>=20
              ORDER BY decl_code;
  V_COUNTSHIP3 C_COUNTSHIP3%ROWTYPE;

  --航空器电台(固定翼飞机27吨以上)
  CURSOR C_COUNTAERO1 IS SELECT * FROM V_RIM_RSM_FEE_A_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND TONNAGE>27
              ORDER BY decl_code;
  V_COUNTAERO1 C_COUNTAERO1%ROWTYPE;
  --航空器电台航空器电台(固定翼飞机5.7吨至27吨以下(含))
  CURSOR C_COUNTAERO2 IS SELECT * FROM V_RIM_RSM_FEE_A_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND TONNAGE<=27 and TONNAGE>5.7
              ORDER BY decl_code;
  V_COUNTAERO2 C_COUNTAERO2%ROWTYPE;
  --航空器电台(固定翼飞机5.7吨(含)以下)
  CURSOR C_COUNTAERO3 IS SELECT * FROM V_RIM_RSM_FEE_A_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND TONNAGE<=5.7  and TONNAGE>0
              ORDER BY decl_code;
  V_COUNTAERO3 C_COUNTAERO3%ROWTYPE;
  --航空器电台(旋翼飞机)
  CURSOR C_COUNTAERO4 IS SELECT * FROM V_RIM_RSM_FEE_A_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND TONNAGE=0
              ORDER BY decl_code;
  V_COUNTAERO4 C_COUNTAERO4%ROWTYPE;

  --无线数据频段----v_rim_rsm_fee_v该为
  CURSOR C_COUNTDATA IS SELECT * FROM v_rim_rsm_fee_data_apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                /*
                AND ((FREQ_EMIT>=223.025 AND FREQ_EMIT<=235) OR (FREQ_RECE>=223.025 AND FREQ_RECE<=235)
                  OR (FREQ_EMIT>821 AND FREQ_EMIT<825) OR (FREQ_RECE>821 AND FREQ_RECE<825)
                  OR (FREQ_EMIT>866 AND FREQ_EMIT<870) OR (FREQ_RECE>866 AND FREQ_RECE<870)
                  OR (FREQ_EMIT>915 AND FREQ_EMIT<917) OR (FREQ_RECE>915 AND FREQ_RECE<917))
                  */
              ORDER BY decl_code,FREQ_EMIT,FREQ_RECE;
  V_COUNTDATA C_COUNTDATA%ROWTYPE;

  --无线接入450MHZ频段----v_rim_rsm_fee_v改为v_rim_rsm_fee_450m_apply
  CURSOR C_COUNT450M IS SELECT * FROM v_rim_rsm_fee_450m_apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                /*
                AND ((FREQ_EMIT>=450.5 AND FREQ_EMIT<=451.975) OR (FREQ_RECE>=450.5 AND FREQ_RECE<=451.975)
                  OR (FREQ_EMIT>=460.5 AND FREQ_EMIT<=461.975) OR (FREQ_RECE>=460.5 AND FREQ_RECE<=461.975))
                */
              ORDER BY decl_code,FREQ_EMIT,FREQ_RECE;
  V_COUNT450M C_COUNT450M%ROWTYPE;

  --其它固定台【1000MHz以下的无线电台(固定电台)--'810000'】
  CURSOR C_COUNTOTHER IS SELECT dept_pay,area_code,net_guid,min(apply_code) apply_code,min(begin_date) begin_date,
       freq,min(freq_note) freq_note,min(derate) derate,decl_code
       FROM V_RIM_RSM_FEE_OTHER_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                and freq>0
              group BY dept_pay,area_code,net_guid,freq,decl_code;
  V_COUNTOTHER C_COUNTOTHER%ROWTYPE;
  --移动台【1000MHz以下的无线电台(移动台)--'820000'】----V_RIM_RSM_FEE_MOBILE_Apply改为 V_RIM_RSM_FEE_U
  CURSOR C_COUNTMOBILE IS SELECT * FROM V_RIM_RSM_FEE_MOBILE_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY decl_code;
  V_COUNTMOBILE C_COUNTMOBILE%ROWTYPE;
  --MMDS台-----V_RIM_RSM_FEE_M改为V_rim_rsm_FEE_MMDS_Apply
  CURSOR C_COUNTMMDS IS SELECT * FROM V_rim_rsm_FEE_MMDS_Apply
              WHERE DECL_CODE LIKE 'TF%'
                AND APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND STAT_TYPE='MD'
                AND FREQ_EMIT>0
              ORDER BY decl_code,FREQ_EMIT;
  V_COUNTMMDS C_COUNTMMDS%ROWTYPE;
  --无线接入1.8G----视图V_rim_rsm_FEE_ENTER1G8 改为V_rim_rsm_FEE_ENTER1G8_Apply
  CURSOR C_COUNT1G8 IS SELECT * FROM V_rim_rsm_FEE_ENTER1G8_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                --AND decl_code like 'C%'
              ORDER BY decl_code;
  V_COUNT1G8 C_COUNT1G8%ROWTYPE;
  --扩频系统2.4G----V_RIM_RSM_FEE_KP2G4_Apply改为V_RIM_RSM_FEE_M
  CURSOR C_COUNT2G4 IS SELECT * FROM V_RIM_RSM_FEE_M
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND (FREQ_EMIT>=2400 AND FREQ_EMIT<=2483.5)
              ORDER BY decl_code,FREQ_EMIT;
  V_COUNT2G4 C_COUNT2G4%ROWTYPE;
  --扩频系统5.8G----V_RIM_RSM_FEE_KP5G8_Apply改为V_RIM_RSM_FEE_M
  CURSOR C_COUNT5G81 IS SELECT * FROM V_RIM_RSM_FEE_KP5G8_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                --AND STAT_TYPE<>'CS'
							  AND (FREQ_EMIT>=5725 AND FREQ_EMIT<=5850)
              ORDER BY decl_code,FREQ_EMIT;
  V_COUNT5G81 C_COUNT5G81%ROWTYPE;
  --无线接入3.5G----V_RIM_RSM_FEE_ENTER3G5_Apply改为V_RIM_RSM_FEE_M
  CURSOR C_COUNT3G5 IS SELECT * FROM V_RIM_RSM_FEE_ENTER3G5_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND ((FREQ_EMIT>=3399.5 AND FREQ_EMIT<=3431) OR (FREQ_EMIT>=3499.5 AND FREQ_EMIT<=3531))
              ORDER BY decl_code,FREQ_EMIT;
  V_COUNT3G5 C_COUNT3G5%ROWTYPE;

  --无线接入5.8G
  CURSOR C_COUNT5G82 IS SELECT * FROM V_RIM_RSM_FEE_M
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND STAT_TYPE='CS'
                AND (FREQ_EMIT>=5725 AND FREQ_EMIT<=5850)
              ORDER BY decl_code,FREQ_EMIT;
  V_COUNT5G82 C_COUNT5G82%ROWTYPE;

  --雷达站10G以下(按照微波站收费)
  CURSOR C_COUNTR10GDOWN IS SELECT * FROM V_rim_rsm_FEE_R
        WHERE APPLY_CODE=APPLYCODE
        AND begin_YEAR=COUNTYEAR
        and FREQ_EMIT<=10000 and FREQ_EMIT>0
        ORDER BY decl_code,FREQ_EMIT;
  V_COUNTR10GDOWN C_COUNTR10GDOWN%ROWTYPE;
  --雷达站10G以上(按照微波站收费)
  CURSOR C_COUNTR10GUP IS SELECT * FROM V_rim_rsm_FEE_R
        WHERE APPLY_CODE=APPLYCODE
        AND begin_YEAR=COUNTYEAR
        and FREQ_EMIT>10000
        ORDER BY decl_code,FREQ_EMIT;
  V_COUNTR10GUP C_COUNTR10GUP%ROWTYPE;
  --10G以下微波
  -----去除同个台站的相同频率
  CURSOR C_COUNT10GDOWN IS SELECT distinct (APPLY_CODE||DECL_CODE||FREQ_EMIT) as APPLY_CODE_TEMP ,APPLY_CODE,DECL_CODE,FREQ_EMIT,chan_dist,derate,begin_date,begin_YEAR,dept_pay,area_code
               FROM V_RIM_RSM_FEE_M_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT<=10000 and FREQ_EMIT>0
              ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT,chan_dist,derate;
  V_COUNT10GDOWN C_COUNT10GDOWN%ROWTYPE;
  --10G以上微波站
  CURSOR C_COUNT10GUP IS SELECT distinct (APPLY_CODE||DECL_CODE||FREQ_EMIT) as APPLY_CODE_TEMP ,APPLY_CODE,DECL_CODE,FREQ_EMIT,chan_dist,derate,begin_date,begin_YEAR,dept_pay,area_code
               FROM V_RIM_RSM_FEE_M_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>10000
              ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT,chan_dist,derate;
  V_COUNT10GUP C_COUNT10GUP%ROWTYPE;
  --地球站
  CURSOR C_COUNTEARTH IS SELECT * FROM V_RIM_RSM_FEE_E_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY decl_code;
  V_COUNTEARTH C_COUNTEARTH%ROWTYPE;
  /*
  --------设备检测费----------------------------------------------------
 --寻呼系统(设备检测费)'112000' /广东省 20130125
  CURSOR C_COUNTPB_EQUCHECK IS SELECT  * FROM v_rim_rsm_fee_EQUCHECK_pb
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTPB_EQUCHECK C_COUNTPB_EQUCHECK%ROWTYPE;
  --集群系统(设备检测费)'113000' /广东省 20130125
  CURSOR C_COUNTJQ_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_jq
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTJQ_EQUCHECK C_COUNTJQ_EQUCHECK%ROWTYPE;
  --广播电台(设备检测费)'116000' /广东省 20130125
   CURSOR C_COUNTBC_EQUCHECK IS SELECT  *  FROM v_rim_rsm_fee_equcheck_bc
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTBC_EQUCHECK C_COUNTBC_EQUCHECK%ROWTYPE;
  --电视(设备检测费)'115000' /广东省 20130125
   CURSOR C_COUNTBT_EQUCHECK IS SELECT  *  FROM V_rim_rsm_FEE_EQUCHECK_BT
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTBT_EQUCHECK C_COUNTBT_EQUCHECK%ROWTYPE;
--无绳电话(设备检测费)'114000'/广东省 20130125
  CURSOR C_COUNTLINELESS_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_linless
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTLINELESS_EQUCHECK C_COUNTLINELESS_EQUCHECK%ROWTYPE;
   --微波站(包括10G以上和10G以下)(设备检测费)'119000' /广东省 20130125
   CURSOR C_COUNT10G_EQUCHECK IS SELECT  *  FROM v_rim_rsm_fee_equcheck_m
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNT10G_EQUCHECK C_COUNT10G_EQUCHECK%ROWTYPE;
  --无线数据频段(设备检测费)(设备检测费)'111700' /广东省 20130125
  CURSOR C_COUNTDATA_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_data
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTDATA_EQUCHECK C_COUNTDATA_EQUCHECK%ROWTYPE;
    --地球站(设备检测费)'111300' /广东省 20130125
  CURSOR C_COUNTEARTH_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_e
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTEARTH_EQUCHECK  C_COUNTEARTH_EQUCHECK%ROWTYPE;
   --MMDS台 (设备检测费)'111200' /广东省 20130125
  CURSOR C_COUNTMMDS_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_mmds
              WHERE DECL_CODE LIKE 'TF%'
                AND APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTMMDS_EQUCHECK C_COUNTMMDS_EQUCHECK%ROWTYPE;
  --无线接入1.8G(设备检测费)'111400'/广东省 20130125
  CURSOR C_COUNT1G8_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_ECHECK_enter1g8
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNT1G8_EQUCHECK C_COUNT1G8_EQUCHECK%ROWTYPE;
   --扩频系统2.4G(设备检测费)'111500'/广东省 20130125
  CURSOR C_COUNT2G4_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_kp2g4
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNT2G4_EQUCHECK C_COUNT2G4_EQUCHECK%ROWTYPE;
  --扩频系统5.8G(设备检测费)'111600'/广东省 20130125
  CURSOR C_COUNT5G81_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_kp5g8
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNT5G81_EQUCHECK C_COUNT5G81_EQUCHECK%ROWTYPE;
   --其它固定台(设备检测费)'117000'/广东省 20130125
  CURSOR C_COUNTOTHER_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_other
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTOTHER_EQUCHECK C_COUNTOTHER_EQUCHECK%ROWTYPE;
   --移动台(设备检测费)'118000'/广东省 20130125
  CURSOR C_COUNTMOBILE_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_mobile
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTMOBILE_EQUCHECK C_COUNTMOBILE_EQUCHECK%ROWTYPE;
   --蜂窝公众通信基站GSM(设备检测费)'111800'/广东省 20130125
  CURSOR C_COUNTGSM_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_GSM
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTGSM_EQUCHECK C_COUNTGSM_EQUCHECK%ROWTYPE;
    --蜂窝公众通信基站CDMA(设备检测费)'111800'/广东省 20130125
  CURSOR C_COUNTCDMA_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_CDMA
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTCDMA_EQUCHECK C_COUNTCDMA_EQUCHECK%ROWTYPE;
      --蜂窝公众通信基站WCDMA(设备检测费)'111800'/广东省 20130125
  CURSOR C_COUNTWCDMA_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_WCDMA
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTWCDMA_EQUCHECK C_COUNTWCDMA_EQUCHECK%ROWTYPE;
      --蜂窝公众通信基站TD-SCDMA(设备检测费)'111800'/广东省 20130125
  CURSOR C_COUNTTDSCDMA_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_TDSCDMA
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTTDSCDMA_EQUCHECK C_COUNTTDSCDMA_EQUCHECK%ROWTYPE;
------------------------------------------------------------------------
*/
  --V_AREACODE1 VARCHAR2(6); --设备检测用到的变量
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  V_YEAR NUMBER;
  --批准年度
  V_MONTH NUMBER;
   --批准月份
  V_PART NUMBER;
    --计收比例
  V_PARTMID NUMBER;
  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);
  V_DECLCODE VARCHAR2(6);
   V_DECLCODE1 VARCHAR2(6);
    --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
   --数量
  V_BANDWIDTH NUMBER;
   --带宽
  V_DERATE NUMBER;
   --减免
  V_FEE NUMBER;
  --无线数据频段记录合计数量
  V_Count_Data NUMBER;
  X_Count_Data NUMBER;----记录次数
  --无线接入450MHZ频段记录合计数量
  V_Count_FEE_450m NUMBER;
  X_Count_FEE_450m NUMBER;----记录次数
  --移动台记录合计数量
  V_Count_mobile NUMBER;
  X_Count_mobile NUMBER;----记录次数
  --扩频系统2.4G记录合计数量
  V_Count_kp2g4 NUMBER;
  X_Count_kp2g4 NUMBER;----记录次数
  --扩频系统5.8G记录合计数量
  V_Count_KP5G8 NUMBER;
  X_Count_KP5G8 NUMBER;----记录次数
  --无线接入3.5G记录合计数量
  V_Count_ENTER3G5 NUMBER;----记录合计数量
  X_Count_ENTER3G5 NUMBER;----记录次数
  --无线接入5.8G记录合计数量
  V_Count_ENTER5G8 NUMBER;----记录合计数量
  X_Count_ENTER5G8 NUMBER;----记录次数
  --雷达站10G以下--记录合计数量
  V_CountR_10GDOWN NUMBER;----记录合计数量
  X_CountR_10GDOWN NUMBER;----记录次数
  --雷达站10G以上--记录合计数量
  V_CountR_10GUP NUMBER;----记录合计数量
  X_CountR_10GUP NUMBER;----记录次数
    --收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  --
BEGIN
  --V_AREACODE1:=SUBSTR(substr(substr(APPLYCODE,-12,12),0,4),1,4)||'00';--设备检测用到的变量
  -- ApplyCode_Temp := Substr(APPLYCODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
  -- ApplyType_Temp := substr(APPLYCODE,0,length(APPLYCODE)-12);----申请表类型T或PA

  ApplyCode_Temp:=APPLYCODE;
  ApplyType_Temp:='T';
  --
  DELETE FROM T_RIM_RSM_PAY_APPLYITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_applynetitem WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECK_APPITEM WHERE APPLY_CODE=ApplyCode_Temp AND COUNT_YEAR=COUNTYEAR;
  --集群无线调度系统
  OPEN C_COUNTJQ;
  LOOP
    FETCH C_COUNTJQ INTO V_COUNTJQ;
    EXIT WHEN C_COUNTJQ%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTJQ.begin_date,'YYYY'),substr(V_COUNTJQ.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTJQ.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    --查询该缴费单位在本申请表之前的其它申请表中是否已经使用此频点，
    SELECT COUNT(*) INTO V_AMOUNT FROM V_RIM_RSM_FEE_JQ
      WHERE dept_pay=V_COUNTJQ.dept_pay AND area_code=V_COUNTJQ.area_code
         AND freq=V_COUNTJQ.freq AND net_guid=V_COUNTJQ.net_guid AND begin_date<V_COUNTJQ.begin_date;
    --没有使用的频率才计费
    IF V_AMOUNT=0 THEN
      IF  V_COUNTJQ.net_range='GJ' THEN
        V_ITEMCODE:='210000';
      ELSIF V_COUNTJQ.net_range='SJ' THEN
        V_ITEMCODE:='220000';
      ELSE
        V_ITEMCODE:='230000';
      END IF;
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE=V_ITEMCODE;
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTJQ.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTJQ.APPLY_CODE,0,length(V_COUNTJQ.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTJQ.DECL_CODE;---技术资料表编号
      --新增明细记录表
     INSERT INTO t_rim_rsm_pay_applynetitem(apply_code,
                      dept_pay,
                      area_code,
                      count_year,
                      item_code,
                      freq_note,
                      derate,
                      pay_rate,
                      sum_count,
                      sum_pay,
                      applytype,
                      decl_code)
                  VALUES (ApplyCode_Temp,
                      V_COUNTJQ.dept_pay,
                      V_COUNTJQ.area_code,
                      COUNTYEAR,
                      V_ITEMCODE,
                      V_COUNTJQ.freq_note,
                      V_COUNTJQ.DERATE,
                      V_PART,
                      V_FEE,
                      V_FEE*(V_PART/100.0)*(100-V_COUNTJQ.DERATE)/100,
                      ApplyType_Temp,
                      DECL_CODE_Temp);
    END IF;
  END LOOP;
  CLOSE C_COUNTJQ;
  --寻呼系统
  OPEN C_COUNTPB;
  LOOP
    FETCH C_COUNTPB INTO V_COUNTPB;
    EXIT WHEN C_COUNTPB%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTPB.begin_date,'YYYY'),substr(V_COUNTPB.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTPB.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    --查询该缴费单位是否已经使用此频率
    SELECT COUNT(*) INTO V_AMOUNT FROM V_RIM_RSM_FEE_PB_Apply
      WHERE dept_pay=V_COUNTPB.dept_pay AND area_code=V_COUNTPB.area_code
         AND freq_emit=V_COUNTPB.freq_emit  AND net_guid=V_COUNTPB.net_guid AND begin_date<V_COUNTPB.begin_date;
    --没有使用的频率才计费
    IF V_AMOUNT=0 THEN
      IF  V_COUNTPB.net_range='GJ' THEN
        V_ITEMCODE:='310000';
      ELSIF V_COUNTPB.net_range='SJ' THEN
        V_ITEMCODE:='320000';
      ELSE
        V_ITEMCODE:='330000';
      END IF;
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE=V_ITEMCODE;
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTPB.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTPB.APPLY_CODE,0,length(V_COUNTPB.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTPB.DECL_CODE;---技术资料表编号
      --新增明细记录表
     INSERT INTO t_rim_rsm_pay_applynetitem(apply_code,
                      dept_pay,
                      area_code,
                      count_year,
                      item_code,
                      freq_note,
                      derate,
                      pay_rate,
                      sum_count,
                      sum_pay,
                      applytype,
                      decl_code)
                  VALUES (ApplyCode_Temp,
                      V_COUNTPB.dept_pay,
                      V_COUNTPB.area_code,
                      COUNTYEAR,
                      V_ITEMCODE,
                      V_COUNTPB.freq_note,
                      V_COUNTPB.DERATE,
                      V_PART,
                      V_FEE,
                      V_FEE*(V_PART/100.0)*(100-V_COUNTPB.DERATE)/100,
                      ApplyType_Temp,
                      DECL_CODE_Temp);
    END IF;
  END LOOP;
  CLOSE C_COUNTPB;
  --广播电台
  OPEN C_COUNTBC;
  LOOP
    FETCH C_COUNTBC INTO V_COUNTBC;
    EXIT WHEN C_COUNTBC%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTBC.begin_date,'YYYY'),substr(V_COUNTBC.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTBC.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    --查询该缴费单位是否已经使用此频率
    SELECT COUNT(*) INTO V_AMOUNT FROM V_RIM_RSM_FEE_BC_Apply
      WHERE dept_pay=V_COUNTBC.dept_pay AND area_code=V_COUNTBC.area_code
         AND freq_emit=V_COUNTBC.freq_emit  AND net_guid=V_COUNTBC.net_guid AND begin_date<V_COUNTBC.begin_date;
    --没有使用的频率才计费
    IF V_AMOUNT=0 THEN
      IF  V_COUNTBC.net_range='GJ' THEN
        V_ITEMCODE:='560000';
      ELSIF V_COUNTBC.net_range='SJ' THEN
        V_ITEMCODE:='570000';
      ELSIF V_COUNTBC.net_range='CJ' THEN
        V_ITEMCODE:='580000';
      ELSE
        V_ITEMCODE:='590000';
      END IF;
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE=V_ITEMCODE;
      --
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTBC.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTBC.APPLY_CODE,0,length(V_COUNTBC.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTBC.DECL_CODE;---技术资料表编号
      --新增明细记录表
      --
     INSERT INTO t_rim_rsm_pay_applynetitem(apply_code,
                      dept_pay,
                      area_code,
                      count_year,
                      item_code,
                      freq_note,
                      derate,
                      pay_rate,
                      sum_count,
                      sum_pay,
                      applytype,
                      decl_code)
                  VALUES (ApplyCode_Temp,
                      V_COUNTBC.dept_pay,
                      V_COUNTBC.area_code,
                      COUNTYEAR,
                      V_ITEMCODE,
                      V_COUNTBC.freq_note,
                      V_COUNTBC.DERATE,
                      V_PART,
                      V_FEE,
                      V_FEE*(V_PART/100.0)*(100-V_COUNTBC.DERATE)/100,
                      ApplyType_Temp,
                      DECL_CODE_Temp);
    END IF;
  END LOOP;
  CLOSE C_COUNTBC;
  --电视
  OPEN C_COUNTBT;
  LOOP
    FETCH C_COUNTBT INTO V_COUNTBT;
    EXIT WHEN C_COUNTBT%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTBT.begin_date,'YYYY'),substr(V_COUNTBT.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTBT.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    --查询该缴费单位是否已经使用此频率
    SELECT COUNT(*) INTO V_AMOUNT FROM V_RIM_RSM_FEE_BT_Apply
      WHERE dept_pay=V_COUNTBT.dept_pay AND area_code=V_COUNTBT.area_code
         AND freq_emit=V_COUNTBT.freq_emit AND net_guid=V_COUNTBT.net_guid AND begin_date<V_COUNTBT.begin_date;
    --没有使用的频率才计费
    IF V_AMOUNT=0 THEN
      IF  V_COUNTBT.net_range='GJ' THEN
        V_ITEMCODE:='510000';
      ELSIF V_COUNTBT.net_range='SJ' THEN
        V_ITEMCODE:='520000';
      ELSIF V_COUNTBT.net_range='CJ' THEN
        V_ITEMCODE:='530000';
      ELSE
        V_ITEMCODE:='540000';
      END IF;
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE=V_ITEMCODE;
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTBT.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTBT.APPLY_CODE,0,length(V_COUNTBT.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTBT.DECL_CODE;---技术资料表编号
      --新增明细记录表
      INSERT INTO t_rim_rsm_pay_applynetitem(apply_code,
                      dept_pay,
                      area_code,
                      count_year,
                      item_code,
                      freq_note,
                      derate,
                      pay_rate,
                      sum_count,
                      sum_pay,
                      decl_code,
                      applytype)
                  VALUES (ApplyCode_Temp,
                      V_COUNTBT.dept_pay,
                      V_COUNTBT.area_code,
                      COUNTYEAR,
                      V_ITEMCODE,
                      V_COUNTBT.freq_note,
                      V_COUNTBT.DERATE,
                      V_PART,
                      V_FEE,
                      V_FEE*(V_PART/100.0)*(100-V_COUNTBT.DERATE)/100,
                      DECL_CODE_Temp,
                      ApplyType_Temp);
    END IF;
  END LOOP;
  CLOSE C_COUNTBT;

  --无绳电话计费暂时不计费
  --无绳电话计费'410000'

  /*
  V_FLAG := 'N';
  OPEN C_COUNTLINELESS;
  LOOP
    FETCH C_COUNTLINELESS INTO V_COUNTLINELESS;
    EXIT WHEN C_COUNTLINELESS%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTLINELESS.begin_date,'YYYY'),substr(V_COUNTLINELESS.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTLINELESS.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='410000';
      V_FLAG := 'Y';
    end if;
    V_FEE :=0;
    --获取申请表编号和技术资料表编号
    ApplyCode_Temp := Substr(V_COUNTLINELESS.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
    ApplyType_Temp := substr(V_COUNTLINELESS.APPLY_CODE,0,length(V_COUNTLINELESS.APPLY_CODE)-12);----申请表类型T或PA
    DECL_CODE_Temp := V_COUNTLINELESS.DECL_CODE;---技术资料表编号
    ----新增明细记录表
    INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                  decl_code,
                  dept_pay,
                  area_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  pay_rate,
                  amount,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (ApplyCode_Temp,
                  DECL_CODE_Temp,
                  V_COUNTLINELESS.dept_pay,
                  V_COUNTLINELESS.area_code,
                  COUNTYEAR,
                  '410000',
                  V_COUNTLINELESS.DERATE,
                  V_PART,
                  1,
                  V_FEE,
                  V_FEE*(V_PART/100.0)*(100-V_COUNTLINELESS.DERATE)/100,
                  ApplyType_Temp);
  END LOOP;
  CLOSE C_COUNTLINELESS;

  */

  --船舶电台（吨位小于1600吨）计费'620000'
  V_FLAG := 'N';
  OPEN C_COUNTSHIP1;
  LOOP
    FETCH C_COUNTSHIP1 INTO V_COUNTSHIP1;
    EXIT WHEN C_COUNTSHIP1%NOTFOUND;

    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTSHIP1.begin_date,'YYYY'),substr(V_COUNTSHIP1.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTSHIP1.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='620000';
      V_FLAG := 'Y';
    end if;
    --获取申请表编号和技术资料表编号
    ApplyCode_Temp := Substr(V_COUNTSHIP1.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
    ApplyType_Temp := substr(V_COUNTSHIP1.APPLY_CODE,0,length(V_COUNTSHIP1.APPLY_CODE)-12);----申请表类型T或PA
    DECL_CODE_Temp := V_COUNTSHIP1.DECL_CODE;---技术资料表编号
    ----新增明细记录表
    INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                  decl_code,
                  dept_pay,
                  area_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  pay_rate,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (ApplyCode_Temp,
                  DECL_CODE_Temp,
                  V_COUNTSHIP1.dept_pay,
                  V_COUNTSHIP1.area_code,
                  COUNTYEAR,
                  '620000',
                  V_COUNTSHIP1.DERATE,
                  V_PART,
                  1,
                  V_FEE,
                  V_FEE*(V_PART/100.0)*(100-V_COUNTSHIP1.DERATE)/100,
                  ApplyType_Temp);
  END LOOP;
  CLOSE C_COUNTSHIP1;
  --船舶电台（吨位大于1600吨）计费'610000'
  V_FLAG := 'N';
  OPEN C_COUNTSHIP2;
  LOOP
    FETCH C_COUNTSHIP2 INTO V_COUNTSHIP2;
    EXIT WHEN C_COUNTSHIP2%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTSHIP2.begin_date,'YYYY'),substr(V_COUNTSHIP2.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTSHIP2.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='610000';
      V_FLAG := 'Y';
    end if;
    --获取申请表编号和技术资料表编号
    ApplyCode_Temp := Substr(V_COUNTSHIP2.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
    ApplyType_Temp := substr(V_COUNTSHIP2.APPLY_CODE,0,length(V_COUNTSHIP2.APPLY_CODE)-12);----申请表类型T或PA
    DECL_CODE_Temp := V_COUNTSHIP2.DECL_CODE;---技术资料表编号
    ----新增明细记录表
    INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                  decl_code,
                  dept_pay,
                  area_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  pay_rate,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (ApplyCode_Temp,
                  DECL_CODE_Temp,
                  V_COUNTSHIP2.dept_pay,
                  V_COUNTSHIP2.area_code,
                  COUNTYEAR,
                  '610000',
                  V_COUNTSHIP2.DERATE,
                  V_PART,
                  1,
                  V_FEE,
                  V_FEE*(V_PART/100.0)*(100-V_COUNTSHIP2.DERATE)/100,
                  ApplyType_Temp);
  END LOOP;
  CLOSE C_COUNTSHIP2;
  --船舶电台（渔船，功率>=20马力）计费'630000'
  V_FLAG := 'N';
  OPEN C_COUNTSHIP3;
  LOOP
    FETCH C_COUNTSHIP3 INTO V_COUNTSHIP3;
    EXIT WHEN C_COUNTSHIP3%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTSHIP3.begin_date,'YYYY'),substr(V_COUNTSHIP3.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTSHIP3.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='630000';
      V_FLAG := 'Y';
    end if;
     --获取申请表编号和技术资料表编号
    ApplyCode_Temp := Substr(V_COUNTSHIP3.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
    ApplyType_Temp := substr(V_COUNTSHIP3.APPLY_CODE,0,length(V_COUNTSHIP3.APPLY_CODE)-12);----申请表类型T或PA
    DECL_CODE_Temp := V_COUNTSHIP3.DECL_CODE;---技术资料表编号
    ----新增明细记录表
    INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                  decl_code,
                  dept_pay,
                  area_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  pay_rate,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (ApplyCode_Temp,
                  DECL_CODE_Temp,
                  V_COUNTSHIP3.dept_pay,
                  V_COUNTSHIP3.area_code,
                  COUNTYEAR,
                  '630000',
                  V_COUNTSHIP3.DERATE,
                  V_PART,
                  1,
                  V_FEE,
                  V_FEE*(V_PART/100.0)*(100-V_COUNTSHIP3.DERATE)/100,
                  ApplyType_Temp);
  END LOOP;
  CLOSE C_COUNTSHIP3;
  --航空器电台(固定翼飞机27吨以上)
  V_FLAG := 'N';
  OPEN C_COUNTAERO1;
  LOOP
    FETCH C_COUNTAERO1 INTO V_COUNTAERO1;
    EXIT WHEN C_COUNTAERO1%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTAERO1.begin_date,'YYYY'),substr(V_COUNTAERO1.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTAERO1.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='710000';
      V_FLAG := 'Y';
    end if;
    --获取申请表编号和技术资料表编号
    ApplyCode_Temp := Substr(V_COUNTAERO1.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
    ApplyType_Temp := substr(V_COUNTAERO1.APPLY_CODE,0,length(V_COUNTAERO1.APPLY_CODE)-12);----申请表类型T或PA
    DECL_CODE_Temp := V_COUNTAERO1.DECL_CODE;---技术资料表编号
    ----新增明细记录表
    INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                  decl_code,
                  dept_pay,
                  area_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  pay_rate,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (ApplyCode_Temp,
                  DECL_CODE_Temp,
                  V_COUNTAERO1.dept_pay,
                  V_COUNTAERO1.area_code,
                  COUNTYEAR,
                  '710000',
                  V_COUNTAERO1.DERATE,
                  V_PART,
                  1,
                  V_FEE,
                  V_FEE*(V_PART/100.0)*(100-V_COUNTAERO1.DERATE)/100,
                  ApplyType_Temp);
  END LOOP;
  CLOSE C_COUNTAERO1;
  --航空器电台(固定翼飞机5.7吨至27吨以下(含))
  V_FLAG := 'N';
  OPEN C_COUNTAERO2;
  LOOP
    FETCH C_COUNTAERO2 INTO V_COUNTAERO2;
    EXIT WHEN C_COUNTAERO2%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTAERO2.begin_date,'YYYY'),substr(V_COUNTAERO2.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTAERO2.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='720000';
      V_FLAG := 'Y';
    end if;
    --获取申请表编号和技术资料表编号
    ApplyCode_Temp := Substr(V_COUNTAERO2.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
    ApplyType_Temp := substr(V_COUNTAERO2.APPLY_CODE,0,length(V_COUNTAERO2.APPLY_CODE)-12);----申请表类型T或PA
    DECL_CODE_Temp := V_COUNTAERO2.DECL_CODE;---技术资料表编号
    ----新增明细记录表
    INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                  decl_code,
                  dept_pay,
                  area_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  pay_rate,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (ApplyCode_Temp,
                  DECL_CODE_Temp,
                  V_COUNTAERO2.dept_pay,
                  V_COUNTAERO2.area_code,
                  COUNTYEAR,
                  '720000',
                  V_COUNTAERO2.DERATE,
                  V_PART,
                  1,
                  V_FEE,
                  V_FEE*(V_PART/100.0)*(100-V_COUNTAERO2.DERATE)/100,
                  ApplyType_Temp);

  END LOOP;
  CLOSE C_COUNTAERO2;
  --航空器电台(固定翼飞机5.7吨(含)以下)
  V_FLAG := 'N';
  OPEN C_COUNTAERO3;
  LOOP
    FETCH C_COUNTAERO3 INTO V_COUNTAERO3;
    EXIT WHEN C_COUNTAERO3%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTAERO3.begin_date,'YYYY'),substr(V_COUNTAERO3.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTAERO3.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='730000';
      V_FLAG := 'Y';
    end if;
    --获取申请表编号和技术资料表编号
    ApplyCode_Temp := Substr(V_COUNTAERO3.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
    ApplyType_Temp := substr(V_COUNTAERO3.APPLY_CODE,0,length(V_COUNTAERO3.APPLY_CODE)-12);----申请表类型T或PA
    DECL_CODE_Temp := V_COUNTAERO3.DECL_CODE;---技术资料表编号
    ----新增明细记录表
    INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                  decl_code,
                  dept_pay,
                  area_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  pay_rate,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (ApplyCode_Temp,
                  DECL_CODE_Temp,
                  V_COUNTAERO3.dept_pay,
                  V_COUNTAERO3.area_code,
                  COUNTYEAR,
                  '730000',
                  V_COUNTAERO3.DERATE,
                  V_PART,
                  1,
                  V_FEE,
                  V_FEE*(V_PART/100.0)*(100-V_COUNTAERO3.DERATE)/100,
                  ApplyType_Temp);
  END LOOP;
  CLOSE C_COUNTAERO3;

  --航空器电台(旋翼飞机)
  V_FLAG := 'N';
  OPEN C_COUNTAERO4;
  LOOP
    FETCH C_COUNTAERO4 INTO V_COUNTAERO4;
    EXIT WHEN C_COUNTAERO4%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTAERO4.begin_date,'YYYY'),substr(V_COUNTAERO4.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTAERO4.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='740000';
      V_FLAG := 'Y';
    end if;
    --获取申请表编号和技术资料表编号
    ApplyCode_Temp := Substr(V_COUNTAERO4.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
    ApplyType_Temp := substr(V_COUNTAERO4.APPLY_CODE,0,length(V_COUNTAERO4.APPLY_CODE)-12);----申请表类型T或PA
    DECL_CODE_Temp := V_COUNTAERO4.DECL_CODE;---技术资料表编号
    ----新增明细记录表
    INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                  decl_code,
                  dept_pay,
                  area_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  pay_rate,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (ApplyCode_Temp,
                  DECL_CODE_Temp,
                  V_COUNTAERO4.dept_pay,
                  V_COUNTAERO4.area_code,
                  COUNTYEAR,
                  '740000',
                  V_COUNTAERO4.DERATE,
                  V_PART,
                  1,
                  V_FEE,
                  V_FEE*(V_PART/100.0)*(100-V_COUNTAERO4.DERATE)/100,
                  ApplyType_Temp);
  END LOOP;
  CLOSE C_COUNTAERO4;

  --无线数据频段计费'140100'
  V_FLAG := 'N';
  OPEN C_COUNTDATA;
  LOOP
    FETCH C_COUNTDATA INTO V_COUNTDATA;
    EXIT WHEN C_COUNTDATA%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTDATA.begin_date,'YYYY'),substr(V_COUNTDATA.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTDATA.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    ---
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='140100';
      ----数据记录合计数量
      SELECT count(*) INTO V_Count_Data FROM V_RIM_RSM_FEE_data_Apply
              WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND (freq_emit>0 or freq_rece>0) ;
      --第一条记录
      V_AMOUNT := 0;
      X_Count_Data :=0;
      X_Count_Data := X_Count_Data+1;
      --计算发射频点
      if V_COUNTDATA.freq_emit>0 then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --计算接收频点
      if V_COUNTDATA.freq_rece>0 and V_COUNTDATA.freq_rece<>V_COUNTDATA.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --计算技术资料表编号是否相同
      ----台站相同，继续累加
      --计算发射频点
      IF  V_DECLCODE=V_COUNTDATA.decl_code AND V_APPLYCODE=V_COUNTDATA.APPLY_CODE THEN
        if V_COUNTDATA.freq_emit>0 then
           V_AMOUNT := V_AMOUNT+1;
        end if;
        --计算接收频点
        if V_COUNTDATA.freq_rece>0 and V_COUNTDATA.freq_rece<>V_COUNTDATA.freq_emit then
          V_AMOUNT := V_AMOUNT+1;
        end if;
      END IF;
      --
      --记录累加
      V_APPLYCODE := V_COUNTDATA.APPLY_CODE;
      V_DERATE := V_COUNTDATA.DERATE;
      V_DECLCODE := V_COUNTDATA.decl_code;
       --取出减免比例
      v_deptpay:= V_COUNTDATA.dept_pay;
      v_areacode:= V_COUNTDATA.area_code;
      V_FREQEMIT:= V_COUNTDATA.FREQ_EMIT;
      V_FREQRECE:= V_COUNTDATA.FREQ_RECE;
      V_PARTMID:=V_PART;
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTDATA.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTDATA.APPLY_CODE,0,length(V_COUNTDATA.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTDATA.DECL_CODE;---技术资料表编号
      V_FLAG := 'Y';
    ELSIF v_applycode=V_COUNTDATA.apply_code and v_declcode=V_COUNTDATA.decl_code THEN
      X_Count_Data := X_Count_Data+1;
      --台站相同，继续累加
      --计算发射频点
      if V_COUNTDATA.freq_emit>0 and V_FREQEMIT <> V_COUNTDATA.FREQ_EMIT then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQEMIT:= V_COUNTDATA.FREQ_EMIT;
      end if;
      --计算接收频点
      if V_COUNTDATA.freq_rece>0 and V_FREQRECE <> V_COUNTDATA.FREQ_RECE and V_COUNTDATA.freq_rece<>V_COUNTDATA.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQRECE:= V_COUNTDATA.FREQ_RECE;
      end if;
    ELSE
      ----新增明细记录表
      INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '140100',
                        V_DERATE,
                        V_PARTMID,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ----第二次初始数据
      --记录累加
      V_APPLYCODE := V_COUNTDATA.APPLY_CODE;
      V_DERATE := V_COUNTDATA.DERATE;
      V_DECLCODE := V_COUNTDATA.decl_code;
       --取出减免比例
      v_deptpay:= V_COUNTDATA.dept_pay;
      v_areacode:= V_COUNTDATA.area_code;
      V_FREQEMIT:= V_COUNTDATA.FREQ_EMIT;
      V_FREQRECE:= V_COUNTDATA.FREQ_RECE;
      V_PARTMID:=V_PART;
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTDATA.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTDATA.APPLY_CODE,0,length(V_COUNTDATA.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTDATA.DECL_CODE;---技术资料表编号
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_Data := X_Count_Data+1;
      --如果执行最后条记录
      IF V_Count_Data=X_Count_Data THEN
         --
         --计算发射频点
          if V_COUNTDATA.freq_emit>0 then
            V_AMOUNT := V_AMOUNT+1;
          end if;
          --计算接收频点
          if V_COUNTDATA.freq_rece>0 and V_COUNTDATA.freq_rece<>V_COUNTDATA.freq_emit then
            V_AMOUNT := V_AMOUNT+1;
          end if;
         ----新增明细记录表
         INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '140100',
                        V_DERATE,
                        V_PARTMID,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
         --新增明细记录表
      END IF;
      --
    END IF;
    --
  END LOOP;
  CLOSE C_COUNTDATA;
  ---
  IF V_FLAG = 'Y' THEN
      ----新增明细记录表
      INSERT INTO T_RIM_RSM_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '140100',
                        V_DERATE,
                        V_PARTMID,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
  END IF;


  --无线接入450MHZ频段计费'120100'
  V_FLAG := 'N';
  OPEN C_COUNT450M;
  LOOP
    FETCH C_COUNT450M INTO V_COUNT450M;
    EXIT WHEN C_COUNT450M%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT450M.begin_date,'YYYY'),substr(V_COUNT450M.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT450M.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120100';
      ----数据记录合计数量
      SELECT count(*) INTO V_Count_FEE_450m FROM V_RIM_RSM_FEE_450m_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                and (freq_emit>0 or freq_rece>0);
      --第一条记录
      V_AMOUNT := 0;
      X_Count_FEE_450m :=0;
      X_Count_FEE_450m := X_Count_FEE_450m+1;
      --计算发射频点
      if V_COUNT450M.freq_emit>0 then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --计算接收频点
      if V_COUNT450M.freq_rece>0 and V_COUNT450M.freq_rece<>V_COUNT450M.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
      end if;
       --计算技术资料表编号是否相同
      ----台站相同，继续累加
      --计算发射频点
      IF  V_DECLCODE=V_COUNT450M.decl_code AND V_APPLYCODE=V_COUNT450M.APPLY_CODE THEN
        if V_COUNT450M.freq_emit>0 then
           V_AMOUNT := V_AMOUNT+1;
        end if;
        --计算接收频点
        if V_COUNT450M.freq_rece>0 and V_COUNT450M.freq_rece<>V_COUNT450M.freq_emit then
          V_AMOUNT := V_AMOUNT+1;
        end if;
      END IF;
      --记录累加
      V_APPLYCODE := V_COUNT450M.APPLY_CODE;
      V_DERATE := V_COUNT450M.DERATE;
      V_DECLCODE := V_COUNT450M.decl_code;
      --取出减免比例
      v_deptpay:= V_COUNT450M.dept_pay;
      v_areacode:= V_COUNT450M.area_code;
      V_FREQEMIT:= V_COUNT450M.FREQ_EMIT;
      V_FREQRECE:= V_COUNT450M.FREQ_RECE;
      V_PARTMID:=V_PART;
       --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNT450M.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNT450M.APPLY_CODE,0,length(V_COUNT450M.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNT450M.DECL_CODE;---技术资料表编号
      V_FLAG := 'Y';

    ELSIF V_APPLYCODE=V_COUNT450M.apply_code and V_DECLCODE=V_COUNT450M.decl_code THEN
      X_Count_FEE_450m := X_Count_FEE_450m+1;
     --台站相同，继续累加
      --计算发射频点
      if V_COUNT450M.freq_emit>0 and V_FREQEMIT <> V_COUNT450M.FREQ_EMIT then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQEMIT:= V_COUNT450M.FREQ_EMIT;
      end if;
      --计算接收频点
      if V_COUNT450M.freq_rece>0 and V_FREQRECE <> V_COUNT450M.FREQ_RECE and V_COUNT450M.freq_rece<>V_COUNT450M.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQRECE:= V_COUNT450M.FREQ_RECE;
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT450M.DERATE;
    ELSE
      INSERT INTO T_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120100',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ----第二次初始数据
      --记录累加
      --记录累加
      V_APPLYCODE := V_COUNT450M.APPLY_CODE;
      V_DERATE := V_COUNT450M.DERATE;
      V_DECLCODE := V_COUNT450M.decl_code;
      --取出减免比例
      v_deptpay:= V_COUNT450M.dept_pay;
      v_areacode:= V_COUNT450M.area_code;
      V_FREQEMIT:= V_COUNT450M.FREQ_EMIT;
      V_FREQRECE:= V_COUNT450M.FREQ_RECE;
      V_PARTMID:=V_PART;
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNT450M.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNT450M.APPLY_CODE,0,length(V_COUNT450M.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNT450M.DECL_CODE;---技术资料表编号
       V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_FEE_450m := X_Count_FEE_450m+1;
      --如果执行最后条记录
      IF V_Count_FEE_450m=X_Count_FEE_450m THEN
           --计算发射频点
          if V_COUNT450M.freq_emit>0 then
            V_AMOUNT := V_AMOUNT+1;
          end if;
          --计算接收频点
          if V_COUNT450M.freq_rece>0 and V_COUNT450M.freq_rece<>V_COUNT450M.freq_emit then
            V_AMOUNT := V_AMOUNT+1;
          end if;
          --
          INSERT INTO T_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120100',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
          --
      END IF;
      --
    END IF;
  END LOOP;
  CLOSE C_COUNT450M;
  --
  IF V_FLAG = 'Y' THEN
   --存在需要添加的记录结果
    INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      DECL_CODE_Temp,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '120100',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  --
  --其它V表固定站计费'810000'
  OPEN C_COUNTOTHER;
  LOOP
    FETCH C_COUNTOTHER INTO V_COUNTOTHER;
    EXIT WHEN C_COUNTOTHER%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTOTHER.begin_date,'YYYY'),substr(V_COUNTOTHER.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTOTHER.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    --查询该缴费单位在本申请表之前的其它申请表中是否已经使用此频点，V_RIM_RSM_FEE_OTHER_Apply
    SELECT COUNT(*) INTO V_AMOUNT FROM V_RIM_RSM_FEE_OTHER_Apply
      WHERE dept_pay=V_COUNTOTHER.dept_pay AND area_code=V_COUNTOTHER.area_code
         AND freq=V_COUNTOTHER.freq AND net_guid=V_COUNTOTHER.net_guid AND begin_date<V_COUNTOTHER.begin_date;
    --没有使用的频率才计费
    IF V_AMOUNT=0 THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='810000';
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTOTHER.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTOTHER.APPLY_CODE,0,length(V_COUNTOTHER.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTOTHER.DECL_CODE;---技术资料表编号
      --
     INSERT INTO t_rim_rsm_pay_applynetitem(apply_code,
                      dept_pay,
                      area_code,
                      count_year,
                      item_code,
                      freq_note,
                      derate,
                      pay_rate,
                      sum_count,
                      sum_pay,
                      applytype,
                      decl_code)
                  VALUES (ApplyCode_Temp,
                      V_COUNTOTHER.dept_pay,
                      V_COUNTOTHER.area_code,
                      COUNTYEAR,
                      '810000',
                      V_COUNTOTHER.freq_note,
                      V_COUNTOTHER.DERATE,
                      V_PART,
                      V_FEE,
                      V_FEE*(V_PART/100.0)*(100-V_COUNTOTHER.DERATE)/100,
                      ApplyType_Temp,
                      DECL_CODE_Temp);
    END IF;
  END LOOP;
  CLOSE C_COUNTOTHER;
  --移动台计费'820000'
  V_FLAG := 'N';
  OPEN C_COUNTMOBILE;
  LOOP
    FETCH C_COUNTMOBILE INTO V_COUNTMOBILE;
    EXIT WHEN C_COUNTMOBILE%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTMOBILE.begin_date,'YYYY'),substr(V_COUNTMOBILE.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTMOBILE.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='820000';
       ----数据记录合计数量
      SELECT count(*) INTO V_Count_mobile FROM V_RIM_RSM_FEE_mobile_Apply
                WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY decl_code;
      --第一条记录
      V_AMOUNT := 1;
      X_Count_mobile :=0;
      X_Count_mobile :=X_Count_mobile+1;
       --记录累加
      V_DERATE := V_COUNTMOBILE.DERATE;
       --取出减免比例
      V_DECLCODE := V_COUNTMOBILE.decl_code;
      v_deptpay:= V_COUNTMOBILE.dept_pay;
      v_areacode:= V_COUNTMOBILE.area_code;
      V_PARTMID:=V_PART;
      V_FLAG := 'Y';
      -----获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTMOBILE.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTMOBILE.APPLY_CODE,0,length(V_COUNTMOBILE.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTMOBILE.DECL_CODE;---技术资料表编号
      ---
    ELSIF V_DECLCODE=V_COUNTMOBILE.decl_code THEN
      X_Count_mobile :=X_Count_mobile+1;
     --台站相同，继续累加
      V_AMOUNT := V_AMOUNT+1;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNTMOBILE.DERATE;
    ELSE
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNTMOBILE.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNTMOBILE.APPLY_CODE,0,length(V_COUNTMOBILE.APPLY_CODE)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTMOBILE.DECL_CODE;---技术资料表编号
      --
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '820000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_AMOUNT := 1;
      V_DECLCODE := V_COUNTMOBILE.decl_code;
      v_deptpay:= V_COUNTMOBILE.dept_pay;
      v_areacode:= V_COUNTMOBILE.area_code;
      V_DERATE := V_COUNTMOBILE.DERATE;
      --
      X_Count_mobile :=X_Count_mobile+1;
       --取出减免比例
    END IF;
  END LOOP;
  CLOSE C_COUNTMOBILE;
  ---
  IF   V_FLAG = 'Y' AND V_Count_mobile= X_Count_mobile THEN
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '820000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
  END IF;


  --有线电视传输（MMDS）计费'930000'
  V_FLAG := 'N';
  OPEN C_COUNTMMDS;
  LOOP
    FETCH C_COUNTMMDS INTO V_COUNTMMDS;
    EXIT WHEN C_COUNTMMDS%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTMMDS.begin_date,'YYYY'),substr(V_COUNTMMDS.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTMMDS.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_DECLCODE := V_COUNTMMDS.DECL_CODE;
      V_BANDWIDTH := nvl(V_COUNTMMDS.CHAN_DIST,1);
      v_deptpay:= V_COUNTMMDS.dept_pay;
      v_areacode:= V_COUNTMMDS.area_code;
      V_FREQEMIT:= V_COUNTMMDS.FREQ_EMIT;
      V_PARTMID := V_PART;
      --空值则默认为一个单位
      V_DERATE := V_COUNTMMDS.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='930000';
      --取出收费标准
    ELSIF V_DECLCODE = V_COUNTMMDS.DECL_CODE THEN
     --台站相同，继续累加
      if V_FREQEMIT <> V_COUNTMMDS.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+nvl(V_COUNTMMDS.CHAN_DIST,1);
        V_FREQEMIT:= V_COUNTMMDS.FREQ_EMIT;
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNTMMDS.DERATE;
    ELSE
    --台站不同,保存计算结果
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '930000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_BANDWIDTH := nvl(V_COUNTMMDS.CHAN_DIST,1);
       --空值则默认为一个单位
      V_DERATE := V_COUNTMMDS.DERATE;
       --取出减免比例
      V_DECLCODE := V_COUNTMMDS.DECL_CODE;
      v_deptpay:= V_COUNTMMDS.dept_pay;
      v_areacode:= V_COUNTMMDS.area_code;
      V_FREQEMIT:= V_COUNTMMDS.FREQ_EMIT;
    END IF;
  END LOOP;
  CLOSE C_COUNTMMDS;
  IF V_FLAG = 'Y' THEN
   --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
    END IF;
    INSERT INTO t_rim_rsm_PAY_APPLYITEM  (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '930000',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  --无线接入1.8G '120200'
  V_FLAG := 'N';
  OPEN C_COUNT1G8;
  LOOP
    FETCH C_COUNT1G8 INTO V_COUNT1G8;
    EXIT WHEN C_COUNT1G8%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT1G8.begin_date,'YYYY'),substr(V_COUNT1G8.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT1G8.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;

    --取出收费标准
    SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120200';
    --第一条记录
    V_AMOUNT := 1;
     --记录累加
    V_DERATE := V_COUNT1G8.DERATE;
     --取出减免比例
    V_DECLCODE := V_COUNT1G8.DECL_CODE;
    v_deptpay:= V_COUNT1G8.dept_pay;
    v_areacode:= V_COUNT1G8.area_code;
    V_PARTMID:=V_PART;

    --获取申请表编号和技术资料表编号
    ApplyCode_Temp := Substr(V_COUNT1G8.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
    ApplyType_Temp := substr(V_COUNT1G8.APPLY_CODE,0,length(V_COUNT1G8.APPLY_CODE)-12);----申请表类型T或PA
    DECL_CODE_Temp := V_COUNT1G8.DECL_CODE;---技术资料表编号
    ---
    INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      DECL_CODE_Temp,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '120200',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
    V_AMOUNT := 1;
    V_DECLCODE := V_COUNT1G8.DECL_CODE;
    v_deptpay:= V_COUNT1G8.dept_pay;
    v_areacode:= V_COUNT1G8.area_code;
    V_DERATE := V_COUNT1G8.DERATE;
    --取出减免比例
  END LOOP;
  CLOSE C_COUNT1G8;
  --扩频系统2.4G计费'130100'
  V_FLAG := 'N';
  OPEN C_COUNT2G4;
  LOOP
    FETCH C_COUNT2G4 INTO V_COUNT2G4;
    EXIT WHEN C_COUNT2G4%NOTFOUND;

    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT2G4.begin_date,'YYYY'),substr(V_COUNT2G4.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT2G4.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    ----
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='130100';
      ----数据记录合计数量
      SELECT count(*) INTO V_Count_kp2g4 FROM V_RIM_RSM_FEE_KP2G4_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>0 ;
      --第一条记录
      X_Count_kp2g4 :=0;
      X_Count_kp2g4 :=X_Count_kp2g4+1;
      ---记录累加
      v_deptpay:= V_COUNT2G4.dept_pay;
      v_areacode:= V_COUNT2G4.area_code;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      V_BANDWIDTH := CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));
      V_PARTMID := V_PART;
      --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;
       --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_DECLCODE=V_COUNT2G4.DECL_CODE AND V_APPLYCODE= V_COUNT2G4.APPLY_CODE THEN
      ---
      X_Count_kp2g4 :=X_Count_kp2g4+1;
      --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT2G4.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
       ---记录累加
      V_APPLYCODE := V_COUNT2G4.APPLY_CODE;
      V_DECLCODE := V_COUNT2G4.DECL_CODE;
      v_deptpay:= V_COUNT2G4.dept_pay;
      v_areacode:= V_COUNT2G4.area_code;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      V_PARTMID := V_PART;
      --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT2G4.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      --
      --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNT2G4.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNT2G4.APPLY_CODE,0,length(V_COUNT2G4.APPLY_CODE)-12);----申请表类型T或PA
     -- DECL_CODE_Temp := V_COUNT2G4.DECL_CODE;---技术资料表编号
      --
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '130100',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);

      V_BANDWIDTH := nvl(V_COUNT2G4.CHAN_DIST,1);
      --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;
      --取出减免比例
      V_DECLCODE := V_COUNT2G4.DECL_CODE;
      v_deptpay:= V_COUNT2G4.dept_pay;
      v_areacode:= V_COUNT2G4.area_code;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      --
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_kp2g4 :=X_Count_kp2g4+1;
       --如果执行最后条记录
      IF X_Count_kp2g4=V_Count_kp2g4 THEN
         ---记录累加
          v_deptpay:= V_COUNT2G4.dept_pay;
          v_areacode:= V_COUNT2G4.area_code;
          V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
          V_BANDWIDTH := CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));
          V_PARTMID := V_PART;
          --空值则默认为一个单位
          V_DERATE := V_COUNT2G4.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          --
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT2G4.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNT2G4.APPLY_CODE,0,length(V_COUNT2G4.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT2G4.DECL_CODE;---技术资料表编号
          --
          INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                          decl_code,
                          dept_pay,
                          area_code,
                          COUNT_YEAR,
                          ITEM_CODE,
                          DERATE,
                          pay_rate,
                          AMOUNT,
                          SUM_COUNT,
                          SUM_PAY,
                          Applytype)
                      VALUES (ApplyCode_Temp,
                            DECL_CODE_Temp,
                          v_deptpay,
                          v_areacode,
                          COUNTYEAR,
                            '130100',
                            V_DERATE,
                            V_PARTMID,
                          V_AMOUNT,
                            V_AMOUNT*V_FEE,
                            V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                            ApplyType_Temp);
      END IF;

    END IF;
    --
    ---记录累加
    V_APPLYCODE := V_COUNT2G4.APPLY_CODE;
    V_DECLCODE := V_COUNT2G4.DECL_CODE;
    v_deptpay:= V_COUNT2G4.dept_pay;
    v_areacode:= V_COUNT2G4.area_code;
    V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
    --
  END LOOP;
  CLOSE C_COUNT2G4;

  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '130100',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  --扩频系统5.8G计费'130200'
  V_FLAG := 'N';
  V_BANDWIDTH :=0;
  OPEN  C_COUNT5G81;
  LOOP
    FETCH  C_COUNT5G81 INTO V_COUNT5G81;
    EXIT WHEN  C_COUNT5G81%NOTFOUND;

    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT5G81.begin_date,'YYYY'),substr(V_COUNT5G81.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT5G81.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='130200';
      ----数据记录合计数量
      SELECT count(*) INTO V_Count_KP5G8 FROM V_RIM_RSM_FEE_KP5G8_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>0;
      --第一条记录
      X_Count_KP5G8 :=0;
      X_Count_KP5G8 :=X_Count_KP5G8+1;
       ---记录累加
      v_deptpay:= V_COUNT5G81.dept_pay;
      v_areacode:= V_COUNT5G81.area_code;
      V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
      V_PARTMID := V_PART;
      if (V_BANDWIDTH = 0 ) then
         V_BANDWIDTH :=0;
      end if;
      V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT5G81.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNT5G81.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_DECLCODE=V_COUNT5G81.DECL_CODE AND V_APPLYCODE=V_COUNT5G81.APPLY_CODE THEN
       X_Count_KP5G8 :=X_Count_KP5G8+1;
      --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT5G81.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT5G81.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT5G81.DERATE;
       --取出减免比例
       ---记录累加
      V_APPLYCODE := V_COUNT5G81.APPLY_CODE;
      V_DECLCODE := V_COUNT5G81.DECL_CODE;
      v_deptpay:= V_COUNT5G81.dept_pay;
      v_areacode:= V_COUNT5G81.area_code;
      V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '130200',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ---
      V_BANDWIDTH := CEIL(nvl(V_COUNT5G81.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNT5G81.DERATE;
       --取出减免比例
      V_DECLCODE := V_COUNT5G81.DECL_CODE;
      v_deptpay:= V_COUNT5G81.dept_pay;
      v_areacode:= V_COUNT5G81.area_code;
      V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_KP5G8 :=X_Count_KP5G8+1;
       --如果执行最后条记录
      IF X_Count_KP5G8=V_Count_KP5G8 THEN
         ---记录累加
          v_deptpay:= V_COUNT5G81.dept_pay;
          v_areacode:= V_COUNT5G81.area_code;
          V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
          V_BANDWIDTH := CEIL(nvl(V_COUNT5G81.CHAN_DIST,1));
          V_PARTMID := V_PART;
          --空值则默认为一个单位
          V_DERATE := V_COUNT5G81.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          --
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT5G81.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNT5G81.APPLY_CODE,0,length(V_COUNT5G81.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT5G81.DECL_CODE;---技术资料表编号
          --
         INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '130200',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      END IF;
      --
    END IF;
    ---记录累加
    V_APPLYCODE := V_COUNT5G81.APPLY_CODE;
    V_DECLCODE := V_COUNT5G81.DECL_CODE;
    v_deptpay:= V_COUNT5G81.dept_pay;
    v_areacode:= V_COUNT5G81.area_code;
    V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
  END LOOP;
  CLOSE  C_COUNT5G81;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '130200',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  --无线接入系统(3.5GHZ)计费'120300'
  V_FLAG := 'N';
  V_BANDWIDTH :=0;
  OPEN  C_COUNT3G5;
  LOOP
    FETCH  C_COUNT3G5 INTO V_COUNT3G5;
    EXIT WHEN  C_COUNT3G5%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT3G5.begin_date,'YYYY'),substr(V_COUNT3G5.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT3G5.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120300';
      ------数据记录合计数量
      SELECT count(*) INTO V_Count_ENTER3G5 FROM V_RIM_RSM_FEE_ENTER3G5_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>0;
      --第一条记录
       --第一条记录
      X_Count_ENTER3G5 :=0;
      X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
       ---记录累加
      v_deptpay:= V_COUNT3G5.dept_pay;
      v_areacode:= V_COUNT3G5.area_code;
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      if V_BANDWIDTH =0 then
         V_BANDWIDTH :=0;
      end if;
       V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
       --空值则默认为一个单位
      V_DERATE := V_COUNT3G5.DERATE;
      V_PARTMID := V_PART;
      --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_DECLCODE=V_COUNT3G5.DECL_CODE AND V_APPLYCODE = V_COUNT3G5.APPLY_CODE THEN
      --同一个台站则带宽数据累计
      X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
      --计算发射频点
      if V_FREQEMIT <> V_COUNT3G5.FREQ_EMIT then
         V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
        V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT3G5.DERATE;
       --取出减免比例
       ---记录累加
      V_APPLYCODE := V_COUNT3G5.APPLY_CODE;
      V_DECLCODE := V_COUNT3G5.DECL_CODE;
      v_deptpay:= V_COUNT3G5.dept_pay;
      v_areacode:= V_COUNT3G5.area_code;
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH/3.5);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120300',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_BANDWIDTH :=0;
      --计算发射频点
     -- V_BANDWIDTH :=  V_BANDWIDTH+nvl(V_COUNT3G5.CHAN_DIST,3.5)*2;
      V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
       --空值则默认为一个单位
      V_DERATE := V_COUNT3G5.DERATE;
      --取出减免比例
      V_DECLCODE := V_COUNT3G5.DECL_CODE;
      v_deptpay:= V_COUNT3G5.dept_pay;
      v_areacode:= V_COUNT3G5.area_code;
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
      --如果执行最后条记录
      if X_Count_ENTER3G5=V_Count_ENTER3G5 then
          ---记录累加
          v_deptpay:= V_COUNT3G5.dept_pay;
          v_areacode:= V_COUNT3G5.area_code;
          V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
          V_BANDWIDTH := CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
          V_PARTMID := V_PART;
          --空值则默认为一个单位
          V_DERATE := V_COUNT3G5.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          --
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT3G5.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNT3G5.APPLY_CODE,0,length(V_COUNT3G5.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT3G5.DECL_CODE;---技术资料表编号
          --
          INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120300',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
          --
      end if;
    END IF;
    ---记录累加
    V_APPLYCODE := V_COUNT3G5.APPLY_CODE;
    V_DECLCODE := V_COUNT3G5.DECL_CODE;
    v_deptpay:= V_COUNT3G5.dept_pay;
    v_areacode:= V_COUNT3G5.area_code;
    V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
    ----
  END LOOP;
  CLOSE  C_COUNT3G5;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH/4);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '120300',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;

  --无线接入系统(5.8GHZ)
  V_FLAG := 'N';
  V_BANDWIDTH :=0;
  OPEN  C_COUNT5G82;
  LOOP
    FETCH  C_COUNT5G82 INTO V_COUNT5G82;
    EXIT WHEN  C_COUNT5G82%NOTFOUND;

    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT5G82.begin_date,'YYYY'),substr(V_COUNT5G82.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT5G82.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120400';
      ----数据记录合计数量
      SELECT count(*) INTO V_Count_KP5G8 FROM V_RIM_RSM_FEE_KP5G8_Apply
               WHERE APPLY_CODE=APPLYCODE
                AND begin_YEAR=COUNTYEAR
                AND FREQ_EMIT>0;
      --第一条记录
      X_Count_KP5G8 :=0;
      X_Count_KP5G8 :=X_Count_KP5G8+1;
       ---记录累加
      v_deptpay:= V_COUNT5G82.dept_pay;
      v_areacode:= V_COUNT5G82.area_code;
      V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
      V_PARTMID := V_PART;
      if (V_BANDWIDTH = 0 ) then
         V_BANDWIDTH :=0;
      end if;
      V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT5G82.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNT5G82.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_DECLCODE=V_COUNT5G82.DECL_CODE AND V_APPLYCODE=V_COUNT5G82.APPLY_CODE THEN
       X_Count_KP5G8 :=X_Count_KP5G8+1;
      --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT5G82.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT5G82.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT5G82.DERATE;
       --取出减免比例
       ---记录累加
      V_APPLYCODE := V_COUNT5G82.APPLY_CODE;
      V_DECLCODE := V_COUNT5G82.DECL_CODE;
      v_deptpay:= V_COUNT5G82.dept_pay;
      v_areacode:= V_COUNT5G82.area_code;
      V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120400',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ---
      V_BANDWIDTH := CEIL(nvl(V_COUNT5G82.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNT5G82.DERATE;
       --取出减免比例
      V_DECLCODE := V_COUNT5G82.DECL_CODE;
      v_deptpay:= V_COUNT5G82.dept_pay;
      v_areacode:= V_COUNT5G82.area_code;
      V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_KP5G8 :=X_Count_KP5G8+1;
       --如果执行最后条记录
      IF X_Count_KP5G8=V_Count_KP5G8 THEN
         ---记录累加
          v_deptpay:= V_COUNT5G82.dept_pay;
          v_areacode:= V_COUNT5G82.area_code;
          V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
          V_BANDWIDTH := CEIL(nvl(V_COUNT5G82.CHAN_DIST,1));
          V_PARTMID := V_PART;
          --空值则默认为一个单位
          V_DERATE := V_COUNT5G82.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          --
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT5G82.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNT5G82.APPLY_CODE,0,length(V_COUNT5G82.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT5G82.DECL_CODE;---技术资料表编号
          --
         INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '120400',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      END IF;
      --
    END IF;
    ---记录累加
    V_APPLYCODE := V_COUNT5G82.APPLY_CODE;
    V_DECLCODE := V_COUNT5G82.DECL_CODE;
    v_deptpay:= V_COUNT5G82.dept_pay;
    v_areacode:= V_COUNT5G82.area_code;
    V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
  END LOOP;
  CLOSE  C_COUNT5G82;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '120400',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;

  --雷达站10G以下计费'910000'(按照微波站收费，重庆需求)
  V_FLAG := 'N';
  V_BANDWIDTH :=0;
  OPEN  C_COUNTR10GDOWN;
  LOOP
    FETCH  C_COUNTR10GDOWN INTO V_COUNTR10GDOWN;
    EXIT WHEN  C_COUNTR10GDOWN%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTR10GDOWN.begin_date,'YYYY'),substr(V_COUNTR10GDOWN.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTR10GDOWN.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='910000';
      ------数据记录合计数量
      SELECT count(*) INTO V_CountR_10GDOWN FROM V_RIM_RSM_FEE_R_Apply
        WHERE APPLY_CODE=APPLYCODE
        AND begin_YEAR=COUNTYEAR
        and FREQ_EMIT<=10000 and FREQ_EMIT>0 ;
      ----
      X_CountR_10GDOWN :=0;
      X_CountR_10GDOWN :=X_CountR_10GDOWN+1;
      --第一条记录
      --V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
      v_deptpay:= V_COUNTR10GDOWN.dept_pay;
      v_areacode:= V_COUNTR10GDOWN.area_code;
      V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
      V_PARTMID:= V_PART;
       if V_BANDWIDTH =0 then
         V_BANDWIDTH :=0;
      end if;
      V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNTR10GDOWN.CHAN_DIST,1));
       --空值则默认为一个单位
      V_DERATE := V_COUNTR10GDOWN.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_DECLCODE=V_COUNTR10GDOWN.DECL_CODE  AND V_APPLYCODE = V_COUNTR10GDOWN.APPLY_CODE THEN
      --同一个台站则带宽数据累计
      X_CountR_10GDOWN :=X_CountR_10GDOWN+1;
      ----
      if V_FREQEMIT <> V_COUNTR10GDOWN.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNTR10GDOWN.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNTR10GDOWN.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '910000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ---
      V_BANDWIDTH :=0;
      V_BANDWIDTH := CEIL(nvl(V_COUNTR10GDOWN.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNTR10GDOWN.DERATE;
      --取出减免比例
      V_APPLYCODE := V_COUNTR10GDOWN.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
      v_deptpay:= V_COUNTR10GDOWN.dept_pay;
      v_areacode:= V_COUNTR10GDOWN.area_code;
      V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_CountR_10GDOWN :=X_CountR_10GDOWN+1;
      IF X_CountR_10GDOWN = V_CountR_10GDOWN  THEN
          V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
          v_deptpay:= V_COUNTR10GDOWN.dept_pay;
          v_areacode:= V_COUNTR10GDOWN.area_code;
          V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
          --空值则默认为一个单位
          V_DERATE := V_COUNTR10GDOWN.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          ----
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNTR10GDOWN.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNTR10GDOWN.APPLY_CODE,0,length(V_COUNTR10GDOWN.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNTR10GDOWN.DECL_CODE;---技术资料表编号
          ---
           INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '910000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
          ---
      END IF;
      --如果执行最后条记录
    END IF;
    ---
      V_DERATE := V_COUNTR10GDOWN.DERATE;
      --取出减免比例
      ---记录累加
      V_APPLYCODE := V_COUNTR10GDOWN.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
      v_deptpay:= V_COUNTR10GDOWN.dept_pay;
      v_areacode:= V_COUNTR10GDOWN.area_code;
      V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
    ----
  END LOOP;
  CLOSE  C_COUNTR10GDOWN;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '910000',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  ----
  --雷达站10G以上计费'920000'(按照微波站收费，重庆需求)
  V_FLAG := 'N';
  V_BANDWIDTH :=0;
  OPEN  C_COUNTR10GUP;
  LOOP
    FETCH  C_COUNTR10GUP INTO V_COUNTR10GUP;
    EXIT WHEN  C_COUNTR10GUP%NOTFOUND;
    --在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNTR10GUP.begin_date,'YYYY'),substr(V_COUNTR10GUP.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNTR10GUP.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      --第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        --第四季度计收25％
        V_PART :=25;
      ELSE
        --第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
      ----取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='920000';
      ------数据记录合计数量
      SELECT count(*) INTO V_CountR_10GUP FROM V_RIM_RSM_FEE_R_Apply
          WHERE APPLY_CODE=APPLYCODE
          AND begin_YEAR=COUNTYEAR
          and FREQ_EMIT>10000;
      ----
      X_CountR_10GUP :=0;
      X_CountR_10GUP :=X_CountR_10GUP+1;
      ----第一条记录
      ----V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
      v_deptpay:= V_COUNTR10GUP.dept_pay;
      v_areacode:= V_COUNTR10GUP.area_code;
      V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
      V_PARTMID:= V_PART;
       if V_BANDWIDTH =0 then
         V_BANDWIDTH :=0;
      end if;
      V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNTR10GUP.CHAN_DIST,1));
       ----空值则默认为一个单位
      V_DERATE := V_COUNTR10GUP.DERATE;
      ----取出减免比例
      V_FLAG := 'Y';
    ELSIF V_DECLCODE=V_COUNTR10GUP.DECL_CODE  AND V_APPLYCODE = V_COUNTR10GUP.APPLY_CODE THEN
      ----同一个台站则带宽数据累计
      X_CountR_10GUP :=X_CountR_10GUP+1;
      ----
      if V_FREQEMIT <> V_COUNTR10GUP.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNTR10GUP.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNTR10GUP.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '920000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ---
      V_BANDWIDTH :=0;
      V_BANDWIDTH := CEIL(nvl(V_COUNTR10GUP.CHAN_DIST,1));
      ----空值则默认为一个单位
      V_DERATE := V_COUNTR10GUP.DERATE;
      ----取出减免比例
      V_APPLYCODE := V_COUNTR10GUP.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GUP.DECL_CODE;
      v_deptpay:= V_COUNTR10GUP.dept_pay;
      v_areacode:= V_COUNTR10GUP.area_code;
      V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
       X_CountR_10GUP :=X_CountR_10GUP+1;
      IF X_CountR_10GUP = V_CountR_10GUP  THEN
          V_DECLCODE := V_COUNTR10GUP.DECL_CODE;
          v_deptpay:= V_COUNTR10GUP.dept_pay;
          v_areacode:= V_COUNTR10GUP.area_code;
          V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
          ----空值则默认为一个单位
          V_DERATE := V_COUNTR10GUP.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          ----
          ----获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNTR10GUP.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNTR10GUP.APPLY_CODE,0,length(V_COUNTR10GUP.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNTR10GUP.DECL_CODE;---技术资料表编号
          ----
           INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        DECL_CODE_Temp,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '920000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
          ---
      END IF;
      ----如果执行最后条记录
    END IF;
    ---
      V_DERATE := V_COUNTR10GUP.DERATE;
      ----取出减免比例
      ---记录累加
      V_APPLYCODE := V_COUNTR10GUP.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GUP.DECL_CODE;
      v_deptpay:= V_COUNTR10GUP.dept_pay;
      v_areacode:= V_COUNTR10GUP.area_code;
      V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
    ----
  END LOOP;
  CLOSE  C_COUNTR10GUP;
  IF V_FLAG = 'Y' THEN
  ----存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '920000',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  ----微波站10G以下计费'910000'
  V_FLAG := 'N';
  OPEN  C_COUNT10GDOWN;
  LOOP
    FETCH  C_COUNT10GDOWN INTO V_COUNT10GDOWN;
    EXIT WHEN  C_COUNT10GDOWN%NOTFOUND;
    ----在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT10GDOWN.begin_date,'YYYY'),substr(V_COUNT10GDOWN.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT10GDOWN.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      ----第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        ----第四季度计收25％
        V_PART :=25;
      ELSE
        ----第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
    ----第一条记录
      V_DECLCODE := V_COUNT10GDOWN.DECL_CODE;
      v_deptpay:= V_COUNT10GDOWN.dept_pay;
      v_areacode:= V_COUNT10GDOWN.area_code;
      V_FREQEMIT:= V_COUNT10GDOWN.FREQ_EMIT;
      V_PARTMID:= V_PART;
      V_BANDWIDTH := nvl(V_COUNT10GDOWN.CHAN_DIST,1);
       ----空值则默认为一个单位
      V_DERATE := V_COUNT10GDOWN.DERATE;
      ----取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='910000';
      ----取出收费标准
    ELSIF V_DECLCODE=V_COUNT10GDOWN.DECL_CODE THEN
    ----同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT10GDOWN.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+nvl(V_COUNT10GDOWN.CHAN_DIST,1);
        V_FREQEMIT:= V_COUNT10GDOWN.FREQ_EMIT;
      ----带宽累加，空值则默认为一个单位
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT10GDOWN.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '910000',
                        V_DERATE,
                        V_PARTMID,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_BANDWIDTH := nvl(V_COUNT10GDOWN.CHAN_DIST,1);
      ----空值则默认为一个单位
      V_DERATE := V_COUNT10GDOWN.DERATE;
      ----取出减免比例
      V_DECLCODE := V_COUNT10GDOWN.DECL_CODE;
      v_deptpay:= V_COUNT10GDOWN.dept_pay;
      v_areacode:= V_COUNT10GDOWN.area_code;
      V_FREQEMIT:= V_COUNT10GDOWN.FREQ_EMIT;
    END IF;
  END LOOP;
  CLOSE  C_COUNT10GDOWN;
  IF V_FLAG = 'Y' THEN
  ----存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '910000',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  ----10G以上微波站计费'920000'
  V_FLAG := 'N';
  OPEN  C_COUNT10GUP;
  LOOP
    FETCH  C_COUNT10GUP INTO V_COUNT10GUP;
    EXIT WHEN  C_COUNT10GUP%NOTFOUND;
    ----在计费年度之前的年份
    V_YEAR := to_number(nvl(to_char(V_COUNT10GUP.begin_date,'YYYY'),substr(V_COUNT10GUP.APPLY_code,5,4)));
    V_MONTH := to_number(nvl(to_char(V_COUNT10GUP.begin_date,'MM'),'1'));
    if V_YEAR < COUNTYEAR then
      V_PART :=100;
    elsif V_YEAR = COUNTYEAR then
      IF V_MONTH<7 THEN
      ----第一、二季度计收全年
        V_PART :=100;
      ELSIF V_MONTH>9 THEN
        ----第四季度计收25％
        V_PART :=25;
      ELSE
        ----第三季度计收50％
        V_PART :=50;
      END IF;
    ELSE
      V_PART :=0;
    END IF;
    IF V_FLAG = 'N' THEN
    ----第一条记录
      V_DECLCODE := V_COUNT10GUP.DECL_CODE;
      v_deptpay:= V_COUNT10GUP.dept_pay;
      v_areacode:= V_COUNT10GUP.area_code;
      V_FREQEMIT:= V_COUNT10GUP.FREQ_EMIT;
      V_PARTMID := V_PART;
      V_BANDWIDTH := CEIL(nvl(V_COUNT10GUP.CHAN_DIST,1));
      ----空值则默认为一个单位
      V_DERATE := V_COUNT10GUP.DERATE;
       ----取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='920000';
       ----取出收费标准
    ELSIF V_DECLCODE=V_COUNT10GUP.DECL_CODE THEN
    ----同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT10GUP.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT10GUP.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT10GUP.FREQ_EMIT;
      ----带宽累加，空值则默认为一个单位
      end if;
      V_PARTMID:=V_PART;
      V_DERATE := V_COUNT10GUP.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                        V_DECLCODE,
                      v_deptpay,
                      v_areacode,
                      COUNTYEAR,
                        '920000',
                        V_DERATE,
                        V_PARTMID,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_BANDWIDTH := CEIL(nvl(V_COUNT10GUP.CHAN_DIST,1));
       ----空值则默认为一个单位
      V_DERATE := V_COUNT10GUP.DERATE;
      ----取出减免比例
      V_DECLCODE := V_COUNT10GUP.DECL_CODE;
      v_deptpay:= V_COUNT10GUP.dept_pay;
      v_areacode:= V_COUNT10GUP.area_code;
      V_FREQEMIT:= V_COUNT10GUP.FREQ_EMIT;
    END IF;
  END LOOP;
  CLOSE  C_COUNT10GUP;
  IF V_FLAG = 'Y' THEN
  ----存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF NVL(V_AMOUNT,0)<=0 THEN
        V_AMOUNT:=1;
    END IF;
    INSERT INTO  t_rim_rsm_PAY_APPLYITEM (APPLY_CODE,
                    decl_code,
                    dept_pay,
                    area_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    pay_rate,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    Applytype)
                VALUES (ApplyCode_Temp,
                      V_DECLCODE,
                    v_deptpay,
                    v_areacode,
                    COUNTYEAR,
                      '920000',
                      V_DERATE,
                      V_PARTMID,
                    V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(V_PARTMID/100.0)*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  ----地球站计费'100100'
  V_FLAG := 'N';
  OPEN  C_COUNTEARTH;
  LOOP
      FETCH  C_COUNTEARTH INTO V_COUNTEARTH;
      EXIT WHEN  C_COUNTEARTH%NOTFOUND;
      ----在计费年度之前的年份
      V_YEAR := to_number(nvl(to_char(V_COUNTEARTH.begin_date,'YYYY'),substr(V_COUNTEARTH.APPLY_code,5,4)));
      V_MONTH := to_number(nvl(to_char(V_COUNTEARTH.begin_date,'MM'),'1'));
      if V_YEAR < COUNTYEAR then
        V_PART :=100;
      elsif V_YEAR = COUNTYEAR then
        IF V_MONTH<7 THEN
        ----第一、二季度计收全年
          V_PART :=100;
        ELSIF V_MONTH>9 THEN
          ----第四季度计收25％
          V_PART :=25;
        ELSE
          ----第三季度计收50％
          V_PART :=50;
        END IF;
      ELSE
        V_PART :=0;
      END IF;
      ----取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='100100';
      --
      V_AMOUNT := CEIL(NVL(V_COUNTEARTH.ASSI_BAND,0));
      --记录累加
      v_applycode1 :=V_COUNTEARTH.apply_code;
      v_declcode1 :=V_COUNTEARTH.decl_code;
      V_DERATE := V_COUNTEARTH.DERATE;
      V_FLAG := 'N';
      --
      IF V_AMOUNT<=0 THEN
         V_AMOUNT:=1;
      END IF;
      --
      ApplyCode_Temp := Substr(v_applycode1,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(v_applycode1,0,length(v_applycode1)-12);----申请表类型T或PA
      DECL_CODE_Temp := V_COUNTEARTH.DECL_CODE;---技术资料表编号
      --
      INSERT INTO t_rim_rsm_PAY_APPLYITEM(APPLY_CODE,
                      decl_code,
                      dept_pay,
                      area_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      pay_rate,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      Applytype)
                  VALUES (ApplyCode_Temp,
                      DECL_CODE_Temp,
                      V_COUNTEARTH.dept_pay,
                      V_COUNTEARTH.area_code,
                        COUNTYEAR,
                        '100100',
                        V_DERATE,
                        V_PART,
                      V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(V_PART/100.0)*(100-V_DERATE)/100,
                        ApplyType_Temp);
        ----
        V_AMOUNT :=0;
        v_applycode1 :=V_COUNTEARTH.apply_code;
        v_declcode1 :=V_COUNTEARTH.decl_code;
        V_DERATE := V_COUNTEARTH.DERATE;
        ----
  END LOOP;
  CLOSE  C_COUNTEARTH;
  /*
   -----------------------设备检测费用-----------------------------------
   --无线寻呼系统(设备检测费)'112000' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTPB_EQUCHECK;
     LOOP
      FETCH C_COUNTPB_EQUCHECK INTO V_COUNTPB_EQUCHECK;
      EXIT WHEN C_COUNTPB_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='112000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTPB_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTPB_EQUCHECK.APPLY_CODE,
                    V_COUNTPB_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTPB_EQUCHECK;
   END IF;
      --集群无线调度系统(设备检测费)'113000' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTJQ_EQUCHECK;
     LOOP
      FETCH C_COUNTJQ_EQUCHECK INTO V_COUNTJQ_EQUCHECK;
      EXIT WHEN C_COUNTJQ_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='113000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTJQ_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTJQ_EQUCHECK.APPLY_CODE,
                    V_COUNTJQ_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTJQ_EQUCHECK;
   END IF;
     --无绳电话(设备检测费)'114000' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTLINELESS_EQUCHECK;
     LOOP
      FETCH C_COUNTLINELESS_EQUCHECK INTO V_COUNTLINELESS_EQUCHECK;
      EXIT WHEN C_COUNTLINELESS_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='114000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTLINELESS_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTLINELESS_EQUCHECK.APPLY_CODE,
                    V_COUNTLINELESS_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTLINELESS_EQUCHECK;
   END IF;
    --电视(设备检测费)'115000' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   V_FLAG := 'N';
   OPEN C_COUNTBT_EQUCHECK;
     LOOP
      FETCH C_COUNTBT_EQUCHECK INTO V_COUNTBT_EQUCHECK;
      EXIT WHEN C_COUNTBT_EQUCHECK%NOTFOUND;
      IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode1 :=V_COUNTBT_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTBT_EQUCHECK.decl_code;
      V_FLAG := 'Y';
      V_ITEMCODE:='115000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      ELSIF v_applycode1=V_COUNTBT_EQUCHECK.apply_code and v_declcode1=V_COUNTBT_EQUCHECK.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      ELSE
          INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTBT_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
      V_AMOUNT := 1;
      v_applycode1 :=V_COUNTBT_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTBT_EQUCHECK.decl_code;
    END IF;
     END LOOP;
   CLOSE C_COUNTBT_EQUCHECK;
    IF V_FLAG = 'Y' THEN
    INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
            VALUES (V_COUNTBT_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
      END IF;
   END IF;
    --广播电台(设备检测费)'' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   V_FLAG := 'N';
   OPEN C_COUNTBC_EQUCHECK;
     LOOP
      FETCH C_COUNTBC_EQUCHECK INTO V_COUNTBC_EQUCHECK;
      EXIT WHEN C_COUNTBC_EQUCHECK%NOTFOUND;
      IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode1 :=V_COUNTBC_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTBC_EQUCHECK.decl_code;
      V_FLAG := 'Y';
      V_ITEMCODE:='116000';
       SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      ELSIF v_applycode1=V_COUNTBC_EQUCHECK.apply_code and v_declcode1=V_COUNTBC_EQUCHECK.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      ELSE
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTBC_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
      V_AMOUNT := 1;
      v_applycode1 :=V_COUNTBC_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTBC_EQUCHECK.decl_code;
      END IF;
     END LOOP;
   CLOSE C_COUNTBC_EQUCHECK;
    IF V_FLAG = 'Y' THEN
      INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTBC_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
       END IF;
   END IF;
    --1000MHz以下的无线电台（固定台）'117000' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTOTHER_EQUCHECK;
     LOOP
      FETCH C_COUNTOTHER_EQUCHECK INTO V_COUNTOTHER_EQUCHECK;
      EXIT WHEN C_COUNTOTHER_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='117000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTOTHER_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTOTHER_EQUCHECK.APPly_CODE,
                    V_COUNTOTHER_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);

     END LOOP;
   CLOSE C_COUNTOTHER_EQUCHECK;
   END IF;
    --1000MHz以下的无线电台（移动台）车载台LC收费代码111121，手持台或其它收费代码118000/广东省 20130125
    IF  V_AREACODE1='440300' THEN
   V_FLAG := 'N';
  OPEN C_COUNTMOBILE_EQUCHECK;
  LOOP
    FETCH C_COUNTMOBILE_EQUCHECK INTO V_COUNTMOBILE_EQUCHECK;
    EXIT WHEN C_COUNTMOBILE_EQUCHECK%NOTFOUND;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode1 :=V_COUNTMOBILE_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTMOBILE_EQUCHECK.decl_code;
      --V_DERATE := V_COUNTMOBILE.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
        --车载台或其它收费LC收费代码111121，手持台代码118000
      if V_COUNTMOBILE_EQUCHECK.Stat_Type='LC' THEN
      V_ITEMCODE:='111121';
      ELSE
      V_ITEMCODE:='118000';
      END IF;
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      --取出收费标准
    ELSIF v_applycode1=V_COUNTMOBILE_EQUCHECK.apply_code and v_declcode1=V_COUNTMOBILE_EQUCHECK.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
        if V_COUNTMOBILE_EQUCHECK.Stat_Type='LC' THEN
      V_ITEMCODE:='111121';
      ELSE
      V_ITEMCODE:='118000';
      END IF;
    ELSE
       INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTMOBILE_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
      V_AMOUNT := 1;
      v_applycode1 :=V_COUNTMOBILE_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTMOBILE_EQUCHECK.decl_code;
      --V_DERATE := V_COUNTMOBILE.DERATE;
      --取出减免比例
    END IF;
  END LOOP;
  CLOSE C_COUNTMOBILE_EQUCHECK;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
   INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTMOBILE_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                     v_applycode1,
                     v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
  END IF;
 END IF;
  --微波站计费(设备检测费)'' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   V_FLAG := 'N';
   OPEN C_COUNT10G_EQUCHECK;
     LOOP
      FETCH C_COUNT10G_EQUCHECK INTO V_COUNT10G_EQUCHECK;
      EXIT WHEN C_COUNT10G_EQUCHECK%NOTFOUND;
       IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode1 :=V_COUNT10G_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNT10G_EQUCHECK.decl_code;
      V_FLAG := 'Y';
      V_ITEMCODE:='119000';
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      ELSIF v_applycode1=V_COUNT10G_EQUCHECK.apply_code and v_declcode1=V_COUNT10G_EQUCHECK.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
        ELSE
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNT10G_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_AMOUNT*V_FEE);
                    V_AMOUNT := 1;
      v_applycode1 :=V_COUNTBT_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTBT_EQUCHECK.decl_code;
    END IF;
     END LOOP;
   CLOSE C_COUNT10G_EQUCHECK;
   IF V_FLAG = 'Y' THEN
   INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNT10G_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                   v_applycode1,
                   v_declcode1,
                    V_AMOUNT,
                    V_AMOUNT*V_FEE);
   END IF;
   END IF;
     --MMDS计费(设备检测费)'111200' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTMMDS_EQUCHECK;
     LOOP
      FETCH C_COUNTMMDS_EQUCHECK INTO V_COUNTMMDS_EQUCHECK;
      EXIT WHEN C_COUNTMMDS_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111200';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTMMDS_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTMMDS_EQUCHECK.Apply_Code,
                    V_COUNTMMDS_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTMMDS_EQUCHECK;
   END IF;
  --地球站计费(设备检测费)'' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTEARTH_EQUCHECK;
     LOOP
      FETCH C_COUNTEARTH_EQUCHECK INTO V_COUNTEARTH_EQUCHECK;
      EXIT WHEN C_COUNTEARTH_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111300';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTEARTH_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTEARTH_EQUCHECK.Apply_Code,
                    V_COUNTEARTH_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTEARTH_EQUCHECK;
   END IF;
  --无线接入系统（1.8GHz-1.9GHz）(设备检测费)'111400' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNT1G8_EQUCHECK;
     LOOP
      FETCH C_COUNT1G8_EQUCHECK INTO V_COUNT1G8_EQUCHECK;
      EXIT WHEN C_COUNT1G8_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111400';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNT1G8_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNT1G8_EQUCHECK.Apply_Code,
                    V_COUNT1G8_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNT1G8_EQUCHECK;
   END IF;
    --扩频系统（2.4GHz）(设备检测费)'111500' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNT2G4_EQUCHECK;
     LOOP
      FETCH C_COUNT2G4_EQUCHECK INTO V_COUNT2G4_EQUCHECK;
      EXIT WHEN C_COUNT2G4_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111500';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNT2G4_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNT2G4_EQUCHECK.Apply_Code,
                    V_COUNT2G4_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNT2G4_EQUCHECK;
   END IF;
     --扩频系统（5.8GHz）(设备检测费)'111600' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNT5G81_EQUCHECK;
     LOOP
      FETCH C_COUNT5G81_EQUCHECK INTO V_COUNT5G81_EQUCHECK;
      EXIT WHEN C_COUNT5G81_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111600';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNT5G81_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNT5G81_EQUCHECK.Apply_Code,
                    V_COUNT5G81_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNT5G81_EQUCHECK;
   END IF;
  --无线数据(设备检测费)'111700' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTDATA_EQUCHECK;
     LOOP
      FETCH C_COUNTDATA_EQUCHECK INTO V_COUNTDATA_EQUCHECK;
      EXIT WHEN C_COUNTDATA_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111700';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTDATA_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTDATA_EQUCHECK.APPLY_CODE,
                    V_COUNTDATA_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTDATA_EQUCHECK;
   END IF;
    --GSM(设备检测费)'111800' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTGSM_EQUCHECK;
     LOOP
      FETCH C_COUNTGSM_EQUCHECK INTO V_COUNTGSM_EQUCHECK;
      EXIT WHEN C_COUNTGSM_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111800';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTGSM_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTGSM_EQUCHECK.APPLY_CODE,
                    V_COUNTGSM_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);

     END LOOP;
   CLOSE C_COUNTGSM_EQUCHECK;
   END IF;
       --CDMA(设备检测费)'111800' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTCDMA_EQUCHECK;
     LOOP
      FETCH C_COUNTCDMA_EQUCHECK INTO V_COUNTCDMA_EQUCHECK;
      EXIT WHEN C_COUNTCDMA_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111800';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTCDMA_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTCDMA_EQUCHECK.APPLY_CODE,
                    V_COUNTCDMA_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);

     END LOOP;
   CLOSE C_COUNTCDMA_EQUCHECK;
   END IF;
          --WCDMS(设备检测费)'111800' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTWCDMA_EQUCHECK;
     LOOP
      FETCH C_COUNTWCDMA_EQUCHECK INTO V_COUNTWCDMA_EQUCHECK;
      EXIT WHEN C_COUNTWCDMA_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111800';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTWCDMA_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTWCDMA_EQUCHECK.APPLY_CODE,
                    V_COUNTWCDMA_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTWCDMA_EQUCHECK;
   END IF;
             --TDSCDMS(设备检测费)'111800' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTTDSCDMA_EQUCHECK;
     LOOP
      FETCH C_COUNTTDSCDMA_EQUCHECK INTO V_COUNTTDSCDMA_EQUCHECK;
      EXIT WHEN C_COUNTTDSCDMA_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111800';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECK_APPITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTTDSCDMA_EQUCHECK.DEPT_PAY,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTTDSCDMA_EQUCHECK.APPLY_CODE,
                    V_COUNTTDSCDMA_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTTDSCDMA_EQUCHECK;
   END IF;
  ---------------------------------------------------------------------------------------------------
  */
  COMMIT;
END;

/

-- ----------------------------
-- Procedure structure for P_RIM_RSM_FEEITEM_DEPT
-- ----------------------------
CREATE OR REPLACE PROCEDURE "RXDEV"."P_RIM_RSM_FEEITEM_DEPT"(COUNTYEAR NUMBER,DEPTCODE varchar2,areacode varchar2)
IS
  ----年度计费
  ----集群系统
  CURSOR C_COUNTJQ IS SELECT count(distinct net_guid) net_count,freq,net_range,
  min(freq_note) freq_note,min(derate) derate,
  ----2015新增申请表编号、技术资料表编号
  max (APPLY_CODE) as APPLY_CODE, min (DECL_CODE) as DECL_CODE
   FROM V_rim_rsm_FEE_JQ
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                and freq>0
                AND begin_YEAR<COUNTYEAR
              group BY freq,net_range;
  V_COUNTJQ C_COUNTJQ%ROWTYPE;

  --寻呼系统
  CURSOR C_COUNTPB IS SELECT  count(distinct net_guid) net_count,freq_emit,net_range,
  min(freq_note) freq_note,min(derate) derate ,
  ----2015新增申请表编号、技术资料表编号
  min (APPLY_CODE) as APPLY_CODE, min (DECL_CODE) as DECL_CODE
   FROM V_rim_rsm_FEE_PB
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                and freq_emit>0
              group BY freq_emit,net_range;
  V_COUNTPB C_COUNTPB%ROWTYPE;

  --广播电台
  CURSOR C_COUNTBC IS SELECT  count(distinct net_guid) net_count,freq_emit,net_range,
  min(freq_note) freq_note,min(derate) derate,
  ----2015新增申请表编号、技术资料表编号
  min (APPLY_CODE) as APPLY_CODE, min (DECL_CODE) as DECL_CODE
  FROM V_rim_rsm_FEE_BC
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                and freq_emit>0
              group BY freq_emit,net_range;
  V_COUNTBC C_COUNTBC%ROWTYPE;

  ----电视
  CURSOR C_COUNTBT IS SELECT  count(distinct net_guid) net_count,freq_emit,net_range,
  min(freq_note) freq_note,min(derate) derate,
  ----2015新增申请表编号、技术资料表编号
  min (APPLY_CODE) as APPLY_CODE, min (DECL_CODE) as DECL_CODE
  FROM V_rim_rsm_FEE_BT
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                and freq_emit>0
              group BY freq_emit,net_range;
  V_COUNTBT C_COUNTBT%ROWTYPE;
  ----无绳电话
  ----暂时去掉
  /*

  CURSOR C_COUNTLINELESS IS SELECT * FROM V_RIM_RSM_FEE_LINELESS
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTLINELESS C_COUNTLINELESS%ROWTYPE;

  */
  ----船舶电台（吨位小于1600吨）
  CURSOR C_COUNTSHIP1 IS SELECT * FROM V_rim_rsm_FEE_S
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND SHIP_TYPE<>'PH'
                AND TONNAGE<=1600
              ORDER BY apply_code,decl_code;
  V_COUNTSHIP1 C_COUNTSHIP1%ROWTYPE;
  ----船舶电台（吨位大于1600吨）
  CURSOR C_COUNTSHIP2 IS SELECT * FROM V_rim_rsm_FEE_S
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND SHIP_TYPE<>'PH'
                AND TONNAGE>1600
              ORDER BY apply_code,decl_code;
  V_COUNTSHIP2 C_COUNTSHIP2%ROWTYPE;
  ----船舶电台（渔船，功率>=20马力）
  CURSOR C_COUNTSHIP3 IS SELECT * FROM V_rim_rsm_FEE_S
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND SHIP_TYPE='PH'
                AND POWER>=20
              ORDER BY apply_code,decl_code;
  V_COUNTSHIP3 C_COUNTSHIP3%ROWTYPE;
  CURSOR C_COUNTAERO1 IS SELECT * FROM V_rim_rsm_FEE_A
  ----航空器电台(固定翼飞机27吨以上)
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND TONNAGE>27
              ORDER BY decl_code;
  V_COUNTAERO1 C_COUNTAERO1%ROWTYPE;
  ----航空器电台航空器电台(固定翼飞机5.7吨至27吨以下(含))
  CURSOR C_COUNTAERO2 IS SELECT * FROM V_rim_rsm_FEE_A
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND TONNAGE<=27 and TONNAGE>5.7
              ORDER BY decl_code;
  V_COUNTAERO2 C_COUNTAERO2%ROWTYPE;
  ----航空器电台(固定翼飞机5.7吨(含)以下)
  CURSOR C_COUNTAERO3 IS SELECT * FROM V_rim_rsm_FEE_A
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND TONNAGE<=5.7 AND TONNAGE>0
              ORDER BY decl_code;
  V_COUNTAERO3 C_COUNTAERO3%ROWTYPE;
  ----航空器电台(旋翼飞机)
  CURSOR C_COUNTAERO4 IS SELECT * FROM V_rim_rsm_FEE_A
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND TONNAGE=0
              ORDER BY decl_code;
  V_COUNTAERO4 C_COUNTAERO4%ROWTYPE;
  ----无线数据频段-----v_rim_rsm_fee_v改为v_rim_rsm_fee_data
  CURSOR C_COUNTDATA IS SELECT * FROM v_rim_rsm_fee_data
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                /*
                AND ((FREQ_EMIT>=223.025 AND FREQ_EMIT<=235) OR (FREQ_RECE>=223.025 AND FREQ_RECE<=235)
                  OR (FREQ_EMIT>821 AND FREQ_EMIT<825) OR (FREQ_RECE>821 AND FREQ_RECE<825)
                  OR (FREQ_EMIT>866 AND FREQ_EMIT<870) OR (FREQ_RECE>866 AND FREQ_RECE<870)
                  OR (FREQ_EMIT>915 AND FREQ_EMIT<917) OR (FREQ_RECE>915 AND FREQ_RECE<917))
                */
              ORDER BY apply_code,decl_code,FREQ_EMIT,FREQ_RECE;
  V_COUNTDATA C_COUNTDATA%ROWTYPE;

  ----无线接入450MHZ频段---v_rim_rsm_fee_v改为v_rim_rsm_fee_450m
  CURSOR C_COUNT450M IS SELECT * FROM v_rim_rsm_fee_450m
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                /*
                AND ((FREQ_EMIT>=450.5 AND FREQ_EMIT<=451.975) OR (FREQ_RECE>=450.5 AND FREQ_RECE<=451.975)
                  OR (FREQ_EMIT>=460.5 AND FREQ_EMIT<=461.975) OR (FREQ_RECE>=460.5 AND FREQ_RECE<=461.975))
                */
              ORDER BY apply_code,decl_code,FREQ_EMIT,FREQ_RECE;
  V_COUNT450M C_COUNT450M%ROWTYPE;


  ----其它固定台(1000MHz以下的无线电台(固定电台)--'810000')
  CURSOR C_COUNTOTHER IS SELECT count(distinct net_guid) net_count,freq,
  min(freq_note) freq_note,min(derate) derate,
  ----2015【申请表编号、技术资料表编号】
  min (APPLY_CODE) as APPLY_CODE, min (DECL_CODE) as DECL_CODE
  FROM V_rim_rsm_FEE_OTHER
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                and freq>0
              group BY freq;
  V_COUNTOTHER C_COUNTOTHER%ROWTYPE;
  ----移动台(1000MHz以下的无线电台(移动电台)--'820000')---V_RIM_RSM_FEE_MOBILE改为V_RIM_RSM_FEE_U
  CURSOR C_COUNTMOBILE IS SELECT * FROM V_RIM_RSM_FEE_MOBILE
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTMOBILE C_COUNTMOBILE%ROWTYPE;
   ----MMDS台-----V_rim_rsm_FEE_MMDS改为V_RIM_RSM_FEE_M
  CURSOR C_COUNTMMDS IS SELECT * FROM V_rim_rsm_FEE_MMDS
              WHERE DECL_CODE LIKE 'TF%'
                AND DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND STAT_TYPE='MD'
                AND FREQ_EMIT>0
              ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT;
  V_COUNTMMDS C_COUNTMMDS%ROWTYPE;
  ----无线接入1.8G
  CURSOR C_COUNT1G8 IS SELECT * FROM V_rim_rsm_FEE_ENTER1G8
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                --AND decl_code like 'C%'
              ORDER BY apply_code,decl_code;
  V_COUNT1G8 C_COUNT1G8%ROWTYPE;
   ----扩频系统2.4G ----V_rim_rsm_FEE_KP2G4改为V_RIM_RSM_FEE_M
  CURSOR C_COUNT2G4 IS SELECT * FROM V_RIM_RSM_FEE_M
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND (FREQ_EMIT>=2400 AND FREQ_EMIT<=2483.5)
              ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT;
  V_COUNT2G4 C_COUNT2G4%ROWTYPE;
  --扩频系统5.8G----V_rim_rsm_FEE_KP5G8改为V_RIM_RSM_FEE_M
  CURSOR C_COUNT5G81 IS SELECT * FROM V_rim_rsm_FEE_KP5G8
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                --AND STAT_TYPE<>'XX'
							  --AND (FREQ_EMIT>=5725 AND FREQ_EMIT<=5850)
              ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT;
  V_COUNT5G81 C_COUNT5G81%ROWTYPE;
  ----无线接入3.5G----V_rim_rsm_FEE_ENTER3G5改为V_RIM_RSM_FEE_M
  CURSOR C_COUNT3G5 IS SELECT * FROM V_rim_rsm_FEE_ENTER3G5
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND ((FREQ_EMIT>=3399.5 AND FREQ_EMIT<=3431) OR (FREQ_EMIT>=3499.5 AND FREQ_EMIT<=3531))
              ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT;
  V_COUNT3G5 C_COUNT3G5%ROWTYPE;

 --无线接入5.8G
  CURSOR C_COUNT5G82 IS SELECT * FROM V_RIM_RSM_FEE_M
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND STAT_TYPE='XX'
                AND (FREQ_EMIT>=5725 AND FREQ_EMIT<=5850)
              ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT;
  V_COUNT5G82 C_COUNT5G82%ROWTYPE;

  --雷达站10G以下(按照微波站收费)
  CURSOR C_COUNTR10GDOWN IS SELECT * FROM V_rim_rsm_FEE_R
        WHERE DEPT_PAY=DEPTCODE
        AND area_code=areacode
        AND begin_YEAR<COUNTYEAR
        and FREQ_EMIT<=10000 and FREQ_EMIT>0
        ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT;
  V_COUNTR10GDOWN C_COUNTR10GDOWN%ROWTYPE;

  --雷达站10G以上(按照微波站收费)
  CURSOR C_COUNTR10GUP IS SELECT * FROM V_rim_rsm_FEE_R
        WHERE DEPT_PAY=DEPTCODE
        AND area_code=areacode
        AND begin_YEAR<COUNTYEAR
        and FREQ_EMIT>10000
        ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT;
  V_COUNTR10GUP C_COUNTR10GUP%ROWTYPE;
   --微波站10G以下---
  -------去除同个台站的相同频率
  CURSOR C_COUNT10GDOWN IS SELECT distinct (APPLY_CODE||DECL_CODE||FREQ_EMIT) as APPLY_CODE_TEMP ,APPLY_CODE,DECL_CODE,FREQ_EMIT,chan_dist,derate
              FROM V_rim_rsm_FEE_M
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND FREQ_EMIT<=10000 and FREQ_EMIT>0
              ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT,chan_dist,derate;
  V_COUNT10GDOWN C_COUNT10GDOWN%ROWTYPE;
  --微波站10G以上
  --去除同个台站的相同频率
  CURSOR C_COUNT10GUP IS SELECT distinct (APPLY_CODE||DECL_CODE||FREQ_EMIT) as APPLY_CODE_TEMP ,APPLY_CODE,DECL_CODE,FREQ_EMIT,chan_dist,derate
              FROM V_rim_rsm_FEE_M
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND FREQ_EMIT>10000
                ORDER BY APPLY_CODE,DECL_CODE,FREQ_EMIT,chan_dist,derate;
  V_COUNT10GUP C_COUNT10GUP%ROWTYPE;
  --地球站
  CURSOR C_COUNTEARTH IS SELECT * FROM V_rim_rsm_FEE_E
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTEARTH C_COUNTEARTH%ROWTYPE;
  /*
--------设备检测费----------------------------------------------------
 --寻呼系统(设备检测费)'112000' /广东省 20130125
  CURSOR C_COUNTPB_EQUCHECK IS SELECT  * FROM v_rim_rsm_fee_EQUCHECK_pb
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTPB_EQUCHECK C_COUNTPB_EQUCHECK%ROWTYPE;
  --集群系统(设备检测费)'113000' /广东省 20130125
  CURSOR C_COUNTJQ_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_jq
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTJQ_EQUCHECK C_COUNTJQ_EQUCHECK%ROWTYPE;
  --广播电台(设备检测费)'116000' /广东省 20130125
   CURSOR C_COUNTBC_EQUCHECK IS SELECT  *  FROM v_rim_rsm_fee_equcheck_bc
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTBC_EQUCHECK C_COUNTBC_EQUCHECK%ROWTYPE;
  --电视(设备检测费)'115000' /广东省 20130125
   CURSOR C_COUNTBT_EQUCHECK IS SELECT  *  FROM V_rim_rsm_FEE_EQUCHECK_BT
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTBT_EQUCHECK C_COUNTBT_EQUCHECK%ROWTYPE;
--无绳电话(设备检测费)'114000'/广东省 20130125
  CURSOR C_COUNTLINELESS_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_linless
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTLINELESS_EQUCHECK C_COUNTLINELESS_EQUCHECK%ROWTYPE;
   --微波站(包括10G以上和10G以下)(设备检测费)'119000' /广东省 20130125
   CURSOR C_COUNT10G_EQUCHECK IS SELECT  *  FROM v_rim_rsm_fee_equcheck_m
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNT10G_EQUCHECK C_COUNT10G_EQUCHECK%ROWTYPE;
  --无线数据频段(设备检测费)(设备检测费)'111700' /广东省 20130125
  CURSOR C_COUNTDATA_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_data
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTDATA_EQUCHECK C_COUNTDATA_EQUCHECK%ROWTYPE;
    --地球站(设备检测费)'111300' /广东省 20130125
  CURSOR C_COUNTEARTH_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_e
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTEARTH_EQUCHECK  C_COUNTEARTH_EQUCHECK%ROWTYPE;
   --MMDS台 (设备检测费)'111200' /广东省 20130125
  CURSOR C_COUNTMMDS_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_mmds
              WHERE DECL_CODE LIKE 'TF%'
                AND DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTMMDS_EQUCHECK C_COUNTMMDS_EQUCHECK%ROWTYPE;
  --无线接入1.8G(设备检测费)'111400'/广东省 20130125
  CURSOR C_COUNT1G8_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_ECHECK_enter1g8
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNT1G8_EQUCHECK C_COUNT1G8_EQUCHECK%ROWTYPE;
   --扩频系统2.4G(设备检测费)'111500'/广东省 20130125
  CURSOR C_COUNT2G4_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_kp2g4
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNT2G4_EQUCHECK C_COUNT2G4_EQUCHECK%ROWTYPE;
  --扩频系统5.8G(设备检测费)'111600'/广东省 20130125
  CURSOR C_COUNT5G81_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_kp5g8
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNT5G81_EQUCHECK C_COUNT5G81_EQUCHECK%ROWTYPE;
   --其它固定台(设备检测费)'117000'/广东省 20130125
  CURSOR C_COUNTOTHER_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_other
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTOTHER_EQUCHECK C_COUNTOTHER_EQUCHECK%ROWTYPE;
   --移动台(设备检测费)'118000'/广东省 20130125
  CURSOR C_COUNTMOBILE_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_EQUCHECK_mobile
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTMOBILE_EQUCHECK C_COUNTMOBILE_EQUCHECK%ROWTYPE;
   --蜂窝公众通信基站GSM(设备检测费)'111800'/广东省 20130125
  CURSOR C_COUNTGSM_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_GSM
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTGSM_EQUCHECK C_COUNTGSM_EQUCHECK%ROWTYPE;
    --蜂窝公众通信基站CDMA(设备检测费)'111800'/广东省 20130125
  CURSOR C_COUNTCDMA_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_CDMA
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTCDMA_EQUCHECK C_COUNTCDMA_EQUCHECK%ROWTYPE;
      --蜂窝公众通信基站WCDMA(设备检测费)'111800'/广东省 20130125
  CURSOR C_COUNTWCDMA_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_WCDMA
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTWCDMA_EQUCHECK C_COUNTWCDMA_EQUCHECK%ROWTYPE;
      --蜂窝公众通信基站TD-SCDMA(设备检测费)'111800'/广东省 20130125
  CURSOR C_COUNTTDSCDMA_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_TDSCDMA
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTTDSCDMA_EQUCHECK C_COUNTTDSCDMA_EQUCHECK%ROWTYPE;
------------------------------------------------------------------------
*/
  V_APPLYCODE VARCHAR2(14);
  V_APPLYCODE1 VARCHAR2(14);
  --申请表编号

  V_DECLCODE VARCHAR2(6);
  V_DECLCODE1 VARCHAR2(6);
   --技术资料表编号
  V_FREQEMIT NUMBER;
  V_FREQRECE NUMBER;
  --频率
  V_AMOUNT NUMBER;
  V_AMOUNT1 NUMBER;
  --数量
  V_BANDWIDTH NUMBER;
  --带宽
  V_DERATE NUMBER;
  --减免
  V_FEE NUMBER;
  --

  v_deptpay  VARCHAR2(36);
  v_areacode  VARCHAR2(6);

  --无绳电话的收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
  --无线数据频段记录合计数量
  V_Count_Data NUMBER;
  X_Count_Data NUMBER;----记录次数
  --无线接入450MHZ频段记录合计数量
  V_Count_FEE_450m NUMBER;
  X_Count_FEE_450m NUMBER;----记录次数
  --移动台记录合计数量
  V_Count_mobile NUMBER;
  X_Count_mobile NUMBER;----记录次数
  --扩频系统2.4G记录合计数量
  V_Count_kp2g4 NUMBER;
  X_Count_kp2g4 NUMBER;----记录次数
  --扩频系统5.8G记录合计数量
  V_Count_KP5G8 NUMBER;
  X_Count_KP5G8 NUMBER;----记录次数
  --无线接入3.5G记录合计数量
  V_Count_ENTER3G5 NUMBER;----记录合计数量
  X_Count_ENTER3G5 NUMBER;----记录次数
  --无线接入5.8G记录合计数量
  V_Count_ENTER5G8 NUMBER;----记录合计数量
  X_Count_ENTER5G8 NUMBER;----记录次数
  --雷达站10G以下--记录合计数量
  V_CountR_10GDOWN NUMBER;----记录合计数量
  X_CountR_10GDOWN NUMBER;----记录次数
  --雷达站10G以上--记录合计数量
  V_CountR_10GUP NUMBER;----记录合计数量
  X_CountR_10GUP NUMBER;----记录次数
   --
  ApplyCode_Temp varchar2(20);----申请表编号转化后的（T500020150005转化为500020150005）
  ApplyType_Temp varchar2(10); ---申请表类型T或PA
  DECL_CODE_Temp varchar2(10); ---技术资料表编号（V0001或者C0001）
  --
BEGIN
  DELETE FROM T_RIM_RSM_PAY_DEPTITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_pay_deptnetitem WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  DELETE FROM T_RIM_RSM_PAY_EQUCHECKITEM WHERE DEPT_PAY=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  --集群无线调度系统
  OPEN C_COUNTJQ;
  LOOP
    FETCH C_COUNTJQ INTO V_COUNTJQ;
    EXIT WHEN C_COUNTJQ%NOTFOUND;
    IF  V_COUNTJQ.net_range='GJ' THEN
      V_ITEMCODE:='210000';
    ELSIF V_COUNTJQ.net_range='SJ' THEN
      V_ITEMCODE:='220000';
    ELSE
      V_ITEMCODE:='230000';
    END IF;
    SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE=V_ITEMCODE;
    INSERT INTO T_RIM_RSM_pay_deptnetitem(dept_pay,
                    area_code,
                    APPLY_CODE,
                    decl_code,
                    count_year,
                    item_code,
                    freq_note,
                    amount,
                    derate,
                    sum_count,
                    sum_pay,
                    Applytype)
                VALUES (DEPTCODE,
                    areacode,
                    V_COUNTJQ.APPLY_CODE,
                    V_COUNTJQ.DECL_CODE,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTJQ.freq_note,
                    V_COUNTJQ.NET_COUNT,
                    V_COUNTJQ.DERATE,
                    V_FEE*V_COUNTJQ.NET_COUNT,
                    V_FEE*V_COUNTJQ.NET_COUNT*(100-V_COUNTJQ.DERATE)/100,
                    'T');
  END LOOP;
  CLOSE C_COUNTJQ;
  --寻呼系统
  OPEN C_COUNTPB;
  LOOP
    FETCH C_COUNTPB INTO V_COUNTPB;
    EXIT WHEN C_COUNTPB%NOTFOUND;
    IF  V_COUNTPB.net_range='GJ' THEN
      V_ITEMCODE:='310000';
    ELSIF V_COUNTPB.net_range='SJ' THEN
      V_ITEMCODE:='320000';
    ELSE
      V_ITEMCODE:='330000';
    END IF;
    SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE=V_ITEMCODE;
    INSERT INTO T_RIM_RSM_pay_deptnetitem(dept_pay,
                    area_code,
                    APPLY_CODE,
                    decl_code,
                    count_year,
                    item_code,
                    freq_note,
                    amount,
                    derate,
                    sum_count,
                    sum_pay,
                    Applytype)
                VALUES (DEPTCODE,
                    areacode,
                    V_COUNTPB.APPLY_CODE,
                    V_COUNTPB.DECL_CODE,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTPB.freq_note,
                    V_COUNTPB.NET_COUNT,
                    V_COUNTPB.DERATE,
                    V_FEE*V_COUNTPB.NET_COUNT,
                    V_FEE*V_COUNTPB.NET_COUNT*(100-V_COUNTPB.DERATE)/100,
                    'T');
  END LOOP;
  CLOSE C_COUNTPB;
  --广播电台
  OPEN C_COUNTBC;
  LOOP
    FETCH C_COUNTBC INTO V_COUNTBC;
    EXIT WHEN C_COUNTBC%NOTFOUND;
    IF  V_COUNTBC.net_range='GJ' THEN
      V_ITEMCODE:='560000';
    ELSIF V_COUNTBC.net_range='SJ' THEN
      V_ITEMCODE:='570000';
    ELSIF V_COUNTBC.net_range='CJ' THEN
      V_ITEMCODE:='580000';
    ELSE
      V_ITEMCODE:='590000';
    END IF;
    SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE=V_ITEMCODE;
    INSERT INTO T_RIM_RSM_pay_deptnetitem(dept_pay,
                    area_code,
                    APPLY_CODE,
                    decl_code,
                    count_year,
                    item_code,
                    freq_note,
                    amount,
                    derate,
                    sum_count,
                    sum_pay,
                    Applytype)
                VALUES (DEPTCODE,
                    areacode,
                    V_COUNTBC.APPLY_CODE,
                    V_COUNTBC.DECL_CODE,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTBC.freq_note,
                    V_COUNTBC.NET_COUNT,
                    V_COUNTBC.DERATE,
                    V_FEE*V_COUNTBC.NET_COUNT,
                    V_FEE*V_COUNTBC.NET_COUNT*(100-V_COUNTBC.DERATE)/100,
                    'T');
  END LOOP;
  CLOSE C_COUNTBC;
  --电视
  OPEN C_COUNTBT;
  LOOP
    FETCH C_COUNTBT INTO V_COUNTBT;
    EXIT WHEN C_COUNTBT%NOTFOUND;
    IF  V_COUNTBT.net_range='GJ' THEN
      V_ITEMCODE:='510000';
    ELSIF V_COUNTBT.net_range='SJ' THEN
      V_ITEMCODE:='520000';
    ELSIF V_COUNTBT.net_range='CJ' THEN
      V_ITEMCODE:='530000';
    ELSE
      V_ITEMCODE:='540000';
    END IF;
    SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE=V_ITEMCODE;
    INSERT INTO T_RIM_RSM_pay_deptnetitem(dept_pay,
                    area_code,
                    APPLY_CODE,
                    decl_code,
                    count_year,
                    item_code,
                    freq_note,
                    amount,
                    derate,
                    sum_count,
                    sum_pay,
                    Applytype)
                VALUES (DEPTCODE,
                    areacode,
                    V_COUNTBT.APPLY_CODE,
                    V_COUNTBT.DECL_CODE,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTBT.freq_note,
                    V_COUNTBT.NET_COUNT,
                    V_COUNTBT.DERATE,
                    V_FEE*V_COUNTBT.NET_COUNT,
                    V_FEE*V_COUNTBT.NET_COUNT*(100-V_COUNTBT.DERATE)/100,
                    'T');
  END LOOP;
  CLOSE C_COUNTBT;
  /*无无绳电话计费暂时不计费
  --无绳电话计费'410000'
  V_FLAG := 'N';
  OPEN C_COUNTLINELESS;
  LOOP
    FETCH C_COUNTLINELESS INTO V_COUNTLINELESS;
    EXIT WHEN C_COUNTLINELESS%NOTFOUND;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='410000';
      V_FLAG := 'Y';
    end if;
    INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                  AREA_CODE,
                  APPLY_CODE,
                  decl_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY)
              VALUES (DEPTCODE,
                  areacode,
                  V_COUNTLINELESS.APPLY_CODE,
                  V_COUNTLINELESS.decl_code,
                  COUNTYEAR,
                  '410000',
                  V_COUNTLINELESS.DERATE,
                  1,
                  V_FEE,
                  V_FEE*(100-V_COUNTLINELESS.DERATE)/100);
  END LOOP;
  CLOSE C_COUNTLINELESS;
  */
  --船舶电台（吨位小于1600吨）计费'620000'
  V_FLAG := 'N';
  OPEN C_COUNTSHIP1;
  LOOP
    FETCH C_COUNTSHIP1 INTO V_COUNTSHIP1;
    EXIT WHEN C_COUNTSHIP1%NOTFOUND;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='620000';
      V_FLAG := 'Y';
    end if;
    INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                  AREA_CODE,
                  APPLY_CODE,
                  decl_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (DEPTCODE,
                  areacode,
                  V_COUNTSHIP1.APPLY_CODE,
                  V_COUNTSHIP1.decl_code,
                  COUNTYEAR,
                  '620000',
                  V_COUNTSHIP1.DERATE,
                  1,
                  V_FEE,
                  V_FEE*(100-V_COUNTSHIP1.DERATE)/100,
                  'T');
  END LOOP;
  CLOSE C_COUNTSHIP1;
  --船舶电台（吨位大于1600吨）计费'610000'
  V_FLAG := 'N';
  OPEN C_COUNTSHIP2;
  LOOP
    FETCH C_COUNTSHIP2 INTO V_COUNTSHIP2;
    EXIT WHEN C_COUNTSHIP2%NOTFOUND;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='610000';
      V_FLAG := 'Y';
    end if;
    INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                  AREA_CODE,
                  APPLY_CODE,
                  decl_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (DEPTCODE,
                  areacode,
                  V_COUNTSHIP2.APPLY_CODE,
                  V_COUNTSHIP2.decl_code,
                  COUNTYEAR,
                  '610000',
                  V_COUNTSHIP2.DERATE,
                  1,
                  V_FEE,
                  V_FEE*(100-V_COUNTSHIP2.DERATE)/100,
                  'T');
  END LOOP;
  CLOSE C_COUNTSHIP2;
  --船舶电台（渔船，功率>=20马力）计费'630000'
  V_FLAG := 'N';
  OPEN C_COUNTSHIP3;
  LOOP
    FETCH C_COUNTSHIP3 INTO V_COUNTSHIP3;
    EXIT WHEN C_COUNTSHIP3%NOTFOUND;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='630000';
      V_FLAG := 'Y';
    end if;
    INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                  AREA_CODE,
                  APPLY_CODE,
                  decl_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (DEPTCODE,
                  areacode,
                  V_COUNTSHIP3.APPLY_CODE,
                  V_COUNTSHIP3.decl_code,
                  COUNTYEAR,
                  '630000',
                  V_COUNTSHIP3.DERATE,
                  1,
                  V_FEE,
                  V_FEE*(100-V_COUNTSHIP3.DERATE)/100,
                  'T');
  END LOOP;
  CLOSE C_COUNTSHIP3;
  --航空器电台(固定翼飞机27吨以上)
  V_FLAG := 'N';
  OPEN C_COUNTAERO1;
  LOOP
    FETCH C_COUNTAERO1 INTO V_COUNTAERO1;
    EXIT WHEN C_COUNTAERO1%NOTFOUND;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='710000';
      V_FLAG := 'Y';
    end if;
    INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                  AREA_CODE,
                  APPLY_CODE,
                  decl_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (DEPTCODE,
                  areacode,
                  V_COUNTAERO1.APPLY_CODE,
                  V_COUNTAERO1.decl_code,
                  COUNTYEAR,
                  '710000',
                  V_COUNTAERO1.DERATE,
                  1,
                  V_FEE,
                  V_FEE*(100-V_COUNTAERO1.DERATE)/100,
                  'T');

  END LOOP;
  CLOSE C_COUNTAERO1;
  --航空器电台(固定翼飞机5.7吨至27吨以下(含))
  V_FLAG := 'N';
  OPEN C_COUNTAERO2;
  LOOP
    FETCH C_COUNTAERO2 INTO V_COUNTAERO2;
    EXIT WHEN C_COUNTAERO2%NOTFOUND;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='720000';
      V_FLAG := 'Y';
    end if;
    INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                  AREA_CODE,
                  APPLY_CODE,
                  decl_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (DEPTCODE,
                  areacode,
                  V_COUNTAERO2.APPLY_CODE,
                  V_COUNTAERO2.decl_code,
                  COUNTYEAR,
                  '720000',
                  V_COUNTAERO2.DERATE,
                  1,
                  V_FEE,
                  V_FEE*(100-V_COUNTAERO2.DERATE)/100,
                  'T');
  END LOOP;
  CLOSE C_COUNTAERO2;
  --航空器电台(固定翼飞机5.7吨(含)以下)
  V_FLAG := 'N';
  OPEN C_COUNTAERO3;
  LOOP
    FETCH C_COUNTAERO3 INTO V_COUNTAERO3;
    EXIT WHEN C_COUNTAERO3%NOTFOUND;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='730000';
      V_FLAG := 'Y';
    end if;
    INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                  AREA_CODE,
                  APPLY_CODE,
                  decl_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (DEPTCODE,
                  areacode,
                  V_COUNTAERO3.APPLY_CODE,
                  V_COUNTAERO3.decl_code,
                  COUNTYEAR,
                  '730000',
                  V_COUNTAERO3.DERATE,
                  1,
                  V_FEE,
                  V_FEE*(100-V_COUNTAERO3.DERATE)/100,
                  'T');
  END LOOP;
  CLOSE C_COUNTAERO3;
  --航空器电台(旋翼飞机)
  V_FLAG := 'N';
  OPEN C_COUNTAERO4;
  LOOP
    FETCH C_COUNTAERO4 INTO V_COUNTAERO4;
    EXIT WHEN C_COUNTAERO4%NOTFOUND;
    IF V_FLAG = 'N' THEN
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='740000';
      V_FLAG := 'Y';
    end if;
    INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                  AREA_CODE,
                  APPLY_CODE,
                  decl_code,
                  COUNT_YEAR,
                  ITEM_CODE,
                  DERATE,
                  AMOUNT,
                  SUM_COUNT,
                  SUM_PAY,
                  APPLYTYPE)
              VALUES (DEPTCODE,
                  areacode,
                  V_COUNTAERO4.APPLY_CODE,
                  V_COUNTAERO4.decl_code,
                  COUNTYEAR,
                  '740000',
                  V_COUNTAERO4.DERATE,
                  1,
                  V_FEE,
                  V_FEE*(100-V_COUNTAERO4.DERATE)/100,
                  'T');

  END LOOP;
  CLOSE C_COUNTAERO4;
  --无线数据频段计费'140100'
  V_FLAG := 'N';
  OPEN C_COUNTDATA;
  LOOP
    FETCH C_COUNTDATA INTO V_COUNTDATA;
    EXIT WHEN C_COUNTDATA%NOTFOUND;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 0;
      --计算发射频点
      if V_COUNTDATA.freq_emit>0 then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --计算接收频点
      if V_COUNTDATA.freq_rece>0 and V_COUNTDATA.freq_rece<>V_COUNTDATA.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --记录累加
      v_applycode :=V_COUNTDATA.apply_code;
      v_declcode :=V_COUNTDATA.decl_code;
      V_FREQEMIT:= V_COUNTDATA.FREQ_EMIT;
      V_FREQRECE:= V_COUNTDATA.FREQ_RECE;
      V_DERATE := V_COUNTDATA.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='140100';
      --取出收费标准
    ELSIF v_applycode=V_COUNTDATA.apply_code and v_declcode=V_COUNTDATA.decl_code THEN
     --台站相同，继续累加
      --计算发射频点
      if V_COUNTDATA.freq_emit>0 and V_FREQEMIT <> V_COUNTDATA.FREQ_EMIT then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQEMIT:= V_COUNTDATA.FREQ_EMIT;
      end if;
      --计算接收频点
      if V_COUNTDATA.freq_rece>0 and V_FREQRECE <> V_COUNTDATA.FREQ_RECE and V_COUNTDATA.freq_rece<>V_COUNTDATA.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQRECE:= V_COUNTDATA.FREQ_RECE;
      end if;
    ELSE
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '140100',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        'T');
      V_AMOUNT := 0;
      --计算发射频点
      if V_COUNTDATA.freq_emit>0 then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --计算接收频点
      if V_COUNTDATA.freq_rece>0 and V_COUNTDATA.freq_rece<>V_COUNTDATA.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      v_applycode :=V_COUNTDATA.apply_code;
      v_declcode :=V_COUNTDATA.decl_code;
      V_DERATE := V_COUNTDATA.DERATE;
      V_FREQEMIT:= V_COUNTDATA.FREQ_EMIT;
      V_FREQRECE:= V_COUNTDATA.FREQ_RECE;
      --取出减免比例
    END IF;
  END LOOP;
  CLOSE C_COUNTDATA;
  IF V_FLAG = 'Y' THEN
   --存在需要添加的记录结果
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '140100',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      'T');
  END IF;
  --无线接入450MHZ频段计费'120100'
  V_FLAG := 'N';
  OPEN C_COUNT450M;
  LOOP
    FETCH C_COUNT450M INTO V_COUNT450M;
    EXIT WHEN C_COUNT450M%NOTFOUND;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 0;
      --计算发射频点
      if V_COUNT450M.freq_emit>0 then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --计算接收频点
      if V_COUNT450M.freq_rece>0 and V_COUNT450M.freq_rece<>V_COUNT450M.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --记录累加
      v_applycode :=V_COUNT450M.apply_code;
      v_declcode :=V_COUNT450M.decl_code;
      V_FREQEMIT:= V_COUNT450M.FREQ_EMIT;
      V_FREQRECE:= V_COUNT450M.FREQ_RECE;
      V_DERATE := V_COUNT450M.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120100';
      --取出收费标准
    ELSIF v_applycode=V_COUNT450M.apply_code and v_declcode=V_COUNT450M.decl_code THEN
      --计算发射频点
      if V_COUNT450M.freq_emit>0 and V_FREQEMIT <> V_COUNT450M.FREQ_EMIT then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQEMIT:= V_COUNT450M.FREQ_EMIT;
      end if;
      --计算接收频点
      if V_COUNT450M.freq_rece>0 and V_FREQRECE <> V_COUNT450M.FREQ_RECE and V_COUNT450M.freq_rece<>V_COUNT450M.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
        V_FREQRECE:= V_COUNT450M.FREQ_RECE;
      end if;
    ELSE
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '120100',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        'T');
      V_AMOUNT := 0;
      --计算发射频点
      if V_COUNT450M.freq_emit>0 then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      --计算接收频点
      if V_COUNT450M.freq_rece>0 and V_COUNT450M.freq_rece<>V_COUNT450M.freq_emit then
        V_AMOUNT := V_AMOUNT+1;
      end if;
      v_applycode :=V_COUNT450M.apply_code;
      v_declcode :=V_COUNT450M.decl_code;
      V_DERATE := V_COUNT450M.DERATE;
      V_FREQEMIT:= V_COUNT450M.FREQ_EMIT;
      V_FREQRECE:= V_COUNT450M.FREQ_RECE;
      --取出减免比例
    END IF;
  END LOOP;
  CLOSE C_COUNT450M;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '120100',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      'T');
  END IF;
  --其它V表固定站计费'810000'【1000MHz以下的无线电台(固定电台)】
  OPEN C_COUNTOTHER;
  LOOP
    FETCH C_COUNTOTHER INTO V_COUNTOTHER;
    EXIT WHEN C_COUNTOTHER%NOTFOUND;
    SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='810000';
    INSERT INTO T_RIM_RSM_pay_deptnetitem(dept_pay,
                    area_code,
                    APPLY_CODE,
                    DECL_CODE,
                    count_year,
                    item_code,
                    freq_note,
                    amount,
                    derate,
                    sum_count,
                    sum_pay,
                    Applytype)
                VALUES (DEPTCODE,
                    areacode,
                    V_COUNTOTHER.APPLY_CODE,
                    V_COUNTOTHER.DECL_CODE,
                    COUNTYEAR,
                    '810000',
                    V_COUNTOTHER.freq_note,
                    V_COUNTOTHER.NET_COUNT,
                    V_COUNTOTHER.DERATE,
                    V_FEE*V_COUNTOTHER.NET_COUNT,
                    V_FEE*V_COUNTOTHER.NET_COUNT*(100-V_COUNTOTHER.DERATE)/100,
                    'T');
  END LOOP;
  CLOSE C_COUNTOTHER;
  --移动台计费'820000'【1000MHz以下的无线电台(移动电台)】
  V_FLAG := 'N';
  OPEN C_COUNTMOBILE;
  LOOP
    FETCH C_COUNTMOBILE INTO V_COUNTMOBILE;
    EXIT WHEN C_COUNTMOBILE%NOTFOUND;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode :=V_COUNTMOBILE.apply_code;
      v_declcode :=V_COUNTMOBILE.decl_code;
      V_DERATE := V_COUNTMOBILE.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='820000';
      --取出收费标准
    ELSIF v_applycode=V_COUNTMOBILE.apply_code and v_declcode=V_COUNTMOBILE.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
    ELSE
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '820000',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        'T');
      V_AMOUNT := 1;
      v_applycode :=V_COUNTMOBILE.apply_code;
      v_declcode :=V_COUNTMOBILE.decl_code;
      V_DERATE := V_COUNTMOBILE.DERATE;
      --取出减免比例
    END IF;
  END LOOP;
  CLOSE C_COUNTMOBILE;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '820000',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      'T');
  END IF;
  --有线电视传输（MMDS）计费'930000'
  V_FLAG := 'N';
  OPEN C_COUNTMMDS;
  LOOP
    FETCH C_COUNTMMDS INTO V_COUNTMMDS;
    EXIT WHEN C_COUNTMMDS%NOTFOUND;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_APPLYCODE:= V_COUNTMMDS.APPLY_CODE;
      V_DECLCODE := V_COUNTMMDS.DECL_CODE;
      V_FREQEMIT:= V_COUNTMMDS.FREQ_EMIT;
      V_BANDWIDTH := nvl(V_COUNTMMDS.CHAN_DIST,1);
      --空值则默认为一个单位
      V_DERATE := V_COUNTMMDS.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='930000';
      --取出收费标准
    ELSIF V_APPLYCODE = V_COUNTMMDS.APPLY_CODE and V_DECLCODE = V_COUNTMMDS.DECL_CODE THEN
    --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNTMMDS.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+nvl(V_COUNTMMDS.CHAN_DIST,1);
        V_FREQEMIT:= V_COUNTMMDS.FREQ_EMIT;
      end if;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF V_AMOUNT<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '930000',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        'T');
      V_BANDWIDTH := nvl(V_COUNTMMDS.CHAN_DIST,1);
      --空值则默认为一个单位
      V_DERATE := V_COUNTMMDS.DERATE;
      --取出减免比例
      V_APPLYCODE:= V_COUNTMMDS.APPLY_CODE;
      V_DECLCODE := V_COUNTMMDS.DECL_CODE;
      V_FREQEMIT:= V_COUNTMMDS.FREQ_EMIT;
    END IF;
  END LOOP;
  CLOSE C_COUNTMMDS;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF V_AMOUNT<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '930000',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      'T');
  END IF;
  --无线接入1.8G '120200'
  V_FLAG := 'N';
  OPEN C_COUNT1G8;
  LOOP
    FETCH C_COUNT1G8 INTO V_COUNT1G8;
    EXIT WHEN C_COUNT1G8%NOTFOUND;
    --
    --取出收费标准
    SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120200';
    --第一条记录
    V_AMOUNT := 1;
    --记录累加
    V_APPLYCODE:= V_COUNT1G8.APPLY_CODE;
    V_DECLCODE := V_COUNT1G8.DECL_CODE;
    V_DERATE := V_COUNT1G8.DERATE;
    --取出减免比例
    --
    --获取申请表编号和技术资料表编号
    ApplyCode_Temp := V_COUNT1G8.APPLY_CODE;----申请表编号转化后的（T500020150005转化为500020150005）
    ApplyType_Temp := 'T';----申请表类型T或PA
    DECL_CODE_Temp := V_COUNT1G8.DECL_CODE;---技术资料表编号
    ---
    --
    INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '120200',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_AMOUNT := 1;
      V_APPLYCODE:= V_COUNT1G8.APPLY_CODE;
      V_DECLCODE := V_COUNT1G8.DECL_CODE;
      V_DERATE := V_COUNT1G8.DERATE;
      --取出减免比例
    --
    /*
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120200';
      --第一条记录
      V_AMOUNT := 1;
      --记录累加
      V_APPLYCODE:= V_COUNT1G8.APPLY_CODE;
      V_DECLCODE := V_COUNT1G8.DECL_CODE;
      V_DERATE := V_COUNT1G8.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_APPLYCODE = V_COUNT1G8.APPLY_CODE and V_DECLCODE = V_COUNT1G8.DECL_CODE THEN
      V_AMOUNT := V_AMOUNT+1;
    ELSE
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '120200',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100);
      V_AMOUNT := 1;
      V_APPLYCODE:= V_COUNT1G8.APPLY_CODE;
      V_DECLCODE := V_COUNT1G8.DECL_CODE;
      V_DERATE := V_COUNT1G8.DERATE;
      --取出减免比例
    END IF;
    */
  END LOOP;
  CLOSE C_COUNT1G8;
  /*
  IF V_FLAG = 'Y' THEN
   --存在需要添加的记录结果
    INSERT INTO   T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '120200',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100);
  END IF;
  */
  --扩频系统2.4G计费'130100'
  V_FLAG := 'N';
  OPEN C_COUNT2G4;
  LOOP
    FETCH C_COUNT2G4 INTO V_COUNT2G4;
    EXIT WHEN C_COUNT2G4%NOTFOUND;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='130100';
       ----数据记录合计数量
      SELECT count(*) INTO V_Count_kp2g4 FROM V_rim_rsm_FEE_KP2G4
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND FREQ_EMIT>0;
      --第一条记录
      X_Count_kp2g4 :=0;
      X_Count_kp2g4 :=X_Count_kp2g4+1;
      --
      v_deptpay:= V_COUNT2G4.dept_pay;
      v_areacode:= V_COUNT2G4.area_code;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      V_BANDWIDTH := CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));
        --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_APPLYCODE = V_COUNT2G4.APPLY_CODE AND V_DECLCODE = V_COUNT2G4.DECL_CODE THEN
       X_Count_kp2g4 :=X_Count_kp2g4+1;
      --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT2G4.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
        --带宽累加，空值则默认为一个单位
      end if;
       ---记录累加
      V_APPLYCODE := V_COUNT2G4.APPLY_CODE;
      V_DECLCODE := V_COUNT2G4.DECL_CODE;
      v_deptpay:= V_COUNT2G4.dept_pay;
      v_areacode:= V_COUNT2G4.area_code;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;

      --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;

      V_DERATE := V_COUNT2G4.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF V_AMOUNT<=0 THEN
        V_AMOUNT:=1;
      END IF;
       --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNT2G4.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := substr(V_COUNT2G4.APPLY_CODE,0,length(V_COUNT2G4.APPLY_CODE)-12);----申请表类型T或PA
     -- DECL_CODE_Temp := V_COUNT2G4.DECL_CODE;---技术资料表编号
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '130100',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        ApplyType_Temp);
      ---

      V_BANDWIDTH := nvl(V_COUNT2G4.CHAN_DIST,1);
       --空值则默认为一个单位
      V_DERATE := V_COUNT2G4.DERATE;
       --取出减免比例
      V_APPLYCODE:= V_COUNT2G4.APPLY_CODE;
      V_DECLCODE := V_COUNT2G4.DECL_CODE;
      V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_kp2g4 :=X_Count_kp2g4+1;
       --如果执行最后条记录
      IF X_Count_kp2g4=V_Count_kp2g4 THEN
         ---记录累加
          v_deptpay:= V_COUNT2G4.dept_pay;
          v_areacode:= V_COUNT2G4.area_code;
          V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
          V_BANDWIDTH := CEIL(nvl(V_COUNT2G4.CHAN_DIST,1));

          --空值则默认为一个单位
          V_DERATE := V_COUNT2G4.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          --
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT2G4.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := substr(V_COUNT2G4.APPLY_CODE,0,length(V_COUNT2G4.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT2G4.DECL_CODE;---技术资料表编号
          --
          INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        ApplyCode_Temp,
                        DECL_CODE_Temp,
                        COUNTYEAR,
                        '130100',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        ApplyType_Temp);
      END IF;
    END IF;
     ---记录累加
    V_APPLYCODE := V_COUNT2G4.APPLY_CODE;
    V_DECLCODE := V_COUNT2G4.DECL_CODE;
    v_deptpay:= V_COUNT2G4.dept_pay;
    v_areacode:= V_COUNT2G4.area_code;
    V_FREQEMIT:= V_COUNT2G4.FREQ_EMIT;
    --
  END LOOP;
  CLOSE C_COUNT2G4;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF V_AMOUNT<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '130100',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      'T');
  END IF;
  --扩频系统5.8G计费'130200'
  V_FLAG := 'N';
  OPEN  C_COUNT5G81;
  LOOP
    FETCH  C_COUNT5G81 INTO V_COUNT5G81;
    EXIT WHEN  C_COUNT5G81%NOTFOUND;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_APPLYCODE:= V_COUNT5G81.APPLY_CODE;
      V_DECLCODE := V_COUNT5G81.DECL_CODE;
      V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
      V_BANDWIDTH := CEIL(nvl(V_COUNT5G81.CHAN_DIST,1));
       --空值则默认为一个单位
      V_DERATE := V_COUNT5G81.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='130200';
      --取出收费标准
    ELSIF V_APPLYCODE = V_COUNT5G81.APPLY_CODE AND V_DECLCODE = V_COUNT5G81.DECL_CODE THEN
    --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT5G81.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT5G81.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
    ELSE
       V_AMOUNT := CEIL(V_BANDWIDTH);
      IF V_AMOUNT<=0 THEN
        V_AMOUNT:=1;
      END IF;
       ApplyType_Temp := 'T';----申请表类型T或PA
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '130200',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_BANDWIDTH := nvl(V_COUNT5G81.CHAN_DIST,1);
      --空值则默认为一个单位
      V_DERATE := V_COUNT5G81.DERATE;
      --取出减免比例
      V_APPLYCODE:= V_COUNT5G81.APPLY_CODE;
      V_DECLCODE := V_COUNT5G81.DECL_CODE;
      V_FREQEMIT:= V_COUNT5G81.FREQ_EMIT;
    END IF;
  END LOOP;
  CLOSE  C_COUNT5G81;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF V_AMOUNT<=0 THEN
      V_AMOUNT:=1;
    END IF;
    ApplyType_Temp := 'T';--substr(V_COUNT3G5.APPLY_CODE,0,length(V_COUNT3G5.APPLY_CODE)-12);----申请表类型T或PA
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '130200',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  --无线接入系统(3.5GHZ)计费'120300'
  V_FLAG := 'N';
  X_Count_ENTER3G5 :=0;
  V_BANDWIDTH :=0;
  OPEN  C_COUNT3G5;
  LOOP
    FETCH  C_COUNT3G5 INTO V_COUNT3G5;
    EXIT WHEN  C_COUNT3G5%NOTFOUND;
    IF V_FLAG = 'N' THEN
      --取出收费标准
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120300';
        ----数据记录合计数量
      SELECT count(*) INTO V_Count_ENTER3G5 FROM V_rim_rsm_FEE_ENTER3G5
              WHERE DEPT_PAY=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
                AND FREQ_EMIT>0;
      --第一条记录
      if X_Count_ENTER3G5 = 0 then
         X_Count_ENTER3G5 :=0;
      end if;
      X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
      --第一条记录
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      if V_BANDWIDTH  =0 then
         V_BANDWIDTH :=0;
      end if;
      --计算发射频点
       V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
      V_DERATE := V_COUNT3G5.DERATE;
       --取出减免比例
      V_FLAG := 'Y';
    ELSIF V_APPLYCODE = V_COUNT3G5.APPLY_CODE AND V_DECLCODE = V_COUNT3G5.DECL_CODE THEN
      --同一个台站则带宽数据累计
       X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
      --计算发射频点
      if V_FREQEMIT <> V_COUNT3G5.FREQ_EMIT then
         V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
        V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
       ---记录累加
      V_APPLYCODE := V_COUNT3G5.APPLY_CODE;
      V_DECLCODE := V_COUNT3G5.DECL_CODE;
      v_deptpay:= V_COUNT3G5.dept_pay;
      v_areacode:= V_COUNT3G5.area_code;
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      --空值则默认为一个单位
      V_DERATE := V_COUNT3G5.DERATE;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH/3.5);
      IF V_AMOUNT<=0 THEN
        V_AMOUNT:=1;
      END IF;
        --获取申请表编号和技术资料表编号
      ApplyCode_Temp := Substr(V_COUNT3G5.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
      ApplyType_Temp := 'T';----申请表类型T或PA
      --
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '120300',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_BANDWIDTH :=0;
      --计算发射频点
      V_BANDWIDTH :=  V_BANDWIDTH+CEIL(nvl(V_COUNT3G5.CHAN_DIST,3.5));
      --空值则默认为一个单位
      V_DERATE := V_COUNT3G5.DERATE;
      --取出减免比例
      V_APPLYCODE:= V_COUNT3G5.APPLY_CODE;
      V_DECLCODE := V_COUNT3G5.DECL_CODE;
      V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
      V_FLAG := 'N';
      V_AMOUNT := 0;
      X_Count_ENTER3G5 :=X_Count_ENTER3G5+1;
      if  X_Count_ENTER3G5 =V_Count_ENTER3G5 then
          ---记录累加
          v_deptpay:= V_COUNT3G5.dept_pay;
          v_areacode:= V_COUNT3G5.area_code;
          V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
          V_BANDWIDTH := CEIL(nvl(V_COUNT3G5.CHAN_DIST,1));

          --空值则默认为一个单位
          V_DERATE := V_COUNT3G5.DERATE;
          V_AMOUNT := CEIL(V_BANDWIDTH);
          IF NVL(V_AMOUNT,0)<=0 THEN
            V_AMOUNT:=1;
          END IF;
          --
          --获取申请表编号和技术资料表编号
          ApplyCode_Temp := Substr(V_COUNT3G5.APPLY_CODE,-12,12);----申请表编号转化后的（T500020150005转化为500020150005）
          ApplyType_Temp := 'T';--substr(V_COUNT3G5.APPLY_CODE,0,length(V_COUNT3G5.APPLY_CODE)-12);----申请表类型T或PA
          DECL_CODE_Temp := V_COUNT3G5.DECL_CODE;---技术资料表编号
          --
          INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        ApplyCode_Temp,
                        DECL_CODE_Temp,
                        COUNTYEAR,
                        '120300',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        ApplyType_Temp);
          --
      end if;
      --
    END IF;
     ---记录累加
    V_APPLYCODE := V_COUNT3G5.APPLY_CODE;
    V_DECLCODE := V_COUNT3G5.DECL_CODE;
    v_deptpay:= V_COUNT3G5.dept_pay;
    v_areacode:= V_COUNT3G5.area_code;
    V_FREQEMIT:= V_COUNT3G5.FREQ_EMIT;
    --
  END LOOP;
  CLOSE  C_COUNT3G5;
  IF V_FLAG = 'Y' THEN
   --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH/4);
    IF V_AMOUNT<=0 THEN
      V_AMOUNT:=1;
    END IF;
    ApplyType_Temp := 'T';--substr(V_COUNT3G5.APPLY_CODE,0,length(V_COUNT3G5.APPLY_CODE)-12);----申请表类型T或PA
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '120300',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  --无线接入系统(5.8GHZ)----暂时不计费
  --无线接入系统(5.8GHZ)计费'120400'
  V_FLAG := 'N';
  OPEN  C_COUNT5G82;
  LOOP
    FETCH  C_COUNT5G82 INTO V_COUNT5G82;
    EXIT WHEN  C_COUNT5G82%NOTFOUND;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_APPLYCODE:= V_COUNT5G82.APPLY_CODE;
      V_DECLCODE := V_COUNT5G82.DECL_CODE;
      V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
      V_BANDWIDTH := CEIL(nvl(V_COUNT5G82.CHAN_DIST,1));
       --空值则默认为一个单位
      V_DERATE := V_COUNT5G82.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='120400';
      --取出收费标准
    ELSIF V_APPLYCODE = V_COUNT5G82.APPLY_CODE AND V_DECLCODE = V_COUNT5G82.DECL_CODE THEN
    --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT5G82.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT5G82.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
    ELSE
       V_AMOUNT := CEIL(V_BANDWIDTH);
      IF V_AMOUNT<=0 THEN
        V_AMOUNT:=1;
      END IF;
       ApplyType_Temp := 'T';----申请表类型T或PA
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '120400',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        ApplyType_Temp);
      V_BANDWIDTH := nvl(V_COUNT5G82.CHAN_DIST,1);
      --空值则默认为一个单位
      V_DERATE := V_COUNT5G82.DERATE;
      --取出减免比例
      V_APPLYCODE:= V_COUNT5G82.APPLY_CODE;
      V_DECLCODE := V_COUNT5G82.DECL_CODE;
      V_FREQEMIT:= V_COUNT5G82.FREQ_EMIT;
    END IF;
  END LOOP;
  CLOSE  C_COUNT5G82;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF V_AMOUNT<=0 THEN
      V_AMOUNT:=1;
    END IF;
    ApplyType_Temp := 'T';--substr(V_COUNT3G5.APPLY_CODE,0,length(V_COUNT3G5.APPLY_CODE)-12);----申请表类型T或PA
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '120400',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      ApplyType_Temp);
  END IF;
  ----雷达站10G以下计费'910000'(按照微波站收费，重庆需求)
  V_FLAG := 'N';
  OPEN  C_COUNTR10GDOWN;
  LOOP
    FETCH  C_COUNTR10GDOWN INTO V_COUNTR10GDOWN;
    EXIT WHEN  C_COUNTR10GDOWN%NOTFOUND;

    IF V_FLAG = 'N' THEN
    --第一条记录
      V_APPLYCODE:= V_COUNTR10GDOWN.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
      V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
      V_BANDWIDTH := CEIL(nvl(V_COUNTR10GDOWN.CHAN_DIST,1));
       --空值则默认为一个单位
      V_DERATE := V_COUNTR10GDOWN.DERATE;
       --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='910000';
      --取出收费标准
    ELSIF V_APPLYCODE = V_COUNTR10GDOWN.APPLY_CODE AND V_DECLCODE = V_COUNTR10GDOWN.DECL_CODE THEN
    --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNTR10GDOWN.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNTR10GDOWN.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF V_AMOUNT<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '910000',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        'T');
      V_BANDWIDTH := nvl(V_COUNTR10GDOWN.CHAN_DIST,1);
       --空值则默认为一个单位
      V_DERATE := V_COUNTR10GDOWN.DERATE;
      --取出减免比例
      V_APPLYCODE:= V_COUNTR10GDOWN.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GDOWN.DECL_CODE;
      V_FREQEMIT:= V_COUNTR10GDOWN.FREQ_EMIT;
    END IF;
  END LOOP;
  CLOSE  C_COUNTR10GDOWN;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF V_AMOUNT<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '910000',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      'T');
  END IF;
  -----雷达站10G以上计费'920000'(按照微波站收费，重庆需求)
  V_FLAG := 'N';
  OPEN  C_COUNTR10GUP;
  LOOP
    FETCH  C_COUNTR10GUP INTO V_COUNTR10GUP;
    EXIT WHEN  C_COUNTR10GUP%NOTFOUND;

    IF V_FLAG = 'N' THEN
    --第一条记录
      V_APPLYCODE:= V_COUNTR10GUP.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GUP.DECL_CODE;
      V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
      V_BANDWIDTH := CEIL(nvl(V_COUNTR10GUP.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNTR10GUP.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='920000';
       --取出收费标准
    ELSIF V_APPLYCODE = V_COUNTR10GUP.APPLY_CODE AND V_DECLCODE = V_COUNTR10GUP.DECL_CODE THEN
    --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNTR10GUP.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNTR10GUP.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF V_AMOUNT<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '920000',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        'T');
      V_BANDWIDTH := nvl(V_COUNTR10GUP.CHAN_DIST,1);
      --空值则默认为一个单位
      V_DERATE := V_COUNTR10GUP.DERATE;
      --取出减免比例
      V_APPLYCODE:= V_COUNTR10GUP.APPLY_CODE;
      V_DECLCODE := V_COUNTR10GUP.DECL_CODE;
      V_FREQEMIT:= V_COUNTR10GUP.FREQ_EMIT;
    END IF;
  END LOOP;
  CLOSE  C_COUNTR10GUP;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF V_AMOUNT<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '920000',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      'T');
  END IF;
  --微波站10G以下计费'910000'
  V_FLAG := 'N';
  OPEN  C_COUNT10GDOWN;
  LOOP
    FETCH  C_COUNT10GDOWN INTO V_COUNT10GDOWN;
    EXIT WHEN  C_COUNT10GDOWN%NOTFOUND;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_APPLYCODE:= V_COUNT10GDOWN.APPLY_CODE;
      V_DECLCODE := V_COUNT10GDOWN.DECL_CODE;
      V_FREQEMIT:= V_COUNT10GDOWN.FREQ_EMIT;
      --V_BANDWIDTH := nvl(V_COUNT10GDOWN.CHAN_DIST,1);
       V_BANDWIDTH := CEIL(V_COUNT10GDOWN.CHAN_DIST);
       --空值则默认为一个单位
      V_DERATE := V_COUNT10GDOWN.DERATE;
       --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='910000';
      --取出收费标准
    ELSIF V_APPLYCODE = V_COUNT10GDOWN.APPLY_CODE AND V_DECLCODE = V_COUNT10GDOWN.DECL_CODE THEN

       V_BANDWIDTH := V_BANDWIDTH+CEIL(V_COUNT10GDOWN.CHAN_DIST);
       V_FREQEMIT:= V_COUNT10GDOWN.FREQ_EMIT;
       /*
       if V_FREQEMIT <> V_COUNT10GDOWN.FREQ_EMIT then
           V_BANDWIDTH := V_BANDWIDTH+CEIL(V_COUNT10GDOWN.CHAN_DIST);
           V_FREQEMIT:= V_COUNT10GDOWN.FREQ_EMIT;
       end if;
       */

    --同一个台站则带宽数据累计

      --if V_FREQEMIT <> V_COUNT10GDOWN.FREQ_EMIT then
       -- V_BANDWIDTH := V_BANDWIDTH+nvl(V_COUNT10GDOWN.CHAN_DIST,1);
         --V_BANDWIDTH := V_BANDWIDTH+CEIL(V_COUNT10GDOWN.CHAN_DIST);
        --V_FREQEMIT:= V_COUNT10GDOWN.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
     -- end if;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF V_AMOUNT<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '910000',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        'T');
      V_BANDWIDTH := nvl(V_COUNT10GDOWN.CHAN_DIST,1);
       --空值则默认为一个单位
      V_DERATE := V_COUNT10GDOWN.DERATE;
      --取出减免比例
      V_APPLYCODE:= V_COUNT10GDOWN.APPLY_CODE;
      V_DECLCODE := V_COUNT10GDOWN.DECL_CODE;
      V_FREQEMIT:= V_COUNT10GDOWN.FREQ_EMIT;
    END IF;
  END LOOP;
  CLOSE  C_COUNT10GDOWN;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF V_AMOUNT<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '910000',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      'T');
  END IF;
  ------微波站10G以上计费'920000'
  V_FLAG := 'N';
  OPEN  C_COUNT10GUP;
  LOOP
    FETCH  C_COUNT10GUP INTO V_COUNT10GUP;
    EXIT WHEN  C_COUNT10GUP%NOTFOUND;

    IF V_FLAG = 'N' THEN
    --第一条记录
      V_APPLYCODE:= V_COUNT10GUP.APPLY_CODE;
      V_DECLCODE := V_COUNT10GUP.DECL_CODE;
      V_FREQEMIT:= V_COUNT10GUP.FREQ_EMIT;
      V_BANDWIDTH := CEIL(nvl(V_COUNT10GUP.CHAN_DIST,1));
      --空值则默认为一个单位
      V_DERATE := V_COUNT10GUP.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='920000';
       --取出收费标准
    ELSIF V_APPLYCODE = V_COUNT10GUP.APPLY_CODE AND V_DECLCODE = V_COUNT10GUP.DECL_CODE THEN
    --同一个台站则带宽数据累计
      if V_FREQEMIT <> V_COUNT10GUP.FREQ_EMIT then
        V_BANDWIDTH := V_BANDWIDTH+CEIL(nvl(V_COUNT10GUP.CHAN_DIST,1));
        V_FREQEMIT:= V_COUNT10GUP.FREQ_EMIT;
      --带宽累加，空值则默认为一个单位
      end if;
    ELSE
      V_AMOUNT := CEIL(V_BANDWIDTH);
      IF V_AMOUNT<=0 THEN
        V_AMOUNT:=1;
      END IF;
      INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                      AREA_CODE,
                      APPLY_CODE,
                      decl_code,
                      COUNT_YEAR,
                      ITEM_CODE,
                      DERATE,
                      AMOUNT,
                      SUM_COUNT,
                      SUM_PAY,
                      APPLYTYPE)
                  VALUES (DEPTCODE,
                        areacode,
                        v_applycode,
                        v_declcode,
                        COUNTYEAR,
                        '920000',
                        V_DERATE,
                        V_AMOUNT,
                        V_AMOUNT*V_FEE,
                        V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                        'T');
      V_BANDWIDTH := nvl(V_COUNT10GUP.CHAN_DIST,1);
      --空值则默认为一个单位
      V_DERATE := V_COUNT10GUP.DERATE;
      --取出减免比例
      V_APPLYCODE:= V_COUNT10GUP.APPLY_CODE;
      V_DECLCODE := V_COUNT10GUP.DECL_CODE;
      V_FREQEMIT:= V_COUNT10GUP.FREQ_EMIT;
    END IF;
  END LOOP;
  CLOSE  C_COUNT10GUP;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
    V_AMOUNT := CEIL(V_BANDWIDTH);
    IF V_AMOUNT<=0 THEN
      V_AMOUNT:=1;
    END IF;
    INSERT INTO  T_RIM_RSM_PAY_DEPTITEM  (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode,
                      v_declcode,
                      COUNTYEAR,
                      '920000',
                      V_DERATE,
                      V_AMOUNT,
                      V_AMOUNT*V_FEE,
                      V_AMOUNT*V_FEE*(100-V_DERATE)/100,
                      'T');
  END IF;
  --地球站计费'100100'
  V_FLAG := 'N';
  OPEN  C_COUNTEARTH;
  LOOP
    FETCH  C_COUNTEARTH INTO V_COUNTEARTH;
    EXIT WHEN  C_COUNTEARTH%NOTFOUND;
    IF V_FLAG = 'N' THEN
    V_AMOUNT := CEIL(NVL(V_COUNTEARTH.ASSI_BAND,0));
    V_AMOUNT1:= CEIL(NVL(V_COUNTEARTH.ASSI_BAND,0));
    --记录累加
      v_applycode1 :=V_COUNTEARTH.apply_code;
      v_declcode1 :=V_COUNTEARTH.decl_code;
      V_DERATE := V_COUNTEARTH.DERATE;
      V_FLAG := 'Y';
      SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='100100';
    ELSIF v_applycode1=V_COUNTEARTH.apply_code and v_declcode1=V_COUNTEARTH.decl_code THEN
        --深圳地球站缴费按照发射必要带宽计费，如必要带宽0.8MHz，数量就是0.8
     V_AMOUNT := CEIL( NVL(V_COUNTEARTH.ASSI_BAND,0));
     V_AMOUNT1:=V_AMOUNT1+V_AMOUNT;
    SELECT FEE_PAY INTO V_FEE FROM rsbt_FEESTANDERD WHERE ITEM_CODE='100100';
   -- V_AMOUNT := CEIL(NVL(V_COUNTEARTH.ASSI_BAND,0)); --2013年以前计费的版本 地球站是以发射总带宽计费，且按取最大整数来算数量，函数CEIL
    IF V_AMOUNT<=0 THEN
       V_AMOUNT:=1;
       --V_AMOUNT:=0;
    END IF;
     ELSE
    INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode1,
                      v_declcode1,
                      COUNTYEAR,
                      '100100',
                      V_DERATE,
                      V_AMOUNT1,
                      V_AMOUNT1*V_FEE,
                      V_AMOUNT1*V_FEE*(100-V_DERATE)/100,
                      'T');
      V_AMOUNT :=  CEIL(NVL(V_COUNTEARTH.ASSI_BAND,0));
      V_AMOUNT1:=  CEIL(NVL(V_COUNTEARTH.ASSI_BAND,0));
      v_applycode1 :=V_COUNTEARTH.apply_code;
      v_declcode1 :=V_COUNTEARTH.decl_code;
       V_DERATE := V_COUNTEARTH.DERATE;
 end if;
  END LOOP;
  CLOSE  C_COUNTEARTH;
  IF V_FLAG = 'Y' THEN
  INSERT INTO T_RIM_RSM_PAY_DEPTITEM (DEPT_PAY,
                    AREA_CODE,
                    APPLY_CODE,
                    decl_code,
                    COUNT_YEAR,
                    ITEM_CODE,
                    DERATE,
                    AMOUNT,
                    SUM_COUNT,
                    SUM_PAY,
                    APPLYTYPE)
                VALUES (DEPTCODE,
                      areacode,
                      v_applycode1,
                      v_declcode1,
                      COUNTYEAR,
                      '100100',
                     V_DERATE,
                      V_AMOUNT1,
                      V_AMOUNT1*V_FEE,
                      V_AMOUNT1*V_FEE*(100-V_DERATE)/100,
                      'T');
  end if;
/*
  -----------------------设备检测费用-----------------------------------
   --无线寻呼系统(设备检测费)'112000' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTPB_EQUCHECK;
     LOOP
      FETCH C_COUNTPB_EQUCHECK INTO V_COUNTPB_EQUCHECK;
      EXIT WHEN C_COUNTPB_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='112000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTPB_EQUCHECK.APPLY_CODE,
                    V_COUNTPB_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTPB_EQUCHECK;
   END IF;
      --集群无线调度系统(设备检测费)'113000' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTJQ_EQUCHECK;
     LOOP
      FETCH C_COUNTJQ_EQUCHECK INTO V_COUNTJQ_EQUCHECK;
      EXIT WHEN C_COUNTJQ_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='113000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTJQ_EQUCHECK.APPLY_CODE,
                    V_COUNTJQ_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTJQ_EQUCHECK;
   END IF;
     --无绳电话(设备检测费)'114000' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTLINELESS_EQUCHECK;
     LOOP
      FETCH C_COUNTLINELESS_EQUCHECK INTO V_COUNTLINELESS_EQUCHECK;
      EXIT WHEN C_COUNTLINELESS_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='114000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTLINELESS_EQUCHECK.APPLY_CODE,
                    V_COUNTLINELESS_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);

     END LOOP;
   CLOSE C_COUNTLINELESS_EQUCHECK;
   END IF;
  --电视(设备检测费)'115000' /广东省 20130125
  IF  areacode='440300' THEN
   V_FLAG := 'N';
   OPEN C_COUNTBT_EQUCHECK;
     LOOP
      FETCH C_COUNTBT_EQUCHECK INTO V_COUNTBT_EQUCHECK;
      EXIT WHEN C_COUNTBT_EQUCHECK%NOTFOUND;
      IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode1 :=V_COUNTBT_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTBT_EQUCHECK.decl_code;
      V_FLAG := 'Y';
      V_ITEMCODE:='115000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      ELSIF v_applycode1=V_COUNTBT_EQUCHECK.apply_code and v_declcode1=V_COUNTBT_EQUCHECK.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      ELSE
          INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
      V_AMOUNT := 1;
      v_applycode1 :=V_COUNTBT_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTBT_EQUCHECK.decl_code;
    END IF;
     END LOOP;
   CLOSE C_COUNTBT_EQUCHECK;
    IF V_FLAG = 'Y' THEN
    INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
      END IF;
   END IF;
    --广播电台(设备检测费)'' /广东省 20130125
  IF  areacode='440300' THEN
   V_FLAG := 'N';
   OPEN C_COUNTBC_EQUCHECK;
     LOOP
      FETCH C_COUNTBC_EQUCHECK INTO V_COUNTBC_EQUCHECK;
      EXIT WHEN C_COUNTBC_EQUCHECK%NOTFOUND;
      IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode1 :=V_COUNTBC_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTBC_EQUCHECK.decl_code;
      V_FLAG := 'Y';
      V_ITEMCODE:='116000';
       SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      ELSIF v_applycode1=V_COUNTBC_EQUCHECK.apply_code and v_declcode1=V_COUNTBC_EQUCHECK.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      ELSE
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
      V_AMOUNT := 1;
      v_applycode1 :=V_COUNTBC_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTBC_EQUCHECK.decl_code;
      END IF;
     END LOOP;
   CLOSE C_COUNTBC_EQUCHECK;
    IF V_FLAG = 'Y' THEN
      INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
       END IF;
   END IF;
    --1000MHz以下的无线电台（固定台）'117000' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTOTHER_EQUCHECK;
     LOOP
      FETCH C_COUNTOTHER_EQUCHECK INTO V_COUNTOTHER_EQUCHECK;
      EXIT WHEN C_COUNTOTHER_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='117000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTOTHER_EQUCHECK.APPly_CODE,
                    V_COUNTOTHER_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTOTHER_EQUCHECK;
   END IF;
    --1000MHz以下的无线电台（移动台）'118000' /广东省 20130125
    IF  areacode='440300' THEN
   V_FLAG := 'N';
  OPEN C_COUNTMOBILE_EQUCHECK;
  LOOP
    FETCH C_COUNTMOBILE_EQUCHECK INTO V_COUNTMOBILE_EQUCHECK;
    EXIT WHEN C_COUNTMOBILE_EQUCHECK%NOTFOUND;
    IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode1 :=V_COUNTMOBILE_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTMOBILE_EQUCHECK.decl_code;
      V_FLAG := 'Y';
      --车载台收费代码111121，手持台或其它收费LS代码118000
      if V_COUNTMOBILE_EQUCHECK.Stat_Type='LC' THEN
      V_ITEMCODE:='111121';
      ELSE
      V_ITEMCODE:='118000';
      END IF;
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      --取出收费标准
    ELSIF v_applycode1=V_COUNTMOBILE_EQUCHECK.apply_code and v_declcode1=V_COUNTMOBILE_EQUCHECK.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
        if V_COUNTMOBILE_EQUCHECK.Stat_Type='LC' THEN
      V_ITEMCODE:='111121';
      ELSE
      V_ITEMCODE:='118000';
      END IF;
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
    ELSE
       INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
      V_AMOUNT := 1;
      v_applycode1 :=V_COUNTMOBILE_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNTMOBILE_EQUCHECK.decl_code;
    END IF;
  END LOOP;
  CLOSE C_COUNTMOBILE_EQUCHECK;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
   INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
  END IF;
 END IF;
  --微波站计费(设备检测费)'' /广东省 20130125
  IF  areacode='440300' THEN
  V_FLAG := 'N';
   OPEN C_COUNT10G_EQUCHECK;
     LOOP
      FETCH C_COUNT10G_EQUCHECK INTO V_COUNT10G_EQUCHECK;
      EXIT WHEN C_COUNT10G_EQUCHECK%NOTFOUND;
       IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode1 :=V_COUNT10G_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNT10G_EQUCHECK.decl_code;
      V_FLAG := 'Y';
      V_ITEMCODE:='119000';
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      ELSIF v_applycode1=V_COUNT10G_EQUCHECK.apply_code and v_declcode1=V_COUNT10G_EQUCHECK.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
        ELSE
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                   v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_AMOUNT*V_FEE);
                     V_AMOUNT := 1;
      v_applycode1 :=V_COUNT10G_EQUCHECK.apply_code;
      v_declcode1 :=V_COUNT10G_EQUCHECK.decl_code;
      END IF;
     END LOOP;
   CLOSE C_COUNT10G_EQUCHECK;
    IF V_FLAG = 'Y' THEN
      INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                   v_applycode1,
                    v_declcode1,
                    V_AMOUNT,
                    V_AMOUNT*V_FEE);
    END IF;
   END IF;
     --MMDS计费(设备检测费)'111200' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTMMDS_EQUCHECK;
     LOOP
      FETCH C_COUNTMMDS_EQUCHECK INTO V_COUNTMMDS_EQUCHECK;
      EXIT WHEN C_COUNTMMDS_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111200';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTMMDS_EQUCHECK.Apply_Code,
                    V_COUNTMMDS_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTMMDS_EQUCHECK;
   END IF;
  --地球站计费(设备检测费)'' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTEARTH_EQUCHECK;
     LOOP
      FETCH C_COUNTEARTH_EQUCHECK INTO V_COUNTEARTH_EQUCHECK;
      EXIT WHEN C_COUNTEARTH_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111300';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTEARTH_EQUCHECK.Apply_Code,
                    V_COUNTEARTH_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTEARTH_EQUCHECK;
   END IF;
  --无线接入系统（1.8GHz-1.9GHz）(设备检测费)'111400' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNT1G8_EQUCHECK;
     LOOP
      FETCH C_COUNT1G8_EQUCHECK INTO V_COUNT1G8_EQUCHECK;
      EXIT WHEN C_COUNT1G8_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111400';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNT1G8_EQUCHECK.Apply_Code,
                    V_COUNT1G8_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNT1G8_EQUCHECK;
   END IF;
    --扩频系统（2.4GHz）(设备检测费)'111500' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNT2G4_EQUCHECK;
     LOOP
      FETCH C_COUNT2G4_EQUCHECK INTO V_COUNT2G4_EQUCHECK;
      EXIT WHEN C_COUNT2G4_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111500';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNT2G4_EQUCHECK.Apply_Code,
                    V_COUNT2G4_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNT2G4_EQUCHECK;
   END IF;
     --扩频系统（5.8GHz）(设备检测费)'111600' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNT5G81_EQUCHECK;
     LOOP
      FETCH C_COUNT5G81_EQUCHECK INTO V_COUNT5G81_EQUCHECK;
      EXIT WHEN C_COUNT5G81_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111600';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNT5G81_EQUCHECK.Apply_Code,
                    V_COUNT5G81_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNT5G81_EQUCHECK;
   END IF;
  --无线数据(设备检测费)'111700' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTDATA_EQUCHECK;
     LOOP
      FETCH C_COUNTDATA_EQUCHECK INTO V_COUNTDATA_EQUCHECK;
      EXIT WHEN C_COUNTDATA_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111700';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTDATA_EQUCHECK.APPLY_CODE,
                    V_COUNTDATA_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTDATA_EQUCHECK;
   END IF;
    --GSM(设备检测费)'111800' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTGSM_EQUCHECK;
     LOOP
      FETCH C_COUNTGSM_EQUCHECK INTO V_COUNTGSM_EQUCHECK;
      EXIT WHEN C_COUNTGSM_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111800';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTGSM_EQUCHECK.APPLY_CODE,
                    V_COUNTGSM_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTGSM_EQUCHECK;
   END IF;
       --CDMA(设备检测费)'111800' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTCDMA_EQUCHECK;
     LOOP
      FETCH C_COUNTCDMA_EQUCHECK INTO V_COUNTCDMA_EQUCHECK;
      EXIT WHEN C_COUNTCDMA_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111800';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTCDMA_EQUCHECK.APPLY_CODE,
                    V_COUNTCDMA_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTCDMA_EQUCHECK;
   END IF;
          --WCDMS(设备检测费)'111800' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTWCDMA_EQUCHECK;
     LOOP
      FETCH C_COUNTWCDMA_EQUCHECK INTO V_COUNTWCDMA_EQUCHECK;
      EXIT WHEN C_COUNTWCDMA_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111800';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTWCDMA_EQUCHECK.APPLY_CODE,
                    V_COUNTWCDMA_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTWCDMA_EQUCHECK;
   END IF;
             --TDSCDMS(设备检测费)'111800' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTTDSCDMA_EQUCHECK;
     LOOP
      FETCH C_COUNTTDSCDMA_EQUCHECK INTO V_COUNTTDSCDMA_EQUCHECK;
      EXIT WHEN C_COUNTTDSCDMA_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111800';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUCHECKITEM(dept_pay,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTTDSCDMA_EQUCHECK.APPLY_CODE,
                    V_COUNTTDSCDMA_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTTDSCDMA_EQUCHECK;
   END IF;
  --------------------------------------------------------------------
  */
  COMMIT;
END;

/

-- ----------------------------
-- Procedure structure for P_RIM_RSM_FEEITEM_EQUAPP_PA
-- ----------------------------
CREATE OR REPLACE PROCEDURE "RXDEV"."P_RIM_RSM_FEEITEM_EQUAPP_PA"(COUNTYEAR NUMBER,APPLYCODE varchar2)
IS
--------设备检测费----------------------------------------------------

 --寻呼系统(设备检测费)'112000' /广东省 20130125
  CURSOR C_COUNTPB_EQUCHECK IS SELECT  * FROM v_rim_rsm_fee_EQUCHECK_pb_PA
              WHERE apply_code=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTPB_EQUCHECK C_COUNTPB_EQUCHECK%ROWTYPE;
    --地球站(设备检测费)'111300' /广东省 20130125
  CURSOR C_COUNTEARTH_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_e_PA
              WHERE apply_code=APPLYCODE
                AND begin_YEAR=COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTEARTH_EQUCHECK  C_COUNTEARTH_EQUCHECK%ROWTYPE;
   --其它固定台(设备检测费)'117000'/广东省 20130125
  CURSOR C_COUNTOTHER_EQUCHECK IS SELECT * FROM V_RIM_RSM_FEE_EQUC_OTHER_PA
              WHERE apply_code=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTOTHER_EQUCHECK C_COUNTOTHER_EQUCHECK%ROWTYPE;
   --移动台(设备检测费)'118000'/广东省 20130125
  CURSOR C_COUNTMOBILE_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equc_mobile_PA
                WHERE apply_code=APPLYCODE
                AND begin_YEAR=COUNTYEAR;
  V_COUNTMOBILE_EQUCHECK C_COUNTMOBILE_EQUCHECK%ROWTYPE;

------------------------------------------------------------------------

   V_AREACODE1 VARCHAR2(6);
  V_APPLYCODE1 VARCHAR2(14);
  --申请表编号
  V_DECLCODE VARCHAR2(6);
   --技术资料表编号
  V_AMOUNT NUMBER;
  --数量
  V_FEE NUMBER;
   --无绳电话的收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
BEGIN
  DELETE FROM T_RIM_RSM_PAY_EQUPA_APPLYITEM WHERE apply_code=APPLYCODE  AND COUNT_YEAR=COUNTYEAR;
 V_AREACODE1:=SUBSTR(substr(substr(APPLYCODE,-12,12),0,4),1,4)||'00';
  -----------------------设备检测费用-----------------------------------
   --无线寻呼系统(设备检测费)'112000' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTPB_EQUCHECK;
     LOOP
      FETCH C_COUNTPB_EQUCHECK INTO V_COUNTPB_EQUCHECK;
      EXIT WHEN C_COUNTPB_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='112000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUPA_APPLYITEM(IDENTIFICATION_CARD,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTPB_EQUCHECK.Id_Card,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTPB_EQUCHECK.APPLY_CODE,
                    V_COUNTPB_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTPB_EQUCHECK;
   END IF;
    --1000MHz以下的无线电台（固定台）'117000' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTOTHER_EQUCHECK;
     LOOP
      FETCH C_COUNTOTHER_EQUCHECK INTO V_COUNTOTHER_EQUCHECK;
      EXIT WHEN C_COUNTOTHER_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='117000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUPA_APPLYITEM(IDENTIFICATION_CARD,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTOTHER_EQUCHECK.Id_Card,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTOTHER_EQUCHECK.APPly_CODE,
                    V_COUNTOTHER_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTOTHER_EQUCHECK;
   END IF;
    --1000MHz以下的无线电台（移动台）'118000' /广东省 20130125
    IF  V_AREACODE1='440300' THEN
   V_FLAG := 'N';
  OPEN C_COUNTMOBILE_EQUCHECK;
  LOOP
    FETCH C_COUNTMOBILE_EQUCHECK INTO V_COUNTMOBILE_EQUCHECK;
    EXIT WHEN C_COUNTMOBILE_EQUCHECK%NOTFOUND;

    IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode1 :=V_COUNTMOBILE_EQUCHECK.apply_code;
      v_declcode :=V_COUNTMOBILE_EQUCHECK.decl_code;
      --V_DERATE := V_COUNTMOBILE.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
       --车载台或其它收费LC收费代码111121，手持台LS代码118000
      if V_COUNTMOBILE_EQUCHECK.Stat_Type='LS' THEN
      V_ITEMCODE:='118000';
      ELSE
      V_ITEMCODE:='111121';
      END IF;
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      --取出收费标准
    ELSIF v_applycode1=V_COUNTMOBILE_EQUCHECK.apply_code and v_declcode=V_COUNTMOBILE_EQUCHECK.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
       if V_COUNTMOBILE_EQUCHECK.Stat_Type='LS' THEN
      V_ITEMCODE:='118000';
      ELSE
      V_ITEMCODE:='111121';
      END IF;
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
    ELSE
       INSERT INTO T_RIM_RSM_PAY_EQUPA_APPLYITEM(IDENTIFICATION_CARD,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTMOBILE_EQUCHECK.Id_Card,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                   v_declcode,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
      V_AMOUNT := 1;
      v_applycode1 :=V_COUNTMOBILE_EQUCHECK.apply_code;
      v_declcode :=V_COUNTMOBILE_EQUCHECK.decl_code;
      --V_DERATE := V_COUNTMOBILE.DERATE;
      --取出减免比例
    END IF;
  END LOOP;
  CLOSE C_COUNTMOBILE_EQUCHECK;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
   INSERT INTO T_RIM_RSM_PAY_EQUPA_APPLYITEM(IDENTIFICATION_CARD,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTMOBILE_EQUCHECK.Id_Card,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                     v_applycode1,
                   v_declcode,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
  END IF;
 END IF;
  --地球站计费(设备检测费)'' /广东省 20130125
  IF  V_AREACODE1='440300' THEN
   OPEN C_COUNTEARTH_EQUCHECK;
     LOOP
      FETCH C_COUNTEARTH_EQUCHECK INTO V_COUNTEARTH_EQUCHECK;
      EXIT WHEN C_COUNTEARTH_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111300';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUPA_APPLYITEM(IDENTIFICATION_CARD,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (V_COUNTEARTH_EQUCHECK.Id_Card,
                    V_AREACODE1,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTEARTH_EQUCHECK.Apply_Code,
                    V_COUNTEARTH_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTEARTH_EQUCHECK;
   END IF;
----------------------------------------------------------
  COMMIT;
END;

/

-- ----------------------------
-- Procedure structure for P_RIM_RSM_FEEITEM_EQUDEPT_PA
-- ----------------------------
CREATE OR REPLACE PROCEDURE "RXDEV"."P_RIM_RSM_FEEITEM_EQUDEPT_PA"(COUNTYEAR NUMBER,DEPTCODE varchar2,areacode varchar2)
IS
--------设备检测费----------------------------------------------------

 --寻呼系统(设备检测费)'112000' /广东省 20130125
  CURSOR C_COUNTPB_EQUCHECK IS SELECT  * FROM v_rim_rsm_fee_EQUCHECK_pb_PA
              WHERE id_card=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTPB_EQUCHECK C_COUNTPB_EQUCHECK%ROWTYPE;
    --地球站(设备检测费)'111300' /广东省 20130125
  CURSOR C_COUNTEARTH_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equcheck_e_PA
              WHERE id_card=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTEARTH_EQUCHECK  C_COUNTEARTH_EQUCHECK%ROWTYPE;
   --其它固定台(设备检测费)'117000'/广东省 20130125
  CURSOR C_COUNTOTHER_EQUCHECK IS SELECT * FROM V_RIM_RSM_FEE_EQUC_OTHER_PA
              WHERE id_card=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR;
  V_COUNTOTHER_EQUCHECK C_COUNTOTHER_EQUCHECK%ROWTYPE;
   --移动台(设备检测费)'118000'/广东省 20130125
  CURSOR C_COUNTMOBILE_EQUCHECK IS SELECT * FROM v_rim_rsm_fee_equc_mobile_PA
              WHERE id_card=DEPTCODE
                AND area_code=areacode
                AND begin_YEAR<COUNTYEAR
              ORDER BY apply_code,decl_code;
  V_COUNTMOBILE_EQUCHECK C_COUNTMOBILE_EQUCHECK%ROWTYPE;
-----------------------------------------------------------------------
  V_APPLYCODE1 VARCHAR2(14);
  --申请表编号
  V_DECLCODE VARCHAR2(6);
   --技术资料表编号
  V_AMOUNT NUMBER;
  --数量
  V_FEE NUMBER;
   --无绳电话的收费标准
  V_ITEMCODE VARCHAR2(10);
  V_FLAG VARCHAR2(1);
BEGIN
  DELETE FROM T_RIM_RSM_PAY_EQUPADEPTITEM WHERE IDENTIFICATION_CARD=DEPTCODE and area_code=areacode AND COUNT_YEAR=COUNTYEAR;
  -----------------------设备检测费用-----------------------------------
   --无线寻呼系统(设备检测费)'112000' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTPB_EQUCHECK;
     LOOP
      FETCH C_COUNTPB_EQUCHECK INTO V_COUNTPB_EQUCHECK;
      EXIT WHEN C_COUNTPB_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='112000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUPADEPTITEM(IDENTIFICATION_CARD,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTPB_EQUCHECK.APPLY_CODE,
                    V_COUNTPB_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTPB_EQUCHECK;
   END IF;
    --1000MHz以下的无线电台（固定台）'117000' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTOTHER_EQUCHECK;
     LOOP
      FETCH C_COUNTOTHER_EQUCHECK INTO V_COUNTOTHER_EQUCHECK;
      EXIT WHEN C_COUNTOTHER_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='117000';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUPADEPTITEM(IDENTIFICATION_CARD,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTOTHER_EQUCHECK.APPly_CODE,
                    V_COUNTOTHER_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTOTHER_EQUCHECK;
   END IF;
    --1000MHz以下的无线电台（移动台）'118000' /广东省 20130125
    IF  areacode='440300' THEN
   V_FLAG := 'N';
  OPEN C_COUNTMOBILE_EQUCHECK;
  LOOP
    FETCH C_COUNTMOBILE_EQUCHECK INTO V_COUNTMOBILE_EQUCHECK;
    EXIT WHEN C_COUNTMOBILE_EQUCHECK%NOTFOUND;

    IF V_FLAG = 'N' THEN
    --第一条记录
      V_AMOUNT := 1;
       --记录累加
      v_applycode1 :=V_COUNTMOBILE_EQUCHECK.apply_code;
      v_declcode :=V_COUNTMOBILE_EQUCHECK.decl_code;
      --V_DERATE := V_COUNTMOBILE.DERATE;
      --取出减免比例
      V_FLAG := 'Y';
       --车载台或其它收费LC收费代码111121，手持台LS代码118000
      if V_COUNTMOBILE_EQUCHECK.Stat_Type='LS' THEN
      V_ITEMCODE:='118000';
      ELSE
      V_ITEMCODE:='111121';
      END IF;
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
      --取出收费标准
    ELSIF v_applycode1=V_COUNTMOBILE_EQUCHECK.apply_code and v_declcode=V_COUNTMOBILE_EQUCHECK.decl_code THEN
      V_AMOUNT := V_AMOUNT+1;
      if V_COUNTMOBILE_EQUCHECK.Stat_Type='LS' THEN
      V_ITEMCODE:='118000';
      ELSE
      V_ITEMCODE:='111121';
      END IF;
      SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
    ELSE
       INSERT INTO T_RIM_RSM_PAY_EQUPADEPTITEM(IDENTIFICATION_CARD,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                   v_applycode1,
                   v_declcode,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
      V_AMOUNT := 1;
      v_applycode1 :=V_COUNTMOBILE_EQUCHECK.apply_code;
      v_declcode :=V_COUNTMOBILE_EQUCHECK.decl_code;
      --V_DERATE := V_COUNTMOBILE.DERATE;
      --取出减免比例
    END IF;
  END LOOP;
  CLOSE C_COUNTMOBILE_EQUCHECK;
  IF V_FLAG = 'Y' THEN
  --存在需要添加的记录结果
   INSERT INTO T_RIM_RSM_PAY_EQUPADEPTITEM(IDENTIFICATION_CARD,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    v_applycode1,
                   v_declcode,
                    V_AMOUNT,
                    V_FEE*V_AMOUNT);
  END IF;
 END IF;
  --地球站计费(设备检测费)'' /广东省 20130125
  IF  areacode='440300' THEN
   OPEN C_COUNTEARTH_EQUCHECK;
     LOOP
      FETCH C_COUNTEARTH_EQUCHECK INTO V_COUNTEARTH_EQUCHECK;
      EXIT WHEN C_COUNTEARTH_EQUCHECK%NOTFOUND;
      V_ITEMCODE:='111300';
        SELECT FEE_PAY INTO V_FEE FROM t_rim_rsm_pay_equcheckstandard WHERE ITEM_CODE=V_ITEMCODE;
           INSERT INTO T_RIM_RSM_PAY_EQUPADEPTITEM(IDENTIFICATION_CARD,
                    area_code,
                    count_year,
                    item_code,
                    APPLY_CODE,
                    DECL_CODE,
                    amount,
                    sum_pay)
                VALUES (DEPTCODE,
                    areacode,
                    COUNTYEAR,
                    V_ITEMCODE,
                    V_COUNTEARTH_EQUCHECK.Apply_Code,
                    V_COUNTEARTH_EQUCHECK.DECL_CODE,
                    1,
                    V_FEE);
     END LOOP;
   CLOSE C_COUNTEARTH_EQUCHECK;
   END IF;
----------------------------------------------------------
  COMMIT;
END;

/

-- ----------------------------
-- Procedure structure for P_RIM_RSM_MVIEW_REFRESH
-- ----------------------------
CREATE OR REPLACE PROCEDURE "RXDEV"."P_RIM_RSM_MVIEW_REFRESH"(ASSESSOR varchar)
IS
v_guid varchar2(36);
BEGIN
   v_guid:=sys_guid();
   insert into T_RIM_RSM_MVIEW_REFRESH_LOG (guid,Status,START_DATE,END_DATE,ASSESSOR) values(v_guid,'0',sysdate,sysdate,ASSESSOR);
   commit;
   dbms_mview.refresh('mv_rim_rsm_stat_view','C');
   dbms_mview.refresh('mv_rim_rsm_stat_freq_view','C');
   dbms_mview.refresh('mv_rim_rsm_stat_equ_view','C');
   dbms_mview.refresh('mv_rim_rsm_stat_ant_view','C');
   dbms_mview.refresh('mv_rim_rsm_stat_freq_equ_view','C');
   dbms_mview.refresh('mv_rim_rsm_stat_freq_ant_view','C');
   dbms_mview.refresh('mv_rim_rsm_stat_equ_ant_view','C');
   dbms_mview.refresh('mv_rim_rsm_stat_efa_view','C');
   update T_RIM_RSM_MVIEW_REFRESH_LOG set Status='1',end_date=sysdate where guid=v_guid;
   commit;
   exception when others then
   update T_RIM_RSM_MVIEW_REFRESH_LOG set Status='1',end_date=sysdate where guid=v_guid;
   commit;
END;

/

-- ----------------------------
-- Procedure structure for P_RIM_RSM_RECREATELINK
-- ----------------------------
CREATE OR REPLACE PROCEDURE "RXDEV"."P_RIM_RSM_RECREATELINK"
IS
   v_tf_code varchar2(100);
   v_to_tf_code varchar2(100);
   v_net_guid varchar2(36);
   v_stat_guid_a varchar2(36);
   v_stat_guid_b varchar2(36);
   v_eaf_guid_a varchar2(36);
   v_eaf_guid_b varchar2(36);
   v_ant_guid varchar2(36);
   v_eaf_a_count number;
   v_eaf_b_count number;

   v_max_link number;
   v_min_link number;
   v_cLink number;
   v_linkIndex number;
   v_to_linkIndex number;

   v_freq_a  number;
   v_freq_b number;

   v_ant_count number;
   loopCount number;
   v_temp varchar2(36);

   CURSOR c_stat IS
          select guid,stat_app_type from rsbt_station t
          where --t.app_code='T500020120061' and stat_tdi='0049' and --t.guid='10188a40-6afd-4e03-95d8-8e013360c3f6' and --stat_tdi='0001' and
          t.stat_app_type ='TF' ;
   v_stat c_stat%ROWTYPE;
BEGIN
  OPEN c_stat;
  LOOP
    FETCH  c_stat INTO v_stat;
    EXIT WHEN c_stat%NOTFOUND;
       delete from rsbt_link l where l.station_guid_a=v_stat.guid or l.station_guid_b=v_stat.guid; --删除原链路
       select st.st_tf_code into v_tf_code from rsbt_station_t st where st.guid=v_stat.guid; --查找台站的站代号
       select s.guid into v_net_guid from rsbt_station s where s.guid=v_stat.guid;--查找通信网guid

       select count(0) into v_ant_count from rsbt_antfeed ant where ant.station_guid=v_stat.guid; --获取天线总数
       loopCount:=1;
       while loopCount<=v_ant_count loop
              select guid,at_ant_tfcode  into v_ant_guid, v_to_tf_code from (select rownum num,a.guid,ant.at_ant_tfcode from rsbt_antfeed a,rsbt_antfeed_t ant
                where a.guid=ant.guid and a.station_guid=v_stat.guid order by num)  where num=loopCount;
              --台站本身的索引数据
              select count(0) into v_eaf_a_count from rsbt_eaf eaf where eaf.ant_guid= v_ant_guid;

              --与通信对象通信的索引总数
              select count(a.guid) into v_eaf_b_count from rsbt_eaf a,rsbt_station b ,rsbt_freq c ,rsbt_freq_t d ,rsbt_station_t e
                     where a.station_guid=b.guid and a.freq_guid=c.guid and c.station_guid=b.guid and c.guid=d.guid and b.guid=e.guid
                           and d.ft_freq_tfcode is not null
                           and instr(','||trim(both ',' from d.ft_freq_tfcode)||',',','||v_tf_code||',')>0
                           and instr(','||v_to_tf_code||',',','||trim(both ',' from e.st_tf_code)||',')>0;

               EXIT WHEN v_eaf_b_count=0;--没有就找通信对象的索引数据就退出

               v_max_link:= v_eaf_a_count;
               if v_eaf_b_count>v_max_link then
                  v_max_link:=v_eaf_b_count;
               end if;
               v_min_link :=v_eaf_a_count;
               if v_eaf_b_count<v_min_link then
                  v_min_link:=v_eaf_b_count;
               end if;
               v_cLink:=1;
               v_linkIndex:=1;
               v_to_linkIndex:=1;
               while v_cLink<=v_max_link loop
                  if v_cLink <= v_min_link then
                        v_linkIndex := v_cLink;
                        v_to_linkIndex := v_cLink;
                    else
                        if v_eaf_a_count > v_eaf_b_count then
                            v_linkIndex := v_cLink;
                        else
                            v_to_linkIndex := v_cLink;
                        end if;
                    end if;
                    --台站本身的索引数据
                    select  guid ,station_guid,freq_efb into v_eaf_guid_a, v_stat_guid_a,v_freq_a  from (
                     select rownum num,eaf.guid,eaf.station_guid ,decode(f.freq_type,'0',f.freq_uc,'1',f.freq_efb) freq_efb from rsbt_eaf eaf ,rsbt_freq f
                            where eaf.freq_guid=f.guid and  eaf.ant_guid= v_ant_guid
                             order by rownum ) where num=v_linkIndex;

                    --与通信对象通信的索引数据
                    select guid ,station_guid , freq_efb into v_eaf_guid_b,v_stat_guid_b,v_freq_b   from (
                       select rownum num,a.guid ,a.station_guid,decode(c.freq_type,'0',c.freq_uc,'1',c.freq_efb)  freq_efb from rsbt_eaf a,rsbt_station b ,rsbt_freq c ,rsbt_freq_t d ,rsbt_station_t e
                          where a.station_guid=b.guid and a.freq_guid=c.guid and c.station_guid=b.guid and c.guid=d.guid and b.guid=e.guid
                            and d.ft_freq_tfcode is not null
                            and instr(','||trim(both ',' from d.ft_freq_tfcode)||',',','||v_tf_code||',')>0
                            and instr(','||v_to_tf_code||',',','||trim(both ',' from e.st_tf_code)||',')>0
                            order by rownum ) where num=v_to_linkIndex;

                    --如果频率B大于频率A，则台站A和台站B互换
                    if (v_freq_a < v_freq_b) then
                        v_temp:=v_stat_guid_a;
                        v_stat_guid_a:=  v_stat_guid_b;
                        v_stat_guid_b:=v_temp;

                        v_temp :=v_eaf_guid_a;
                        v_eaf_guid_a:=v_eaf_guid_b;
                        v_eaf_guid_b:=v_temp;
                    end if;
                    --插入到链路表
                    insert into rsbt_link (guid,net_guid_a,station_guid_a,guid_eaf_a,net_guid_b,station_guid_b,guid_eaf_b)
                           values(get_guid,v_net_guid,v_stat_guid_a,v_eaf_guid_a,v_net_guid,v_stat_guid_b,v_eaf_guid_b);

                     v_cLink:=v_cLink+1;
               end loop;

             loopCount:=loopCount+1;
       end loop;

    end loop;
    commit;
  CLOSE c_stat;
  exception when others then
            --insert into recreateLink_errorlog values(v_stat.guid);
            commit;
END;

/

-- ----------------------------
-- Function structure for F_AILDM_GET_GUID
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_AILDM_GET_GUID"
    RETURN CHAR
IS
    v_guid              CHAR (36);
    v_guid_part_one     CHAR (8);
    v_guid_part_two     CHAR (4);
    v_guid_part_three   CHAR (4);
    v_guid_part_four    CHAR (4);
    v_guid_part_five    CHAR (12);
    --在Oracle中使用Guid
BEGIN
    SELECT SYS_GUID () INTO v_guid FROM DUAL;

    v_guid_part_one := SUBSTR (v_guid, 0, 8);
    v_guid_part_two := SUBSTR (v_guid, 8, 4);
    v_guid_part_three := SUBSTR (v_guid, 12, 4);
    v_guid_part_four := SUBSTR (v_guid, 16, 4);
    v_guid_part_five := SUBSTR (v_guid, 20, 12);
    v_guid :=
    CONCAT
    (CONCAT
     (CONCAT
      (CONCAT (CONCAT (CONCAT (CONCAT (CONCAT (v_guid_part_one,
                 '-'),
               v_guid_part_two
              ),
             '-'
            ),
           v_guid_part_three
          ),
         '-'
        ),
       v_guid_part_four
      ),
      '-'
     ),
     v_guid_part_five
    );
    RETURN (v_guid);
END F_AILDM_GET_GUID;

/

-- ----------------------------
-- Function structure for F_ANGLE2RADIAN
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_ANGLE2RADIAN"(d in number) return number is
 PI number :=3.141592653589793;
begin
return  d* PI/180.0;
end;

/

-- ----------------------------
-- Function structure for F_CONVERTDEFAULTDATE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_CONVERTDEFAULTDATE"(p_name in date) return date is
  v_Result date;
begin
  v_Result := p_name;
  if p_name = to_date('0001/01/01', 'yyyy/mm/dd') then
    v_Result := null;
  end if;
  return(v_Result);
end;

/

-- ----------------------------
-- Function structure for F_FORMATTOLONGTHDATE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_FORMATTOLONGTHDATE"(inDate in date) return varchar2 is
  OutDate varchar2(20);
begin
  OutDate := to_char(inDate, 'YYYY-MM-DD HH24:MI:SS');
  return(OutDate);
end;

/

-- ----------------------------
-- Function structure for F_FORMATTOSHORTDATE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_FORMATTOSHORTDATE"(inDate in date) return varchar2 is
  OutDate varchar2(20);
begin
  OutDate := to_char(inDate, 'YYYY-MM-DD');
  return(OutDate);
end;

/

-- ----------------------------
-- Function structure for F_GETDISTANCE
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_GETDISTANCE" (
   lat1 in  NUMBER,
   lng1  in NUMBER,
   lat2  in NUMBER,
   lng2  in NUMBER
)
   RETURN NUMBER
is
   earth_padius   NUMBER := 6378.137;
   radlat1        NUMBER := f_angle2Radian (lat1);
   radlat2        NUMBER := f_angle2Radian (lat2);
   a              NUMBER := radlat1 - radlat2;
   b              NUMBER := f_angle2Radian (lng1) - f_angle2Radian (lng2);
   s              NUMBER := 0;
BEGIN
   s :=
        2
      * ASIN (SQRT (  POWER (SIN (a / 2), 2)
                    + COS (radlat1) * COS (radlat2) * POWER (SIN (b / 2), 2)
                   )
             );
   s := s * earth_padius;
   s := ROUND (s * 10000) / 10000;
   RETURN s;
END;

/

-- ----------------------------
-- Function structure for F_GETFREQ
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_GETFREQ"(statGuid  VARCHAR2) return varchar2
is
 V_RET_CODE VARCHAR2(1000);
 v_freq_e varchar2(400);
 v_freq_r varchar2(400);
 CURSOR C_code IS select t.freq_type,t.freq_uc,t.freq_efb,t.freq_efe,
  t.freq_lc,t.freq_rfb,t.freq_rfe
   from RSBT_FREQ t where t.Station_Guid=statGuid;

  V_CODE C_code%ROWTYPE;
BEGIN
  V_RET_CODE:='';
  OPEN C_code;
     LOOP
       FETCH C_code INTO V_CODE;
       EXIT WHEN C_code%NOTFOUND;
         if V_CODE.FREQ_TYPE=0 then
            if nvl(V_CODE.FREQ_UC,'0')<>'0'and instr(','||v_freq_e||',',','||to_char(V_CODE.FREQ_UC,'FM999999990.0999')||',')<=0 then
               v_freq_e:=v_freq_e||','||to_char(V_CODE.FREQ_UC,'FM999999990.0999');
            end if;
            if nvl(V_CODE.FREQ_LC,'0')<>'0'and instr(','||v_freq_r||',',','||to_char(V_CODE.FREQ_LC,'FM999999990.0999')||',')<=0 then
               v_freq_r:=v_freq_r||','||to_char(V_CODE.FREQ_LC,'FM999999990.0999');
            end if;
         else
            if nvl(V_CODE.Freq_Efb,'0')<>'0'and instr(','||v_freq_e||',',','||to_char(V_CODE.Freq_Efb,'FM999999990.0999')||'-'||to_char(V_CODE.Freq_Efe,'FM999999990.0999')||',')<=0 then
               v_freq_e:=v_freq_e||','||to_char(V_CODE.Freq_Efb,'FM999999990.0999')||'-'||to_char(V_CODE.Freq_Efe,'FM999999990.0999');
            end if;
            if nvl(V_CODE.Freq_Rfb,'0')<>'0'and instr(','||v_freq_r||',',','||to_char(V_CODE.Freq_Rfb,'FM999999990.0999')||'-'||to_char(V_CODE.Freq_Rfe,'FM999999990.0999')||',')<=0 then
               v_freq_r:=v_freq_r||','||to_char(V_CODE.Freq_Rfb,'FM999999990.0999')||'-'||to_char(V_CODE.Freq_Rfe,'FM999999990.0999');
            end if;
         end if;
     END LOOP;
   CLOSE C_code;
   v_freq_e:=trim(leading ',' from v_freq_e);
    v_freq_r:=trim(leading ',' from v_freq_r);
   V_RET_CODE:='发射：'|| v_freq_e||';接收：'||v_freq_r;
   V_RET_CODE:=replace(V_RET_CODE,' ','');
   RETURN (V_RET_CODE);
END F_GetFreq;

/

-- ----------------------------
-- Function structure for F_GETMEMBER_CODE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_GETMEMBER_CODE"(appGuid  VARCHAR2) return varchar2
is
 V_RET_CODE VARCHAR2(400);

 CURSOR C_code IS select t.app_clubs_member_code from rsbt_appclubs t where t.app_guid=appGuid;

  V_CODE C_code%ROWTYPE;
BEGIN
  V_RET_CODE:='';
  OPEN C_code;
     LOOP
       FETCH C_code INTO V_CODE;
       EXIT WHEN C_code%NOTFOUND;
          V_RET_CODE:=V_RET_CODE||','||V_CODE.app_clubs_member_code;
     END LOOP;
   CLOSE C_code;
   V_RET_CODE:=trim(leading ',' from V_RET_CODE);
   RETURN (V_RET_CODE);
END F_GetMember_CODE;

/

-- ----------------------------
-- Function structure for F_GETPAYCOUNTYEAR_STRINGKM
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_GETPAYCOUNTYEAR_STRINGKM"(orgGuid  VARCHAR2) return varchar2
is
 V_RET_CODE VARCHAR2(400);

 CURSOR C_code IS     select distinct a.count_year from v_rim_rsm_pay_deptprint a,t_rim_rsm_pay_deptcount b where a.dept_pay=b.dept_pay and a.dept_pay=orgGuid;

  V_CODE C_code%ROWTYPE;
BEGIN
  V_RET_CODE:='';
  OPEN C_code;
     LOOP
       FETCH C_code INTO V_CODE;
       EXIT WHEN C_code%NOTFOUND;
          V_RET_CODE:=V_RET_CODE||','||V_CODE.count_year;
     END LOOP;
   CLOSE C_code;
   V_RET_CODE:=trim(leading ',' from V_RET_CODE);
   RETURN (V_RET_CODE);
END F_GetPayCountYear_stringkm;

/

-- ----------------------------
-- Function structure for F_GETROLENAME
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_GETROLENAME"(roleNum in varchar2)
return varchar2 is  roleName varchar2(100);

begin
   roleName := '';
   IF roleNum = '1' THEN
     roleName := '单位领导';
   END IF;
   IF
     roleNum = '2' THEN
     roleName := '部门负责人';
   END IF;
   IF
     roleNum = '3' THEN
     roleName := '收发员';
  END IF;
   IF
     roleNum = '4' THEN
     roleName := '审核人';
  END IF;
   IF
     roleNum = '5' THEN
     roleName := '经办人';
  END IF;
   IF
     roleNum = '6' THEN
     roleName := '委办公室文秘';
  END IF;
   IF
     roleNum = '8' THEN
     roleName := '委办公室主任';
  END IF;
   IF
     roleNum = '9' THEN
     roleName := '委文印室和保密室';
  END IF;
   IF
     roleNum = '10' THEN
     roleName := '委保密室';
  END IF;

  return roleName;
end F_GetRoleName;

/

-- ----------------------------
-- Function structure for F_GETROLENAMEBYUSERID
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_GETROLENAMEBYUSERID"(user_id in varchar2)
return varchar2 is
 V_RET_CODE VARCHAR2(200);
begin
    for z in (select a.role,a.secondrole
              from t_rim_comm_employee a,t_rim_comm_user  d
              where  a.empno = d.empno(+) and d.userid=user_id)
    loop
       V_RET_CODE:=F_GetRoleName(z.role)||'&'||F_GetRoleName(z.secondrole);

       IF (z.secondrole is null or z.secondrole ='') THEN
              V_RET_CODE:=F_GetRoleName(z.role);
       END IF;

       exit;
    end loop;

    return V_RET_CODE;
end F_GetRoleNameByUserID;

/

-- ----------------------------
-- Function structure for F_IFNULL
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_IFNULL"(valueIn in varchar2) return varchar2 is
  valueOut varchar2(4000);
begin
  if (valueIn is null) then
    valueOut :=  ' ';
  else
    valueOut := valueIn;
  end if ;
  return(valueOut);
end;

/

-- ----------------------------
-- Function structure for F_IFNULL2
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_IFNULL2"(valueIn in varchar2,defaultValue in varchar2) return varchar2 is
  valueOut varchar2(4000);
begin
  if (valueIn is null) then
    valueOut :=  defaultValue;
  else
    valueOut := valueIn;
  end if ;
  return(valueOut);
end;

/

-- ----------------------------
-- Function structure for F_RIM_OA_ARCHIVENAME
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_OA_ARCHIVENAME"(ItemID_P in varchar2,TypeID_P in varchar2) return varchar2  is
  Result  varchar2(30);
  V_Temp  varchar2(30);
   CURSOR c_types is
   select ITEMNAME  from T_RIM_OA_TYPE
		where itemid=ItemID_P and TYPEID=TypeID_P;
    v_type c_types%rowtype;
begin
  ----根据类型ID"TypeID_P"，类型项目ID"ItemID_P"，获取[类型项目名称]
  OPEN c_types;
  loop
    fetch c_types into v_type;
    exit when c_types%notfound;
    V_Temp := v_type.itemname;
  end loop;
  close c_types;
  Result :=V_Temp;
  return(Result);
end F_RIM_OA_ARCHIVEName;

/

-- ----------------------------
-- Function structure for F_RIM_OA_GETDEFVALID
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_OA_GETDEFVALID"(startdt date,operatedt date) return varchar2 is
  retType varchar2(10);
begin
  retType := '有效';
  if startdt < sysdate then
  retType := '无效';
  end if;
  if operatedt < (sysdate - 2 / 24) then
  retType := '无效';
  end if;
  return(retType);
end f_rim_oa_getdefvalid;

/

-- ----------------------------
-- Function structure for F_RIM_OA_STRLIST
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_OA_STRLIST"(str_in in varchar2) return varchar2 is
  returnStr varchar2(4000) default null;--连接后字符串
  mStr varchar2(20) default null;--连接字符
begin
  for x in (select b.username from t_rim_wf_delegatemissivelist a,t_rim_comm_user b where a.delegateuserid=b.userid and workid=str_in and (a.delflag=0 or a.delflag is null))
  loop
      returnStr := returnStr || mStr || x.username;
      mStr :=',';
  end loop;
  return returnStr;
end F_RIM_OA_STRLIST;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_APP_GUID_BYDEPT_PAY
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_APP_GUID_BYDEPT_PAY"(Dept_Pay_Temp in varchar2) return varchar2 is
  Result varchar2(80);
  AppCode_Temp varchar2(80);
  cursor PT is select B.GUID as App_GUID from Rsbt_Apply B where b.org_guid in (select ORG_GUID from RSBT_NET A where A.FEE_GUID=Dept_Pay_Temp);
  V_SF PT%ROWTYPE;
  --历史库
  cursor PT_H is select B.GUID as App_GUID from Rsbt_Apply_H B where b.org_guid in (select ORG_GUID from RSBT_NET_H A where A.FEE_GUID=Dept_Pay_Temp);
  V_SF_H PT_H%ROWTYPE;
begin
  ----根据缴费单位Guid编码Dept_Pay，获取申请表编号的App_GUID
  open PT;
  loop
     FETCH PT INTO V_SF;
        EXIT WHEN PT%notfound;
     AppCode_Temp := V_SF.App_GUID;
     Exit;
  end loop;
  close PT;
  ----查询历史库（如果AppCode_Temp is null）
  if AppCode_Temp is null then
    open PT_H;
    loop
       FETCH PT_H INTO V_SF_H;
          EXIT WHEN PT_H%notfound;
         AppCode_Temp := V_SF_H.App_GUID;
       Exit;
     end loop;
     close PT_H;
  end if;
  --
  Result := AppCode_Temp;
  return(Result);

end F_rim_rsm_App_GUID_ByDept_Pay;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_APPCODE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_APPCODE"(Apply_codeTemp in varchar2,decl_codeTemp in varchar2) return varchar2 is
  Result varchar2(80);
  AppCode_Temp varchar2(80);
  cursor PT is select APP_CODE from  rsbt_station A where substr(A.app_code,-12,12)=Apply_codeTemp and A.STAT_APP_Type||A.STAT_TDI=decl_codeTemp;
  V_SF PT%ROWTYPE;
  --历史库
  cursor PT_H is select APP_CODE from  Rsbt_Station_H A where substr(A.app_code,-12,12)=Apply_codeTemp and A.STAT_APP_Type||A.STAT_TDI=decl_codeTemp;
  V_SF_H PT_H%ROWTYPE;
begin
  ----根据申请编号500020070245、技术资料表编号LM0005，获取申请表编号T500020070245或PA500020070245
  open PT;
  loop
     FETCH PT INTO V_SF;
        EXIT WHEN PT%notfound;
     AppCode_Temp := V_SF.APP_CODE;
     Exit;
  end loop;
  close PT;
  ----查询历史库（如果AppCode_Temp is null）
  if AppCode_Temp is null then
    open PT_H;
    loop
       FETCH PT_H INTO V_SF_H;
          EXIT WHEN PT_H%notfound;
         AppCode_Temp := V_SF_H.APP_CODE;
       Exit;
     end loop;
     close PT_H;
  end if;
  --
  Result := AppCode_Temp;
  return(Result);

end F_rim_rsm_AppCode;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_APPCODE_BYDEPT_PAY
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_APPCODE_BYDEPT_PAY"(Dept_Pay_Temp in varchar2) return varchar2 is
  Result varchar2(80);
  AppCode_Temp varchar2(80);
  cursor PT is select B.APP_CODE from Rsbt_Apply B where b.org_guid in (select ORG_GUID from RSBT_NET A where A.FEE_GUID=Dept_Pay_Temp);
  V_SF PT%ROWTYPE;
  --历史库
  cursor PT_H is select B.APP_CODE from Rsbt_Apply_H B where b.org_guid in (select ORG_GUID from RSBT_NET_H A where A.FEE_GUID=Dept_Pay_Temp);
  V_SF_H PT_H%ROWTYPE;
begin
  ----根据缴费单位Guid编码Dept_Pay，获取申请表编号T500020070245或PA500020070245
  open PT;
  loop
     FETCH PT INTO V_SF;
        EXIT WHEN PT%notfound;
     AppCode_Temp := V_SF.APP_CODE;
     Exit;
  end loop;
  close PT;
  ----查询历史库（如果AppCode_Temp is null）
  if AppCode_Temp is null then
    open PT_H;
    loop
       FETCH PT_H INTO V_SF_H;
          EXIT WHEN PT_H%notfound;
         AppCode_Temp := V_SF_H.APP_CODE;
       Exit;
     end loop;
     close PT_H;
  end if;
  --
  Result := AppCode_Temp;
  return(Result);

end F_rim_rsm_AppCode_ByDept_Pay;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_CHANGEDEGREE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_CHANGEDEGREE"(deg IN NUMBER) return varchar2
is
    v_num number;
    v_d number;
    v_m number;
    v_s number;
    b_rtn varchar2(30) := '';
begin
     if deg is NULL OR deg = 0 then
	      return b_rtn;
	   end if;
     v_d := floor(deg);
     v_num := (deg - v_d) * 60;
     v_m := floor(v_num);
     v_num := (v_num - v_m) * 60;
     v_s := v_num;
     b_rtn := to_char(v_d) || '°' || to_char(v_m) || '′' || round(v_s,2) || '″';
	   return b_rtn;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_AS
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_AS" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station
		where  STAT_APP_Type='A' and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T' AND nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station
		where STAT_APP_Type='A' and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T' AND org_code=areacode AND nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_AS_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_AS_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptitem a,rsbt_station b
		where count_year=pyear and (item_code='710000' or item_code='720000' or item_code='730000' or item_code='740000')
		and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
  if nvl(V_Temp,0)<>0 then
		V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_applyitem a,rsbt_station b
		where count_year=pyear and (item_code='710000' or item_code='720000' or item_code='730000' or item_code='740000')
		and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
    if nvl(V_Temp,0)<>0 then
			V_Result := V_Result + V_Temp;
		end if;
	else
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptitem a,rsbt_station b
		where area_code=areacode AND count_year=pyear and (item_code='710000' or item_code='720000' or item_code='730000' or item_code='740000')
    and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
    if nvl(V_Temp,0)<>0 then
    V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_applyitem a,rsbt_station b
    where area_code=areacode AND count_year=pyear and (item_code='710000' or item_code='720000' or item_code='730000' or item_code='740000')
    and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
    if nvl(V_Temp,0)<>0 then
    V_Result := V_Result + V_Temp;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_AS_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_AS_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station_r
		where  STAT_APP_Type='A'  and substr(app_code,1,length(app_code)-12)='T' AND nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station_r
		where STAT_APP_Type='A'  and substr(app_code,1,length(app_code)-12)='T' AND org_code=areacode AND nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_BC
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_BC" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station a,rsbt_station_t b
		where STAT_Status='1' AND a.guid=b.guid AND STAT_APP_Type='B' AND nvl(ST_B_TYPE1,'0')='0'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and nvl(ST_B_IC,'0')='0'
			 and substr(app_code,1,length(app_code)-12)='T';
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station a,rsbt_station_t b
		where STAT_Status='1' AND a.guid=b.guid AND STAT_APP_Type='B' AND nvl(ST_B_TYPE1,'0')='0'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and nvl(ST_B_IC,'0')='0'
			 and substr(app_code,1,length(app_code)-12)='T'
			AND a.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_BC_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_BC_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptnetitem
		where count_year=pyear and (item_code='560000' or item_code='570000' or item_code='580000' or item_code='590000');
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applynetitem
    where count_year=pyear and (item_code='560000' or item_code='570000' or item_code='580000' or item_code='590000');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  else
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptnetitem
    where area_code=areacode AND count_year=pyear and (item_code='560000' or item_code='570000' or item_code='580000' or item_code='590000');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applynetitem
    where area_code=areacode AND count_year=pyear and (item_code='560000' or item_code='570000' or item_code='580000' or item_code='590000');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_BC_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_BC_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station_r a,rsbt_station_t_r b
		where  a.guid=b.guid AND STAT_APP_Type='B' AND nvl(ST_B_TYPE1,'0')='0'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and nvl(ST_B_IC,'0')='0'
			 and substr(app_code,1,length(app_code)-12)='T';
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station_r a,rsbt_station_t_r b
		where a.guid=b.guid AND STAT_APP_Type='B' AND nvl(ST_B_TYPE1,'0')='0'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and nvl(ST_B_IC,'0')='0'
			 and substr(app_code,1,length(app_code)-12)='T'
			AND a.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_BT
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_BT" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station a,rsbt_station_t b
		where STAT_Status='1' AND a.guid=b.guid AND ST_B_TYPE1='1' AND STAT_APP_Type='B'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and nvl(ST_B_IC,'0')='0'
			 and substr(app_code,1,length(app_code)-12)='T';
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station a,rsbt_station_t b
		where STAT_Status='1' AND a.guid=b.guid  AND STAT_APP_Type='B' AND ST_B_TYPE1='1'  and nvl(ST_B_IC,'0')='0'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and substr(app_code,1,length(app_code)-12)='T'
			 AND a.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_BT_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_BT_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
 	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptnetitem
		where count_year=pyear and (item_code='510000' or item_code='520000' or item_code='530000' or item_code='540000');
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applynetitem
		where count_year=pyear and (item_code='510000' or item_code='520000' or item_code='530000' or item_code='540000');
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp+V_Result;
		end if;
	else
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptnetitem
		where area_code=areacode AND count_year=pyear and (item_code='510000' or item_code='520000' or item_code='530000' or item_code='540000');
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;

    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applynetitem
    where area_code=areacode AND count_year=pyear and (item_code='510000' or item_code='520000' or item_code='530000' or item_code='540000');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_BT_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_BT_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station_r a,rsbt_station_t_r b
		where a.guid=b.guid AND ST_B_TYPE1='1' AND STAT_APP_Type='B'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and nvl(ST_B_IC,'0')='0'
			 and substr(app_code,1,length(app_code)-12)='T';
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station a,rsbt_station_t b
		where a.guid=b.guid  AND STAT_APP_Type='B' AND ST_B_TYPE1='1'  and nvl(ST_B_IC,'0')='0'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and substr(app_code,1,length(app_code)-12)='T'
			 AND a.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_BW
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_BW" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station a,rsbt_station_t b
		where STAT_Status='1' AND a.guid=b.guid AND STAT_APP_Type='B' and ST_B_IC='1'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and substr(app_code,1,length(app_code)-12)='T';
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station a,rsbt_station_t b
		where STAT_Status='1' AND a.guid=b.guid AND STAT_APP_Type='B' and ST_B_IC='1' AND a.org_code=areacode
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and substr(app_code,1,length(app_code)-12)='T';
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_BW_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_BW_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station_r a,rsbt_station_t_r b
		where a.guid=b.guid AND STAT_APP_Type='B' and ST_B_IC='1'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and substr(app_code,1,length(app_code)-12)='T';
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station_r a,rsbt_station_t_r b
		where a.guid=b.guid AND STAT_APP_Type='B' and ST_B_IC='1' AND a.org_code=areacode
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			 and substr(app_code,1,length(app_code)-12)='T';
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_CDMA
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_CDMA" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
        AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
        --and c.net_ts='LY0102' --CDMA系统
        and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
            and ((FREQ_TYPE='0' and (FREQ_UC>=870 and FREQ_UC<=880) or (FREQ_UC>=2110 and FREQ_UC<=2125))
                or (FREQ_TYPE='1' and (FREQ_EFE>=870 and FREQ_EFB<=880) or (FREQ_EFE>=2110 and FREQ_EFB<=2125))) );
    V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T'
      and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode
        AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
        --and c.net_ts='LY0102' --CDMA系统
         and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
            and ((FREQ_TYPE='0' and (FREQ_UC>=870 and FREQ_UC<=880) or (FREQ_UC>=2110 and FREQ_UC<=2125))
                or (FREQ_TYPE='1' and (FREQ_EFE>=870 and FREQ_EFB<=880) or (FREQ_EFE>=2110 and FREQ_EFB<=2125))) );
    V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_CDMA_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_CDMA_P" (areacode varchar2,pyear number) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_deptitem a,
      (select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station c,rsbt_net d,rsbt_freq e
        where substr(app_code,1,length(app_code)-12)='T' and e.station_guid=c.guid and c.net_guid=d.guid
     AND ((STAT_APP_Type='C' AND ((FREQ_TYPE='0' AND ((FREQ_UC>=870 AND FREQ_UC<=880 ) OR (FREQ_UC>=2110 AND FREQ_UC<=2125 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFE>=870 AND FREQ_EFB<=880 ) OR (FREQ_EFE>=2110 AND FREQ_EFB<=2125 ))))) or (STAT_APP_Type='D' AND NET_ts='LY0102'))) b
    where count_year=pyear and to_char(a.apply_code)=substr(b.app_code,-12,12) and a.decl_code=b.decl_code
      and (item_code='110000' or item_code='120000');
    if nvl(V_Temp,0)<>0 then
    V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_applyitem a,
      (select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station c,rsbt_net d,rsbt_freq e
        where substr(app_code,1,length(app_code)-12)='T' and e.station_guid=c.guid and c.net_guid=d.guid
     AND ((STAT_APP_Type='C' AND ((FREQ_TYPE='0' AND ((FREQ_UC>=870 AND FREQ_UC<=880 ) OR (FREQ_UC>=2110 AND FREQ_UC<=2125 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFE>=870 AND FREQ_EFB<=880 ) OR (FREQ_EFE>=2110 AND FREQ_EFB<=2125 ))))) or (STAT_APP_Type='D' AND NET_ts='LY0102'))) b
    where count_year=pyear  and to_char(a.apply_code)=substr(b.app_code,-12,12) and a.decl_code=b.decl_code
      and (item_code='110000' or item_code='120000');
    if nvl(V_Temp,0)<>0 then
    V_Result := V_Result + V_Temp;
    end if;
  else
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_deptitem a,
      (select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station c,rsbt_net d,rsbt_freq e
        where substr(app_code,1,length(app_code)-12)='T' and e.station_guid=c.guid and c.net_guid=d.guid
     AND ((STAT_APP_Type='C' AND ((FREQ_TYPE='0' AND ((FREQ_UC>=870 AND FREQ_UC<=880 ) OR (FREQ_UC>=2110 AND FREQ_UC<=2125 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFE>=870 AND FREQ_EFB<=880 ) OR (FREQ_EFE>=2110 AND FREQ_EFB<=2125 ))))) or (STAT_APP_Type='D' AND NET_ts='LY0102'))) b
    where area_code=areacode AND count_year=pyear and to_char(a.apply_code)=substr(b.app_code,-12,12) and a.decl_code=b.decl_code
      and (item_code='110000' or item_code='120000');
    if nvl(V_Temp,0)<>0 then
    V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_applyitem a,
      (select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station c,rsbt_net d,rsbt_freq e
        where substr(app_code,1,length(app_code)-12)='T' and e.station_guid=c.guid and c.net_guid=d.guid
      AND ((STAT_APP_Type='C' AND ((FREQ_TYPE='0' AND ((FREQ_UC>=870 AND FREQ_UC<=880 ) OR (FREQ_UC>=2110 AND FREQ_UC<=2125 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFE>=870 AND FREQ_EFB<=880 ) OR (FREQ_EFE>=2110 AND FREQ_EFB<=2125 ))))) or (STAT_APP_Type='D' AND NET_ts='LY0102'))) b
    where area_code=areacode AND count_year=pyear  and to_char(a.apply_code)=substr(b.app_code,-12,12) and a.decl_code=b.decl_code
      and (item_code='110000' or item_code='120000');
    if nvl(V_Temp,0)<>0 then
    V_Result := V_Result + V_Temp;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_CDMA_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_CDMA_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
        AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
        --and c.net_ts='LY0102' --CDMA系统
        and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
            and ((FREQ_TYPE='0' and (FREQ_UC>=870 and FREQ_UC<=880) or (FREQ_UC>=2110 and FREQ_UC<=2125))
                or (FREQ_TYPE='1' and (FREQ_EFE>=870 and FREQ_EFB<=880) or (FREQ_EFE>=2110 and FREQ_EFB<=2125))) );
    V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T'
      and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode
        AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
        --and c.net_ts='LY0102' --CDMA系统
         and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
            and ((FREQ_TYPE='0' and (FREQ_UC>=870 and FREQ_UC<=880) or (FREQ_UC>=2110 and FREQ_UC<=2125))
                or (FREQ_TYPE='1' and (FREQ_EFE>=870 and FREQ_EFB<=880) or (FREQ_EFE>=2110 and FREQ_EFB<=2125))) );
    V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_GD
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_COUNT_GD" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and STAT_Status='1' AND (STAT_APP_Type='TF' and nvl(stat_type,' ')='TS')  and substr(app_code,1,length(app_code)-12)='T'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		 V_Result :=V_Temp;
	else
		select count(a.guid) into V_Temp
		from rsbt_station a,rsbt_net c
		where a.net_guid=c.guid and STAT_Status='1' AND (STAT_APP_Type='TF' and nvl(stat_type,' ')='TS') and substr(app_code,1,length(app_code)-12)='T'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode;
		 V_Result :=V_Temp;
	end if;
	return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_GD_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_GD_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120200' or item_code='120300' or item_code='130100' or item_code='130200')
			and count_year=pyear
			and apply_code||decl_code in
				(select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET c
				where a.net_guid=c.guid  AND (STAT_APP_Type='TF' and nvl(stat_type,' ')='TS') and substr(app_code,1,length(app_code)-12)='T');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
    where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120200' or item_code='120300' or item_code='130100' or item_code='130200')
      and count_year=pyear
      and apply_code||decl_code in
        (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET c
        where a.net_guid=c.guid  AND (STAT_APP_Type='TF' and nvl(stat_type,' ')='TS') and substr(app_code,1,length(app_code)-12)='T');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  else
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
    where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120200' or item_code='120300' or item_code='130100' or item_code='130200')
      and area_code=areacode AND count_year=pyear
      and apply_code||decl_code in
        (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET c
        where a.net_guid=c.guid  AND (STAT_APP_Type='TF' and nvl(stat_type,' ')='TS') and substr(app_code,1,length(app_code)-12)='T');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
    where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120200' or item_code='120300' or item_code='130100' or item_code='130200')
      and area_code=areacode AND count_year=pyear
      and apply_code||decl_code in
        (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET c
       where a.net_guid=c.guid  AND (STAT_APP_Type='TF' and nvl(stat_type,' ')='TS') and substr(app_code,1,length(app_code)-12)='T');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  end if;
    return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_GD_R
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_COUNT_GD_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid AND (STAT_APP_Type='TF' and nvl(stat_type,' ')='TS')  and substr(app_code,1,length(app_code)-12)='T'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		 V_Result :=V_Temp;
	else
		select count(a.guid) into V_Temp
		from rsbt_station_r a,rsbt_net_r c
		where a.net_guid=c.guid  AND (STAT_APP_Type='TF' and nvl(stat_type,' ')='TS') and substr(app_code,1,length(app_code)-12)='T'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode;
		 V_Result :=V_Temp;
	end if;
	return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_GSM
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_GSM" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and STAT_Status='1'and substr(app_code,1,length(app_code)-12)='T'
        and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
            AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
            --and c.net_ts='LY0101' --GSM/GPRS 系统
            and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
                and ((FREQ_TYPE='0' and (FREQ_UC>=935 and FREQ_UC<=960) or (FREQ_UC>=1805 and FREQ_UC<=1850))
                    or (FREQ_TYPE='1' and (FREQ_EFE>=935 and FREQ_EFB<=960) or (FREQ_EFE>=1805 and FREQ_EFB<=1850))) );
    V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode
      AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
            --and c.net_ts='LY0101' --GSM/GPRS 系统
            and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
                and ((FREQ_TYPE='0' and (FREQ_UC>=935 and FREQ_UC<=960) or (FREQ_UC>=1805 and FREQ_UC<=1850))
                    or (FREQ_TYPE='1' and (FREQ_EFE>=935 and FREQ_EFB<=960) or (FREQ_EFE>=1805 and FREQ_EFB<=1850))) );
    V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_GSM_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_GSM_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptitem a,rsbt_station b
		where count_year=pyear and (item_code='110000' or item_code='120000')
    and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
		if nvl(V_Temp,0)<>0 then
		V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_applyitem a,rsbt_station b
		where count_year=pyear  and (item_code='110000' or item_code='120000')
    and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
		if nvl(V_Temp,0)<>0 then
		V_Result := V_Result + V_Temp;
		end if;
	else
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptitem  a,rsbt_station b
		where area_code=areacode AND count_year=pyear and (item_code='110000' or item_code='120000')
    and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
	  if nvl(V_Temp,0)<>0 then
		V_Result :=V_Temp;
	  end if;
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_applyitem a,rsbt_station b
		where area_code=areacode AND count_year=pyear and (item_code='110000' or item_code='120000')
    and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
		if nvl(V_Temp,0)<>0 then
		V_Result := V_Result + V_Temp;
		end if;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_GSM_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_GSM_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T'
        and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
            AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
            --and c.net_ts='LY0101' --GSM/GPRS 系统
            and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
                and ((FREQ_TYPE='0' and (FREQ_UC>=935 and FREQ_UC<=960) or (FREQ_UC>=1805 and FREQ_UC<=1850))
                    or (FREQ_TYPE='1' and (FREQ_EFE>=935 and FREQ_EFB<=960) or (FREQ_EFE>=1805 and FREQ_EFB<=1850))) );
    V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode
      AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
            --and c.net_ts='LY0101' --GSM/GPRS 系统
            and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
                and ((FREQ_TYPE='0' and (FREQ_UC>=935 and FREQ_UC<=960) or (FREQ_UC>=1805 and FREQ_UC<=1850))
                    or (FREQ_TYPE='1' and (FREQ_EFE>=935 and FREQ_EFB<=960) or (FREQ_EFE>=1805 and FREQ_EFB<=1850))) );
    V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_GX
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_COUNT_GX" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
begin
  if areacode='999999' then
	--全部数据计算
		select count(a.guid) into V_Temp
		from rsbt_station a,rsbt_net c
		where a.net_guid=c.guid and STAT_Status='1' AND (STAT_APP_Type='TF' and nvl(stat_type,'null')='CS') and substr(app_code,1,length(app_code)-12)='T'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		 V_Result :=V_Temp;
	else
		select count(a.guid) into V_Temp
		from rsbt_station a,rsbt_net c
		where a.net_guid=c.guid and STAT_Status='1' AND (STAT_APP_Type='TF'  and nvl(stat_type,'null')='CS') and substr(app_code,1,length(app_code)-12)='T'
			 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode;
		 V_Result :=V_Temp;
	end if;
	return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_GX_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_GX_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200')
			and count_year=pyear
			and apply_code||decl_code in
				(select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET c
				where a.net_guid=c.guid  AND (STAT_APP_Type='TF'  and nvl(stat_type,'null')='CS') and substr(app_code,1,length(app_code)-12)='T');
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
		where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200')
			and count_year=pyear
			and apply_code||decl_code in
				(select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET c
				where a.net_guid=c.guid  AND (STAT_APP_Type='TF'  and nvl(stat_type,'null')='CS') and substr(app_code,1,length(app_code)-12)='T');
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp+V_Result;
		end if;
	else
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200')
			and area_code=areacode AND count_year=pyear
			and apply_code||decl_code in
				(select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET c
				where a.net_guid=c.guid  AND (STAT_APP_Type='TF'  and nvl(stat_type,'null')='CS') and substr(app_code,1,length(app_code)-12)='T');
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
		where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200')
			and area_code=areacode AND count_year=pyear
			and apply_code||decl_code in
				(select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET c
				where a.net_guid=c.guid  AND (STAT_APP_Type='TF'  and nvl(stat_type,'null')='CS') and substr(app_code,1,length(app_code)-12)='T');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  end if;
        return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_GX_R
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_COUNT_GX_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid  AND (STAT_APP_Type='TF' and nvl(stat_type,'null')='CS') and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
     V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid  AND (STAT_APP_Type='TF'  and nvl(stat_type,'null')='CS') and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode;
     V_Result :=V_Temp;
  end if;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_HA
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_HA" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(distinct a.guid) into V_Temp
		from rsbt_station a,rsbt_antfeed c
		where a.guid=c.station_guid and STAT_Status='1' AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	else
		select count(distinct a.guid) into V_Temp
		from rsbt_station a,rsbt_antfeed c
		where a.guid=c.station_guid and STAT_Status='1' AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			AND a.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_HA_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_HA_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where item_code='100100' and count_year=pyear
			and apply_code||decl_code in
				(select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,rsbt_antfeed c
				where a.guid=c.station_guid AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5);
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
		where item_code='100100' and count_year=pyear
			and apply_code||decl_code in
				(select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,rsbt_antfeed c
				where a.guid=c.station_guid AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5);
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp+V_Result;
		end if;
	else
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where area_code=areacode AND  item_code='100100' and count_year=pyear
			and apply_code||decl_code in
        (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,rsbt_antfeed c
        where a.guid=c.station_guid AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5);
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
    where area_code=areacode AND  item_code='100100' and count_year=pyear
      and apply_code||decl_code in
        (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,rsbt_antfeed c
       where a.guid=c.station_guid AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5);
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_HA_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_HA_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(distinct a.guid) into V_Temp
		from rsbt_station_r a,rsbt_antfeed_r c
		where a.guid=c.station_guid AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	else
		select count(distinct a.guid) into V_Temp
		from rsbt_station_r a,rsbt_antfeed_r c
		where a.guid=c.station_guid  AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)>4.5 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			AND a.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_HF
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_HF" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and STAT_Status='1' AND STAT_APP_Type='V' and a.stat_type<>'RA' AND a.stat_type<>'AT'
          --and  nvl(NET_SVN,' ')<>'GD04' and nvl(NET_SVN,' ')<>'LY05' and nvl(NET_SVN,' ')<>'LY06' and nvl(NET_SVN,' ')<>'WA' and substr(app_code,1,length(app_code)-12)='T'
          and substr(app_code,1,length(app_code)-12)='T' and nvl(c.NET_SVN,'null')<>'LY06'
           and exists (select station_guid from rsbt_freq f where a.guid=f.station_guid and decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC)>30 )
          and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
     V_Result :=V_Temp;
     else
    select count(a.guid) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and STAT_Status='1' AND STAT_APP_Type='V' and  a.stat_type<>'RA' AND a.stat_type<>'AT'
         --and  nvl(NET_SVN,' ')<>'GD04' and nvl(NET_SVN,' ')<>'LY05' and nvl(NET_SVN,' ')<>'LY06' and nvl(NET_SVN,' ')<>'WA'
         and substr(app_code,1,length(app_code)-12)='T' and nvl(c.NET_SVN,'null')<>'LY06'
         and exists (select station_guid from rsbt_freq f where a.guid=f.station_guid and decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC)>30 )
         and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode;
     V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_HF_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_HF_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptnetitem
		where item_code='810000' and count_year=pyear
			   and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,to_number(translate(freq_note,'KMGHz',' '))) >30;
    if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applynetitem
		where item_code='810000' and count_year=pyear
			   and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,to_number(translate(freq_note,'KMGHz',' '))) >30;
   if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp+V_Result;
		end if;
	else
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptnetitem
		where area_code=areacode AND item_code='810000' and count_year=pyear
			   and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,to_number(translate(freq_note,'KMGHz',' '))) >30;
   if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applynetitem
		where area_code=areacode AND item_code='810000' and count_year=pyear
			   and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,to_number(translate(freq_note,'KMGHz',' '))) >30;
   if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp+V_Result;
		end if;
               end if;
  return V_Result;

end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_HF_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_HF_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid  AND STAT_APP_Type='V' and a.stat_type<>'RA' AND a.stat_type<>'AT'
          --and  nvl(NET_SVN,' ')<>'GD04' and nvl(NET_SVN,' ')<>'LY05' and nvl(NET_SVN,' ')<>'LY06' and nvl(NET_SVN,' ')<>'WA' and substr(app_code,1,length(app_code)-12)='T'
          and substr(app_code,1,length(app_code)-12)='T' and nvl(c.NET_SVN,'null')<>'LY06'
           and exists (select station_guid from rsbt_freq_r f where a.guid=f.station_guid and decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC)>30 )
          and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
     V_Result :=V_Temp;
     else
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid AND STAT_APP_Type='V' and  a.stat_type<>'RA' AND a.stat_type<>'AT'
         --and  nvl(NET_SVN,' ')<>'GD04' and nvl(NET_SVN,' ')<>'LY05' and nvl(NET_SVN,' ')<>'LY06' and nvl(NET_SVN,' ')<>'WA'
         and substr(app_code,1,length(app_code)-12)='T' and nvl(c.NET_SVN,'null')<>'LY06'
         and exists (select station_guid from rsbt_freq_r f where a.guid=f.station_guid and decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC)>30 )
         and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode;
     V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_HM
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_HM" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
      from rsbt_equ a,rsbt_station b,RSBT_NET c
      where  a.station_guid=b.guid and STAT_Status='1' and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' and b.NET_GUID=c.GUID
      --  and  nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' AND nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422' and b.STAT_Date_Start<=seldate
         and  exists (select  station_guid from rsbt_freq f where b.guid = f.station_guid and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30)
         and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
      V_Result :=V_Temp;
  else
    select count(*) into V_Temp
      from rsbt_equ a,rsbt_station b,RSBT_NET c
      where a.station_guid=b.guid and STAT_Status='1' and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' and b.NET_GUID=c.GUID
        --and  nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' and nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422' and b.STAT_Date_Start<=seldate AND b.org_code=areacode
         and  exists (select  station_guid from rsbt_freq f where b.guid = f.station_guid and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30)
         and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND b.org_code=areacode;
      V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_HM_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_HM_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where item_code='820000' and count_year=pyear
			and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from  rsbt_equ a,rsbt_station b,RSBT_NET c
		  where a.station_guid=b.guid  and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' and b.NET_GUID=c.GUID
				--and  nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' and nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422' and b.STAT_Date_Start<=seldate AND b.org_code=areacode
				and b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30));
    if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
		where item_code='820000' and count_year=pyear
			and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from  rsbt_equ a,rsbt_station b,RSBT_NET c
    where a.station_guid=b.guid  and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' and b.NET_GUID=c.GUID
				--and  nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' and nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422' and b.STAT_Date_Start<=seldate AND b.org_code=areacode
				and b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30));
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  else
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
    where area_code=areacode AND item_code='820000' and count_year=pyear
      and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from  rsbt_equ a,rsbt_station b,RSBT_NET c
  	where a.station_guid=b.guid  and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' and b.NET_GUID=c.GUID
				--and  nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' and nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422' and b.STAT_Date_Start<=seldate AND b.org_code=areacode
				and b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30));
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
    where area_code=areacode AND item_code='820000' and count_year=pyear
      and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from  rsbt_equ a,rsbt_station b,RSBT_NET c
	where a.station_guid=b.guid  and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' and b.NET_GUID=c.GUID
				--and  nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' and nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422' and b.STAT_Date_Start<=seldate AND b.org_code=areacode
				and b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30));
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_HM_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_HM_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
      from rsbt_equ_r a,rsbt_station_r b,RSBT_NET_r c
      where  a.station_guid=b.guid and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' and b.NET_GUID=c.GUID
      --  and  nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' AND nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422' and b.STAT_Date_Start<=seldate
         and  exists (select  station_guid from rsbt_freq_r f where b.guid = f.station_guid and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30)
         and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
      V_Result :=V_Temp;
  else
    select count(*) into V_Temp
      from rsbt_equ_r a,rsbt_station_r b,RSBT_NET_r c
      where a.station_guid=b.guid and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' and b.NET_GUID=c.GUID
        --and  nvl(c.NET_SVN,' ')<>'LY02' and nvl(c.NET_SVN,' ')<>'GD02' AND nvl(c.NET_SVN,' ')<>'GD03' and nvl(NET_ts,' ')<>'GD0420' and nvl(NET_ts,' ')<>'GD0421' and nvl(NET_ts,' ')<>'GD0422' and b.STAT_Date_Start<=seldate AND b.org_code=areacode
         and  exists (select  station_guid from rsbt_freq_r f where b.guid = f.station_guid and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>30)
         and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND b.org_code=areacode;
      V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_JQ
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_JQ" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station a
 where substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
       AND (STAT_APP_Type='C' OR STAT_APP_Type='D')
       and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
           AND ((FREQ_TYPE='0' AND (FREQ_UC>=361 AND FREQ_UC<=368 ) or (FREQ_UC>=382 AND FREQ_UC<=389 ) or (FREQ_UC>=851 AND FREQ_UC<=866 ))
                OR (FREQ_TYPE='1' AND (FREQ_EFE>=361 AND FREQ_EFB<=368 ) or (FREQ_EFE>=382 AND FREQ_EFB<=389 ) or (FREQ_EFE>=851 AND FREQ_EFB<=866 ))));
  V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
    from rsbt_station a
  where  substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1' AND a.org_code=areacode
           and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
           AND (STAT_APP_Type='C' OR STAT_APP_Type='D')
           and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
               AND ((FREQ_TYPE='0' AND (FREQ_UC>=361 AND FREQ_UC<=368 ) or (FREQ_UC>=382 AND FREQ_UC<=389 ) or (FREQ_UC>=851 AND FREQ_UC<=866 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=361 AND FREQ_EFB<=368 ) or (FREQ_EFE>=382 AND FREQ_EFB<=389 ) or (FREQ_EFE>=851 AND FREQ_EFB<=866 ))));
  V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_JQ_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_JQ_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptnetitem
		where count_year=pyear
		and (item_code='210000' or item_code='220000' or item_code='230000');
		if nvl(V_Temp,0)<>0 then
		V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_applynetitem
		where count_year=pyear
		and (item_code='210000' or item_code='220000' or item_code='230000');
		if nvl(V_Temp,0)<>0 then
		V_Result := V_Result + V_Temp;
		end if;
	else
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptnetitem
		where area_code=areacode AND count_year=pyear
		and (item_code='210000' or item_code='220000' or item_code='230000');
		if nvl(V_Temp,0)<>0 then
		V_Result :=V_Temp;
		end if;

		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_applynetitem
		where area_code=areacode AND count_year=pyear
		and (item_code='210000' or item_code='220000' or item_code='230000');
		if nvl(V_Temp,0)<>0 then
		V_Result := V_Result + V_Temp;
		end if;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_JQ_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_JQ_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station_r a
 where substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
       AND (STAT_APP_Type='C' OR STAT_APP_Type='D')
       and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
           AND ((FREQ_TYPE='0' AND (FREQ_UC>=361 AND FREQ_UC<=368 ) or (FREQ_UC>=382 AND FREQ_UC<=389 ) or (FREQ_UC>=851 AND FREQ_UC<=866 ))
                OR (FREQ_TYPE='1' AND (FREQ_EFE>=361 AND FREQ_EFB<=368 ) or (FREQ_EFE>=382 AND FREQ_EFB<=389 ) or (FREQ_EFE>=851 AND FREQ_EFB<=866 ))));
  V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
    from rsbt_station_r a
  where  substr(app_code,1,length(app_code)-12)='T' AND a.org_code=areacode
           and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
           AND (STAT_APP_Type='C' OR STAT_APP_Type='D')
           and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
               AND ((FREQ_TYPE='0' AND (FREQ_UC>=361 AND FREQ_UC<=368 ) or (FREQ_UC>=382 AND FREQ_UC<=389 ) or (FREQ_UC>=851 AND FREQ_UC<=866 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=361 AND FREQ_EFB<=368 ) or (FREQ_EFE>=382 AND FREQ_EFB<=389 ) or (FREQ_EFE>=851 AND FREQ_EFB<=866 ))));
  V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_LA
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_LA" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(distinct a.guid) into V_Temp
		from rsbt_station a,rsbt_antfeed c
		where a.guid=c.station_guid(+)  AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
			and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	else
		select count(distinct a.guid) into V_Temp
		from rsbt_station a,rsbt_antfeed c
		where a.guid=c.station_guid(+) AND STAT_APP_Type='E'  and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
			and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			AND a.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_LA_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_LA_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where item_code='100100' and count_year=pyear
			and apply_code||decl_code in
				(select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,rsbt_antfeed c
				where  a.guid=c.station_guid(+) AND STAT_APP_Type='E'
					and substr(app_code,1,length(app_code)-12)='T'
					and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5);
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
		where item_code='100100' and count_year=pyear
      and apply_code||decl_code in
        (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,rsbt_antfeed c
        where  a.guid=c.station_guid(+) AND STAT_APP_Type='E'
          and substr(app_code,1,length(app_code)-12)='T'
          and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5);
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  else
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
    where area_code=areacode AND  item_code='100100' and count_year=pyear
      and apply_code||decl_code in
        (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,rsbt_antfeed c
        where  a.guid=c.station_guid(+) AND STAT_APP_Type='E'
          and substr(app_code,1,length(app_code)-12)='T'
          and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5);
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
    where area_code=areacode AND  item_code='100100' and count_year=pyear
      and apply_code||decl_code in
        (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,rsbt_antfeed c
        where  a.guid=c.station_guid(+) AND STAT_APP_Type='E'
          and substr(app_code,1,length(app_code)-12)='T'
          and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5);
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_LA_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_LA_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(distinct a.guid) into V_Temp
		from rsbt_station_r a,rsbt_antfeed_r c
		where a.guid=c.station_guid(+)  AND STAT_APP_Type='E' and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	else
		select count(distinct a.guid) into V_Temp
		from rsbt_station_r a,rsbt_antfeed_r c
		where a.guid=c.station_guid(+) AND STAT_APP_Type='E'  and substr(app_code,1,length(app_code)-12)='T'
			and f_rim_rsm_GETANTESIZE(ANT_Size)<=4.5 and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			AND a.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_LF_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_LF_P" (areacode varchar2,pyear number) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_deptitem a,
      (select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station c,rsbt_net d
        where c.net_guid=d.guid and STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' AND d.NET_SVN='LY01') b
    where count_year=pyear and to_char(a.apply_code)=substr(b.app_code,-12,12) and a.decl_code=b.decl_code
      and item_code='820000';
    if nvl(V_Temp,0)<>0 then
    V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_applyitem a,
      (select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station c,rsbt_net d
        where c.net_guid=d.guid and STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' AND d.NET_SVN='LY01') b
    where count_year=pyear  and to_char(a.apply_code)=substr(b.app_code,-12,12) and a.decl_code=b.decl_code
      and item_code='820000';
    if nvl(V_Temp,0)<>0 then
    V_Result := V_Result + V_Temp;
    end if;
  else
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_deptitem a,
      (select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station c,rsbt_net d
        where c.net_guid=d.guid and STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' AND d.NET_SVN='LY01') b
    where area_code=areacode AND count_year=pyear and to_char(a.apply_code)=substr(b.app_code,-12,12) and a.decl_code=b.decl_code
      and item_code='820000';
    if nvl(V_Temp,0)<>0 then
    V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_applyitem a,
      (select distinct app_code,stat_app_type||stat_tdi decl_code from rsbt_station c,rsbt_net d
        where c.net_guid=d.guid and STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' AND d.NET_SVN='LY01') b
    where area_code=areacode AND count_year=pyear  and to_char(a.apply_code)=substr(b.app_code,-12,12) and a.decl_code=b.decl_code
      and item_code='820000';
    if nvl(V_Temp,0)<>0 then
    V_Result := V_Result + V_Temp;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_LJ
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_LJ" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_equ a,rsbt_station b,rsbt_net c
		where STAT_Status='1' AND a.station_guid=b.guid  and b.net_guid=c.guid  and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			and STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' AND c.NET_SVN='LY02';
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_equ a,rsbt_station b,rsbt_net c
		where STAT_Status='1' AND a.station_guid=b.guid  and b.net_guid=c.guid  and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			and STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' AND c.NET_SVN='LY02' AND b.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_LJ_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_LJ_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where item_code='820000' and count_year=pyear
			and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET b where b.GUID=a.NET_GUID and nvl(NET_SVN,' ')='LY02' and substr(app_code,1,length(app_code)-12)='T' and STAT_APP_Type='LM');
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
		where item_code='820000' and count_year=pyear
			and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET b where b.GUID=a.NET_GUID and nvl(NET_SVN,' ')='LY02' and substr(app_code,1,length(app_code)-12)='T' and STAT_APP_Type='LM');
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp+V_Result;
		end if;
	else
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where area_code=areacode AND item_code='820000' and count_year=pyear
			and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET b where b.GUID=a.NET_GUID and nvl(NET_SVN,' ')='LY02' and substr(app_code,1,length(app_code)-12)='T' and STAT_APP_Type='LM');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
    where area_code=areacode AND item_code='820000' and count_year=pyear
      and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from RSBT_STATION a,RSBT_NET b where b.GUID=a.NET_GUID and nvl(NET_SVN,' ')='LY02' and substr(app_code,1,length(app_code)-12)='T' and STAT_APP_Type='LM');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_LJ_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_LJ_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_equ_r a,rsbt_station_r b,rsbt_net_r c
		where  a.station_guid=b.guid  and b.net_guid=c.guid  and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			and STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' AND c.NET_SVN='LY02';
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_equ_r a,rsbt_station_r b,rsbt_net_r c
		where a.station_guid=b.guid  and b.net_guid=c.guid  and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			and STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='T' AND c.NET_SVN='LY02' AND b.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_MS
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_MS" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(distinct a.guid) into V_Temp
    from rsbt_station a,RSBT_FREQ D
    where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
       and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME') and nvl(a.STAT_Date_Start,to_date(substr(substr(a.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD'))<=seldate
      and ((FREQ_TYPE='0' AND FREQ_UC>=1000) OR (FREQ_TYPE='1' AND FREQ_EFB>=1000));
    V_Result :=V_Temp;
  else
    select count(distinct a.guid) into V_Temp
    from rsbt_station a,RSBT_FREQ D
    where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
       and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME') and nvl(a.STAT_Date_Start,to_date(substr(substr(a.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD'))<=seldate
       and ((FREQ_TYPE='0' AND FREQ_UC>=1000) OR (FREQ_TYPE='1' AND FREQ_EFB>=1000))
      AND a.org_code=areacode;
    V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_MS_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_MS_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200')
			and count_year=pyear
			and apply_code||decl_code in
				(select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from rsbt_station a,RSBT_FREQ D
			 where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
       and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME'));
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
		where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200')
      and count_year=pyear
      and apply_code||decl_code in
        (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from rsbt_station a,RSBT_FREQ D
         where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
       and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME'));
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  else
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
    where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200')
      and area_code=areacode AND count_year=pyear
      and apply_code||decl_code in
        (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from rsbt_station a,RSBT_FREQ D
         where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
       and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME'));
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
    where (item_code='910000' or item_code='920000' or item_code='930000' or item_code='120100' or item_code='120300' or item_code='130100' or item_code='130200')
      and area_code=areacode AND  count_year=pyear
      and apply_code||decl_code in
        (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI from rsbt_station a,RSBT_FREQ D
         where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
       and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME'));
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;

  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_MS_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_MS_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(distinct a.guid) into V_Temp
    from rsbt_station_r a,RSBT_FREQ_r D
    where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
       and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME') and nvl(a.STAT_Date_Start,to_date(substr(substr(a.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD'))<=seldate
      and ((FREQ_TYPE='0' AND FREQ_UC>=1000) OR (FREQ_TYPE='1' AND FREQ_EFB>=1000));
    V_Result :=V_Temp;
  else
    select count(distinct a.guid) into V_Temp
    from rsbt_station_r a,RSBT_FREQ_r D
    where A.GUID=D.STATION_GUID AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
       and (a.stat_type='MB' or a.stat_type='MD' or a.stat_type='MH' or a.stat_type='RS' or a.stat_type='ME') and nvl(a.STAT_Date_Start,to_date(substr(substr(a.app_code,-12,12),5,4)||'.1.1','YYYY.MM.DD'))<=seldate
       and ((FREQ_TYPE='0' AND FREQ_UC>=1000) OR (FREQ_TYPE='1' AND FREQ_EFB>=1000))
      AND a.org_code=areacode;
    V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_OTHER
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_OTHER"(seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
begin
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
    from  (select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
from rsbt_station a,(
select stat_guid from v_rim_rsm_count_as
union
    select stat_guid from v_rim_rsm_count_bc
union
    select stat_guid from v_rim_rsm_count_bt
union
    select stat_guid from v_rim_rsm_count_bw
union
    select stat_guid from v_rim_rsm_count_cdma
union
    select stat_guid from v_rim_rsm_count_gsm
union
    select stat_guid from v_rim_rsm_count_wcdma
union
    select stat_guid from v_rim_rsm_count_td_scdma
union
    select stat_guid from v_rim_rsm_count_gd
union
    select stat_guid from v_rim_rsm_count_gx
union
    select stat_guid from v_rim_rsm_count_ha
union
    select stat_guid from v_rim_rsm_count_hf
union
    select stat_guid from v_rim_rsm_count_jq
union
    select stat_guid from v_rim_rsm_count_la
union
    select stat_guid  from v_rim_rsm_count_lf
union
    select stat_guid from v_rim_rsm_count_ms
union
    select stat_guid from v_rim_rsm_count_pb
union
    select stat_guid from v_rim_rsm_count_sf
union
    select stat_guid from v_rim_rsm_count_spm
union
    select stat_guid from v_rim_rsm_count_ss
union
    select stat_guid from v_rim_rsm_count_ws
union
    select stat_guid from v_rim_rsm_count_wx
union
    select stat_guid from v_rim_rsm_count_yy where stat_app_type<>'LM') b,rsbt_code_dic c
where a.guid=b.stat_guid(+) and b.stat_guid is  null and a.stat_app_type<>'LM' and a.stat_status='1'
      and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006'
union all
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,et_equ_no
from rsbt_equ d,rsbt_equ_t e,rsbt_station a,(
select stat_guid from v_rim_rsm_count_sm
union
    select stat_guid from v_rim_rsm_count_lj
union
    select stat_guid from v_rim_rsm_count_hm
union
    select stat_guid from v_rim_rsm_count_yy where stat_app_type='LM') b,rsbt_code_dic c
where d.guid=e.guid(+) and d.station_guid=a.guid(+) and a.guid=b.stat_guid(+) and b.stat_guid is null and
      a.stat_app_type='LM'  and a.stat_status='1' and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006')
    where
            nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Temp;
  else
    select count(*) into V_Temp
    from (select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
from rsbt_station a,(
select stat_guid from v_rim_rsm_count_as
union
    select stat_guid from v_rim_rsm_count_bc
union
    select stat_guid from v_rim_rsm_count_bt
union
    select stat_guid from v_rim_rsm_count_bw
union
    select stat_guid from v_rim_rsm_count_cdma
union
    select stat_guid from v_rim_rsm_count_gsm
union
    select stat_guid from v_rim_rsm_count_wcdma
union
    select stat_guid from v_rim_rsm_count_td_scdma
union
    select stat_guid from v_rim_rsm_count_gd
union
    select stat_guid from v_rim_rsm_count_gx
union
    select stat_guid from v_rim_rsm_count_ha
union
    select stat_guid from v_rim_rsm_count_hf
union
    select stat_guid from v_rim_rsm_count_jq
union
    select stat_guid from v_rim_rsm_count_la
union
    select stat_guid  from v_rim_rsm_count_lf
union
    select stat_guid from v_rim_rsm_count_ms
union
    select stat_guid from v_rim_rsm_count_pb
union
    select stat_guid from v_rim_rsm_count_sf
union
    select stat_guid from v_rim_rsm_count_spm
union
    select stat_guid from v_rim_rsm_count_ss
union
    select stat_guid from v_rim_rsm_count_ws
union
    select stat_guid from v_rim_rsm_count_wx
union
    select stat_guid from v_rim_rsm_count_yy where stat_app_type<>'LM') b,rsbt_code_dic c
where a.guid=b.stat_guid(+) and b.stat_guid is  null and a.stat_app_type<>'LM' and a.stat_status='1'
      and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006'
union all
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,et_equ_no
from rsbt_equ d,rsbt_equ_t e,rsbt_station a,(
select stat_guid from v_rim_rsm_count_sm
union
    select stat_guid from v_rim_rsm_count_lj
union
    select stat_guid from v_rim_rsm_count_hm
union
    select stat_guid from v_rim_rsm_count_yy where stat_app_type='LM') b,rsbt_code_dic c
where d.guid=e.guid(+) and d.station_guid=a.guid(+) and a.guid=b.stat_guid(+) and b.stat_guid is null and
      a.stat_app_type='LM'  and a.stat_status='1' and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006')
     where
          org_code=areacode
         and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
        V_Result :=V_Temp;
  end if;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_OTHER_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_OTHER_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from v_rim_rsm_count_other_p t where t.count_year=pyear;
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
	else
		select sum(sum_pay) into V_Temp from v_rim_rsm_count_other_p t where  t.count_year=pyear and t.area_code=areacode;
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
  end if;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_OTHER_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_OTHER_R"(seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
begin
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
    from  (select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
from rsbt_station_r a,(
select stat_guid from v_rim_rsm_count_as_r
union
    select stat_guid from v_rim_rsm_count_bc_r
union
    select stat_guid from v_rim_rsm_count_bt_r
union
    select stat_guid from v_rim_rsm_count_bw_r
union
    select stat_guid from v_rim_rsm_count_cdma_r
union
    select stat_guid from v_rim_rsm_count_gsm_r
union
    select stat_guid from v_rim_rsm_count_wcdma_r
union
    select stat_guid from v_rim_rsm_count_td_scdma_r
union
    select stat_guid from v_rim_rsm_count_gd_r
union
    select stat_guid from v_rim_rsm_count_gx_r
union
    select stat_guid from v_rim_rsm_count_ha_r
union
    select stat_guid from v_rim_rsm_count_hf_r
union
    select stat_guid from v_rim_rsm_count_jq_r
union
    select stat_guid from v_rim_rsm_count_la_r
union
    select stat_guid from v_rim_rsm_count_ms_r
union
    select stat_guid from v_rim_rsm_count_pb_r
union
    select stat_guid from v_rim_rsm_count_sf_r
union
    select stat_guid from v_rim_rsm_count_spm_r
union
    select stat_guid from v_rim_rsm_count_ss_r
union
    select stat_guid from v_rim_rsm_count_ws_r
union
    select stat_guid from v_rim_rsm_count_wx_r
union
    select stat_guid from v_rim_rsm_count_yy_r where stat_app_type<>'LM') b,rsbt_code_dic c
where a.guid=b.stat_guid(+) and b.stat_guid is  null and a.stat_app_type<>'LM' and a.stat_status='1'
      and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006'
union all
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,et_equ_no
from rsbt_equ_r d,rsbt_equ_t_r e,rsbt_station_r a,(
select stat_guid from v_rim_rsm_count_sm_r
union
    select stat_guid from v_rim_rsm_count_lj_r
union
    select stat_guid from v_rim_rsm_count_hm_r
union
    select stat_guid from v_rim_rsm_count_yy_r where stat_app_type='LM') b,rsbt_code_dic c
where d.guid=e.guid(+) and d.station_guid=a.guid(+) and a.guid=b.stat_guid(+) and b.stat_guid is null and
      a.stat_app_type='LM'  and a.stat_status='1' and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006')
    where
            nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Temp;
  else
    select count(*) into V_Temp
    from (select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,'' et_equ_no
from rsbt_station_r a,(
select stat_guid from v_rim_rsm_count_as_r
union
    select stat_guid from v_rim_rsm_count_bc_r
union
    select stat_guid from v_rim_rsm_count_bt_r
union
    select stat_guid from v_rim_rsm_count_bw_r
union
    select stat_guid from v_rim_rsm_count_cdma_r
union
    select stat_guid from v_rim_rsm_count_gsm_r
union
    select stat_guid from v_rim_rsm_count_wcdma_r
union
    select stat_guid from v_rim_rsm_count_td_scdma_r
union
    select stat_guid from v_rim_rsm_count_gd_r
union
    select stat_guid from v_rim_rsm_count_gx_r
union
    select stat_guid from v_rim_rsm_count_ha_r
union
    select stat_guid from v_rim_rsm_count_hf_r
union
    select stat_guid from v_rim_rsm_count_jq_r
union
    select stat_guid from v_rim_rsm_count_la_r
union
    select stat_guid from v_rim_rsm_count_ms_r
union
    select stat_guid from v_rim_rsm_count_pb_r
union
    select stat_guid from v_rim_rsm_count_sf_r
union
    select stat_guid from v_rim_rsm_count_spm_r
union
    select stat_guid from v_rim_rsm_count_ss_r
union
    select stat_guid from v_rim_rsm_count_ws_r
union
    select stat_guid from v_rim_rsm_count_wx_r
union
    select stat_guid from v_rim_rsm_count_yy_r where stat_app_type<>'LM') b,rsbt_code_dic c
where a.guid=b.stat_guid(+) and b.stat_guid is  null and a.stat_app_type<>'LM' and a.stat_status='1'
      and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006'
union all
select a.guid Stat_guid,a.APP_Code,STAT_APP_TYPE||STAT_TDI tech_ID,a.stat_name,a.stat_addr,Stat_app_type,
            c.code_chi_name stat_type_name,substr(app_code,1,length(app_code)-12) APP_Type,STAT_Date_Start,a.org_code,et_equ_no
from rsbt_equ_r d,rsbt_equ_t_r e,rsbt_station_r a,(
select stat_guid from v_rim_rsm_count_sm_r
union
    select stat_guid from v_rim_rsm_count_lj_r
union
    select stat_guid from v_rim_rsm_count_hm_r
union
    select stat_guid from v_rim_rsm_count_yy_r where stat_app_type='LM') b,rsbt_code_dic c
where d.guid=e.guid(+) and d.station_guid=a.guid(+) and a.guid=b.stat_guid(+) and b.stat_guid is null and
      a.stat_app_type='LM'  and a.stat_status='1' and a.stat_type=c.cn(+) and c.code_data_type(+)='00052006')
     where
          org_code=areacode
         and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
        V_Result :=V_Temp;
  end if;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_PAY
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_PAY" (areacode varchar2,pyear number) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  V_Result :=0;
  if areacode='999999' then
  --全部数据计算
    select sum(sum_count) into V_Temp
    from t_rim_rsm_pay_deptcount a,rsbt_org b
    where a.dept_pay=b.guid and count_year=pyear;
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_count) into V_Temp
    from t_rim_rsm_pay_applycount a,rsbt_org b
    where a.dept_pay=b.guid and count_year=pyear;
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Result + V_Temp;
    end if;
  else
    select sum(sum_count) into V_Temp
    from t_rim_rsm_pay_deptcount a,rsbt_org b
    where a.dept_pay=b.guid and  area_code=areacode AND count_year=pyear;
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_count) into V_Temp
    from t_rim_rsm_pay_applycount a,rsbt_org b
    where  a.dept_pay=b.guid and area_code=areacode AND count_year=pyear;
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Result + V_Temp;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_PB
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_PB" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station a,rsbt_net c
		where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
		      AND STAT_APP_Type='V'  AND nvl(c.NET_SVN,'null')='LY06' and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station a,rsbt_net c
		where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
		      AND STAT_APP_Type='V'  AND nvl(c.NET_SVN,'null')='LY06' AND a.org_code=areacode and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_PB_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_PB_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptnetitem
		where count_year=pyear
		and (item_code='310000' or item_code='320000' or item_code='330000');
		if nvl(V_Temp,0)<>0 then
		V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_applynetitem
		where count_year=pyear
		and (item_code='310000' or item_code='320000' or item_code='330000');
		if nvl(V_Temp,0)<>0 then
		V_Result := V_Result + V_Temp;
		end if;
	else
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptnetitem
		where area_code=areacode AND count_year=pyear
		and (item_code='310000' or item_code='320000' or item_code='330000');
    if nvl(V_Temp,0)<>0 then
    V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_applynetitem
    where area_code=areacode AND count_year=pyear
    and (item_code='310000' or item_code='320000' or item_code='330000');
    if nvl(V_Temp,0)<>0 then
    V_Result := V_Result + V_Temp;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_PB_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_PB_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station_r a,rsbt_net_r c
		where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T'
		      AND STAT_APP_Type='V'  AND nvl(c.NET_SVN,'null')='LY06' and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station_r a,rsbt_net_r c
		where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T'
		      AND STAT_APP_Type='V'  AND nvl(c.NET_SVN,'null')='LY06' AND a.org_code=areacode and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SF
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SF" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
            AND STAT_APP_Type='H' and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
     -- and a.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30);
    V_Result :=V_Temp;
  else
    select count(*) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T' and STAT_Status='1'
            AND STAT_APP_Type='H' AND a.org_code=areacode and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    --  and a.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30);
    V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SF_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SF_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
 	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptnetitem
    where item_code='810000' and count_year=pyear and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,to_number(translate(freq_note,'KMGHz',' '))) between 0 and 30 ;
	if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applynetitem
    where item_code='810000' and count_year=pyear and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,to_number(translate(freq_note,'KMGHz',' '))) between 0 and 30 ;
	if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  else
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptnetitem
   where item_code='810000' and area_code=areacode and count_year=pyear and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,to_number(translate(freq_note,'KMGHz',' '))) between 0 and 30 ;
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applynetitem
    where item_code='810000' and area_code=areacode and count_year=pyear and decode(substr(freq_note,-3,3),'KHz',to_number(translate(freq_note,'KMGHz',' '))/1000,'GHz',to_number(translate(freq_note,'KMGHz',' '))*1000,to_number(translate(freq_note,'KMGHz',' '))) between 0 and 30 ;
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SF_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SF_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T'
            AND STAT_APP_Type='H' and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
     -- and a.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30);
    V_Result :=V_Temp;
  else
    select count(*) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid and substr(app_code,1,length(app_code)-12)='T'
            AND STAT_APP_Type='H' AND a.org_code=areacode and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    --  and a.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30);
    V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SM
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SM" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
      from rsbt_equ a,rsbt_station b,rsbt_net c
      where b.STAT_APP_Type='LM' and a.station_guid=b.guid and STAT_Status='1'
        and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
        and substr(app_code,1,length(app_code)-12)='T'
        and b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
				and b.net_guid=c.guid(+);
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
			from rsbt_equ a,rsbt_station b,rsbt_net c
			where b.STAT_APP_Type='LM' and a.station_guid=b.guid and STAT_Status='1'
				and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
				and substr(app_code,1,length(app_code)-12)='T'
				AND b.org_code=areacode
				and  b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
				and b.net_guid=c.guid(+);
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SM_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SM_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where item_code='820000' and count_year=pyear
			and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI  from rsbt_equ a,rsbt_station b,rsbt_net c
      where b.STAT_APP_Type='LM' and a.station_guid=b.guid
				and substr(app_code,1,length(app_code)-12)='T'
				and  b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
				and b.net_guid=c.guid(+) and nvl(c.net_svn,' ')<>'LY02');
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
		where item_code='820000' and count_year=pyear
		and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI  from rsbt_equ a,rsbt_station b,rsbt_net c
      where b.STAT_APP_Type='LM' and a.station_guid=b.guid
				and substr(app_code,1,length(app_code)-12)='T'
				and  b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
				and b.net_guid=c.guid(+) and nvl(c.net_svn,' ')<>'LY02');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  else
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
    where area_code=areacode AND item_code='820000' and count_year=pyear
     and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI  from rsbt_equ a,rsbt_station b,rsbt_net c
      where b.STAT_APP_Type='LM' and a.station_guid=b.guid
				and substr(app_code,1,length(app_code)-12)='T'
				and  b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
				and b.net_guid=c.guid(+) and nvl(c.net_svn,' ')<>'LY02');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
    where area_code=areacode AND item_code='820000' and count_year=pyear
     and apply_code||decl_code in (select substr(app_code,-12,12)||STAT_APP_Type||STAT_TDI  from rsbt_equ a,rsbt_station b,rsbt_net c
      where b.STAT_APP_Type='LM' and a.station_guid=b.guid
				and substr(app_code,1,length(app_code)-12)='T'
				and  b.guid in (select distinct station_guid from rsbt_freq where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
				and b.net_guid=c.guid(+) and nvl(c.net_svn,' ')<>'LY02');
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SM_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SM_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
      from rsbt_equ_r a,rsbt_station_r b,rsbt_net_r c
      where b.STAT_APP_Type='LM' and a.station_guid=b.guid
        and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
        and substr(app_code,1,length(app_code)-12)='T'
        and b.guid in (select distinct station_guid from rsbt_freq_r where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
				and b.net_guid=c.guid(+);
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
			from rsbt_equ_r a,rsbt_station_r b,rsbt_net_r c
			where b.STAT_APP_Type='LM' and a.station_guid=b.guid
				and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
				and substr(app_code,1,length(app_code)-12)='T'
				AND b.org_code=areacode
				and  b.guid in (select distinct station_guid from rsbt_freq_r where nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)>=0 and nvl(decode(FREQ_Type,'0',FREQ_UC,'1',FREQ_EFB,FREQ_UC),0)<=30)
				and b.net_guid=c.guid(+);
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SPM
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SPM" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station a
		where STAT_APP_Type='ME' and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T' AND nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate ;
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station a
		where STAT_APP_Type='ME' and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T' AND nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			AND a.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SPM_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SPM_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem  a,rsbt_station b
		where item_code='100100' and count_year=pyear
			and decl_code like 'ME%' and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T'  and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem a,rsbt_station b
		where item_code='100100' and count_year=pyear
			and decl_code like 'ME%' and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T'  and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp+V_Result;
		end if;
	else
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem  a,rsbt_station b
		where area_code=areacode AND item_code='100100' and count_year=pyear
      and decl_code like 'ME%' and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem  a,rsbt_station b
		where area_code=areacode AND item_code='100100' and count_year=pyear
			and decl_code like 'ME%' and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp+V_Result;
		end if;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SPM_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SPM_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		from rsbt_station_r a
		where STAT_APP_Type='ME' and substr(app_code,1,length(app_code)-12)='T' AND nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate ;
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station_r a
		where STAT_APP_Type='ME' and substr(app_code,1,length(app_code)-12)='T' AND nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
			AND a.org_code=areacode;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SS
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SS" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
    from rsbt_station
    where STAT_APP_Type='S' and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T' and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station
		where STAT_APP_Type='S' and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T' AND org_code=areacode and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SS_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SS_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptitem a,rsbt_station b
		where count_year=pyear and (item_code='610000' or item_code='620000' or item_code='630000')
    and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_applyitem a,rsbt_station b
		where count_year=pyear and (item_code='610000' or item_code='620000' or item_code='630000')
    and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
		if nvl(V_Temp,0)<>0 then
			V_Result := V_Result + V_Temp;
		end if;
	else
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptitem a,rsbt_station b
		where area_code=areacode AND count_year=pyear and (item_code='610000' or item_code='620000' or item_code='630000')
    and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_applyitem a,rsbt_station b
    where area_code=areacode AND count_year=pyear and (item_code='610000' or item_code='620000' or item_code='630000')
    and a.apply_code= substr(b.app_code,-12,12) and substr(app_code,1,length(app_code)-12)='T' and a.decl_code = b.STAT_APP_Type||b.stat_tdi;
    if nvl(V_Temp,0)<>0 then
      V_Result := V_Result + V_Temp;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_SS_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_SS_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
    from rsbt_station_r
    where STAT_APP_Type='S' and substr(app_code,1,length(app_code)-12)='T' and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	else
		select count(*) into V_Temp
		from rsbt_station_r
		where STAT_APP_Type='S' and substr(app_code,1,length(app_code)-12)='T' AND org_code=areacode and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_STAT
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_STAT" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  V_Result :=0;
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
    from rsbt_station
    where  STAT_Status='1' AND STAT_APP_Type<>'LM' and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Temp;
    select count(*) into V_Temp
    from rsbt_equ a,rsbt_station b
    where STAT_Status='1' AND a.station_guid=b.guid and b.STAT_APP_Type='LM' and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Result + V_Temp;
  else
    select count(*) into V_Temp
    from rsbt_station
    where STAT_Status='1' and ORG_Code=areacode  AND STAT_APP_Type<>'LM' and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Temp;

    select count(*) into V_Temp
    from rsbt_equ a,rsbt_station b
    where STAT_Status='1' AND a.station_guid=b.guid and b.STAT_APP_Type='LM' and  b.ORG_Code=areacode and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Result + V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_STAT_NET
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_STAT_NET" (netSvn varchar2,seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  V_Result :=0;
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
    from rsbt_station a,rsbt_net b
    where  a.STAT_Status='1' AND a.STAT_APP_Type<>'LM' and a.net_guid=b.guid and b.net_svn=netSvn and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Temp;
    select count(*) into V_Temp
    from rsbt_equ a,rsbt_station b,rsbt_net c
    where STAT_Status='1' AND a.station_guid=b.guid and b.STAT_APP_Type='LM'  and b.net_guid=c.guid and c.net_svn=netSvn and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Result + V_Temp;

  else
    select count(*) into V_Temp
    from rsbt_station a,rsbt_net b
    where a.STAT_Status='1' and a.ORG_Code=areacode  AND a.STAT_APP_Type<>'LM' and a.net_guid=b.guid and b.net_svn=netSvn  and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Temp;
    select count(*) into V_Temp
    from rsbt_equ a,rsbt_station b,rsbt_net c
    where STAT_Status='1' AND a.station_guid=b.guid and b.STAT_APP_Type='LM' and  b.ORG_Code=areacode and b.net_guid=c.guid and c.net_svn=netSvn and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Result + V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_STAT_ORG
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_STAT_ORG" (orgGuid varchar2,seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  V_Result :=0;
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
    from rsbt_station a,rsbt_net b,rsbt_org c
    where  a.STAT_Status='1' AND a.STAT_APP_Type<>'LM' and a.net_guid=b.guid(+) and b.org_guid=c.guid(+) and c.guid=orgGuid and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Temp;
    select count(*) into V_Temp
    from rsbt_equ a,rsbt_station b,rsbt_net c,rsbt_org d
    where STAT_Status='1' AND a.station_guid=b.guid and b.STAT_APP_Type='LM'  and b.net_guid=c.guid(+) and c.org_guid=d.guid(+) and d.guid=orgGuid and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Result + V_Temp;
  else
    select count(*) into V_Temp
    from rsbt_station a,rsbt_net b,rsbt_org c
    where a.STAT_Status='1' and a.ORG_Code=areacode  AND a.STAT_APP_Type<>'LM' and  a.net_guid=b.guid(+) and b.org_guid=c.guid(+) and c.guid=orgGuid   and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Temp;
    select count(*) into V_Temp
    from rsbt_equ a,rsbt_station b,rsbt_net c,rsbt_org d
    where STAT_Status='1' AND a.station_guid=b.guid and b.STAT_APP_Type='LM' and  b.ORG_Code=areacode and b.net_guid=c.guid(+)  and c.org_guid=d.guid(+) and d.guid=orgGuid and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Result + V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_STAT_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_STAT_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  V_Result :=0;
  if areacode='999999' then
  --全部数据计算
    select count(*) into V_Temp
    from rsbt_station_r
    where  STAT_APP_Type<>'LM' and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Temp;
    select count(*) into V_Temp
    from rsbt_equ_r a,rsbt_station_r b
    where  a.station_guid=b.guid and b.STAT_APP_Type='LM' and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Result + V_Temp;
  else
    select count(*) into V_Temp
    from rsbt_station_r
    where   ORG_Code=areacode  AND STAT_APP_Type<>'LM' and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Temp;

    select count(*) into V_Temp
    from rsbt_equ_r a,rsbt_station_r b
    where  a.station_guid=b.guid and b.STAT_APP_Type='LM' and  b.ORG_Code=areacode and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
    V_Result :=V_Result + V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_STAT_TYPE
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_STAT_TYPE" (stattype varchar2,seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  V_Result :=0;
  if areacode='999999' then
  --全部数据计算
    if(stattype<>'LM') then
      select count(*) into V_Temp
      from rsbt_station
      where  STAT_Status='1' AND STAT_APP_Type=stattype and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
      V_Result :=V_Temp;
   else
      select count(*) into V_Temp
      from rsbt_equ a,rsbt_station b
      where STAT_Status='1' AND a.station_guid=b.guid and b.STAT_APP_Type='LM' and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
      V_Result :=V_Temp;
    end if;
 else
    if(stattype<>'LM') then
      select count(*) into V_Temp
      from rsbt_station
      where STAT_Status='1' and ORG_Code=areacode  AND STAT_APP_Type=stattype and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
      V_Result :=V_Temp;
    else
      select count(*) into V_Temp
      from rsbt_equ a,rsbt_station b
      where STAT_Status='1' AND a.station_guid=b.guid and b.STAT_APP_Type='LM' and  b.ORG_Code=areacode and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
      V_Result :=V_Temp;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_TDCDMA
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_TDCDMA" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
       and (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
       and c.net_ts='LY0104' --TD-SCDMA系统
       and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
          and ((FREQ_TYPE='0' and (FREQ_UC>=1880 and FREQ_UC<=1900) or (FREQ_UC>=2010 and FREQ_UC<=2025) or(FREQ_UC>=2320 and FREQ_UC<=2370) or (FREQ_UC>=2570 and FREQ_UC<=2620))
                or (FREQ_TYPE='1' and (FREQ_EFE>=1880 and FREQ_EFB<=1900) or (FREQ_EFE>=2010 and FREQ_EFB<=2025) or (FREQ_EFE>=2320 and FREQ_EFB<=2370) or (FREQ_EFE>=2570 and FREQ_EFB<=2620))));
   V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode
       and (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
       and c.net_ts='LY0104' --TD-SCDMA系统
       and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
          and ((FREQ_TYPE='0' and (FREQ_UC>=1880 and FREQ_UC<=1900) or (FREQ_UC>=2010 and FREQ_UC<=2025) or(FREQ_UC>=2320 and FREQ_UC<=2370) or (FREQ_UC>=2570 and FREQ_UC<=2620))
                or (FREQ_TYPE='1' and (FREQ_EFE>=1880 and FREQ_EFB<=1900) or (FREQ_EFE>=2010 and FREQ_EFB<=2025) or (FREQ_EFE>=2320 and FREQ_EFB<=2370) or (FREQ_EFE>=2570 and FREQ_EFB<=2620))));
   V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_TDCDMA_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_TDCDMA_P" (areacode varchar2,pyear number) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
   select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_deptitem m,
      (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
       AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND ((FREQ_UC>=1880 AND FREQ_UC<=1900 ) OR (FREQ_UC>=2010 AND FREQ_UC<=2025 )OR (FREQ_UC>=2320 AND FREQ_UC<=2370 )OR (FREQ_UC>=2570 AND FREQ_UC<=2620 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFE>=1880 AND FREQ_EFB<=1900 ) OR (FREQ_EFE>=2010 AND FREQ_EFB<=2025 )OR (FREQ_EFE>=2320 AND FREQ_EFB<=2370 )OR (FREQ_EFE>=2570 AND FREQ_EFB<=2620 ))))) or (STAT_APP_Type='D' AND NET_ts='LY0104'))) n
      where count_year=pyear and to_char(m.apply_code)=substr(n.app_code,-12,12) and m.decl_code=n.decl_code;
    if nvl(V_Temp,0)<>0 then
    V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_applyitem m,
      (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
       AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND ((FREQ_UC>=1880 AND FREQ_UC<=1900 ) OR (FREQ_UC>=2010 AND FREQ_UC<=2025 )OR (FREQ_UC>=2320 AND FREQ_UC<=2370 )OR (FREQ_UC>=2570 AND FREQ_UC<=2620 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFE>=1880 AND FREQ_EFB<=1900 ) OR (FREQ_EFE>=2010 AND FREQ_EFB<=2025 )OR (FREQ_EFE>=2320 AND FREQ_EFB<=2370 )OR (FREQ_EFE>=2570 AND FREQ_EFB<=2620 ))))) or (STAT_APP_Type='D' AND NET_ts='LY0104'))) n
      where count_year=pyear and to_char(m.apply_code)=substr(n.app_code,-12,12) and m.decl_code=n.decl_code;
    if nvl(V_Temp,0)<>0 then
      V_Result := V_Result + V_Temp;
    end if;
  else
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_deptitem m,
      (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
       AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND ((FREQ_UC>=1880 AND FREQ_UC<=1900 ) OR (FREQ_UC>=2010 AND FREQ_UC<=2025 )OR (FREQ_UC>=2320 AND FREQ_UC<=2370 )OR (FREQ_UC>=2570 AND FREQ_UC<=2620 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFE>=1880 AND FREQ_EFB<=1900 ) OR (FREQ_EFE>=2010 AND FREQ_EFB<=2025 )OR (FREQ_EFE>=2320 AND FREQ_EFB<=2370 )OR (FREQ_EFE>=2570 AND FREQ_EFB<=2620 ))))) or (STAT_APP_Type='D' AND NET_ts='LY0104'))) n
       where count_year=pyear and to_char(m.apply_code)=substr(n.app_code,-12,12) and m.decl_code=n.decl_code;
    if nvl(V_Temp,0)<>0 then
      V_Result := V_Result + V_Temp;
    end if;
       select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_applyitem m,
      (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
      AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND ((FREQ_UC>=1880 AND FREQ_UC<=1900 ) OR (FREQ_UC>=2010 AND FREQ_UC<=2025 )OR (FREQ_UC>=2320 AND FREQ_UC<=2370 )OR (FREQ_UC>=2570 AND FREQ_UC<=2620 )))
                   OR (FREQ_TYPE='1' AND ((FREQ_EFE>=1880 AND FREQ_EFB<=1900 ) OR (FREQ_EFE>=2010 AND FREQ_EFB<=2025 )OR (FREQ_EFE>=2320 AND FREQ_EFB<=2370 )OR (FREQ_EFE>=2570 AND FREQ_EFB<=2620 ))))) or (STAT_APP_Type='D' AND NET_ts='LY0104'))) n
      where count_year=pyear and to_char(m.apply_code)=substr(n.app_code,-12,12) and m.decl_code=n.decl_code;
    if nvl(V_Temp,0)<>0 then
      V_Result := V_Result + V_Temp;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_TDCDMA_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_TDCDMA_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid  and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
       and (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
       and c.net_ts='LY0104' --TD-SCDMA系统
       and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
          and ((FREQ_TYPE='0' and (FREQ_UC>=1880 and FREQ_UC<=1900) or (FREQ_UC>=2010 and FREQ_UC<=2025) or(FREQ_UC>=2320 and FREQ_UC<=2370) or (FREQ_UC>=2570 and FREQ_UC<=2620))
                or (FREQ_TYPE='1' and (FREQ_EFE>=1880 and FREQ_EFB<=1900) or (FREQ_EFE>=2010 and FREQ_EFB<=2025) or (FREQ_EFE>=2320 and FREQ_EFB<=2370) or (FREQ_EFE>=2570 and FREQ_EFB<=2620))));
   V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid  and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode
       and (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
       and c.net_ts='LY0104' --TD-SCDMA系统
       and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
          and ((FREQ_TYPE='0' and (FREQ_UC>=1880 and FREQ_UC<=1900) or (FREQ_UC>=2010 and FREQ_UC<=2025) or(FREQ_UC>=2320 and FREQ_UC<=2370) or (FREQ_UC>=2570 and FREQ_UC<=2620))
                or (FREQ_TYPE='1' and (FREQ_EFE>=1880 and FREQ_EFB<=1900) or (FREQ_EFE>=2010 and FREQ_EFB<=2025) or (FREQ_EFE>=2320 and FREQ_EFB<=2370) or (FREQ_EFE>=2570 and FREQ_EFB<=2620))));
   V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_WCDMA
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_WCDMA" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
       AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
       --and c.net_ts='LY0103' --WCDMA系统
       and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
       AND ((FREQ_TYPE='0' AND (FREQ_UC>=2130 AND FREQ_UC<=2145 ))
             OR (FREQ_TYPE='1' AND (FREQ_EFE>=2130 AND FREQ_EFB<=2145 ))));
   V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
    from rsbt_station a,rsbt_net c
    where a.net_guid=c.guid and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode
       AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
       --and c.net_ts='LY0103' --WCDMA系统
       and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
       AND ((FREQ_TYPE='0' AND (FREQ_UC>=2130 AND FREQ_UC<=2145 ))
             OR (FREQ_TYPE='1' AND (FREQ_EFE>=2130 AND FREQ_EFB<=2145 ))));
   V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_WCDMA_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_WCDMA_P" (areacode varchar2,pyear number) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
     select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_deptitem m,
      (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
        AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND (FREQ_UC>=2130 AND FREQ_UC<=2145 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=2130 AND FREQ_EFB<=2145))))  or (STAT_APP_Type='D' AND NET_ts='LY0103'))) n
    where count_year=pyear and to_char(m.apply_code)=substr(n.app_code,-12,12) and m.decl_code=n.decl_code;
    if nvl(V_Temp,0)<>0 then
    V_Result :=V_Temp;
    end if;
    select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_applyitem m,
      (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
       AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND (FREQ_UC>=2130 AND FREQ_UC<=2145 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=2130 AND FREQ_EFB<=2145)))) or (STAT_APP_Type='D' AND NET_ts='LY0103'))) n
    where count_year=pyear and to_char(m.apply_code)=substr(n.app_code,-12,12) and m.decl_code=n.decl_code;
    if nvl(V_Temp,0)<>0 then
    V_Result := V_Result + V_Temp;
    end if;
  else
   select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_deptitem m,
      (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
  AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND (FREQ_UC>=2130 AND FREQ_UC<=2145 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=2130 AND FREQ_EFB<=2145)))) or (STAT_APP_Type='D'))) n
    where area_code=areacode AND count_year=pyear and to_char(m.apply_code)=substr(n.app_code,-12,12) and m.decl_code=n.decl_code;
    if nvl(V_Temp,0)<>0 then
    V_Result :=V_Temp;
    end if;
      select sum(sum_pay) into V_Temp
    from t_rim_rsm_pay_applyitem m,
      (select distinct app_code,stat_app_type||stat_tdi decl_code
    from rsbt_station a,rsbt_net c,RSBT_FREQ D
    where a.net_guid=c.guid  AND A.GUID=D.STATION_GUID and substr(app_code,1,length(app_code)-12)='T'
  AND ((STAT_APP_Type='C'  AND ((FREQ_TYPE='0' AND (FREQ_UC>=2130 AND FREQ_UC<=2145 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=2130 AND FREQ_EFB<=2145)))) or (STAT_APP_Type='D'))) n
    where area_code=areacode AND count_year=pyear and to_char(m.apply_code)=substr(n.app_code,-12,12) and m.decl_code=n.decl_code;
    if nvl(V_Temp,0)<>0 then
   V_Result := V_Result + V_Temp;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_WCDMA_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_WCDMA_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
 begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid  and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
       AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
       --and c.net_ts='LY0103' --WCDMA系统
       and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
       AND ((FREQ_TYPE='0' AND (FREQ_UC>=2130 AND FREQ_UC<=2145 ))
             OR (FREQ_TYPE='1' AND (FREQ_EFE>=2130 AND FREQ_EFB<=2145 ))));
   V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
    from rsbt_station_r a,rsbt_net_r c
    where a.net_guid=c.guid  and substr(app_code,1,length(app_code)-12)='T'
       and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND a.org_code=areacode
       AND (STAT_APP_Type='C' OR STAT_APP_TYPE='D')
       --and c.net_ts='LY0103' --WCDMA系统
       and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
       AND ((FREQ_TYPE='0' AND (FREQ_UC>=2130 AND FREQ_UC<=2145 ))
             OR (FREQ_TYPE='1' AND (FREQ_EFE>=2130 AND FREQ_EFB<=2145 ))));
   V_Result :=V_Temp;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_WS
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_COUNT_WS" (seldate date,areacode varchar2,gethistory varchar2)

return number
is
  V_Result number:=0;
  V_Temp   number;
begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
       from rsbt_station a,rsbt_net c
        where a.net_guid=c.guid and STAT_APP_Type='C' and substr(app_code,1,length(app_code)-12)

='T'and STAT_Status='1'
           and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-

7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
           and c.net_ts<>'LY0104' --避免与TD-SCDMA系统的台站重复
           and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
               AND ((FREQ_TYPE='0' AND (FREQ_UC>=1900 AND FREQ_UC<=1920 ))
                  OR (FREQ_TYPE='1' AND (FREQ_EFE>=1900 AND FREQ_EFB<=1920 ))));
    V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
       from rsbt_station a,rsbt_net c
        where a.net_guid=c.guid and STAT_APP_Type='C' and substr(app_code,1,length(app_code)-12)

='T'and STAT_Status='1'
           and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-

7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND

a.org_code=areacode
           and c.net_ts<>'LY0104' --避免与TD-SCDMA系统的台站重复
           and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
               AND ((FREQ_TYPE='0' AND (FREQ_UC>=1900 AND FREQ_UC<=1920 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=1900 AND FREQ_EFB<=1920 ))));
    V_Result :=V_Temp;
  end if;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_WS_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_WS_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where (item_code='410000' or item_code='120200')
			and count_year=pyear;
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
		where (item_code='410000' or item_code='120200')
			and count_year=pyear;
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp+V_Result;
		end if;
	else
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_deptitem
		where (item_code='410000' or item_code='120200')
			and area_code=areacode AND count_year=pyear;
		if nvl(V_Temp,0)<>0 then
			V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp from t_rim_rsm_pay_applyitem
    where (item_code='410000' or item_code='120200')
      and area_code=areacode AND count_year=pyear;
    if nvl(V_Temp,0)<>0 then
      V_Result :=V_Temp+V_Result;
    end if;
  end if;
      return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_WS_R
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_COUNT_WS_R" (seldate date,areacode varchar2,gethistory varchar2)

return number
is
  V_Result number:=0;
  V_Temp   number;
begin
  if areacode='999999' then
  --全部数据计算
    select count(a.guid) into V_Temp
       from rsbt_station_r a,rsbt_net_r c
        where a.net_guid=c.guid and STAT_APP_Type='C' and substr(app_code,1,length(app_code)-12)

='T'
           and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-

7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
           and c.net_ts<>'LY0104' --避免与TD-SCDMA系统的台站重复
           and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
               AND ((FREQ_TYPE='0' AND (FREQ_UC>=1900 AND FREQ_UC<=1920 ))
                  OR (FREQ_TYPE='1' AND (FREQ_EFE>=1900 AND FREQ_EFB<=1920 ))));
    V_Result :=V_Temp;
  else
    select count(a.guid) into V_Temp
       from rsbt_station_r a,rsbt_net_r c
        where a.net_guid=c.guid and STAT_APP_Type='C' and substr(app_code,1,length(app_code)-12)

='T'
           and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-

7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate AND

a.org_code=areacode
           and c.net_ts<>'LY0104' --避免与TD-SCDMA系统的台站重复
           and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
               AND ((FREQ_TYPE='0' AND (FREQ_UC>=1900 AND FREQ_UC<=1920 ))
                   OR (FREQ_TYPE='1' AND (FREQ_EFE>=1900 AND FREQ_EFB<=1920 ))));
    V_Result :=V_Temp;
  end if;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_WX
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_COUNT_WX" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
begin
  if areacode='999999' then
  --全部数据计算
    select count( a.guid) into V_Temp
    from rsbt_station a
    where  STAT_Status='1' AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
        and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
        and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
        AND ((FREQ_TYPE='0' AND (FREQ_UC>=223 AND FREQ_UC<=235) or (FREQ_UC>=866 AND FREQ_UC<=870))
             OR (FREQ_TYPE='1' AND (FREQ_EFE>=223 AND FREQ_EFB<=235 ) or (FREQ_EFE>=866 AND FREQ_EFB<=870 ))));
    V_Result :=V_Temp;
  else
    select count( a.guid) into V_Temp
    from rsbt_station a
     where  STAT_Status='1' AND STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T' and a.org_code=areacode
        and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
        and exists (select d.station_guid from rsbt_freq d where a.guid=d.station_guid
        AND ((FREQ_TYPE='0' AND (FREQ_UC>=223 AND FREQ_UC<=235) or (FREQ_UC>=866 AND FREQ_UC<=870))
             OR (FREQ_TYPE='1' AND (FREQ_EFE>=223 AND FREQ_EFB<=235 ) or (FREQ_EFE>=866 AND FREQ_EFB<=870 ))));
    V_Result :=V_Temp;
  end if;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_WX_P
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_WX_P" (areacode varchar2,pyear number) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptitem
		where count_year=pyear and  item_code='140100';
		if nvl(V_Temp,0)<>0 then
		V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_applyitem
		where count_year=pyear and item_code='140100';
		if nvl(V_Temp,0)<>0 then
		V_Result := V_Result + V_Temp;
		end if;
	else
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_deptitem
		where area_code=areacode AND count_year=pyear and item_code='140100';
		if nvl(V_Temp,0)<>0 then
		V_Result :=V_Temp;
		end if;
		select sum(sum_pay) into V_Temp
		from t_rim_rsm_pay_applyitem
		where area_code=areacode AND count_year=pyear  and item_code='140100';
		if nvl(V_Temp,0)<>0 then
    V_Result := V_Result + V_Temp;
    end if;
  end if;
  return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_WX_R
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_COUNT_WX_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
  V_Result number:=0;
  V_Temp   number;
begin
  if areacode='999999' then
  --全部数据计算
    select count( a.guid) into V_Temp
    from rsbt_station_r a
    where  STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T'
        and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
        and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
        AND ((FREQ_TYPE='0' AND (FREQ_UC>=223 AND FREQ_UC<=235) or (FREQ_UC>=866 AND FREQ_UC<=870))
             OR (FREQ_TYPE='1' AND (FREQ_EFE>=223 AND FREQ_EFB<=235 ) or (FREQ_EFE>=866 AND FREQ_EFB<=870 ))));
    V_Result :=V_Temp;
  else
    select count( a.guid) into V_Temp
    from rsbt_station_r a
     where  STAT_APP_Type='TF' and substr(app_code,1,length(app_code)-12)='T' and a.org_code=areacode
        and nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
        and exists (select d.station_guid from rsbt_freq_r d where a.guid=d.station_guid
        AND ((FREQ_TYPE='0' AND (FREQ_UC>=223 AND FREQ_UC<=235) or (FREQ_UC>=866 AND FREQ_UC<=870))
             OR (FREQ_TYPE='1' AND (FREQ_EFE>=223 AND FREQ_EFB<=235 ) or (FREQ_EFE>=866 AND FREQ_EFB<=870 ))));
    V_Result :=V_Temp;
  end if;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_YY
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_YY" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		   from rsbt_station a
		   where nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
		   		 and STAT_APP_Type<>'LM' and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='PA';
		V_Result :=V_Temp;
		select count(*) into V_Temp
		  from rsbt_equ a,rsbt_station b
		   where a.station_guid=b.guid and b.STAT_APP_Type='LM' and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='PA'
		    and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Result + V_Temp;
	else
		select count(*) into V_Temp
		  from rsbt_station a
		  where nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
		  	 and STAT_APP_Type<>'LM' and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='PA'
				 AND a.org_code=areacode;
		V_Result :=V_Temp;
		select count(*) into V_Temp
		  from rsbt_equ a,rsbt_station b
		  where a.station_guid=b.guid and b.STAT_APP_Type='LM' and STAT_Status='1' and substr(app_code,1,length(app_code)-12)='PA'
		  	 and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
		    AND b.org_code=areacode;
		V_Result :=V_Result + V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_COUNT_YY_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_COUNT_YY_R" (seldate date,areacode varchar2,gethistory varchar2) return number
is
	V_Result number:=0;
	V_Temp   number;
 begin
	if areacode='999999' then
	--全部数据计算
		select count(*) into V_Temp
		   from rsbt_station_r a
		   where nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
		   		 and STAT_APP_Type<>'LM'  and substr(app_code,1,length(app_code)-12)='PA';
		V_Result :=V_Temp;
		select count(*) into V_Temp
		  from rsbt_equ_r a,rsbt_station_r b
		   where a.station_guid=b.guid and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='PA'
		    and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate;
		V_Result :=V_Result + V_Temp;
	else
		select count(*) into V_Temp
		  from rsbt_station_r a
		  where nvl(STAT_Date_Start,to_date( decode(substr(app_code,length(app_code)-7,4),'0000','1900',substr(app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
		  	 and STAT_APP_Type<>'LM'  and substr(app_code,1,length(app_code)-12)='PA'
				 AND a.org_code=areacode;
		V_Result :=V_Temp;
		select count(*) into V_Temp
		  from rsbt_equ_r a,rsbt_station_r b
		  where a.station_guid=b.guid and b.STAT_APP_Type='LM' and substr(app_code,1,length(app_code)-12)='PA'
		  	 and nvl(b.STAT_Date_Start,to_date( decode(substr(b.app_code,length(app_code)-7,4),'0000','1900',substr(b.app_code,length(app_code)-7,4))||'.1.1','YYYY.MM.DD'))<=seldate
		    AND b.org_code=areacode;
		V_Result :=V_Result + V_Temp;
	end if;
	return V_Result;
 end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_DATE
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_DATE"(inputdate date) return varchar2
is
  curyear number;
  curmonth number;
  curday  number;
  yearchar varchar2(20);
  midnum  number;
  midyear  varchar2(10);
  midmonth varchar2(5);
  midday  varchar2(5);
  V_Result varchar2(30);
begin
  midday:='';
  midmonth:='';
  yearchar:='0一二三四五六七八九';
  curyear:=to_number(to_char(inputdate,'YYYY'));
  curmonth:=to_number(to_char(inputdate,'MM'));
  curday:=to_number(to_char(inputdate,'dd'));
  midnum:=trunc(curyear/1000,0);
  midyear:=substr(yearchar,midnum+1,1);
  curyear:=curyear-midnum*1000;
  midnum:=trunc(curyear/100,0);
  midyear:=midyear||substr(yearchar,midnum+1,1);
  curyear:=curyear-midnum*100;
  midnum:=trunc(curyear/10,0);
  midyear:=midyear||substr(yearchar,midnum+1,1);
  curyear:=curyear-midnum*10;
  V_Result:=midyear||substr(yearchar,curyear+1,1)||'年';
  if curmonth=10 then
    midmonth:='十';
  elsif curmonth=11 then
    midmonth:='十一';
  elsif curmonth=12 then
    midmonth:='十二';
  else
    midmonth:=substr(yearchar,curmonth+1,1);
  end if;
  V_Result:=V_Result||midmonth||'月';
  midnum:=trunc(curday/10,0);
  if midnum>1 then
    midday:=substr(yearchar,midnum+1,1)||'十';
  elsif midnum=1 then
    midday:='十';
  end if;
  curday:=curday-midnum*10;
  if curday>0 then
    V_Result:=V_Result||midday||substr(yearchar,curday+1,1)||'日';
  else
    V_Result:=V_Result||midday||'日';
  end if;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_DISTANCECOUNT
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_DISTANCECOUNT"(longi1 number,lati1 number,longi2 number,lati2 number) return number is
  x1 number;
  x2 number;
  y1 number;
  y2 number;
  distance number;
  procedure LLToXY(lati in number,L in number,Num in number,X in out number,Y in out number)
  is
    B number;
    e12  number;
    c  number;
    xx  number;
    m  number;
    n  number;
    Nn  number;
    t  number;
    PI  number;
    P0  number;
  begin
    PI := 3.1415926535897932;
    P0 := 57.2957795130823210;
    B := lati/P0;
    e12 := 0.006739501819473;
    c := 6399596.6519880105;
    xx := 111133.0047*Lati - (32009.8575*sin(B) + 133.9602*power(sin(B),3) + 0.6976*power(sin(B),5) + 0.0039*power(sin(B),7))*cos(B);
    m := cos(B)*L*PI/180.;
    n := sqrt(e12) * cos(B);
    Nn := c / sqrt(1+n*n);
    t := tan(B);

    X := xx+Nn*t*( m*m/2 + (5-t*t+9*n*n+4*power(n,4))*power(m,4)/24 + (61-58*t*t+power(t,4))*power(m,6)/720);
    Y := Nn*(m + (1.-t*t+n*n)*power(m,3)/6.+(5.-18.*t*t+power(t,4)+14*n*n-58*n*n*t*t)*power(m,5)/120.);
    Y:=Y+5000000+Num*10000000;
  end LLToXY;

  procedure LLToXY66(longib in number,longie in number,longi in number,lati in number,X in out number,Y in out number)
  is
    L  number;
    Num  number;
  begin
    if floor(longi/6) = longi/6.0 then
      L := 3+longi-longib;
      Num := longib/6.0;
    else
      L := longi-floor(longib/6.0)*6+3;
      Num :=floor(longib/6.0);
    end if;
    LLToXY(lati,L,Num,X,Y);
  end LLToXY66;

  procedure LLToXY69(longib in number,longie in number,longi in number,lati in number,X in out number,Y in out number)
  is
    L  number;
    Num  number;
  begin
    if floor(longi/6) = longi/6.0 then
      L := 3;
      Num := longib/6.0;
    else
      L := longi-floor(longib/6.0)*6+3;
      Num :=floor(longib/6.0);
    end if;
    LLToXY(lati,L,Num,X,Y);
  end LLToXY69;

  procedure LLToXY96(longib in number,longie in number,longi in number,lati in number,X in out number,Y in out number)
  is
    L  number;
    Num  number;
  begin
    if floor(longi/6) = longi/6.0 then
      L := -3;
      Num := longib/6.0+1;
    else
      L := longi-floor(longib/6.0)*6-3;
      Num :=floor(longib/6.0)+1;
    end if;
    LLToXY(lati,L,Num,X,Y);
  end LLToXY96;

  procedure LLToXY93(longib in number,longie in number,longi in number,lati in number,X in out number,Y in out number)
  is
    L  number;
    Num  number;
  begin
    if floor(longi/6) = longi/6.0 then
      L := 3;
      Num := longib/6.0+1;
    else
      L := longi-floor(longib/6.0)*6-3;
      Num :=floor(longib/6.0)+1;
    end if;
    LLToXY(lati,L,Num,X,Y);
  end LLToXY93;

  procedure LLToXY36(longib in number,longie in number,longi in number,lati in number,X in out number,Y in out number)
  is
    L  number;
    Num  number;
  begin
    if floor(longi/6) = longi/6.0 then
      L := longie-longi-3;
      Num := longib/6.0+1;
    else
      L := longi-floor(longib/6.0)*6-3;
      Num :=floor(longib/6.0)+1;
    end if;
    LLToXY(lati,L,Num,X,Y);
  end LLToXY36;

  procedure LLToXY39(longib in number,longie in number,longi in number,lati in number,X in out number,Y in out number)
  is
    L  number;
    Num  number;
  begin
    if floor(longi/6) = longi/6.0 then
      L := longi-longie+3;
      Num := longib/6.0+1;
    else
      L := longi-floor(longie/6.0)*6-3;
      Num :=floor(longie/6.0)+1;
    end if;
    LLToXY(lati,L,Num,X,Y);
  end LLToXY39;

begin
  if  Longi1=floor(Longi1/6.0)*6.0 then
    if Longi2=floor(Longi2/6.0) *6.0 then
      LLToXY66(Longi1, Longi2,Longi1,Lati1,x1,y1);
      LLToXY66(Longi1, Longi2,Longi2,Lati2,x2,y2);
    else
      LLToXY69(Longi1, Longi2,Longi1,Lati1,x1,y1);
      LLToXY69(Longi1, Longi2,Longi2,Lati2,x2,y2);
    end if;
  else
     if Longi1>Longi2 then
      if Longi2=floor(Longi2/6.0)*6.0 then
        LLToXY96(Longi1, Longi2,Longi1,Lati1,x1,y1);
        LLToXY96(Longi1, Longi2,Longi2,Lati2,x2,y2);
      else
        LLToXY93(Longi1, Longi2,Longi1,Lati1,x1,y1);
        LLToXY93(Longi1, Longi2,Longi2,Lati2,x2,y2);
      end if;
    else
      if Longi2=floor(Longi2/6.0)*6.0 then
        LLToXY36(Longi1, Longi2,Longi1,Lati1,x1,y1);
        LLToXY36(Longi1, Longi2,Longi2,Lati2,x2,y2);
      else
        LLToXY39(Longi1, Longi2,Longi1,Lati1,x1,y1);
        LLToXY39(Longi1, Longi2,Longi2,Lati2,x2,y2);
			end if;
		end if;
	 end if;
	distance :=sqrt( power((x1-x2),2)+power((y1-y2),2) );
	return distance;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETANTESIZE
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETANTESIZE"(asize in varchar2) return float is
	V_Result float;
begin
  if asize is null then
     V_Result := 0;
  else
	    V_Result := to_number(asize);
  end if;
	return V_Result;
EXCEPTION
	WHEN OTHERS THEN
	V_Result := 0;
	return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETAREACODE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETAREACODE"(areacode varchar2)  return varchar2 is
   PVersion varchar2(40);
   i_count number(10);
   begin
   PVersion := areacode;
   if PVersion is null then
     SELECT   keyvalue into PVersion FROM t_rim_comm_appsettings where keyname='Area_Code' ;
   else
       select count(*) into i_count from RSBT_CODE_DIC where code_data_type='00032006' and cn=areacode;
       if i_count=0 then
          SELECT   keyvalue into PVersion FROM t_rim_comm_appsettings where keyname='Area_Code' ;
       end if;
   end if;
     return PVersion;
   end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETCHILDORGCOUNT
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETCHILDORGCOUNT"( parentGuid varchar2) return number  is
  retCount number;
begin
  select count(*) into retCount from t_rim_rsm_org_relev t where t.parent_org_guid = parentGuid;
  return(retCount);
end F_rim_rsm_GetChildOrgCount;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETCODENAME
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETCODENAME"(CODE in varchar2,code_data_type_A in varchar2) return varchar2 is
  Result varchar2(80);
  CodeName varchar2(80);
  cursor PT is select CODE_CHI_NAME from  RSBT_CODE_DIC where CN=CODE and code_data_type=code_data_type_A;
  V_SF PT%ROWTYPE;
begin
  ----根据代码编码获取----代码中文名称----报表
  open PT;
  loop
     FETCH PT INTO V_SF;
        EXIT WHEN PT%notfound;
     CodeName := V_SF.CODE_CHI_NAME;
     Exit;
  end loop;
  close PT;
  Result := CodeName;
  return(Result);

end F_rim_rsm_GetCodeName;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETDCBYDCODE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETDCBYDCODE"(dcode in varchar2,val in varchar2) return varchar2 is
  Result varchar2(200);
begin
  result := '';
  select dc.Code_CHI_Name into result from RSBT_CODE_DIC dc where dc.CN = val and dc.CODE_DATA_TYPE= dcode ;
  return(Result);

  exception
     when others then
      result := '';
      return(Result);
end;
/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETFEENO
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETFEENO" (year1 number) return varchar2 is
  V_Result varchar2(8);
  v_sum number;
begin
  select count(*) into v_sum from v_RIM_RSM_fee_no where item_no like to_char(year1)||'%';
  if v_sum > 0 then
    select to_char(max(to_number(item_no)+1)) into v_result from v_RIM_RSM_fee_no where item_no like to_char(year1)||'%';
  else
    V_Result:=to_char(year1)||'0001';
  end if;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETFREQ_BAND_UNIT
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETFREQ_BAND_UNIT"(FREQ_Band in number) return varchar2 is
  V_RTN varchar2(2);
  fREQ_Bandtmp number;
begin
  V_RTN := '1';
  fREQ_Bandtmp := FREQ_Band;
  if FREQ_Band is null then
     RETURN   V_RTN;
  end if;
	if fREQ_Bandtmp<1 THEN
		V_RTN := '0';
	END IF;
	if fREQ_Bandtmp >= 1000 THEN
		V_RTN := '2';
	END IF;
	RETURN V_RTN;
END;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETFREQ_E_STATGUID
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETFREQ_E_STATGUID"(statguid varchar2) return varchar2 is
  Result varchar2(800);
  CURSOR c_freqs is select t.freq_efb||'-'||t.freq_efe freq from rsbt_freq t where t.station_guid = statguid;
  v_freq c_freqs%rowtype;
begin
  result := '';
  OPEN c_freqs;
  loop
    fetch c_freqs into v_freq;
    exit when c_freqs%notfound;
    result := result ||v_freq.freq||';';
  end loop;
  close c_freqs;
  return(Result);
end f_rim_rsm_getfreq_e_statguid;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETFREQ_FRE_POW_UNI
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETFREQ_FRE_POW_UNI"(freq_Pow in number) return varchar2 is
  V_RTN varchar2(2);
  fREQ_PowTmp number;
begin
  V_RTN := '4';
  fREQ_PowTmp := freq_Pow;
	if freq_Pow is null then
		fREQ_PowTmp :=0;
	end if;
	if fREQ_PowTmp<1 THEN
		V_RTN := '3';
	END IF;
	if fREQ_PowTmp >= 1000 THEN
		V_RTN := '5';
	END IF;
	RETURN V_RTN;
END;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETFREQ_FRE_POWUNI
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETFREQ_FRE_POWUNI"(freq_Pow in number) return varchar2 is
  V_RTN varchar2(2);
  fREQ_PowTmp number;
begin
  V_RTN := '4';
  fREQ_PowTmp := freq_Pow;
	if freq_Pow is null then
		fREQ_PowTmp :=0;
	end if;
	if fREQ_PowTmp<1 THEN
		V_RTN := '3';
	END IF;
	if fREQ_PowTmp >= 1000 THEN
		V_RTN := '5';
	END IF;
	RETURN V_RTN;
END;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETFREQ_FREQ_UNIT
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETFREQ_FREQ_UNIT"(FREQ1 in number,FREQ2 in number,FREQ3 in number,FREQ4 in number) return varchar2 is
	V_RTN varchar2(2);
  fREQ_tmp number;
begin
	V_RTN := '1';
	fREQ_tmp:=FREQ1;
	if nvl(fREQ_tmp,0)=0 then
	   fREQ_tmp:=FREQ2;
	end if;
	if nvl(fREQ_tmp,0)=0 then
	   fREQ_tmp:=FREQ3;
	end if;
	if nvl(fREQ_tmp,0)=0 then
	   fREQ_tmp:=FREQ4;
	end if;
	if nvl(fREQ_tmp,0)=0 then
		RETURN  V_RTN;
	end if;
	if fREQ_tmp<29.7 THEN
		V_RTN := '0';
	elsif fREQ_tmp >= 10000 THEN
		V_RTN := '2';
	END IF;
	RETURN V_RTN;
END;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETFREQ_R
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETFREQ_R"(FREQ in number,UNIT IN varchar2) return NUMBER is
	V_RTN NUMBER(14,7);
begin
	V_RTN := FREQ;
	if UNIT = '2' THEN
		V_RTN := FREQ/1000;
	END IF;
	--if UNIT = '0' THEN
	--	V_RTN := FREQ*1000;
	--END IF;
	if UNIT = '0' THEN
	    IF FREQ <= 9999.9999999 THEN
	       V_RTN := FREQ*1000;
	    ELSE
	       IF NVL(FREQ,9999999.9999999)=9999999.9999999 THEN
						V_RTN := TO_NUMBER(NULL);
					ELSE
						V_RTN := 9999999.9999999;
					END IF;
	    END IF;
	END IF;

	RETURN V_RTN;
END;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETFREQ_R_STATGUID
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETFREQ_R_STATGUID"(statguid varchar2) return varchar2 is
  Result varchar2(800);
  CURSOR c_freqs is select t.freq_rfb||'-'||t.freq_rfe freq from rsbt_freq t where t.station_guid = statguid;
  v_freq c_freqs%rowtype;
begin
  result := '';
  OPEN c_freqs;
  loop
    fetch c_freqs into v_freq;
    exit when c_freqs%notfound;
    result := result ||v_freq.freq||';';
  end loop;
  close c_freqs;
  return(Result);
end f_rim_rsm_getfreq_r_statguid;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETGAIN_I
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETGAIN_I"(GAIN in number,UNIT IN varchar2) return NUMBER is
	V_RTN NUMBER(14,7);
begin
  V_RTN := GAIN;
	if UNIT = '1' then
		V_RTN := GAIN;
	elsif UNIT = '0' then
		V_RTN := GAIN - 2.15;
	end if;
	RETURN V_RTN;
END;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETPAADDRBYAPPCODE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETPAADDRBYAPPCODE"(appCode in varchar2) return varchar2 is
  Result varchar2(200);
begin
  result := '';
  select pa.app_pa_contact_addr into result from RSBT_APPLY_PA pa where rownum=1 and pa.app_guid = (select guid from rsbt_apply where app_code=appCode);
  return(Result);

  exception
     when others then
      result := '';
      return(Result);
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETPANAME
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETPANAME" (appCode Varchar2,isbak Varchar2) return varchar2 is
  V_Result varchar2(40);
BEGIN
    IF isbak='r' THEN
        SELECT app_pa_name INTO V_Result  FROM rsbt_apply_pa_r a,rsbt_apply_r b WHERE a.app_guid=b.guid  AND b.app_code=appCode AND rownum=1;
    ELSE
         SELECT app_pa_name INTO V_Result  FROM rsbt_apply_pa a,rsbt_apply b WHERE a.app_guid=b.guid  AND b.app_code=appCode AND rownum=1;
    END IF;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETPANAME_QUERYLICE
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETPANAME_QUERYLICE" (appCode Varchar2) return varchar2 is
  V_Result varchar2(80);
  AppCode_Temp varchar2(80);
  ----查询执照数据PA的单位名称
  cursor PT is SELECT app_pa_name  FROM rsbt_apply_pa a,rsbt_apply b WHERE a.app_guid=b.guid  AND b.app_code=appCode AND rownum=1;
  V_SF PT%ROWTYPE;
  --历史库
  cursor PT_H is SELECT app_pa_name  FROM rsbt_apply_pa_r a,rsbt_apply_r b WHERE a.app_guid=b.guid  AND b.app_code=appCode AND rownum=1;
  V_SF_H PT_H%ROWTYPE;
BEGIN
  open PT;
  loop
     FETCH PT INTO V_SF;
        EXIT WHEN PT%notfound;
     AppCode_Temp := V_SF.app_pa_name;
     Exit;
  end loop;
  close PT;
  ----查询历史库（如果AppCode_Temp is null）
  if AppCode_Temp is null then
    open PT_H;
    loop
       FETCH PT_H INTO V_SF_H;
          EXIT WHEN PT_H%notfound;
         AppCode_Temp := V_SF_H.app_pa_name;
       Exit;
     end loop;
     close PT_H;
  end if;
  --
  V_Result := AppCode_Temp;
  return(V_Result);

end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETPANAMEBYAPPCODE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETPANAMEBYAPPCODE"(appCode in varchar2) return varchar2 is
  Result varchar2(200);
begin
  result := '';
  select pa.app_pa_name into result from RSBT_APPLY_PA pa where rownum=1 and pa.app_guid = (select guid from rsbt_apply where app_code=appCode);
  return(Result);
  exception
     when others then
      result := '';
      return(Result);
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETPANAMEBYAPPCODE_H
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETPANAMEBYAPPCODE_H"(appCode in varchar2) return varchar2 is
  Result varchar2(200);
begin
  result := '';
  select pa.app_pa_name into result from RSBT_APPLY_PA_H pa where rownum=1 and pa.app_guid = (select guid from rsbt_apply_H where app_code=appCode);
  return(Result);
  exception
     when others then
      result := '';
      return(Result);
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETPARAMETERVERSION
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETPARAMETERVERSION"  return varchar2 is
   PVersion varchar2(40);
   begin
     SELECT   valuedesc into PVersion FROM t_rim_comm_appsettings where keyid='ParameterVersion' ;
     return PVersion;
   end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETPOWER_W
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETPOWER_W"(EPOWER IN NUMBER,UNIT IN VARCHAR2) RETURN NUMBER IS
V_RTN NUMBER(14,7);
V_TMP NUMBER(14,7);
V_ISZ BOOLEAN;
BEGIN
IF NVL(EPOWER,0)<>0 THEN
     V_TMP := EPOWER;
     IF EPOWER<0 THEN
        V_ISZ := FALSE;
        V_TMP := EPOWER * -1;
     END IF;
     SELECT DECODE(UNIT,'5',V_TMP/1000,'3',V_TMP*1000,
          '2',LOG(10, V_TMP) * 10,'1',(LOG(10, V_TMP)*10) + 30,
          '0',LOG(10,SQRT(50*V_TMP))*20+120,V_TMP) INTO V_RTN FROM DUAL;
END IF;
IF  EPOWER=0 THEN
    V_RTN:=0;
END IF;
IF V_ISZ=FALSE THEN
     V_RTN := V_RTN * -1;
END IF;
  RETURN ROUND(V_RTN,2);
END;
/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETRELEVTYPE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETRELEVTYPE"(orgGuid varchar2) return varchar2 is
  retType varchar2(10);
  itemCount number;
begin
  retType := '无';
  select count(*) into itemCount from t_rim_rsm_org_relev t where t.parent_org_guid = orgGuid;
  if itemCount > 0 then
  retType := '上级单位';
  end if;
  select count(*) into itemCount from t_rim_rsm_org_relev t where t.child_org_guid = orgGuid;
  if itemCount > 0 then
  retType := '下属单位';
  end if;
  return(retType);
end f_rim_rsm_getrelevtype;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETSTATCOUNTBYTYPEID
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETSTATCOUNTBYTYPEID"(typeguid varchar2,statguid varchar2) return number is
  Result number;
begin
  Result := 0;
      select count(*) into Result from t_rim_rsm_stat_type_relev t where t.stat_type_guid = typeguid and t.stat_guid = statguid ;
  return(Result);
end f_rim_rsm_GetStatCountByTypeID;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETSTATTYPES
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETSTATTYPES"(stat_no varchar2) return varchar2 is
  Result varchar2(800);
  CURSOR c_types is  select t.typename from rsbt_station s,t_rim_rsm_stat_type_relev r,t_rim_rsm_station_type t where s.guid = r.stat_guid and r.stat_type_guid = t.guid and s.guid = stat_no;
  v_type c_types%rowtype;
begin
  result := '';
  OPEN c_types;
  loop
    fetch c_types into v_type;
    exit when c_types%notfound;
    result := result ||v_type.typename||'; ';
  end loop;
  close c_types;
  return(Result);
end f_rim_rsm_getstattypes;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETTECHCODE
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_GETTECHCODE"(app_code_I varchar2) return varchar2
is
  V_Result varchar2(50);
  V_DECL VARCHAR2(10);
        CURSOR c_decl IS select distinct stat_app_type from rsbt_station where app_code=app_code_I order by stat_app_type;
        r_decl c_decl%ROWTYPE;
begin
      V_DECL := '#';
  OPEN c_decl;
  LOOP
      FETCH c_decl INTO r_decl;
      EXIT WHEN c_decl%NOTFOUND;
         if r_decl.stat_app_type <> V_DECL then
            V_DECL := r_decl.stat_app_type;
            V_Result:=V_Result || '/' || V_DECL;
         End if;
  end loop;
  CLOSE c_decl;
  if length(V_Result)>0 then
     return substr(V_Result,2,length(V_Result)-1);
  else
     return '';
  end if;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_GETUSERLISTBYAREA
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_GETUSERLISTBYAREA"(guid in varchar2,resultType in varchar2 default '0') return varchar2 is
  result varchar2(10000);
  v_name varchar2(100);
   nameid varchar2(100);
  i_mid number(4);
  CURSOR C_USERLIST IS SELECT RESID,PRINCIPALID,PRINCIPALTYPE,PERMISSIONVALUE FROM T_RIM_COMM_DATA_ACL WHERE RESID=guid;
  V_USERLIST C_USERLIST%ROWTYPE;
begin
  result := '';
  OPEN C_USERLIST;
  LOOP
    FETCH C_USERLIST INTO V_USERLIST;
    EXIT WHEN C_USERLIST%NOTFOUND;
      if V_USERLIST.PRINCIPALTYPE=0 then
        select count(*) into i_mid from T_RIM_comm_user where userid=V_USERLIST.PRINCIPALID;
        if i_mid>0 then
          select nvl(userName,userid),userid into v_name, nameid from T_RIM_comm_user where userid=V_USERLIST.PRINCIPALID;
        end if;
      ELSIF V_USERLIST.PRINCIPALTYPE=1 then
        select count(*) into i_mid from T_RIM_comm_role where ROLENAME=V_USERLIST.PRINCIPALID;
        if i_mid>0 then
          select nvl(ROLEDESC,ROLENAME),ROLENAME into v_name, nameid from T_RIM_comm_role where ROLENAME=V_USERLIST.PRINCIPALID;
        end if;
      else
        select count(*) into i_mid from t_rim_comm_department where DEPTID=V_USERLIST.PRINCIPALID;
        if i_mid>0 then
          select DEPTNAME,DEPTID into v_name,nameid from t_rim_comm_department where DEPTID=V_USERLIST.PRINCIPALID;
        --else  在gdims 下没有找到oa_company相对应的表
        --  select count(*) into i_mid from oa_company where DEPTID=V_USERLIST.PRINCIPALID;
        --  if i_mid>0 then
        --    select name into v_name from oa_company where DEPTID=V_USERLIST.PRINCIPALID;
        --  end if;
        end if;
      end if;
      if v_name='' then
        Result := Result;
      else
        --20111009 wangzh 只需要获取数据名称
        if resultType = '1' then
           Result := Result || ' ' || v_name || ';' ;
        else
           Result := Result || '$' || V_USERLIST.PRINCIPALTYPE || '_' || v_name || '_' || nameid;
        end if;
      end if;
  END LOOP;
  CLOSE C_USERLIST;
  if Result = '' then
    Result := Result;
  else
    Result:=substr(Result,2,length(Result)-1);
  end if;
  return(Result);
  exception
     when others then
      Result := '';
      return(Result);
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_ISALERT
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_ISALERT"(end_date DATE,isalert VARCHAR2) return varchar2 is
  retVal varchar2(1) ;
begin
  retVal:='1';
  if end_date is null or isalert is null then
     retVal:='1';
  else
     if end_date < sysdate  then
        retVal:=isalert;
      else
         retVal:='0';
      end if;
  end if;
  return(retVal);
end f_rim_rsm_isalert;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_LICEVALIDCHECK
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_LICEVALIDCHECK"(validdate date,licstatues varchar2) return varchar2
is
	V_Result varchar2(4);
	V_Tmp varchar2(24);
  V_Date date;
 begin
	if validdate is null then
		V_Result:='未发';
	else
    V_Tmp := to_char(validdate,'yyyy-mm-dd');
    V_Date := to_date(V_Tmp || ' 23:59:59','yyyy-mm-dd HH24:Mi:ss');
    if licstatues='2' then
       return '吊销';
    end if;
    if licstatues='4' then
          return '注销';
    end if;
    if V_Date<sysdate then
  		V_Result:='过期';
  	else if licstatues='1' then
  		V_Result:='已发';
      end if;
       if licstatues='3' then
      V_Result:='换发';
      end if;
    end if;
  end if;
  return V_Result;
end;
/

-- ----------------------------
-- Function structure for F_RIM_RSM_LICEVALIDCHECK1
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_LICEVALIDCHECK1"(validdate date,licstatues varchar2) return varchar2
is
	V_Result varchar2(4);
	V_Tmp varchar2(24);
  V_Date date;
 begin
	if validdate is null then
		V_Result:='未发';
	else
    V_Tmp := to_char(validdate,'yyyy-mm-dd');
    V_Date := to_date(V_Tmp || ' 23:59:59','yyyy-mm-dd HH24:Mi:ss');
    if V_Date<sysdate then
  		V_Result:='过期';
  	else
      if licstatues='1' then
  		V_Result:='已发';
      end if;
      if licstatues='2' then
      V_Result:='停用';
      end if;
    end if;
  end if;
	return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_LICEVALIDCHECKFLAG
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_LICEVALIDCHECKFLAG"(validdate date,licstatues varchar2) return varchar2
is
----执照状态标示（1：已发，2：停用，3：换发，4：注销，5：过期，6：未发）
  V_Result varchar2(4);
  V_Tmp varchar2(24);
  V_Date date;
 begin
  if validdate is null then
    --V_Result:='未发';
    V_Result:='6';
  else
    V_Tmp := to_char(validdate,'yyyy-mm-dd');
    V_Date := to_date(V_Tmp || ' 23:59:59','yyyy-mm-dd HH24:Mi:ss');
    if licstatues='2' then
       --return '停用';
       return '2';
    end if;
    if licstatues='4' then
          --return '注销';
          return '4';
    end if;
    if V_Date<sysdate then
      --V_Result:='过期';
      V_Result:='5';
    else if licstatues='1' then
       --V_Result:='已发';
       V_Result:='1';
    end if;
       if licstatues='3' then
         --V_Result:='换发';
         V_Result:='3';
       end if;
    end if;
  end if;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_MONEY
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_MONEY"(money_num number) return varchar2
is
  v_word varchar2(100);
  v_tmp varchar2(100);
  V_Result varchar2(100);
  v_num number;
  v_word1 varchar2(10);
  v_word2 varchar2(10);
begin
  v_word:='零壹贰叁肆伍陆柒捌玖分角元拾佰仟万拾佰仟亿';
  V_Result := '';
  v_tmp := to_char(floor(money_num*100));
  v_num :=length(v_tmp);
  while v_num >0  loop
    v_word1 :=substr(v_word,to_number(substr(v_tmp,Length(v_tmp)-v_num+1,1)+1),1);
    v_word2 :=substr(v_word,(10+v_num),1);
    V_Result:=V_Result||v_word1||v_word2;
    v_num :=v_num-1;
  end loop;
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_STAT_CHANGEDEGREE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_STAT_CHANGEDEGREE"(deg IN NUMBER) return varchar2
is
    v_num number;
    v_d number;
    v_m number;
    v_s number;
    b_rtn varchar2(30) := '';
begin
     if deg is NULL OR deg = 0 then
	      return b_rtn;
	   end if;
     v_d := floor(deg);
     v_num := (deg - v_d) * 60;
     v_m := floor(v_num);
     v_num := (v_num - v_m) * 60;
     v_s := v_num;
     b_rtn := to_char(v_d) || '°' || to_char(v_m) || '′' || round(v_s,2) || '″';
	   return b_rtn;
end;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_STATION_GUIDCODE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_RIM_RSM_STATION_GUIDCODE"(Apply_codeTemp in varchar2,decl_codeTemp in varchar2) return varchar2 is
  Result varchar2(80);
  AppCode_Temp varchar2(80);
  cursor PT is select guid AS Station_Guid from  rsbt_station A where substr(A.app_code,-12,12)=Apply_codeTemp and A.STAT_APP_Type||A.STAT_TDI=decl_codeTemp;
  V_SF PT%ROWTYPE;
  --历史库
  cursor PT_H is select guid AS Station_Guid from  Rsbt_Station_H A where substr(A.app_code,-12,12)=Apply_codeTemp and A.STAT_APP_Type||A.STAT_TDI=decl_codeTemp;
  V_SF_H PT_H%ROWTYPE;
begin
  ----根据申请编号500020070245、技术资料表编号LM0005，获取申请表编号T500020070245或PA500020070245
  open PT;
  loop
     FETCH PT INTO V_SF;
        EXIT WHEN PT%notfound;
     AppCode_Temp := V_SF.Station_Guid;
     Exit;
  end loop;
  close PT;
  ----查询历史库（如果AppCode_Temp is null）
  if AppCode_Temp is null then
    open PT_H;
    loop
       FETCH PT_H INTO V_SF_H;
          EXIT WHEN PT_H%notfound;
         AppCode_Temp := V_SF_H.Station_Guid;
       Exit;
     end loop;
     close PT_H;
  end if;
  --
  Result := AppCode_Temp;
  return(Result);

end F_rim_rsm_Station_GuidCode;

/

-- ----------------------------
-- Function structure for F_RIM_RSM_YEAR
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."F_RIM_RSM_YEAR"(inputyear varchar2) return varchar2
is
  curyear number;
  yearchar varchar2(20);
  midnum  number;
  midyear  varchar2(10);
  V_Result varchar2(30);
begin
  yearchar:='0一二三四五六七八九';
  curyear:=to_number(inputyear);
  midnum:=trunc(curyear/1000,0);
  midyear:=substr(yearchar,midnum+1,1);
  curyear:=curyear-midnum*1000;
  midnum:=trunc(curyear/100,0);
  midyear:=midyear||substr(yearchar,midnum+1,1);
  curyear:=curyear-midnum*100;
  midnum:=trunc(curyear/10,0);
  midyear:=midyear||substr(yearchar,midnum+1,1);
  curyear:=curyear-midnum*10;
  V_Result:=midyear||substr(yearchar,curyear+1,1)||'年';
  return V_Result;
end;

/

-- ----------------------------
-- Function structure for F_TABLEEXISTS
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_TABLEEXISTS"(tableName in varchar2) return char is
  Result char(1);
  v_count number;
begin
  select count(*) into v_count from tab where upper(tname)=upper(tableName);
  if v_count>=1 then
      Result := 'Y';
  else
      Result := 'N';
  end if;
  return(Result);
end;

/

-- ----------------------------
-- Function structure for F_TO_CHAR
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_TO_CHAR"(num number ) return varchar2 is
  Result varchar2(15);
begin
    Result := to_char(num);
  if(num < 1) then
    Result := '0' || Result;
  end if;
  return(Result);
end f_to_char;

/

-- ----------------------------
-- Function structure for F_WF_CANRETAKE
-- ----------------------------
CREATE OR REPLACE function "RXDEV"."F_WF_CANRETAKE"(v_workId in char) return char is
  Result char(1);
  v_tranNo number(12);
  v_commitedCount number(6);
  v_caseId number(12);
begin
  --获取指定工作项提交时的事务编号
  select a.transactionno into v_tranNo from wf_rt_rollbackstack a where
  a.optarget=v_workId and a.optype=4;

  select a.caseid into v_caseId from wf_rt_rollbackstack a where
  a.optarget=v_workId and a.optype=4;

  --判断指定事务中所派发的工作项有多少已完成
 select count(*) into v_commitedCount from wf_rt_work a where
  a.workid in (select b.optarget from wf_rt_rollbackstack b
           where b.caseid=v_caseId and b.transactionno=v_tranNo and b.optype=3 and b.optarget<>v_workId)
  and a.iscommited='Y';

  if v_commitedCount=0 then
      Result := 'Y';
  else
      Result := 'N';
  end if;

  return(Result);
end f_wf_CanRetake;

/

-- ----------------------------
-- Function structure for GET_GUID
-- ----------------------------
CREATE OR REPLACE FUNCTION "RXDEV"."GET_GUID"
   RETURN CHAR
IS
   v_guid              CHAR (36);
   v_guid_part_one     CHAR (8);
   v_guid_part_two     CHAR (4);
   v_guid_part_three   CHAR (4);
   v_guid_part_four    CHAR (4);
   v_guid_part_five    CHAR (12);
BEGIN
   SELECT SYS_GUID ()
     INTO v_guid
     FROM DUAL;

   v_guid_part_one := SUBSTR (v_guid, 0, 8);
   v_guid_part_two := SUBSTR (v_guid, 8, 4);
   v_guid_part_three := SUBSTR (v_guid, 12, 4);
   v_guid_part_four := SUBSTR (v_guid, 16, 4);
   v_guid_part_five := SUBSTR (v_guid, 20, 12);
   v_guid :=
      CONCAT
         (CONCAT
             (CONCAT
                 (CONCAT (CONCAT (CONCAT (CONCAT (CONCAT (v_guid_part_one,
                                                          '-'),
                                                  v_guid_part_two
                                                 ),
                                          '-'
                                         ),
                                  v_guid_part_three
                                 ),
                          '-'
                         ),
                  v_guid_part_four
                 ),
              '-'
             ),
          v_guid_part_five
         );
   RETURN (lower(v_guid));
END GET_GUID;

/

-- ----------------------------
-- Indexes structure for table AR_CALL_SIGN_T
-- ----------------------------

-- ----------------------------
-- Primary Key structure for table AR_CALL_SIGN_T
-- ----------------------------
ALTER TABLE "RXDEV"."AR_CALL_SIGN_T" ADD PRIMARY KEY ("CALL_SIGN_ID");



-- ----------------------------
-- Indexes structure for table FRBT_ASSIGN_TEMP_BUSINESS
-- ----------------------------

-- ----------------------------
-- Checks structure for table FRBT_ASSIGN_TEMP_BUSINESS
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table FRBT_ASSIGN_TEMP_BUSINESS
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_ASSIGN_TEMP_BUSINESS" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table FRBT_ASSIGN_TEMP_FILE
-- ----------------------------

-- ----------------------------
-- Checks structure for table FRBT_ASSIGN_TEMP_FILE
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_ASSIGN_TEMP_FILE" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table FRBT_ASSIGN_TEMP_FILE
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_ASSIGN_TEMP_FILE" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table FRBT_ASSIGN_TEMP_MATCH
-- ----------------------------

-- ----------------------------
-- Checks structure for table FRBT_ASSIGN_TEMP_MATCH
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_ASSIGN_TEMP_MATCH" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table FRBT_ASSIGN_TEMP_MATCH
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_ASSIGN_TEMP_MATCH" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table FRBT_RESOURCE
-- ----------------------------

-- ----------------------------
-- Checks structure for table FRBT_RESOURCE
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table FRBT_RESOURCE
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table FRBT_RESOURCE_BAND
-- ----------------------------

-- ----------------------------
-- Checks structure for table FRBT_RESOURCE_BAND
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_BAND" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table FRBT_RESOURCE_BAND
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_BAND" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table FRBT_RESOURCE_BAND_FREQ
-- ----------------------------

-- ----------------------------
-- Checks structure for table FRBT_RESOURCE_BAND_FREQ
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_BAND_FREQ" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table FRBT_RESOURCE_BAND_FREQ
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_BAND_FREQ" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table FRBT_RESOURCE_FREQ
-- ----------------------------

-- ----------------------------
-- Checks structure for table FRBT_RESOURCE_FREQ
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_FREQ" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table FRBT_RESOURCE_FREQ
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_FREQ" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table FRBT_RESOURCE_GROUP
-- ----------------------------

-- ----------------------------
-- Checks structure for table FRBT_RESOURCE_GROUP
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_GROUP" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table FRBT_RESOURCE_GROUP
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_GROUP" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table IP_SYS_SEQUENCE
-- ----------------------------
CREATE UNIQUE INDEX "RXDEV"."UNIQUE_YEAR"
ON "RXDEV"."IP_SYS_SEQUENCE" ("CURRENT_YEAR" DESC)
LOGGING
VISIBLE;

-- ----------------------------
-- Checks structure for table IP_SYS_SEQUENCE
-- ----------------------------
ALTER TABLE "RXDEV"."IP_SYS_SEQUENCE" ADD CHECK ("ID" IS NOT NULL);
ALTER TABLE "RXDEV"."IP_SYS_SEQUENCE" ADD CHECK ("CURRENT_YEAR" IS NOT NULL);
ALTER TABLE "RXDEV"."IP_SYS_SEQUENCE" ADD CHECK ("CURRENT_NUM" IS NOT NULL);
ALTER TABLE "RXDEV"."IP_SYS_SEQUENCE" ADD CHECK ("ID" IS NOT NULL);
ALTER TABLE "RXDEV"."IP_SYS_SEQUENCE" ADD CHECK ("CURRENT_YEAR" IS NOT NULL);
ALTER TABLE "RXDEV"."IP_SYS_SEQUENCE" ADD CHECK ("CURRENT_NUM" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table IP_SYS_SEQUENCE
-- ----------------------------
ALTER TABLE "RXDEV"."IP_SYS_SEQUENCE" ADD PRIMARY KEY ("ID");

-- ----------------------------
-- Indexes structure for table RSBT_TEMPORARY
-- ----------------------------

-- ----------------------------
-- Checks structure for table RSBT_TEMPORARY
-- ----------------------------
ALTER TABLE "RXDEV"."RSBT_TEMPORARY" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table RSBT_TEMPORARY
-- ----------------------------
ALTER TABLE "RXDEV"."RSBT_TEMPORARY" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table SPLSTATION_CONDITION
-- ----------------------------

-- ----------------------------
-- Checks structure for table SPLSTATION_CONDITION
-- ----------------------------
ALTER TABLE "RXDEV"."SPLSTATION_CONDITION" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table SPLSTATION_CONDITION
-- ----------------------------
ALTER TABLE "RXDEV"."SPLSTATION_CONDITION" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Checks structure for table SPLSTATION_CONSULT
-- ----------------------------
ALTER TABLE "RXDEV"."SPLSTATION_CONSULT" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_CONSULT" ADD CHECK ("SPLSTATION_GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_CONSULT" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_CONSULT" ADD CHECK ("SPLSTATION_GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_CONSULT" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_CONSULT" ADD CHECK ("SPLSTATION_GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_CONSULT" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_CONSULT" ADD CHECK ("SPLSTATION_GUID" IS NOT NULL);

-- ----------------------------
-- Indexes structure for table SPLSTATION_MANGER
-- ----------------------------

-- ----------------------------
-- Checks structure for table SPLSTATION_MANGER
-- ----------------------------
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD CHECK ("STATION_GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD CHECK ("STATION_GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD CHECK ("STATION_GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table SPLSTATION_MANGER
-- ----------------------------
ALTER TABLE "RXDEV"."SPLSTATION_MANGER" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table SPLSTATION_PROTECTINTERVAL
-- ----------------------------

-- ----------------------------
-- Checks structure for table SPLSTATION_PROTECTINTERVAL
-- ----------------------------
ALTER TABLE "RXDEV"."SPLSTATION_PROTECTINTERVAL" ADD CHECK ("GUID" IS NOT NULL);
ALTER TABLE "RXDEV"."SPLSTATION_PROTECTINTERVAL" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table SPLSTATION_PROTECTINTERVAL
-- ----------------------------
ALTER TABLE "RXDEV"."SPLSTATION_PROTECTINTERVAL" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table SPLSTATION_RELEVANTFILE
-- ----------------------------

-- ----------------------------
-- Checks structure for table SPLSTATION_RELEVANTFILE
-- ----------------------------
ALTER TABLE "RXDEV"."SPLSTATION_RELEVANTFILE" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table SPLSTATION_RELEVANTFILE
-- ----------------------------
ALTER TABLE "RXDEV"."SPLSTATION_RELEVANTFILE" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Indexes structure for table T_RIM_PA_AR_LICENSE
-- ----------------------------

-- ----------------------------
-- Checks structure for table T_RIM_PA_AR_LICENSE
-- ----------------------------
ALTER TABLE "RXDEV"."T_RIM_PA_AR_LICENSE" ADD CHECK ("GUID" IS NOT NULL);

-- ----------------------------
-- Primary Key structure for table T_RIM_PA_AR_LICENSE
-- ----------------------------
ALTER TABLE "RXDEV"."T_RIM_PA_AR_LICENSE" ADD PRIMARY KEY ("GUID");

-- ----------------------------
-- Foreign Key structure for table "RXDEV"."FRBT_RESOURCE_BAND"
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_BAND" ADD FOREIGN KEY ("RESOURCE_GUID") REFERENCES "RXDEV"."FRBT_RESOURCE" ("GUID");

-- ----------------------------
-- Foreign Key structure for table "RXDEV"."FRBT_RESOURCE_BAND_FREQ"
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_BAND_FREQ" ADD FOREIGN KEY ("BAND_GUID") REFERENCES "RXDEV"."FRBT_RESOURCE_BAND" ("GUID");

-- ----------------------------
-- Foreign Key structure for table "RXDEV"."FRBT_RESOURCE_FREQ"
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_FREQ" ADD FOREIGN KEY ("GROUP_GUID") REFERENCES "RXDEV"."FRBT_RESOURCE_GROUP" ("GUID");

-- ----------------------------
-- Foreign Key structure for table "RXDEV"."FRBT_RESOURCE_GROUP"
-- ----------------------------
ALTER TABLE "RXDEV"."FRBT_RESOURCE_GROUP" ADD FOREIGN KEY ("BAND_GUID") REFERENCES "RXDEV"."FRBT_RESOURCE_BAND" ("GUID");
